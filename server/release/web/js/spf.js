function ArrayList(){this._array=new Array,this._length=0}function StringMapedArrayList(){ArrayList.call(this),this._map={}}function StringMapedStringArrayList(){ArrayList.call(this),this._map={}}function PersonList(){StringMapedArrayList.call(this)}function ContactList(){PersonList.call(this),this._sortedData=null}function FollowFollowerList(){PersonList.call(this),this._memberCount=0,this._gotten=!1}function FollowList(){FollowFollowerList.call(this)}function FollowerList(){FollowFollowerList.call(this)}function NoConnectionPersonList(){PersonList.call(this)}function ReminderList(){ArrayList.call(this)}function SearchResultPersonList(){this._allItemCount=0,PersonList.call(this)}function ColumnInformation(){this._colmnType=ColumnInformation.TYPE_COLUMN_UNKNOWN,this._filterCondition="",this._sortOrder=ColumnInformation.SORT_ORDER_DES,this._sortType=ColumnInformation.SORT_TYPE_TIME,this._messageList=new MessageDataList,this._displayName="",this._iconImage="",this._searchCondition=null,this._hasSendMessageRight=!1,this._hasViewMessageRight=!1}function FilterColumnInfomation(){ColumnInformation.call(this),this._colmnType=ColumnInformation.TYPE_COLUMN_FILTER,this._sourceColumnType=ColumnInformation.TYPE_COLUMN_UNKNOWN,this._sourceColumnDisplayName="",this._keyword="",this._subData=null,this._beginningColumnType=ColumnInformation.TYPE_COLUMN_UNKNOWN}function CustomFilterColumnInfomation(){ColumnInformation.call(this),this._colmnType=ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER,this._sourceColumnType=ColumnInformation.TYPE_COLUMN_UNKNOWN,this._sourceColumnDisplayName="",this._setting=null,this._subData=null,this._sourceColumnTypeList=new ArrayList,this._keyword=null,this._beginningColumnType=ColumnInformation.TYPE_COLUMN_UNKNOWN}function SearchColumnInfomation(){ColumnInformation.call(this),this._colmnType=ColumnInformation.TYPE_COLUMN_SEARCH,this._sourceColumnType=ColumnInformation.TYPE_COLUMN_UNKNOWN,this._sourceColumnTypeList=new ArrayList,this._keyword="",this._subData=null}function GroupChatColumnInformation(){ColumnInformation.call(this),this._colmnType=ColumnInformation.TYPE_COLUMN_GROUP_CHAT,this._iconImage="images/community_onebit.png",this._chatRoomInfomation=null}function CommunityFeedColumnInformation(){ColumnInformation.call(this),this._colmnType=ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED,this._iconImage="images/column_community_feed.png",this._communityInfomation=null}function CommunityTaskColumnInformation(){ColumnInformation.call(this),this._colmnType=ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK,this._iconImage="images/community_onebit.png",this._communityInfomation=null}function RecentColumnInfomation(){ColumnInformation.call(this),this._colmnType=ColumnInformation.TYPE_COLUMN_RECENT,this._sourceColumnType=ColumnInformation.TYPE_COLUMN_UNKNOWN,this._sourceColumnTypeList=new ArrayList,this._keyword="",this._subData=null}function ToMeColumnInfomation(){ColumnInformation.call(this),this._colmnType=ColumnInformation.TYPE_COLUMN_TOME,this._sourceColumnType=ColumnInformation.TYPE_COLUMN_UNKNOWN,this._sourceColumnTypeList=new ArrayList,this._keyword="",this._subData=null}function ShowConversationColumnInfomation(){ColumnInformation.call(this),this._colmnType=ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION,this._iconImage="images/column_show_conversation.png",this._sourceColumnType=ColumnInformation.TYPE_COLUMN_UNKNOWN,this._sourceColumnDisplayName="",this._parentItemId=null,this._itemId=null}function MurmurColumnInformation(){ColumnInformation.call(this),this._colmnType=ColumnInformation.TYPE_COLUMN_MURMUR,this._iconImage="",this._info=null,this._columnName=""}function ColumnList(){ArrayList.call(this)}function Profile(){this._nickName=null,this._mailAddress=null,this._group=null,this._avatarType=null,this._avatarData=null,this._loginAccount=null,this._status=Profile.STATUS_UNKNOWN}function Person(){this._group=null,this._profile=null,this._jid=null,this._presence=Person.PRESENCE_STATUS_OFFLINE,this._myMemo=null,this._id=-1}function LoginUser(){Person.call(this),this._settings=null,this._tenantInfo=null,this._extras=null,this._firstLogin=!1,this._followee=[],this._follower=[]}function UserSettings(){this._mailCooperationInfoList=new MailCooperationInfoList}function ProfileChangeNotice(){this._type=0,this._jid=""}function PresenceChangeNotice(){ProfileChangeNotice.call(this),this._type=ProfileChangeNotice.TYPE_PRESENCE,this._presence=Person.PRESENCE_STATUS_OFFLINE,this._myMemo=""}function ProfileChangeData(){ProfileChangeNotice.call(this),this._type=ProfileChangeNotice.TYPE_PROFILE,this._profile=null,this._updateTime=""}function AddContactListMember(){this._person=null,this._contactListGroup=null,this._position=0}function LoginPresence(){this._loginPresence=Person.PRESENCE_STATUS_OFFLINE,this._loginPresenceStr=""}function LoginMyMemo(){this._loginMyMemo=null}function Notification_model(){this._type=Notification_model.TYPE_BASE}function GoodJobNotification(){Profile.call(this),Notification_model.call(this),this._type=Notification_model.TYPE_GOOD_JOB,this._itemId="",this._fromJid="",this._fromName="",this._date="",this._message="",this._msgOwnJid="",this._msgTo="",this._msgType=Message.TYPE_UNKNOWN}function TaskNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_TASK,this._actionType=TaskNotification.ACTION_TYPE_NONE,this._taskMessage=null}function QuestionnaireNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_QUESTIONNAIRE,this._actionType=QuestionnaireNotification.ACTION_TYPE_NONE,this._questionnaireMessage=null}function ChatNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_CHAT,this._chatMessage=null}function SystemNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_SYSTEM,this._systemMessage=null}function MessageOptionNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_MESSAGE_OPTION,this._contentType=MessageOptionNotification.CONTENT_TYPE_BASE,this._itemId=""}function SiblingTaskNotification(){MessageOptionNotification.call(this),this._contentType=MessageOptionNotification.CONTENT_TYPE_SIBLING_TASK,this._siblingItemId="",this._ownerJid="",this._ownerName="",this._status=TaskMessage.STATUS_UNKNOWN,this._nickName=null,this._avatarType=null,this._avatarData=null,this._loginAccount=null,this._userStatus=Profile.STATUS_UNKNOWN}function DeleteMessageNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_DELETE_MESSAGE,this._itemId="",this._deleteFlag="",this._adminDeleted=""}function GroupChatNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_GROUP_CHAT,this._subType=0,this._roomInfo=null,this._profileMap=new StringMapedArrayList}function GroupChatMessageNotification(){GroupChatNotification.call(this),this._subType=GroupChatNotification.SUB_TYPE_MESSAGE,this._groupChatMessage=null}function GroupChatCreateNotification(){GroupChatNotification.call(this),this._subType=GroupChatNotification.SUB_TYPE_CREATE_ROOM}function GroupChatAddMemberNotification(){GroupChatNotification.call(this),this._subType=GroupChatNotification.SUB_TYPE_ADD_MEMBER,this._addedBy=null,this._addedMemberList=new ArrayList}function GroupChatRemoveMemberNotification(){GroupChatNotification.call(this),this._subType=GroupChatNotification.SUB_TYPE_REMOVE_MEMBER,this._removedBy=null,this._removedMemberList=new ArrayList}function GroupChatInfoUpdateNotification(){GroupChatNotification.call(this),this._subType=GroupChatNotification.SUB_TYPE_UPDATE_ROOM_INFO,this._updatedItems=new Array,this._previousRoomName=null,this._previousPrivacyType=null}function GroupChatAuthorityChangedNotification(){GroupChatNotification.call(this),this._subType=GroupChatNotification.SUB_TYPE_AUTHORITY_CHANGED,this._roomId="",this._roomInfo=null,this._policy=null}function MailMessageNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_MAIL,this._mailMessage=null}function DemandTaskNotification(){MessageOptionNotification.call(this),this._contentType=MessageOptionNotification.CONTENT_TYPE_DEMAND_TASK,this._taskTitle="",this._taskOwner="",this._taskClient="",this._taskStatus="",this._taskDemandStatus=TaskMessage.DEMAND_ON,this._taskDemandDate="",this._fromJid="",this._fromName=""}function SetReadMessageNotification(){MessageOptionNotification.call(this),this._contentType=MessageOptionNotification.CONTENT_TYPE_SET_READ_MESSAGE,this._existingReaderItem=null}function CommunityNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_COMMUNITY,this._subType=0}function CommunityInfoUpdateNotification(){CommunityNotification.call(this),this._subType=CommunityNotification.SUB_TYPE_UPDATE_ROOM_INFO,this._updatedCommunityInfo=null,this._previousCommunityInfo=null}function CommunityMemberAddNotification(){CommunityNotification.call(this),this._subType=CommunityNotification.SUB_TYPE_ADD_MEMBER,this._roomId="",this._roomName="",this._addedBy="",this._addedMemberList=new CommunityMemberList}function CommunityOwnerUpdateNotification(){CommunityNotification.call(this),this._subType=CommunityNotification.SUB_TYPE_UPDATE_OWNER,this._roomId="",this._ownerList=new ArrayList,this._preOwnerList=new ArrayList}function CommunityMemberRemoveNotification(){CommunityNotification.call(this),this._subType=CommunityNotification.SUB_TYPE_REMOVE_MEMBER,this._roomId="",this._roomName="",this._removedBy="",this._removedMemberList=new ArrayList}function CommunityMessageNotification(){CommunityNotification.call(this),this._subType=CommunityNotification.SUB_TYPE_MESSAGE,this._communityMessage=null}function CommunityAuthorityChangedNotification(){CommunityNotification.call(this),this._subType=CommunityNotification.SUB_TYPE_AUTHORITY_CHANGED,this._roomId="",this._roomName="",this._policy=null}function MurmurNotification(){}function MurmurMessageNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_MURMUR,this._subType=MurmurNotification.SUB_TYPE_MESSAGE,this._murmurMessage=null}function AuthorityInfoUpdateNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_AUTHORITY_CHANGED,this._subType=null,this._updatedItem=null,this._previousRoomName=null,this._triger=null}function MurmurSetColumnNameNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_MURMUR,this._subType=MurmurNotification.SUB_TYPE_SET_COLUMN_NAME,this._jid=null,this._columnName=null}function ThreadTitleUpdateNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_THREAD_TITLE,this._subType=null,this._threadRootId=null,this._threadTitle=null,this._itemId=null}function MessageUpdateNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_MESSAGE_UPDATE,this._subType=null,this._message=null}function EmotionPointNotification(){Profile.call(this),Notification_model.call(this),this._type=Notification_model.TYPE_EMOTION_POINT,this._itemId="",this._fromJid="",this._fromName="",this._created_at="",this._updated_at="",this._emotion_point="",this._message="",this._msgOwnJid="",this._msgTo="",this._msgType=Message.TYPE_UNKNOWN}function NoteAssignChangedNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_ASSIGN_NOTE,this._noteTitle=null,this._noteUrl=null,this._oldThreadRootId=null,this._threadRootId=null,this._roomId=null,this._ownJid=null}function NoteDeleteNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_DELETE_NOTE,this._noteTitle=null,this._noteUrl=null,this._threadRootId=null,this._roomId=null,this._ownJid=null}function UserFollowNotification(){Notification_model.call(this),this._type=Notification_model.TYPE_USER_FOLLOW,this._actionType=UserFollowNotification.ACTION_TYPE_NONE,this._followeeJid=null,this._followerJid=null,this._personInfo=null}function GoodJobList(){ArrayList.call(this)}function GoodJobData(){Profile.call(this),this._jid="",this._date=null}function Message(){this._type=Message.TYPE_UNKNOWN,this._from="",this._message="",this._date="",this._itemId="",this._id=-1,this._history=!1,this._deleteFlag=0,this._goodJobList=new GoodJobList,this._emotionPointList=new EmotionPointList,this._emotionIconList=null,this._readMore=!1,this._attachedFileUrlList=new ArrayList,this._readFlag=0,this._existingReaderInfo=null,this._uiShortenUrls=new ArrayList,this._profileMap=new StringMapedArrayList,this._threadTitle="",this._threadRootId="",this._updatedAt="",this._quotation="",this._noteTitle="",this._noteUrl="",this._bodyType=0}function PublicMessage(){Message.call(this),this._replyItemId="",this._publishNode="",this._replyTo="",this._type=Message.TYPE_PUBLIC}function ChatMessage(){Message.call(this),this._to="",this._direction=-1,this._replyItemId="",this._replyTo="",this._type=Message.TYPE_CHAT}function GroupChatMessage(){ChatMessage.call(this),this._roomName="",this._parentRoomId="",this._type=Message.TYPE_GROUP_CHAT}function MailMessage(){Message.call(this),this._to="",this._priority=1,this._mailMessageId="",this._mailInReplyTo="",this._replyItemId="",this._mailBodyInfo=null,this._type=Message.TYPE_MAIL}function MailBody(){this._id=-1,this._itemId="",this._jid="",this._mailBody=""}function TaskMessage(){Message.call(this),this._type=Message.TYPE_TASK,this._title="",this._startDate=null,this._dueDate=null,this._ownerJid="",this._priority=TaskMessage.PRIORITY_LOW,this._progress=0,this._noteArray=new TaskNoteList,this._status=TaskMessage.STATUS_NEW,this._reminderList=new ReminderList,this._spentTime=0,this._estimatedTime=0,this._remainingTime=0,this._parentItemId="",this._childrenItemIdList=new ArrayList,this._goal="",this._alert=TaskMessage.ALERT_NORMAL,this._referenceMessageItemId="",this._completeDate=null,this._replyTo="",this._updatedAt=null,this._updatedBy="",this._client="",this._preStatus=TaskMessage.STATUS_UNKNOWN,this._preOwnerJid="",this._preTitle="",this._preMessage="",this._preProgress=0,this._preSpentTime=0,this._preEstimatedTime=0,this._preRemainingTime=0,this._preGoal="",this._preAlert=TaskMessage.ALERT_NORMAL,this._siblingTaskDataList=new SiblingTaskDataList,this._demandStatus=TaskMessage.DEMAND_OFF,this._demandDate=null,this._communityId="",this._communityNeme=""}function CommunityMessage(){GroupChatMessage.call(this),this._type=Message.TYPE_COMMUNITY}function SystemMessage(){Message.call(this),this._type=Message.TYPE_SYSTEM,this._triggerAction=SystemMessage.TRIGGER_ACTION_NONE,this._replyItemId="",this._replyTo=""}function MessageDataList(){StringMapedArrayList.call(this)}function TaskNoteData(){this._jid="",this._date=null,this._message=""}function TaskNoteList(){ArrayList.call(this)}function SiblingTaskData(){Profile.call(this),this._itemId="",this._siblingItemId="",this._siblingOwnerJid="",this._siblingTaskStatus=TaskMessage.STATUS_UNKNOWN}function SiblingTaskDataList(){ArrayList.call(this)}function QuestionnaireMessage(){Message.call(this),this._type=Message.TYPE_QUESTIONNAIRE,this._inputType=QuestionnaireMessage.INPUTTYPE_RADIO,this._resultVisible=QuestionnaireMessage.INFORMATION_PUBLIC,this._graphType=QuestionnaireMessage.GRAPHTYPE_BAR,this._roomType="",this._roomId="",this._roomName="",this._parentRoomId="",this._optionCount=0,this._optionItems=new ArrayList,this._startDate=null,this._dueDate=null,this._replyItemId="",this._voteFlag=!1}function MurmurMessage(){ChatMessage.call(this),this._type=Message.TYPE_MURMUR,this._columnName=""}function CommunityInfo(){this._id=-1,this._roomId="",this._roomName="",this._description="",this._privacyType=CommunityInfo.PRIVACY_TYPE_ITEM_OPEN,this._memberEntryType="",this._logoUrl="",this._createdAt=null,this._createdBy="",this._updatedAt=null,this._updatedBy="",this._ownerList=new CommunityMemberList,this._generalMemberList=new CommunityMemberList,this._memberCount=0}function CommunityList(){StringMapedArrayList.call(this)}function CommunityMemberList(){PersonList.call(this)}function CommunityMember(){Person.call(this),this._role=CommunityMember.ROLE_TYPE_NOT_JOIN}function ColumnSearchCondition(e,t){this._filterCondition=null,this._sortCondition=null,e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))&&(this._filterCondition=e,this._sortCondition=t)}function ColumnFilterCondition(){}function ColumnSortCondition(){this._items=new ArrayList,this._orders=new ArrayList}function AndOrCondition(){ColumnFilterCondition.call(this),this._columnFilterConditionList=new ArrayList}function AndCondition(){AndOrCondition.call(this),this._type=ColumnFilterCondition.CONDITION_TYPE_AND}function OrCondition(){AndOrCondition.call(this),this._type=ColumnFilterCondition.CONDITION_TYPE_OR}function NotCondition(){ColumnFilterCondition.call(this),this._columnFilterCondition=null,this._type=ColumnFilterCondition.CONDITION_TYPE_NOT}function ItemCondition(){ColumnFilterCondition.call(this),this._type=ColumnFilterCondition.CONDITION_TYPE_ITEM,this._name=null,this._value=null}function GreaterThanCondition(){ItemCondition.call(this),this._type=ColumnFilterCondition.CONDITION_TYPE_GREATER_THAN}function LessThanCondition(){ItemCondition.call(this),this._type=ColumnFilterCondition.CONDITION_TYPE_LESS_THAN}function KeywordCondition(){ColumnFilterCondition.call(this),this._type=ColumnFilterCondition.CONDITION_TYPE_KEYWORD,this._value=null,this._include=null}function ParticularCondition(){ItemCondition.call(this),this._type=ColumnFilterCondition.CONDITION_TYPE_PARTICULAR}function FilterCondition(e){return e&&"string"==typeof e?void(this._jsonString=e):void(this._jsonString="")}function SortCondition(e){return e&&"string"==typeof e?void(this._jsonString=e):void(this._jsonString=this._getDefaultSortConditionJsonString())}function TaskFilterCondition(e){FilterCondition.call(this,null==e||"string"!=typeof e?this._getDefaultFilterJsonString():e)}function InboxFilterCondition(e){FilterCondition.call(this,null==e||"string"!=typeof e?this._getDefaultFilterJsonString():e)}function TaskSortCondition(e){SortCondition.call(this,null==e||"string"!=typeof e?this._getDefaultFilterJsonString():e)}function ColumnFilterManager(){}function FeedColumnFilter(){}function MyfeedColumnFilter(){}function ChatColumnFilter(){}function TaskColumnFilter(){}function InboxColumnFilter(){}function MentionColumnFilter(){}function GroupChatColumnFilter(){}function CommunityFeedColumnFilter(){}function QuestionnaireColumnFilter(){}function CommunityTaskColumnFilter(){}function MailColumnFilter(){}function RecentColumnFilter(){}function MurmurColumnFilter(){}function MyMurmurColumnFilter(){}function AllMurmurColumnFilter(){}function ToMeColumnFilter(){}function ChatRoomInformation(){this._id=-1,this._roomName="",this._roomId="",this._parentRoomId="",this._memberList=new ArrayList,this._memberListWithData={},this._createdAt=null,this._createdBy="",this._updatedAt=null,this._updatedBy="",this._owner="",this._preRoomName="",this._profileMap=new StringMapedArrayList,this._privacyType=ChatRoomInformation.PRIVACY_TYPE_ITEM_OPEN}function ChatRoomInfoList(){StringMapedArrayList.call(this)}function MailServerInformation(){this._id=-1,this._displayName="",this._serverType=-1,this._createdAt=null,this._createdBy="",this._updatedAt=null,this._updatedBy="",this._popHost="",this._popPort=0,this._popAuthMode=0,this._popResponseTimeout=0}function MailServerInfoList(){ArrayList.call(this)}function MailCooperationInformation(){this._id=-1,this._serverId=-1,this._serverName="",this._jid="",this._mailAddress="",this._branchNumber=-1,this._settingInfo=null,this._cooperationType=0}function MailCooperationInfoList(){ArrayList.call(this)}function AccountSettingInfomation(){this._account="",this._password=""}function PopSettingInfomation(){AccountSettingInfomation.call(this),this._type=AccountSettingInfomation.SERVER_TYPE_POP}function FilterManager(){}function DemandTaskFilter(){}function MessageExistingReaderInfo(){this._allCount=0,this._existingReaderItemList=new ArrayList}function ExistingReaderItem(){this._person=null,this._date=null}function ShortenURLInfo(){this.DisplayedURL=null,this.ShortenPath=null,this.OriginalURL=null}function createKey(e,t){if(!_aes_key)try{_aes_key=CryptoJS.PBKDF2(e,t,{keySize:4,iterations:500})}catch(n){}return _aes_key}function encrypt(e,t,n){var o=null;try{o=CryptoJS.enc.Hex.parse(n)}catch(i){return null}var a=null;try{a=CryptoJS.AES.encrypt(JSON.stringify(e),t,{iv:o})}catch(i){}return a}function decrypt(e,t,n){var o=null;try{o=CryptoJS.enc.Hex.parse(n)}catch(i){return null}var a=null;try{var r=CryptoJS.AES.decrypt(e,t,{iv:o});a=JSON.parse(CryptoJS.enc.Utf8.stringify(r))}catch(i){}return a}function LoginTicket(){}function AuthorityInfo(){this._roleId=null,this._roleName=null,this._rights=null}function AuthorityDef(){}function Policy(){this._id=null,this._action=null,this._resource_id=null,this._room_type=null,this._translations=null}function Role(){this._id=null,this._translations=null}function Translations(){this._translations={}}function EmotionPointList(){ArrayList.call(this)}function EmotionPointData(){Profile.call(this),this._jid="",this._created_at="",this._updated_at="",this._emotion_point=""}function Utils(){}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ApiCubee(){}function SocketIoConnector(){this._socket=null,this._isLogined=!1,this._onConnectCallBack=null,this._onDiscconectCallBack=null,this._onErrorCallBack=null,this._onMessageReceivedCallback=null}function CubeeServerConnector(){this._serverConnector=null,this._xmppServerHostName="",this._user="",this._password="",this._onConnectCallBack=null,this._onDisconnectCallBack=null,this._onErrorCallBack=null,this._onProfileChangedNotifyCallback=null,this._onMessageReceivedCallback=null,this._onNotificationCallback=null,this._onLoginWizardCallback=null,this._nickName=null,this._isLogined=!1,this._callBacks={},this._accessToken="",this._loginTicket="",this._jid="",this._loginStatus=CubeeServerConnector._LOGIN_STATUS_TYPE_NO_LOGIN}function ConnectReceiveData(){this._loginUserPerson=null,this._contactList=null}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CommunityManager(){this._joinedCommunityList=null,this._getRoomInfoRequestList={},this._creatingRoomIdList=[]}function LoginManager(){}function FavoriteManager(){}function MessageManager(){this._replyManager=new ReplyManager,this._childrenManager=new TaskChildrenManager,this._messageDataList=new MessageDataList,this._viewRefarenceCounter={}}function ReplyManager(){this._replyChain={},this._replyReverseChain={}}function TaskChildrenManager(){this._children={},this._viewRefarenceCounter={}}function NotificationManager(){this._notificationList=new StringMapedArrayList}function PersonManager(){this._contactListManger=new ContactListManager,this._followFollowesManager=new FollowFollowersManager,this._loginUserManager=new LoginUserManager,this._noConnectionUserManager=new NoConnectionUserManager}function ContactListManager(){}function FollowFollowersManager(){}function LoginUserManager(){this._prePresence=null}function NoConnectionUserManager(){}function SearchManager(){}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ChatRoomManager(){this._chatroomInfoList=new ChatRoomInfoList,this._getRoomInfoRequestList={},this._creatingRoomIdList=new StringMapedArrayList}function MailServerManager(){this._mailServerInfoList=new MailServerInfoList}function CubeeController(){this._loginManager=new LoginManager,this._personManager=new PersonManager,this._favoriteManager=new FavoriteManager,this._messageManager=new MessageManager,this._searchManager=new SearchManager,this._notificationManager=new NotificationManager,this._communityManager=new CommunityManager,this._chatroomManager=new ChatRoomManager,this._mailServerManager=new MailServerManager,this._authorityManager=new AuthorityManager,this._imageDataMap={}}function NotificationSettingManager(){this._notificationInfo=[]}function PushNotificationSettingManager(){this._notificationInfo=[]}function CodiMdController(){}function openGraphProtocolController(){}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ViewUtils(){}function ViewCore(){}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function View(){this._arrayLoginedNotification=new ArrayList,this._arrayLoginedNotifyMessage=new ArrayList}function TabItemView(){this._tabInfo={type:TabItemView.TYPE_UNKNOWN,columnListId:"",extras:{}},this._defaultColumnInfoList=new ArrayList,this._sideListViewImpl=null,this._onClickCloseCallBack=null,this._dom=null,this._iconUrl="images/blank.png",this._isLoading=!1}function TabMyWorkPlaceItemView(){TabItemView.call(this)}function TabCommunityItemView(){TabItemView.call(this)}function TabColumnStateStore(){this._localStorage=window.localStorage}function TabManager(){this._tabContainerElement=$("#tabContainer"),this._tabInnerContainerElement=this._tabContainerElement.children("#tabInnerContainer"),this._prevTabElement=$("#prevTab"),this._nextTabElement=$("#nextTab"),this._tabItemViewList=new ArrayList,this._tabSelectRefreshing=!1,this._communityInfo=new CommunityInfo,this.selectedInfo={}}function LoginView(){this._isLoginCompleted=!1,this._needRelogin=!1,this._qsParamArray=null,this._loginedViewInitFinish=!1,this._mailCooperationSettingServerList=null}function AvatarView(){}function DialogView(){this._dialogInnerElement=null}function DialogOkCancelView(){DialogView.call(this),this._dialogInnerElement=$("#dialog_area"),this._buttons={},this.ps="",this._init()}function DialogCloseView(e,t){DialogView.call(this),this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._buttons={},this._init(e,t)}function DialogSettingView(e){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,DialogOkCancelView.call(this)}function DialogPersonListView(e,t){this._title=e,this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._personList=t,DialogOkCancelView.call(this)}function DialogExistingPersonListView(e,t){this._messageItemId=e,DialogPersonListView.call(this,Resource.getMessage("existing_reader_dialog_title"),t)}function DialogFollowerListView(e){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._jid=e,DialogOkCancelView.call(this),this._searchword=""}function DialogFolloweeListView(e){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._jid=e,DialogOkCancelView.call(this),this._searchword=""}function DialogGoodJobPersonListView(e,t){this._messageItemId=e,DialogPersonListView.call(this,Resource.getMessage("goodjob"),t)}function DialogAddColumnView(e){this._mailCooperationSettingServerList=e,this._tabDetailList=new ArrayList,this._tabDetailHtmlIdList=new ArrayList,this._width=350,this._height=350,DialogOkCancelView.call(this)}function NewTabDetail(e){this._mailCooperationSettingServerList=e,this._tabName=Resource.getMessage("dialog_tab_new"),this._currentSelectedIndex=-1,this._init()}function DialogAddColumnForCommunityView(e){this._mailCooperationSettingServerList=e,this._height=150,DialogAddColumnView.call(this)}function NewTabDetailForCommunity(e){NewTabDetail.call(this,e)}function DialogRemoveChatListView(){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,DialogOkCancelView.call(this)}function DialogDeleteCheckView(e){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._deleteMessage=e,DialogOkCancelView.call(this)}function DialogPasswordView(e){DialogSettingView.call(this,e),this._createEventHandler()}function DialogProfileView(e){DialogSettingView.call(this,e),this._createEventHandler(),this._avaterType=LoginUser.getInstance().getAvatarType(),this._avaterData=LoginUser.getInstance().getAvatarData(),this._backgroundPath=""}function DialogSettingFilterView(e,t,n){this._title=e,this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._dialogID="keyword-input",this._columnInfo=t,this._ownerObj=n,DialogSettingView.call(this,e)}function DialogSettingFilterTaskView(e,t,n,o){this._submitButtonTitle=DialogOkCancelView.LABEL_OK,this._dialogID="filter-task-input",this._columnInfo=t,this._ownerObj=n,this._parentColumn=o,DialogSettingView.call(this,e)}function DialogSettingFilterMyTaskView(e,t,n,o){this._height=490,this._width=610,this._submitButtonTitle=DialogOkCancelView.LABEL_OK,this._dialogID="filter-my-task-input",DialogSettingFilterTaskView.call(this,e,t,n,o)}function CustomFilterSetting(){}function DialogSettingCustomFilterView(e,t,n,o){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._submitButtonTitle=DialogOkCancelView.LABEL_OK,this._columnInfo=t,this._ownerObj=n,this._parentColumn=o,DialogSettingView.call(this,e)}function CustomFilterInboxSetting(){}function DialogSettingCustomFilterInboxView(e,t,n,o){DialogSettingCustomFilterView.call(this,e,t,n,o)}function DialogSettingSearchView(e){this._height=200,this._submitButtonTitle=DialogOkCancelView.LABEL_OK,this._dialogID="contextsearch-input",DialogSettingView.call(this,e)}function DialogTaskView(e,t){return DialogOkCancelView.call(this),t==DialogTaskView.MODE_UPDATE&&null==e?null:(this._taskMessage=new TaskMessage,this._taskMessage.copy(e),t==DialogTaskView.MODE_UPDATE&&""==this._taskMessage.getItemId()?null:(this._mode=t,void this._initView()))}function DialogMailCooperationView(e){DialogSettingView.call(this,e),this._createEventHandler(),this._mailServerList=null}function DialogChatRoomUpdateRoomInfoView(e,t){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._title=e,this._roomId=t,this._roomInfo=null,DialogSettingView.call(this,e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DialogChatRoomCreateRoomInfoView(e,t,n){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,DialogSettingView.call(this,e)}function DialogCommunityCreateSettingBaseView(e){this.title=e,this._submitButtonTitle=this._submitButtonTitle||Resource.getMessage("dialog_label_ok"),DialogSettingView.call(this,e),this._createEventHandler()}function DialogSelectMemberView(e,t){var n=this;n._groupId=t,n._height=n._height||420,n._width=n._width||610,n._submitButtonTitle=DialogOkCancelView.LABEL_OK,n._memberInputAreaLabel=n._memberInputAreaLabel||"",n._memberAddButtonLabel=n._memberAddButtonLabel||"",n._memberListAreaLabel=n._memberListAreaLabel||"",n._autoCompleteCssCls=n._autoCompleteCssCls||"",DialogSettingView.call(this,e),n._createEventHandler(),n._ctrlFlg=!1}function DialogSelectChatRoomMemberView(e,t){DialogSelectMemberView.call(this,e,t)}function DialogSelectChatRoomAddMemberView(e){var t=this;t._roomId=e;var n=Resource.getMessage("dialog_title_group_chat_add_member");t._memberInputAreaLabel=Resource.getMessage("dialog_label_input_member"),t._memberAddButtonLabel=Resource.getMessage("dialog_button_add_to_member_list"),t._memberListAreaLabel=Resource.getMessage("dialog_label_add_member_list"),t._autoCompleteCssCls="autocomplete",DialogSelectChatRoomMemberView.call(this,n,e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DialogSelectChatRoomChangeAuthorityMemberView(e){var t=this;t._roomId=e,t._title=Resource.getMessage("dialog_title_group_chat_change_authority_member"),DialogSelectChatRoomMemberView.call(this,t._title,e)}function DialogSelectChatRoomConfirmAuthorityMemberView(e){var t=this;t._roomId=e,t._title=Resource.getMessage("conf_confirm_authority_tooltip"),DialogSelectChatRoomMemberView.call(this,t._title,e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{
value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DialogSelectChatRoomForceLeaveMemberView(e){var t=this;t._roomId=e;var n=Resource.getMessage("dialog_title_group_chat_leave_member");t._autoCompleteCssCls="autocomplete-for-chatroom",DialogSelectChatRoomMemberView.call(this,n,e)}function DialogSelectCommunityMemberView(e,t){DialogSelectMemberView.call(this,e,t)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DialogSelectCommunityAddMemberView(e){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._communityId=e,DialogOkCancelView.call(this)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DialogSelectCommunityForceLeaveMemberView(e){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._communityId=e,DialogOkCancelView.call(this)}function DialogCreateCommunityView(){var e=Resource.getMessage("create_community_dialog_title");this._submitButtonTitle=Resource.getMessage("button_create"),DialogCommunityCreateSettingBaseView.call(this,e)}function DialogSettingCommunityView(e){var t=Resource.getMessage("setting_community_dialog_title");this._submitButtonTitle=Resource.getMessage("button_update"),this._communityId=e,DialogCommunityCreateSettingBaseView.call(this,t)}function DialogUnsubscribeCheckView(e){_self=this,this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,_self._roomId=e,DialogOkCancelView.call(_self)}function DialogGroupChatUnsubscribeCheckView(e){_self=this,this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,_self._roomId=e,DialogOkCancelView.call(_self)}function DialogProjectUnsubscribeCheckView(e){_self=this,this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,_self._roomId=e,DialogOkCancelView.call(_self)}function DialogFavoriteGroupView(e,t,n){this._height=200,this._selectedUserList=t,this._callback=n,DialogSettingView.call(this,e)}function DialogGroupchatListView(e){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this.currentTabInfo=e?e:{},DialogOkCancelView.call(this),this.isGotRoomArrayList=!1,this.roomArrayList=new ArrayList}function DialogPublicGroupchatListView(e){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this.currentTabInfo=e?e:{},DialogOkCancelView.call(this),this.isGotRoomArrayList=!1,this.roomArrayList=new ArrayList}function DialogChatListView(){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,DialogOkCancelView.call(this),this._searchword=""}function DialogQuoteMessageView(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._dialogMessagePage=null,this._dialogMessageToPage=null,this._message=e,this._column=t,this.displayMessage="",this.displayRoomInfo=null,this._textarea=null,this._roomPrivacyType=n,DialogOkCancelView.call(this)}function DialogReadInBulkCheckView(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._columnInfo=e,this._columnjq=t,DialogOkCancelView.call(this)}function DialogMenthionCommunityPersonList(e,t,n){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._communityId=e,this._baseMessage=t,this.doneFunction=n,DialogOkCancelView.call(this)}function DialogMenthionGroupChatPersonList(e,t,n){var o=this;o._roomId=e,o._baseMessage=t,o.doneFunction=n;var i=Resource.getMessage("menthion_groupchat_person_list_dialog_title");o._autoCompleteCssCls="autocomplete-for-chatroom",DialogSelectChatRoomMemberView.call(this,i,e)}function FavoriteStore(){this._localStorage=window.localStorage,this._favoriteGroupList=[],this.init()}function GeneralConfigButton(){this._generalConfigMenu=null}function GeneralConfigMenu(e){e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?this._htmlElement=e:this._htmlElement=null,this._createEventHandler()}function GeneralConfigDialog(){DialogView.call(this)}function ColumnReplyTextAreaView(e){this._htmlElement=e,this._ctrlFlg=!1,this._createEventHandler()}function ColumnLinkView(e){this._htmlElement=e,this._ctrlFlg=!1,this._createEventHandler()}function TooltipView(){}function SearchView(){}function ContextSearchView(){SearchView.call(this),this._contextSearchOptionController=new ContextSearchOptionController}function ContextSearchOptionButton(){}function ContextSearchOptionController(){this._showSearchOptionView=null}function ContextSearchOptionView(e,t){e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?this._htmlElement=e:this._htmlElement=null,this._onCloseCallBack=t,this._createEventHandler()}function CommunityContextSearchOptionView(e,t){ContextSearchOptionView.call(this,e,t)}function PersonSearchView(){SearchView.call(this)}function MyPresenceView(){}function IconAreaView(){this._iconAreaContener=$("ul#menuIcons"),this._iconViewList=new ArrayList}function ColumnIconArea(){IconAreaView.call(this),this._movingIconIndex=-1}function IconAreaIconView(){}function NotificationIconManager(){var e=this;IconAreaView.call(e),e._attentionHeaderColumnIconSelectors={},e._attentionHeaderColumnIconPanelConntener=$("#header #mainHeader .ui-sortable"),e._cautionIconViewList=new ArrayList,e._iconAreaContener=$(".alert_menu > ul")}function ColumnAddIconView(){IconAreaIconView.call(this)}function ColumnIconView(){IconAreaIconView.call(this),this._iconElement=null,this._columnType=ColumnInformation.TYPE_COLUMN_UNKNOWN,this._filterCondition=null,this._columnInfo=null}function NotificationIconView(e){IconAreaIconView.call(this),this._imagePath=this._getIconPath(),this._htmlElement=$(".alert_menu > ul"),this._type=ColumnInformation.TYPE_COLUMN_UNKNOWN,this._count=0,this._init(e)}function ChatNotificationIconView(e){NotificationIconView.call(this,e),this._jidList=new StringMapedArrayList,null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&this._jidList.add(e.getFrom(),new Number(1))}function TaskNotificationIconView(e){this._demandTask=0,this._normalTask=0,NotificationIconView.call(this,e)}function InboxNotificationIconView(e){this._demandTask=0,this._normalTask=0,NotificationIconView.call(this,e)}function MentionNotificationIconView(e){NotificationIconView.call(this,e)}function ToMeNotificationIconView(e){NotificationIconView.call(this,e)}function GroupChatNotificationIconView(e){this._toolTipView=null,NotificationIconView.call(this,e)}function MailNotificationIconView(e){NotificationIconView.call(this,e)}function CommunityNotificationIconView(e,t){this._communityInfo=t,this._toolTipView=null,NotificationIconView.call(this,e,t)}function GroupChatNotificationToolTipView(e,t){this._parent=e,this._itemViewList=new ArrayList,this._htmlElement=null,this._init(t)}function GroupChatNotificationToolTipItemView(e,t,n){this._parent=e,this._columnInfo=t,this._htmlElement=null,this._count=0,this._type=n?n:0,this._init()}function GroupChatMessageNotificationToolTipItemView(e,t){GroupChatNotificationToolTipItemView.call(this,e,t),this._type=GroupChatNotificationToolTipItemView.TYPE_MESSAGE}function GroupChatCreateRoomNotificationToolTipItemView(e,t){GroupChatNotificationToolTipItemView.call(this,e,t),this._type=GroupChatNotificationToolTipItemView.TYPE_CREATE_ROOM}function GroupChatAddMemberNotificationToolTipItemView(e,t){GroupChatNotificationToolTipItemView.call(this,e,t),this._type=GroupChatNotificationToolTipItemView.TYPE_ADD_MEMBER}function GroupChatUpdateRoomNameNotificationToolTipItemView(e,t){GroupChatNotificationToolTipItemView.call(this,e,t),this._type=GroupChatNotificationToolTipItemView.TYPE_UPDATE_ROOM_NAME}function GroupChatRemoveMemberNotificationToolTipItemView(e,t,n){n?this._type=GroupChatNotificationToolTipItemView.TYPE_REMOVE_MEMBER_INCLUDE_OWN:this._type=GroupChatNotificationToolTipItemView.TYPE_REMOVE_MEMBER_NOT_INCLUDE_OWN,GroupChatNotificationToolTipItemView.call(this,e,t,this._type)}function GroupChatAuthorityChanagedNotificationToolTipItemView(e,t){GroupChatNotificationToolTipItemView.call(this,e,t),this._type=GroupChatNotificationToolTipItemView.TYPE_AUTHORITY_CHANGED}function CommunityNotificationToolTipItemView(e,t,n,o){this._parent=e,this._htmlElement=null,this._communityId=t,this._communityName=n,this._communityImage=o,this._count=0,this._type=CommunityNotificationToolTipItemView.TYPE_UNKOWN,this._init()}function CommunityInfoChangeNotificationToolTipItemView(e,t,n,o){CommunityNotificationToolTipItemView.call(this,e,t,n,o),this._type=CommunityNotificationToolTipItemView.TYPE_CHANGE_INFO}function CommunityMessageNotificationToolTipItemView(e,t,n,o){CommunityNotificationToolTipItemView.call(this,e,t,n,o),this._type=CommunityNotificationToolTipItemView.TYPE_MESSAGE}function CommunityAuthorityChangedNotificationToolTipItemView(e,t,n,o){CommunityNotificationToolTipItemView.call(this,e,t,n,o),this._type=CommunityNotificationToolTipItemView.TYPE_AUTHORITY_CHANGED}function CommunityNotificationToolTipView(e,t){this._parent=e,this._itemViewList=new ArrayList,this._htmlElement=null,this._init(t)}function SlideContainerView(){}function RightSlideContainerView(){SlideContainerView.call(this)}function GroupFormingAccordion(){}function BaseSideListViewImpl(){this._accordionView=null,this._listContainerElm=null,this._listInnerContainerElm=null,this._tabInfo=null}function MyWorkPlaceSideListViewImpl(){BaseSideListViewImpl.call(this)}function SideListView(){this._sideListViewImpl=null}function SideMenuParts(){this._frame=null}function AccordionView(){SideMenuParts.call(this),this._partsList=new Array,this._activePats=null}function SideMenuAccordionParts(){SideMenuParts.call(this),this._headerDisplayName="",this._subView=null,this.viewPartsListHeader=null}function GroupChatStartFormView(e,t){e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?(this._htmlElement=e,this._createEventHandler()):this._htmlElement=null,t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))?this._parent=t:this._parent=null,this._chatroomInfo=null}function ContactListView(){SideMenuAccordionParts.call(this),this._userListView=null,this._searchView=null,this._searchResultView=null,this._callbacks=null,this._isOpenSearchResultView=!1,this.VIEW_PARTS_TYPE="contact-list",this.viewPartsListHeader=ContactListView._VIEW_PARTS_LIST_HEADER}function ContactListForCommunityView(){ContactListView.call(this),this._communityId=null,this.VIEW_PARTS_TYPE_ALIAS="contact-list-for-community"}function CommunitySideListViewImpl(){BaseSideListViewImpl.call(this),this._communityId=null}function CommunityListView(){SideMenuAccordionParts.call(this),this.viewPartsListHeader=CommunityListView._VIEW_PARTS_LIST_HEADER}function CommunityListElementView(){}function AllCommunityDialog(){DialogView.call(this)}function CommunityAvatar(){AvatarView.call(this)}function CommunityMemberListView(){SideMenuAccordionParts.call(this),this.VIEW_PARTS_TYPE="community-member-list",this._callbacks=null}function CommunityDetailsView(){SideMenuAccordionParts.call(this)}function FollowsView(){}function FollowsListDialog(){DialogView.call(this)}function FollowListView(){FollowsListDialog.call(this)}function FollowerListView(){FollowsListDialog.call(this)}function ColumnMessageView(e,t){var n=this;n._parent=e,n.setMessage(t),n._htmlElement=null,n._goodJobButton=null,n._emotionButton=null,n._isShowReadMore=!1,n._isToolTipOwner=!1}function ColumnMessageAvatar(){AvatarView.call(this)}function ColumnMessageAvatarTooltip(){TooltipView.call(this)}function ColumnMessageGoodJobButton(e,t,n,o,i){this._htmlElement=e,this._parent=t,this._itemId=n,this._goodJobList=o,this._count=0,0!=i&&(i=!0),this._isToolTipOwner=i,this._createEventHandler()}function ColumnMessageEmotionPointButton(e,t,n,o,i){this._htmlElement=e,this._parent=t,this._itemId=n,this._emotionPointList=o,this._count=0,0!=i&&(i=!0),this._isToolTipOwner=i,this._createEventHandler()}function ColumnMessageReadMoreButton(e,t,n){this._htmlElement=e,this._parent=t,0!=n&&(n=!0),this._isToolTipOwner=n,this._createEventHandler()}function ColumnMessageExistingReaderInfoView(e,t,n){this._htmlElement=e,this._message=t,this._itemId=t.getItemId(),this._count=0,0!=n&&(n=!0),this._isToolTipOwner=n,this._createEventHandler()}function ColumnMessageTooltip(){TooltipView.call(this)}function ColumnOptionMenu(e,t,n){e&&"object"===("undefined"==typeof e?"undefined":_typeof(e))?this._htmlElement=e:this._htmlElement=null,t&&"object"===("undefined"==typeof t?"undefined":_typeof(t))?this._columnInfo=t:this._columnInfo=null,n&&"object"===("undefined"==typeof n?"undefined":_typeof(n))?this._ownerObj=n:this._ownerObj=null,this._createEventHandler()}function GroupChatColumnOptionMenu(e,t,n){ColumnOptionMenu.call(this,e,t,n)}function TaskColumnOptionMenu(e,t,n){ColumnOptionMenu.call(this,e,t,n)}function CommunityFeedColumnOptionMenu(e,t,n,o){ColumnOptionMenu.call(this,e,t,n),this._tabType=o}function CommunityTaskColumnOptionMenu(e,t,n,o){TaskColumnOptionMenu.call(this,e,t,n),this._tabType=o}function ToMeColumnOptionMenu(e,t,n){ColumnOptionMenu.call(this,e,t,n)}function WithReadDoneColumnOptionMenu(e,t,n){ColumnOptionMenu.call(this,e,t,n)}function ConversationColumnOptionMenu(e,t,n){ColumnOptionMenu.call(this,e,t,n)}function CustomFilterColumnOptionMenu(e,t,n){ColumnOptionMenu.call(this,e,t,n)}function FilterColumnOptionMenu(e,t,n){ColumnOptionMenu.call(this,e,t,n)}function RecentColumnOptionMenu(e,t,n){ColumnOptionMenu.call(this,e,t,n)}function MurmurColumnOptionMenu(e,t,n){ColumnOptionMenu.call(this,e,t,n)}function ColumnButtonView(e,t,n,o,i){this._htmlElement=e,this._parent=t,this.updateNameHtml(n,i),this._clickEventCallback=o,this._createEventHandler()}function ColumnSubmitButtonView(e,t,n,o){ColumnButtonView.call(this,e,t,n,this._clickEventCallback,o)}function ColumnReloadButtonView(e,t,n){ColumnButtonView.call(this,e,t,n,this._clickEventCallback)}function ColumnTextAreaView(e,t,n){this._htmlElement=e,this._parent=t,n&&"string"==typeof n&&e.attr("placeholder",n),this._ctrlFlg=!1,this._createEventHandler()}function ColumnFileUploadPartsView(e,t){this._htmlElement=e,this._parent=t,this._createEventHandler()}function ProgressBarView(e,t){this._htmlElement=e,this._htmlElement.progressbar({value:0}),t?this.visibleProgressBar():this.hiddenProgressBar(),this._createEventHandler()}function MemberAreaView(e,t){this._htmlElement=e;var n=t.getHtmlElement().find(".group-member-btn");this._readMoreButton=new ColumnMessageReadMoreButton(n,this),this._parent=t}function RegisterView(e,t,n){e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?this._htmlElement=e:this._htmlElement=null,n&&"object"==("undefined"==typeof n?"undefined":_typeof(n))?this._parent=n:this._parent=null,this._createSubForms(t)}function TaskRegister(e,t,n){this._parentObject=e,this._messageData=t,this._registedMessageData=void 0,this._mode=n,this._registerForm=void 0,this._fileList=void 0,this.init(),this._ctrlFlg=!1}function InboxRegisterView(e,t,n){RegisterView.call(this,e,t,n),this._columType=ColumnInformation.TYPE_COLUMN_INBOX}function MessageObjectIndex(e){this._msgObj=e,this._children=new ArrayList}function ColumnView(e){var t=this;t._columnContentObj=null,e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?(t._info=e,t._type=this._info.getColumnType(),t._SendMessageRight=this._info.getRightToSendMessage(),t._ViewMessageRight=this._info.getRightToViewMessage()):(t._info=null,t._type=0,t._SendMessageRight="",t._ViewMessageRight=""),t._className="",t._idName="",t._displayName="",t._htmlElement="",t._closable=!0,t._msgObjHash={},t._msgObjIndexList=new ArrayList,t._width=0,t._currentLoadedItemId=0,t._allMessageReceived=!1,t._uploading=!1,t._inputAreaHeight=0,t._disableBottomEvent=!1,t._pergeMessageTimerId=null}function MessageColumnLink(e,t){this._htmlElement=e,this._message=t,this._createEventHandler()}function TaskFilterAndSortCondition(e){if(this._filterOwner="",this._filterStatus="",this._filterGroup="",this._filterStartDate="",this._filterEndDate="",this._filterClient="",this._filterUpdatedBy="",this._sortItem="",this._sortOrder="",null!=e&&"string"==typeof e&&""!=e){var t=JSON.parse(e),n=t.filter;null!=n&&(null!=n[TaskFilterAndSortCondition.FILTER_KEY_OWNER]&&(this._filterOwner=n[TaskFilterAndSortCondition.FILTER_KEY_OWNER]),null!=n[TaskFilterAndSortCondition.FILTER_KEY_STATUS]&&(this._filterStatus=n[TaskFilterAndSortCondition.FILTER_KEY_STATUS]),null!=n[TaskFilterAndSortCondition.FILTER_KEY_GROUP]&&(this._filterGroup=n[TaskFilterAndSortCondition.FILTER_KEY_GROUP]),null!=n[TaskFilterAndSortCondition.FILTER_KEY_START_DATE]&&(this._filterStartDate=n[TaskFilterAndSortCondition.FILTER_KEY_START_DATE]),null!=n[TaskFilterAndSortCondition.FILTER_KEY_END_DATE]&&(this._filterEndDate=n[TaskFilterAndSortCondition.FILTER_KEY_END_DATE]),null!=n[TaskFilterAndSortCondition.FILTER_KEY_CLIENT]&&(this._filterClient=n[TaskFilterAndSortCondition.FILTER_KEY_CLIENT]),null!=n[TaskFilterAndSortCondition.FILTER_KEY_UPDATED_BY]&&(this._filterUpdatedBy=n[TaskFilterAndSortCondition.FILTER_KEY_UPDATED_BY]));var o=t.sort;null!=o&&(null!=o[TaskFilterAndSortCondition.SORT_KEY_ITEM]&&(this._sortItem=o[TaskFilterAndSortCondition.SORT_KEY_ITEM]),null!=o[TaskFilterAndSortCondition.SORT_KEY_ORDER]&&(this._sortOrder=o[TaskFilterAndSortCondition.SORT_KEY_ORDER]))}}function ColumnChatView(e){ColumnView.call(this,e),this._className=ColumnView.CLASS_SEL_CHAT,this._displayName=this._createDisplayName(null),this.createView(),this.partnerJid=e.getFilterCondition();var t=CubeeController.getInstance().getContactListData(this.partnerJid),n=ViewUtils.getAvatarUrl(t);e.setIconImage(n)}function ColumnGroupChatView(e){this._hasRightMessage(e),ColumnView.call(this,e),this._className=ColumnView.CLASS_SEL_GROUP_CHAT,this._idName=e.getChatRoomInfomation().getRoomId(),this._displayName=this._createDisplayName(),this._memberAreaView=null,this.createView(),this._showMember()}function ColumnTaskView(e){ColumnView.call(this,e),this._className=ColumnView.CLASS_SEL_TASK,this._displayName=ColumnView.DISPLAY_NAME_MY_TASK,this.createView(),this._unfinishedTaskCount=-1,this._readAllUnfinishedTask=!1,this._demandTaskItemIds=new StringMapedArrayList,e.setIconImage("images/column_task.png")}function ColumnInboxView(e){ColumnTaskView.call(this,e),this._className=ColumnView.CLASS_SEL_INBOX,this._displayName=ColumnView.DISPLAY_NAME_INBOX,ColumnView.prototype.createView.call(this),e.setIconImage("images/column_inbox.png")}function ColumnFilterView(e){ColumnView.call(this,e),this._className=ColumnView.CLASS_SEL_FILTER,this._displayName=this._createDisplayName(e),this.createView(),this._resultAllCount=0,this._htmlElement.find("div.frm-message").children("input").val(this._info.getKeyword()),e.setIconImage("images/column_search.png"),this._updateColumnTitle()}function ColumnCustomFilterView(e){ColumnView.call(this,e),this._className=ColumnView.CLASS_SEL_FILTER,this._displayName=this._createDisplayName(e),this.createView(),this._resultAllCount=0,this._htmlElement.find('div.frm-message > input[type="text"]').hide(),e.setIconImage("images/column_search.png"),this._reloadButton=null,this._updateColumnTitle()}function ColumnSearchView(e){ColumnView.call(this,e),this._className=ColumnView.CLASS_SEL_SEARCH,this._displayName=this._createDisplayName(e);var t=TabManager.getInstance().getCurrentTabInfo(),n=t.type;if(n==TabItemView.TYPE_COMMUNITY){var o=this._info,i=o.getKeyword(),a=this._getKeywordFilterCondition(i),r=this._createSearchCondition(a);o.setSearchCondition(r)}this.createView(),this._htmlElement.find("div.frm-message").children("input").val(this._info.getKeyword()),e.setIconImage("images/column_search.png")}function ColumnTimelineView(e){this._hasRightToSendMessage(e),ColumnView.call(this,e),this._className=ColumnView.CLASS_SEL_TIMELINE,this._displayName=this._createDisplayName(),this._closable=!0,this.createView(),e.setIconImage("images/column_myfeed.png")}function ColumnMailView(e){ColumnView.call(this,e),this._className=ColumnView.CLASS_SEL_MAIL,this._displayName=this._createDisplayName(),this.createView(),this._htmlElement.find("button.column-toggle").hide(),this._htmlElement.find("div.wrap-frm-message").hide(),e.setIconImage("images/column_mail.png")}function ColumnMentionView(e){ColumnView.call(this,e),this._className=ColumnView.CLASS_SEL_MENTION,this._displayName=this._createDisplayName(),this.createView(),this._htmlElement.find("button.column-option").show(),e.setIconImage("images/column_reply.png")}function ColumnToMeView(e){ColumnView.call(this,e),this._className=ColumnView.CLASS_SEL_TOME,this._displayName=this._createDisplayName(e),this.createView();var t=this._htmlElement.children("div").children("div.column-header").eq(0).children("div.column-header-title").eq(0);t.css({"border-bottom-color":"#e7435f"}),this._htmlElement.find("div.frm-message").css("display","none"),this._htmlElement.find("a.column-toggle").css("display","none")}function ColumnRecentView(e){ColumnView.call(this,e),this._className=ColumnView.CLASS_SEL_RECENT,this._displayName=this._createDisplayName(),this._initColumnSearchCondition(),this._type==ColumnInformation.TYPE_COLUMN_RECENT&&(this._closable=!1),this.createView(),this._setRecentColumnEvent()}function ColumnCommunityFeedView(e,t){this._hasRightMessage(e),ColumnView.call(this,e),this._className=ColumnView.CLASS_SEL_COMMUNITY_FEED,this._idName=e.getCommunityInfomation().getRoomId(),this._displayName=this._createDisplayName(),this._tabType=t,this._tabType==TabItemView.TYPE_COMMUNITY&&(this._closable=!1),this.createView(),this._showTitleAndSetColor()}function ColumnCommunityTaskView(e,t){this._tabType=t,ColumnTaskView.call(this,e),this._className=ColumnView.CLASS_SEL_COMMUNITY_TASK,this._displayName=this._createDisplayName(),this._tabType==TabItemView.TYPE_COMMUNITY&&(this._closable=!1,this._displayName=Resource.getMessage("ContextSearchCommunityTask")),this.createView(),this._showTitle()}function ColumnShowConversationView(e){ColumnView.call(this,e),this._className=ColumnView.CLASS_SEL_SHOW_CONVERSATION,this._displayName=this._createDisplayName(e),this._parentItemId=e.getParentItemId(),this._itemIdList=[],this._waitMsgList=[],this._msgNestHash={},this.indentSize=20,this.messageBodyMinSize=320,this.sidebarSize=320,this.columnMinSize=600,this.windowSize=$(window).width(),this.createView(),this._htmlElement.find("div.frm-message").css("display","none"),this._htmlElement.find("a.column-toggle").css("display","none"),this._titleElement=null,this._threadRootMessage=null}function ColumnMurmurView(e){var t=this;if(this._hasRightMessage(e),ColumnView.call(this,e),this._className=ColumnView.CLASS_SEL_MURMUR,this._displayName=this._createDisplayName(null),this.createView(),this.partnerJid=MurmurColumnInformation.getOwnJidFromSearchCondition(e),null!=this.partnerJid&&!this.isSideMenu&&(LoginUser.getInstance().getJid()!=this.partnerJid&&this._htmlElement.find(".column-toggle.col_btn.col_input_btn.popup_btn.ico_btn").hide(),null!=this.partnerJid)){var n=this;this._htmlElement.find(".column-header-title").text();CubeeController.getInstance().getPersonDataByJidFromServer(this.partnerJid,function(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var o=e.getByKey(t.partnerJid);if(o){var i=o.getUserName(),a=ViewUtils.getAvatarUrl(o),r=n._createDisplayName(i);n._info.setDisplayName(r),n._info.setIconImage(a);var s=Utils.avatarCreate({name:i,type:"user"});n.updateColumnTitle.call(n,s.color),ColumnManager.getInstance().updateColumnIcon(n)}}});var o=CubeeController.getInstance().getContactListData(this.partnerJid),i=ViewUtils.getAvatarUrl(o);e.setIconImage(i)}}function QuestionnaireNotificationIconView(e){NotificationIconView.call(this,e)}function ColumnQuestionnaireMessageView(e,t){if(!t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return void console.log("ColumnQuestionnaireMessageView::new _ msg is invalid");var n=t.getType();return n!=Message.TYPE_QUESTIONNAIRE?void console.log("ColumnQuestionnaireMessageView::new _ invalid type:"+n):(this._inputType=t.getInputType(),void ColumnMessageView.call(this,e,t))}function ColumnQuestionnaireView(e){ColumnView.call(this,e),this._className=ColumnView.CLASS_SEL_QUESTIONNAIRE,this._displayName=ColumnView.DISPLAY_NAME_QUESTIONNAIRE,this.createView(),this._htmlElement.find("button.column-option").hide()}function QuestionnaireRegister(e,t){this._parentObject=e,this._messageData=t,this._registedMessageData=void 0,this._registerForm=void 0,this.init()}function DialogSelectQuestinnaireRangeView(e,t){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._height=200,this._submitButtonTitle=DialogOkCancelView.LABEL_OK,this._optionItem=t,this._title=e,DialogOkCancelView.call(this)}function DialogQuestionnaireConfirmView(e,t){DialogView.call(this),this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._buttons={},this._callback=t,this._message=e,this._init(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ColumnManager(){this._columnList=ColumnList.getInstance(),this._columnObjList=new ArrayList,this._columnContainer=$("#columnContainer"),this._columnInnerContainer=$("#columnInnerContainer"),this._personListDialogObj=null,this._attentionColumnBlinkTime=500,this._columnListId=null,this._isCleaningUp=!1,this._isRefreshing=!1}function ColumnSystemMessageView(e,t){if(!t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return void console.log("ColumnSystemMessageView::new _ msg is invalid");var n=t.getType();return n!=Message.TYPE_SYSTEM?void console.log("ColumnSystemMessageView::new _ invalid type:"+n):void ColumnMessageView.call(this,e,t)}function ColumnTaskMessageView(e,t){if(!t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return void console.log("ColumnTaskMessageView::new _ msg is invalid");var n=t.getType();return n!=Message.TYPE_TASK?void console.log("ColumnTaskMessageView::new _ invalid type:"+n):(ColumnMessageView.call(this,e,t),this._isEditInit=!1,this._isShowMultiOwner=!1,this._isMultiOwner=!1,this._isMultiOwnerExpand=!1,this._isRequestTask=!1,this._attachedFileListObj=null,void(this._statusAreaTimerBlinkIDList=new StringMapedArrayList))}function ColumnInboxMessageView(e,t){if(!t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return void console.log("ColumnInboxMessageView::new _ msg is invalid");var n=t.getType();return n!=Message.TYPE_TASK?void console.log("ColumnInboxMessageView::new _ invalid type:"+n):(ColumnMessageView.call(this,e,t),this._timerId=null,void(this._isMessageExpand=!1))}function ColumnChatMessageView(e,t){if(!t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return void console.log("ColumnChatMessageView::new _ msg is invalid");var n=t.getType();return n!=Message.TYPE_CHAT?void console.log("ColumnChatMessageView::new _ invalid type:"+n):void ColumnMessageView.call(this,e,t)}function ColumnPublicMessageView(e,t){if(!t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return void console.log("ColumnPublicMessageView::new _ msg is invalid");var n=t.getType();return n!=Message.TYPE_PUBLIC?void console.log("ColumnPublicMessageView::new _ invalid type:"+n):(ColumnMessageView.call(this,e,t),void(this._isShowReadMore=!0))}function ColumnGroupChatMessageView(e,t){if(!t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return void console.log("ColumnGroupChatMessageView::new _ msg is invalid");var n=t.getType();return n!=Message.TYPE_GROUP_CHAT?void console.log("ColumnGroupChatMessageView::new _ invalid type:"+n):void ColumnMessageView.call(this,e,t)}function ColumnMailMessageView(e,t){if(!t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return void console.log("ColumnMailMessageView::new _ msg is invalid");var n=t.getType();return n!=Message.TYPE_MAIL?void console.log("ColumnMailMessageView::new _ invalid type:"+n):void ColumnMessageView.call(this,e,t)}function ColumnCommunityMessageView(e,t){if(!t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return void console.log("ColumnCommunityMessageView::new _ msg is invalid");var n=t.getType();return n!=Message.TYPE_COMMUNITY?void console.log("ColumnCommunityMessageView::new _ invalid type:"+n):void ColumnMessageView.call(this,e,t)}function ColumnCommunityTaskMessageView(e,t){ColumnTaskMessageView.call(this,e,t)}function ColumnMurmurMessageView(e,t){if(!t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return void console.log("ColumnMurmurMessageView::new _ msg is invalid");var n=t.getType();return n!=Message.TYPE_MURMUR?void console.log("ColumnMurmurMessageView::new _ invalid type:"+n):void ColumnMessageView.call(this,e,t)}function AttachedFileData(e,t){this._htmlElement=e,this._url=t,this._controlflag=AttachedFileData.FILE_ATTACHED,this._fileName="",null!=this._url&&(this._fileName=ViewUtils.getAttachmentFileName(this._url)),this._createEventHandler()}function AttachedFileList(e){ArrayList.call(this),this._htmlElement=e}function GroupChatListView(){SideMenuAccordionParts.call(this),this.viewPartsListHeader=GroupChatListView._VIEW_PARTS_LIST_HEADER}function PublicGroupChatListView(){SideMenuAccordionParts.call(this)}function LayoutManager(){}function CautionIconView(e){IconAreaIconView.call(this),this._imagePath=this._getIconPath(),this._htmlElement=null,this._type=CautionIconView.TYPE_UNKNOWN,this._count=0,this._init(e)}function DemandTaskCautionIconView(e){CautionIconView.call(this,e),this._itemList=new StringMapedArrayList}function ReadMessageSetter(){}function SideMenuExtensionParts(e,t,n,o){this._parentObj=t,this._partsType=e,this._title=n?n:Resource.getMessage("subview_title"),this._width=o?o.width:$("#listInnerContainer").outerWidth(),this._frame=null,this._isShow=!1}function ContactListSubView(e,t,n){this._size={width:300,height:150};var o={width:300};SideMenuExtensionParts.call(this,e,t,null,o),this._selectedUserList=new ArrayList,this.init()}function ContactListAccordion(){AccordionView.call(this)}function ContactListGroup(){}function ContactListGroupMember(){}function ContactListGroupMemberAvatar(){AvatarView.call(this)}function ContactListGroupMemberAvatarTooltip(){TooltipView.call(this)}function CommunityMemberListSubView(e,t,n){ContactListSubView.call(this,t,n,null),this._communityId=e}function SideMenuUserListView(e,t,n){this._parentObj=n,this._partsType=e,this._listViewType=t,this._mTipList=new ArrayList,this._accordionSetting=null,this._accordionSortableSetting=null,this.init()}function ContactListMemberView(e,t){SideMenuUserListView.call(this,e,"member-list",t)}function SearchPersonView(e){SideMenuParts.call(this),this._selectedTabIndex=0,this._parentObj=e,this._lastExecSearchTabIndex=-1,this.init()}function SearchPersonResultView(e,t,n){this._searchInfo=t,this._currentLoadedJidForAllUserSearch=0,this._allUserListReceivedForAllUserSearch=!1,this._searchResultList=null,SideMenuUserListView.call(this,e,"search-result",n)}function MessageBox(e,t,n,o,i,a){this.title=i?i:Resource.getMessage("dialog_confirmation_title"),this._displayMessage=e,this._width=a&&"number"==typeof a.width?a.width:null,this._height=a&&"number"==typeof a.height?a.height:null,this._okCallback=t&&"function"==typeof t?t:function(){},this._isConfirm=n,DialogOkCancelView.call(this)}function DialogSelectCommunityConfirmAuthorityMemberView(e){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._communityId=e,DialogOkCancelView.call(this)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DialogSelectCommunityChangeAuthorityMemberView(e){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._communityId=e,DialogOkCancelView.call(this)}function WizardView(){
WizardView.AvaterType="user"}function SelectAndAddProjectView(){this._displayProjects=new CommunityList,this._headerElement=$(".header_project_ico").find(".ico_project"),this._groupchatListView=null,this._chatListView=null,SelectAndAddProjectView._default_color=Conf.getVal("DEFAULT_PROJECT_COLOR"),SelectAndAddProjectView._colors=["#E04F5F","#E7953B","#FAD43D","#98D44E","#32BEA6","#51B8FD","#187BCE","#AF69C4","#F195AD","#A17255","#8CA8BC","#555555",Conf.getVal("DEFAULT_PROJECT_COLOR")],SelectAndAddProjectView.AvaterType="project"}function DialogProjectListView(){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,DialogOkCancelView.call(this),DialogProjectListView.AvaterType="project",this.isGotRoomArrayList=!1,this.roomArrayList=new CommunityList}function DialogPublicProjectListView(){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,DialogOkCancelView.call(this),DialogPublicProjectListView.AvaterType="project",this.isGotRoomArrayList=!1,this.roomArrayList=new CommunityList}function SelectUserListView(){this.selector_searchinput="#txtSearchGroupUser",this.selector_list=".modal_list.select_list",this.allPersons=[],this.countPmember=0}function DialogAddChatListView(){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,DialogOkCancelView.call(this)}function DialogThreadTitleListView(e,t){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._columnInfo=e,this._parentObj=t,this._allThreadTitles=null,DialogOkCancelView.call(this)}function DialogThreadTitleUpdateView(e){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._message=e,DialogOkCancelView.call(this)}function DialogUpdateMessageView(e,t){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._message=e,this._column=t,this._uploading=!1,this.displayMessage="",this.displayFileName="",DialogOkCancelView.call(this)}function DialogEmotionPointPersonListView(e,t,n){this._messageItemId=e,this._emotionPointList=t,this._emotionIcons=n,DialogPersonListView.call(this,Resource.getMessage("dialog_label_list_emotion_point"),t)}function DialogPointRankingView(e){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._point=e,this._weekRankingList=null,this._monthRankingList=null,this._yearRankingList=null,DialogOkCancelView.call(this)}function SideMenuRecentView(){}function SideMenuMurmurView(){}function DialogSendMurmurMessageView(e,t){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._message=e,this._column=t,this._uploading=!1,this.displayMessage="",this.displayFileName="",this.isNoteLiistOpen=!1,DialogOkCancelView.call(this)}function DialogMurmurListView(){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._weekRankingList=null,this._monthRankingList=null,this._yearRankingList=null,DialogOkCancelView.call(this)}function DialogMurmurColumnNameSetView(e){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this.columnInfo=e,DialogOkCancelView.call(this)}function SidebarNoteView(){this._htmlElement=null}function DialogCreateNoteView(){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,DialogOkCancelView.call(this)}function DialogNoteListView(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._allNoteNames=null,this._columnInfo=e,this._threadRootId="",this._roomId="",this._msgType=0,DialogOkCancelView.call(this)}function DialogRemoveNoteView(){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._allNotes=null,this._removeList=new ArrayList,this._searchNotesList=null,DialogOkCancelView.call(this)}function DialogAssignNoteView(e){if(this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,this._allNoteNames=null,this._selectAssignNote=null,this._assignThreadRootId=null,this.AssignedNoteTitle=null,this.AssignedNoteUrl=null,e){this._assignThreadRootId=e.getThreadRootId(),this.AssignedNoteTitle=e.getNoteTitle(),this.AssignedNoteUrl=e.getNoteUrl();var t={msgtype:e.getType(),room_name:""};switch(e.getType()){case Message.TYPE_PUBLIC:break;case Message.TYPE_CHAT:var n=CubeeController.getInstance().getPersonData(e.getTo());n?t.room_name=n.getUserName():t.room_name=e.getTo().slice(0,e.getTo().indexOf("@")-4);break;case Message.TYPE_GROUP_CHAT:case Message.TYPE_COMMUNITY:t.room_name=e.getRoomName()}this.roomName=CodiMdViewUtils.getRoomName(t)}DialogOkCancelView.call(this)}function CodiMdViewUtils(){}function DialogAssignNoteOnSendMessageView(e){this._attachElement=e,DialogAssignNoteView.call(this,"")}function PluginUtility(){}function PluginReader(){}function DialogSearchOptionView(){this._dialogAreaElement=$("#modal_area"),this._dialogInnerElement=null,DialogOkCancelView.call(this)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=ArrayList.prototype;e.add=function(e){var t=this,n=t._length;return t._array[n]=e,t._length++,!0},e.remove=function(e){var t=this;if(null==e||"number"!=typeof e)return null;if(0>e||e>=t._length)return null;for(var n=t._array[e],o=t._length,i=e;o-1>i;i++)t._array[i]=t._array[i+1];return delete t._array[o-1],t._length--,n},e.insert=function(e,t){var n=this;if(null==e||"number"!=typeof e)return!1;if(0>e||e>n._length)return!1;for(var o=n._length,i=o;i>e;i--)n._array[i]=n._array[i-1];return n._array[e]=t,n._length++,!0},e.get=function(e){var t=this;if(null==e||"number"!=typeof e)return null;if(0>e||e>=t._length)return null;var n=t._array[e];return n},e.move=function(e,t){var n=this;if(null==e||"number"!=typeof e)return!1;if(0>e||e>=n._length)return!1;if(null==t||"number"!=typeof t)return!1;if(0>t||t>=n._length)return!1;if(e==t)return!0;var o=n._array[e];if(t>e)for(var i=e;t>i;i++)n._array[i]=n._array[i+1];else for(var i=e;i>t;i--)n._array[i]=n._array[i-1];return n._array[t]=o,!0},e.set=function(e,t){var n=this;return null==e||"number"!=typeof e?!1:0>e||e>=n._length?!1:(delete n._array[e],n._array[e]=t,!0)},e.getCount=function(){return this._length},e.removeAll=function(){for(var e=this,t=e._length,n=0;t>n;n++)delete e._array[n];delete e._array,e._array=new Array,e._length=0},e.copy=function(e){var t=this;if(null!=e&&"number"==typeof e)for(var n=e.getCount(),o=0;n>o;o++)t.add(e.get(o))}}(),function(){var e=function(){};e.prototype=ArrayList.prototype,StringMapedArrayList.prototype=new e;var t=e.prototype,n=StringMapedArrayList.prototype;n.add=function(e,n){var o=this;if(null==e||"string"!=typeof e||""==e)return!1;if(null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n)))return!1;var i=o.getByKey(e);if(null!=i)return!1;var a=t.add.call(o,n);return a&&(o._map[e]=n),a},n.insert=function(e,n,o){var i=this;if(null==e||"number"!=typeof e)return!1;if(0>e||e>i._length)return!1;if(null==n||"string"!=typeof n||""==n)return!1;var a=i.getByKey(n);if(null!=a)return!1;var r=t.insert.call(i,e,o);return r&&(i._map[n]=o),r},n.getByKey=function(e){var t=this;return null==e||"string"!=typeof e||""==e?null:null==t._map[e]?null:t._map[e]},n.remove=function(e){var n=this;if(null==e||"number"!=typeof e)return null;if(0>e||e>=n._length)return null;var o=t.remove.call(n,e);for(var i in n._map)n._map[i]==o&&delete n._map[i];return o},n.removeByKey=function(e){var n=this;if(null==e||"string"!=typeof e)return null;var o=n.getByKey(e);if(null==o)return null;for(var i=n._length,a=0;i>a;a++)if(n._array[a]==o){o=t.remove.call(n,a);break}return delete n._map[e],o},n.removeAll=function(){var e=this;t.removeAll.call(e);for(var n in e._map)delete e._map[n];delete e._map,e._map={}},n.set=function(e,n){var o=this;if(null==e||"number"!=typeof e)return!1;if(0>e||e>=o._length)return!1;for(var i in o._map)o._map[i]==o._array[e]&&(delete o._map[i],o._map[i]==n);return t.set.call(o,e,n),!0},n.setByKey=function(e,n){var o=this;if(null==e||"string"!=typeof e)return!1;var i=o.getByKey(e);if(null==i)return!1;for(var a=o._length,r=0;a>r;r++)if(o._array[r]==i){t.set.call(o,r,n);break}return delete o._map[e],o._map[e]=n,!0}}(),function(){var e=function(){};e.prototype=ArrayList.prototype,StringMapedStringArrayList.prototype=new e;var t=e.prototype,n=StringMapedStringArrayList.prototype;n.add=function(e,n){var o=this;if(null==e||"string"!=typeof e||""==e)return!1;if(null==n||"string"!=typeof n)return!1;var i=o.getByKey(e);if(null!=i)return!1;var a=t.add.call(o,n);return a&&(o._map[e]=n),a},n.insert=function(e,n,o){var i=this;if(null==e||"number"!=typeof e)return!1;if(0>e||e>i._length)return!1;if(null==n||"string"!=typeof n||""==n)return!1;var a=i.getByKey(n);if(null!=a)return!1;var r=t.insert.call(i,e,o);return r&&(i._map[n]=o),r},n.getByKey=function(e){var t=this;return null==e||"string"!=typeof e||""==e?null:null==t._map[e]?null:t._map[e]},n.remove=function(e){var n=this;if(null==e||"number"!=typeof e)return null;if(0>e||e>=n._length)return null;var o=t.remove.call(n,e);for(var i in n._map)n._map[i]==o&&delete n._map[i];return o},n.removeByKey=function(e){var n=this;if(null==e||"string"!=typeof e)return null;var o=n.getByKey(e);if(null==o)return null;for(var i=n._length,a=0;i>a;a++)if(n._array[a]==o){o=t.remove.call(n,a);break}return delete n._map[e],o},n.removeAll=function(){var e=this;t.removeAll.call(e);for(var n in e._map)delete e._map[n];delete e._map,e._map={}},n.set=function(e,n){var o=this;if(null==e||"number"!=typeof e)return!1;if(0>e||e>=o._length)return!1;for(var i in o._map)o._map[i]==o._array[e]&&(delete o._map[i],o._map[i]==n);return t.set.call(o,e,n),!0},n.setByKey=function(e,n){var o=this;if(null==e||"string"!=typeof e)return!1;var i=o.getByKey(e);if(null==i)return!1;for(var a=o._length,r=0;a>r;r++)if(o._array[r]==n){t.set.call(o,r,n);break}return delete o._map[e],o._map[e]=n,!0}}(),function(){var e=function(){};e.prototype=StringMapedArrayList.prototype,PersonList.prototype=new e;var t=e.prototype,n=PersonList.prototype;n.add=function(e){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==e.getJid)return!1;var o=e.getJid();if(null==o||""==o)return!1;var i=n.getByJid(o);return null!=i?!1:t.add.call(this,o,e)},n.insert=function(e,n){var o=this;if(null==e||"number"!=typeof e)return!1;if(0>e||e>o._length)return!1;if(null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n)))return!1;var i=n.getJid();return null==i||""==i?!1:t.insert.call(this,e,i,n)},n.getByJid=function(e){return null==e||"string"!=typeof e?null:t.getByKey.call(this,e)},n.getByLoginAccount=function(e){var t=this;if(null==e||"string"!=typeof e)return null;for(var n=t._length,o=null,i=0;n>i;i++){var a=t._array[i];if(a.getLoginAccount()==e){o=a;break}}return o},n.removeByJid=function(e){return null==e||"string"!=typeof e?null:t.removeByKey.call(this,e)},n.removeAll=function(){t.removeAll.call(this)}}(),function(){var e=function(){};e.prototype=PersonList.prototype,ContactList.prototype=new e;var t=e.prototype,n=new ContactList;ContactList.getInstance=function(){return n};var o=ContactList.prototype;o.removeAll=function(){t.removeAll.call(this),this._sortedData=null},o.getSortedData=function(){return this._sortedData},o.setSortedData=function(e){this._sortedData=e}}(),function(){var e=function(){};e.prototype=PersonList.prototype,FollowFollowerList.prototype=new e;var t=e.prototype,n=FollowFollowerList.prototype;n.getMemberCount=function(){return this._memberCount},n.setMemberCount=function(e){null!=e&&"number"==typeof e&&(this._memberCount=e)},n.add=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var n=t.add.call(this,e);return 1==n&&(this._gotten=!0),n},n.isDataGotten=function(){return this._gotten},n.removeAll=function(){t.removeAll.call(this),this._memberCount=0,this._gotten=!1}}(),function(){var e=function(){};e.prototype=FollowFollowerList.prototype,FollowList.prototype=new e;var t=e.prototype,n=new FollowList;FollowList.getInstance=function(){return n};var o=FollowList.prototype;o.removeAll=function(){t.removeAll.call(this)}}(),function(){var e=function(){};e.prototype=FollowFollowerList.prototype,FollowerList.prototype=new e;var t=e.prototype,n=new FollowerList;FollowerList.getInstance=function(){return n};var o=FollowerList.prototype;o.removeAll=function(){t.removeAll.call(this)}}(),function(){var e=function(){};e.prototype=PersonList.prototype,NoConnectionPersonList.prototype=new e;var t=e.prototype,n=new NoConnectionPersonList;NoConnectionPersonList.getInstance=function(){return n};var o=NoConnectionPersonList.prototype;o.removeAll=function(){t.removeAll.call(this)}}(),function(){var e=function(){};e.prototype=ArrayList.prototype,ReminderList.prototype=new e;e.prototype,ReminderList.prototype}(),function(){var e=function(){};e.prototype=PersonList.prototype,SearchResultPersonList.prototype=new e;var t=e.prototype,n=SearchResultPersonList.prototype;n.getAllItemCount=function(){return this._allItemCount},n.setAllItemCount=function(e){null!=e&&"number"==typeof e&&(this._allItemCount=e)},n.removeAll=function(){t.removeAll.call(this)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnInformation.TYPE_COLUMN_UNKNOWN=0,ColumnInformation.TYPE_COLUMN_TIMELINE=1,ColumnInformation.TYPE_COLUMN_MENTION=2,ColumnInformation.TYPE_COLUMN_CHAT=3,ColumnInformation.TYPE_COLUMN_TASK=4,ColumnInformation.TYPE_COLUMN_TASK_REGISTER=5,ColumnInformation.TYPE_COLUMN_INBOX=6,ColumnInformation.TYPE_COLUMN_SEARCH=7,ColumnInformation.TYPE_COLUMN_FILTER=8,ColumnInformation.TYPE_COLUMN_GROUP_CHAT=9,ColumnInformation.TYPE_COLUMN_MAIL=10,ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER=11,ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED=12,ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK=13,ColumnInformation.TYPE_COLUMN_RECENT=14,ColumnInformation.TYPE_COLUMN_TOME=15,ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION=16,ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE=17,ColumnInformation.TYPE_COLUMN_MURMUR=18,ColumnInformation.SORT_ORDER_ASC=0,ColumnInformation.SORT_ORDER_DES=1,ColumnInformation.SORT_TYPE_TIME=0;var e=ColumnInformation.prototype;e.getColumnType=function(){return this._colmnType},e.setColumnType=function(e){null!=e&&"number"==typeof e&&(this._colmnType=e)},e.getFilterCondition=function(){return this._filterCondition},e.setFilterCondition=function(e){null!=e&&"string"==typeof e&&(this._filterCondition=e)},e.getSortOrder=function(){return this._sortOrder},e.setSortOrder=function(e){null!=e&&"number"==typeof e&&(e<ColumnInformation.SORT_ORDER_ASC||e>ColumnInformation.SORT_ORDER_DES||(this._sortOrder=e))},e.getSortType=function(){return this._sortType},e.setSortType=function(e){null!=e&&"number"==typeof e&&(this._sortType=e)},e.getMessageList=function(){return this._messageList},e.getDisplayName=function(){return this._displayName},e.setDisplayName=function(e){null!=e&&"string"==typeof e&&(this._displayName=e)},e.getIconImage=function(){return this._iconImage},e.setIconImage=function(e){null!=e&&"string"==typeof e&&(this._iconImage=e)},e.getSearchCondition=function(){return this._searchCondition},e.setSearchCondition=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._searchCondition=e)},e.getRightToSendMessage=function(){return this._hasSendMessageRight},e.setRightToSendMessage=function(e){"boolean"==typeof e&&(this._hasSendMessageRight=e)},e.getRightToViewMessage=function(){return this._hasViewMessageRight},e.setRightToViewMessage=function(e){"boolean"==typeof e&&(this._hasViewMessageRight=e)}}(),function(){var e=function(){};e.prototype=ColumnInformation.prototype,FilterColumnInfomation.prototype=new e;var t=(e.prototype,FilterColumnInfomation.prototype);t.getSourceColumnType=function(){return this._sourceColumnType},t.setSourceColumnType=function(e){null!=e&&"number"==typeof e&&(this._sourceColumnType=e)},t.getSourceColumnDisplayName=function(){return this._sourceColumnDisplayName},t.setSourceColumnDisplayName=function(e){null!=e&&"string"==typeof e&&(this._sourceColumnDisplayName=e)},t.getKeyword=function(){return this._keyword},t.setKeyword=function(e){null!=e&&"string"==typeof e&&(this._keyword=e)},t.getSubData=function(){return this._subData},t.setSubData=function(e){this._subData=e},t.getBeginningColumnType=function(){return this._beginningColumnType}}(),function(){CustomFilterColumnInfomation.prototype=$.extend({},ColumnInformation.prototype);var e=(ColumnInformation.prototype,CustomFilterColumnInfomation.prototype);e.getSourceColumnType=function(){return this._sourceColumnType},e.setSourceColumnType=function(e){null!=e&&"number"==typeof e&&(this._sourceColumnType=e)},e.getSourceColumnDisplayName=function(){return this._sourceColumnDisplayName},e.setSourceColumnDisplayName=function(e){null!=e&&"string"==typeof e&&(this._sourceColumnDisplayName=e)},e.getSetting=function(){return this._setting},e.setSetting=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._setting=e)},e.getSubData=function(){return this._subData},e.setSubData=function(e){this._subData=e},e.getSourceColumnTypeList=function(){return this._sourceColumnTypeList},e.getKeyword=function(){return this._keyword},e.setKeyword=function(e){this._keyword=e},e.getBeginningColumnType=function(){return this._beginningColumnType},e.setBeginningColumnType=function(e){null!=e&&"number"==typeof e&&(this._beginningColumnType=e)},CustomFilterColumnInfomation.copySubData=function(e){return $.extend(!0,{},e)}}(),function(){var e=function(){};e.prototype=ColumnInformation.prototype,SearchColumnInfomation.prototype=new e;var t=(e.prototype,SearchColumnInfomation.prototype);t.getSourceColumnType=function(){return this._sourceColumnType},t.getSourceColumnTypeList=function(){return this._sourceColumnTypeList},t.getKeyword=function(){return this._keyword},t.setKeyword=function(e){null!=e&&"string"==typeof e&&(this._keyword=e)},t.getSubData=function(){return this._subData},t.setSubData=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._subData=e)}}(),function(){var e=function(){};e.prototype=ColumnInformation.prototype,GroupChatColumnInformation.prototype=new e;var t=(e.prototype,GroupChatColumnInformation.prototype);t.getChatRoomInfomation=function(){return this._chatRoomInfomation},t.setChatRoomInfomation=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._chatRoomInfomation=e)}}(),function(){var e=function(){};e.prototype=ColumnInformation.prototype,CommunityFeedColumnInformation.prototype=new e;var t=(e.prototype,CommunityFeedColumnInformation.prototype);t.getCommunityInfomation=function(){return this._communityInfomation},t.setCommunityInfomation=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._communityInfomation=e)}}(),function(){var e=function(){};e.prototype=ColumnInformation.prototype,CommunityTaskColumnInformation.prototype=new e;var t=(e.prototype,CommunityTaskColumnInformation.prototype);t.getCommunityInfomation=function(){return this._communityInfomation},t.setCommunityInfomation=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._communityInfomation=e)}}(),function(){var e=function(){};e.prototype=ColumnInformation.prototype,RecentColumnInfomation.prototype=new e;var t=(e.prototype,RecentColumnInfomation.prototype);t.getSourceColumnType=function(){return this._sourceColumnType},t.getSourceColumnTypeList=function(){return this._sourceColumnTypeList},t.getKeyword=function(){return this._keyword},t.setKeyword=function(e){null!=e&&"string"==typeof e&&(this._keyword=e)},t.getSubData=function(){return this._subData},t.setSubData=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._subData=e)}}(),function(){var e=function(){};e.prototype=ColumnInformation.prototype,ToMeColumnInfomation.prototype=new e;var t=(e.prototype,ToMeColumnInfomation.prototype);t.getSourceColumnType=function(){return this._sourceColumnType},t.getSourceColumnTypeList=function(){return this._sourceColumnTypeList},t.getKeyword=function(){return this._keyword},t.setKeyword=function(e){null!=e&&"string"==typeof e&&(this._keyword=e)},t.getSubData=function(){return this._subData},t.setSubData=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._subData=e)}}(),function(){var e=function(){};e.prototype=ColumnInformation.prototype,ShowConversationColumnInfomation.prototype=new e;var t=(e.prototype,ShowConversationColumnInfomation.prototype);t.getSourceColumnType=function(){return this._sourceColumnType},t.setSourceColumnType=function(e){null!=e&&"number"==typeof e&&(this._sourceColumnType=e)},t.getSourceColumnDisplayName=function(){return this._sourceColumnDisplayName},t.setSourceColumnDisplayName=function(e){null!=e&&"string"==typeof e&&(this._sourceColumnDisplayName=e)},t.getParentItemId=function(){return this._parentItemId},t.setParentItemId=function(e){null!=e&&"string"==typeof e&&(this._parentItemId=e)},t.getItemId=function(){return this._itemId},t.setItemId=function(e){null!=e&&"string"==typeof e&&(this._itemId=e)}}(),function(){var e=function(){};e.prototype=ColumnInformation.prototype,MurmurColumnInformation.prototype=new e;var t=(e.prototype,MurmurColumnInformation.prototype);t.getMurmurInfomation=function(){return this._info},t.setMurmurInfomation=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._info=e)},MurmurColumnInformation.getOwnJidFromSearchCondition=function(e){var t=null,n=LoginUser.getInstance().getFolloweeList();if(n.getCount()>0&&null!=e&&e.getSearchCondition()&&e.getSearchCondition().getFilterCondition()&&e.getSearchCondition().getFilterCondition().getJSONObject()&&Array.isArray(e.getSearchCondition().getFilterCondition().getJSONObject().value)&&2==e.getSearchCondition().getFilterCondition().getJSONObject().value.length&&(Array.isArray(e.getSearchCondition().getFilterCondition().getJSONObject().value[0].value)||Array.isArray(e.getSearchCondition().getFilterCondition().getJSONObject().value[1].value))){for(var o={},i=0;i<n.getCount();i++)o[n.get(i).getJid()]=!0;var a=e.getSearchCondition().getFilterCondition().getJSONObject().value,r=void 0;if(Array.isArray(a[1].value))r=a[1].value;else{if(!Array.isArray(a[0].value))return null;r=a[0].value}for(var s=0;s<r.length;s++)if(!o[r[s].value]){t=r[s].value;break}}else if(null!=e&&e.getSearchCondition()&&e.getSearchCondition().getFilterCondition()&&e.getSearchCondition().getFilterCondition().getJSONObject()&&Array.isArray(e.getSearchCondition().getFilterCondition().getJSONObject().value))for(var l=e.getSearchCondition().getFilterCondition().getJSONObject().value,u=0;u<l.length;u++)"msgto"==l[u].name&&(t=l[u].value);return t}}(),function(){var e=function(){};e.prototype=ArrayList.prototype,ColumnList.prototype=new e;var t=e.prototype,n=new ColumnList;ColumnList.getInstance=function(){return n};var o=ColumnList.prototype;o.add=function(e){return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:t.add.call(this,e)},o.insert=function(e,n){var o=this;return null==e||"number"!=typeof e?!1:0>e||e>o._length?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))?!1:t.insert.call(this,e,n)},o.get=function(e){var n=this;return null==e||"number"!=typeof e?null:0>e||e>=n._length?null:t.get.call(this,e)},o.removeAll=function(){t.removeAll.call(this)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){Profile.STATUS_UNKNOWN=-1,Profile.STATUS_ACTIVE=0,Profile.STATUS_DELETE=1,Profile.STATUS_SUSPEND=2;var e=Profile.prototype;e.getNickName=function(){return this._nickName},e.setNickName=function(e){null!=e&&"string"==typeof e&&(this._nickName=e)},e.getMailAddress=function(){return this._mailAddress},e.setMailAddress=function(e){null!=e&&"string"==typeof e&&(this._mailAddress=e)},e.getGroup=function(){return this._group},e.setGroup=function(e){Array.isArray(e)&&(this._group=e)},e.getAvatarType=function(){return this._avatarType},e.setAvatarType=function(e){null!=e&&"string"==typeof e&&(this._avatarType=e)},e.getAvatarData=function(){return this._avatarData},e.setAvatarData=function(e){null!=e&&"string"==typeof e&&(this._avatarData=e)},e.getLoginAccount=function(){return this._loginAccount},e.setLoginAccount=function(e){null!=e&&"string"==typeof e&&(this._loginAccount=e)},e.getStatus=function(){return this._status},e.setStatus=function(e){null!=e&&"number"==typeof e&&(this._status=e)}}(),function(){Person.PRESENCE_STATUS_OFFLINE=0,Person.PRESENCE_STATUS_ONLINE=1,Person.PRESENCE_STATUS_AWAY=2,Person.PRESENCE_STATUS_EXT_AWAY=3,Person.PRESENCE_STATUS_DO_NOT_DISTURB=4,Person.PROFILE_STATUS_ACTIVE=Profile.STATUS_ACTIVE,Person.PROFILE_STATUS_DELETE=Profile.STATUS_DELETE,Person.PROFILE_STATUS_SUSPEND=Profile.STATUS_SUSPEND;var e=Person.prototype;e.getGroup=function(){return this._group},e.setGroup=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._group=e)},e.getLoginAccount=function(){return null==this._profile?null:this._profile.getLoginAccount()},e.setLoginAccount=function(e){null!=e&&"string"==typeof e&&(null==this._profile&&(this._profile=new Profile),this._profile.setLoginAccount(e))},e.getUserName=function(){return null==this._profile?null:this._profile.getNickName()},e.setUserName=function(e){null!=e&&"string"==typeof e&&(null==this._profile&&(this._profile=new Profile),this._profile.setNickName(e))},e.getMailAddress=function(){return null==this._profile?null:this._profile.getMailAddress()},e.setMailAddress=function(e){null!=e&&"string"==typeof e&&(null==this._profile&&(this._profile=new Profile),this._profile.setMailAddress(e))},e.getJid=function(){return this._jid},e.setJid=function(e){null!=e&&"string"==typeof e&&(this._jid=e)},e.getPresence=function(){return this._presence},e.setPresence=function(e){null!=e&&"number"==typeof e&&(e<Person.PRESENCE_STATUS_OFFLINE||e>Person.PRESENCE_STATUS_DO_NOT_DISTURB||(this._presence=e))},e.getMyMemo=function(){return this._myMemo},e.setMyMemo=function(e){null!=e&&"string"==typeof e&&(this._myMemo=e)},e.getAvatarType=function(){return null==this._profile?null:this._profile.getAvatarType()},e.setAvatarType=function(e){null!=e&&"string"==typeof e&&(null==this._profile&&(this._profile=new Profile),this._profile.setAvatarType(e))},e.getAvatarData=function(){return null==this._profile?null:this._profile.getAvatarData()},e.setAvatarData=function(e){null!=e&&"string"==typeof e&&(null==this._profile&&(this._profile=new Profile),this._profile.setAvatarData(e))},e.getLoginAccount=function(){return null==this._profile?null:this._profile.getLoginAccount()},e.setLoginAccount=function(e){null!=e&&"string"==typeof e&&(null==this._profile&&(this._profile=new Profile),this._profile.setLoginAccount(e))},e.getStatus=function(){return null==this._profile?Profile.STATUS_UNKNOWN:this._profile.getStatus()},e.setStatus=function(e){null!=e&&"number"==typeof e&&(null==this._profile&&(this._profile=new Profile),this._profile.setStatus(e))},e.cleanUp=function(){var e=this;e._group=null,e._profile=null,e._jid=null,e._presence=Person.PRESENCE_STATUS_OFFLINE,e._myMemo=null,e._id=-1},e.getId=function(){return this._id},e.setId=function(e){null!=e&&"number"==typeof e&&(this._id=e)}}(),function(){var e=function(){};e.prototype=Person.prototype,LoginUser.prototype=new e;var t=e.prototype,n=new LoginUser;LoginUser.getInstance=function(){return n};var o=LoginUser.prototype;o.setSettings=function(e){this._settings=e},o.getSettings=function(){return this._settings},o.setTenantInfo=function(e){this._tenantInfo=e?JSON.parse(JSON.stringify(e)):this._tenantInfo},o.getTenantInfo=function(){return this._tenantInfo},o.setExtras=function(e){this._extras=e?JSON.parse(JSON.stringify(e)):this._extras},o.getExtras=function(){return this._extras},o.isUpdatablePersonData=function(){var e=this._tenantInfo;return"ldap"in e&&null!=e.ldap&&"ldapEnable"in e.ldap&&null!=e.ldap.ldapEnable&&"ldapUpdatable"in e.ldap&&null!=e.ldap.ldapUpdatable&&1==e.ldap.ldapEnable&&0==e.ldap.ldapUpdatable?!1:!0},o.cleanUp=function(){var e=this;t.cleanUp.call(e),e._settings=null,e._tenantInfo=null,e._followee=[],e._follower=[]},o.isFirstLogin=function(){return this._firstLogin},o.setFirstLogin=function(){this._firstLogin=!0},o.getFolloweeList=function(){return this._followee},o.setFolloweeList=function(e){var t=this;if("object"==!("undefined"==typeof e?"undefined":_typeof(e)))throw new Error("setFolloweeList followee is not array");t._followee=e},o.getFollowerList=function(){return this._follower},o.setFollowerList=function(e){var t=this;if("object"==!("undefined"==typeof e?"undefined":_typeof(e)))throw new Error("setFollowerList follower is not array");t._follower=e}}(),function(){var e=UserSettings.prototype;e.getMailCooperationList=function(){return this._mailCooperationInfoList},e.setMailCooperationList=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._mailCooperationInfoList=e)}}(),function(){ProfileChangeNotice.TYPE_PRESENCE=1,ProfileChangeNotice.TYPE_PROFILE=2;var e=ProfileChangeNotice.prototype;e.getType=function(){return this._type},e.getJid=function(){return this._jid},e.setJid=function(e){null!=e&&"string"==typeof e&&(this._jid=e)}}(),function(){var e=function(){};e.prototype=ProfileChangeNotice.prototype,PresenceChangeNotice.prototype=new e;var t=(e.prototype,PresenceChangeNotice.prototype);t.getPresence=function(){return this._presence},t.setPresence=function(e){null!=e&&"number"==typeof e&&(e<Person.PRESENCE_STATUS_OFFLINE||e>Person.PRESENCE_STATUS_DO_NOT_DISTURB||(this._presence=e))},t.getMyMemo=function(){return this._myMemo},t.setMyMemo=function(e){null!=e&&"string"==typeof e&&(this._myMemo=e)}}(),function(){var e=function(){};e.prototype=ProfileChangeNotice.prototype,ProfileChangeData.prototype=new e;var t=(e.prototype,ProfileChangeData.prototype);t.getProfile=function(){return this._profile},t.setProfile=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._profile=e)},t.getUpdateTime=function(){return this._updateTime},t.setUpdateTime=function(e){null!=e&&"string"==typeof e&&(this._updateTime=e)}}(),function(){var e=AddContactListMember.prototype;e.getPerson=function(){return this._person},e.setPerson=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._person=e)},e.getContactListGroup=function(){return this._contactListGroup},e.setContactListGroup=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._contactListGroup=e)},e.getPosition=function(){return this._position},e.setPosition=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._position=e)},e.removeAll=function(){_super.removeAll.call(this)}}(),function(){LoginPresence.prototype=new LoginPresence;var e=new LoginPresence;LoginPresence.getInstance=function(){return e};var t=LoginPresence.prototype;t.setLoginPresence=function(e){null!=e&&"number"==typeof e&&(this._loginPresence=e,this._loginPresenceStr=Utils.convertPresenceNumToStr(e))},t.getLoginPresence=function(){return this._loginPresence},t.getLoginPresenceToStr=function(){return this._loginPresenceStr},t.isLogin=function(){return this._loginPresence===Person.PRESENCE_STATUS_OFFLINE}}(),function(){LoginMyMemo.prototype=new LoginMyMemo;var e=new LoginMyMemo;LoginMyMemo.getInstance=function(){return e};var t=LoginMyMemo.prototype;t.setLoginMyMemo=function(e){null!=e&&"string"==typeof e&&(this._loginMyMemo=e)},t.getLoginMyMemo=function(){return this._loginMyMemo;
}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){Notification_model.TYPE_BASE=0,Notification_model.TYPE_GOOD_JOB=1,Notification_model.TYPE_TASK=2,Notification_model.TYPE_CHAT=3,Notification_model.TYPE_SYSTEM=4,Notification_model.TYPE_MESSAGE_OPTION=5,Notification_model.TYPE_DELETE_MESSAGE=6,Notification_model.TYPE_GROUP_CHAT=7,Notification_model.TYPE_MAIL=8,Notification_model.TYPE_COMMUNITY=9,Notification_model.TYPE_AUTHORITY_CHANGED=10,Notification_model.TYPE_THREAD_TITLE=11,Notification_model.TYPE_MESSAGE_UPDATE=12,Notification_model.TYPE_EMOTION_POINT=13,Notification_model.TYPE_ASSIGN_NOTE=14,Notification_model.TYPE_DELETE_NOTE=15,Notification_model.TYPE_QUESTIONNAIRE=16,Notification_model.TYPE_USER_FOLLOW=17,Notification_model.TYPE_MURMUR=18;var e=Notification_model.prototype;e.getType=function(){return this._type}}(),function(){GoodJobNotification.prototype=$.extend({},Notification_model.prototype,Profile.prototype);var e=(Notification_model.prototype,GoodJobNotification.prototype);e.getItemId=function(){return this._itemId},e.setItemId=function(e){null!=e&&"string"==typeof e&&(this._itemId=e)},e.getFromJid=function(){return this._fromJid},e.setFromJid=function(e){null!=e&&"string"==typeof e&&(this._fromJid=e)},e.getFromName=function(){return this._fromName},e.setFromName=function(e){null!=e&&"string"==typeof e&&(this._fromName=e)},e.getDate=function(){return this._date},e.setDate=function(e){null!=e&&"string"==typeof e&&(this._date=e)},e.getMessage=function(){return this._message},e.setMessage=function(e){null!=e&&"string"==typeof e&&(this._message=e)},e.getMsgOwnJid=function(){return this._msgOwnJid},e.setMsgOwnJid=function(e){null!=e&&"string"==typeof e&&(this._msgOwnJid=e)},e.getMsgTo=function(){return this._msgTo},e.setMsgTo=function(e){null!=e&&"string"==typeof e&&(this._msgTo=e)},e.getMsgType=function(){return this._msgType},e.setMsgType=function(e){null!=e&&"number"==typeof e&&(this._msgType=e)}}(),function(){TaskNotification.ACTION_TYPE_NONE=0,TaskNotification.ACTION_TYPE_ADD=1,TaskNotification.ACTION_TYPE_UPDATE=2;var e=function(){};e.prototype=Notification_model.prototype,TaskNotification.prototype=new e;var t=(e.prototype,TaskNotification.prototype);t.getActionType=function(){return this._actionType},t.setActionType=function(e){null!=e&&"number"==typeof e&&(this._actionType=e)},t.getTaskMessage=function(){return this._taskMessage},t.setTaskMessage=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._taskMessage=e)}}(),function(){QuestionnaireNotification.ACTION_TYPE_NONE=0,QuestionnaireNotification.ACTION_TYPE_ADD=1,QuestionnaireNotification.ACTION_TYPE_UPDATE=2;var e=function(){};e.prototype=Notification_model.prototype,QuestionnaireNotification.prototype=new e;var t=(e.prototype,QuestionnaireNotification.prototype);t.getActionType=function(){return this._actionType},t.setActionType=function(e){null!=e&&"number"==typeof e&&(this._actionType=e)},t.getQuestionnaireMessage=function(){return this._questionnaireMessage},t.setQuestionnaireMessage=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._questionnaireMessage=e)}}(),function(){var e=function(){};e.prototype=Notification_model.prototype,ChatNotification.prototype=new e;var t=(e.prototype,ChatNotification.prototype);t.getChatMessage=function(){return this._chatMessage},t.setChatMessage=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._chatMessage=e)}}(),function(){var e=function(){};e.prototype=Notification_model.prototype,SystemNotification.prototype=new e;var t=(e.prototype,SystemNotification.prototype);t.getSystemMessage=function(){return this._systemMessage},t.setSystemMessage=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._systemMessage=e)}}(),function(){MessageOptionNotification.CONTENT_TYPE_BASE=0,MessageOptionNotification.CONTENT_TYPE_GOOD_JOB=1,MessageOptionNotification.CONTENT_TYPE_SIBLING_TASK=2,MessageOptionNotification.CONTENT_TYPE_DEMAND_TASK=3,MessageOptionNotification.CONTENT_TYPE_SET_READ_MESSAGE=4;var e=function(){};e.prototype=Notification_model.prototype,MessageOptionNotification.prototype=new e;var t=(e.prototype,MessageOptionNotification.prototype);t.getContentType=function(){return this._contentType},t.setContentType=function(e){null!=_contentType&&"number"==typeof _contentType&&(this._contentType=e)},t.getItemId=function(){return this._itemId},t.setItemId=function(e){null!=e&&"string"==typeof e&&(this._itemId=e)}}(),function(){var e=function(){};e.prototype=MessageOptionNotification.prototype,SiblingTaskNotification.prototype=new e;var t=(e.prototype,SiblingTaskNotification.prototype);t.getSiblingItemId=function(){return this._siblingItemId},t.setSiblingItemId=function(e){null!=e&&"string"==typeof e&&(this._siblingItemId=e)},t.getOwnerJid=function(){return this._ownerJid},t.setOwnerJid=function(e){null!=e&&"string"==typeof e&&(this._ownerJid=e)},t.getOwnerName=function(){return this._ownerName},t.setOwnerName=function(e){null!=e&&"string"==typeof e&&(this._ownerName=e)},t.getStatus=function(){return this._status},t.setStatus=function(e){null!=e&&"number"==typeof e&&(this._status=e)},t.getNickName=function(){return this._nickName},t.setNickName=function(e){null!=e&&"string"==typeof e&&(this._nickName=e)},t.getAvatarType=function(){return this._avatarType},t.setAvatarType=function(e){null!=e&&"string"==typeof e&&(this._avatarType=e)},t.getAvatarData=function(){return this._avatarData},t.setAvatarData=function(e){null!=e&&"string"==typeof e&&(this._avatarData=e)},t.getLoginAccount=function(){return this._loginAccount},t.setLoginAccount=function(e){null!=e&&"string"==typeof e&&(this._loginAccount=e)},t.getUserStatus=function(){return this._userStatus},t.setUserStatus=function(e){null!=e&&"number"==typeof e&&(this._userStatus=e)}}(),function(){var e=function(){};e.prototype=Notification_model.prototype,DeleteMessageNotification.prototype=new e;var t=(e.prototype,DeleteMessageNotification.prototype);t.getItemId=function(){return this._itemId},t.setItemId=function(e){null!=e&&"string"==typeof e&&(this._itemId=e)},t.getDeleteFlag=function(){return this._deleteFlag},t.setDeleteFlag=function(e){null!=e&&"number"==typeof e&&(this._deleteFlag=e)},t.getAdminDeleted=function(){return this._adminDeleted},t.setAdminDeleted=function(e){null!=e&&"boolean"==typeof e&&(this._adminDeleted=e)}}(),function(){GroupChatNotification.SUB_TYPE_UNKNOWN=0,GroupChatNotification.SUB_TYPE_MESSAGE=1,GroupChatNotification.SUB_TYPE_CREATE_ROOM=2,GroupChatNotification.SUB_TYPE_ADD_MEMBER=3,GroupChatNotification.SUB_TYPE_UPDATE_ROOM_INFO=4,GroupChatNotification.SUB_TYPE_REMOVE_MEMBER=5,GroupChatNotification.SUB_TYPE_AUTHORITY_CHANGED=7,GroupChatNotification.prototype=$.extend({},Notification_model.prototype);var e=(Notification_model.prototype,GroupChatNotification.prototype);e.getSubType=function(){return this._subType},e.getRoomInfo=function(){return this._roomInfo},e.setRoomInfo=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._roomInfo=e)},e.getProfileMap=function(){return this._profileMap},e.setProfileMap=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._profileMap=e)}}(),function(){var e=function(){};e.prototype=GroupChatNotification.prototype,GroupChatMessageNotification.prototype=new e;var t=(e.prototype,GroupChatMessageNotification.prototype);t.getGroupChatMessage=function(){return this._groupChatMessage},t.setGroupChatMessage=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._groupChatMessage=e)}}(),function(){var e=function(){};e.prototype=GroupChatNotification.prototype,GroupChatCreateNotification.prototype=new e;e.prototype,GroupChatCreateNotification.prototype}(),function(){var e=function(){};e.prototype=GroupChatNotification.prototype,GroupChatAddMemberNotification.prototype=new e;var t=(e.prototype,GroupChatAddMemberNotification.prototype);t.getAddedBy=function(){return this._addedBy},t.setAddedBy=function(e){null!=e&&"string"==typeof e&&(this._addedBy=e)},t.getAddedMemberList=function(){return this._addedMemberList}}(),function(){GroupChatRemoveMemberNotification.prototype=$.extend({},GroupChatNotification.prototype);var e=(GroupChatNotification.prototype,GroupChatRemoveMemberNotification.prototype);e.getRemovedBy=function(){return this._removedBy},e.setRemovedBy=function(e){null!=e&&"string"==typeof e&&(this._removedBy=e)},e.getRemovedMemberList=function(){return this._removedMemberList}}(),function(){GroupChatInfoUpdateNotification.SUB_TYPE_CHANGE_ROOM_NAME="ChangeRoomName",GroupChatInfoUpdateNotification.SUB_TYPE_CHANGE_ROOM_PRIVACY_TYPE="ChangePrivacyType";var e=function(){};e.prototype=GroupChatNotification.prototype,GroupChatInfoUpdateNotification.prototype=new e;var t=(e.prototype,GroupChatInfoUpdateNotification.prototype);t.getUpdatedItems=function(){return this._updatedItems},t.getPreviousRoomName=function(){return this._previousRoomName},t.setPreviousRoomName=function(e){null!=e&&"string"==typeof e&&(this._previousRoomName=e)},t.getPreviousPrivacyType=function(){return this._previousPrivacyType},t.setPreviousPrivacyType=function(e){null!=e&&"number"==typeof e&&(this._previousPrivacyType=e)}}(),function(){var e=function(){};e.prototype=GroupChatNotification.prototype,GroupChatAuthorityChangedNotification.prototype=new e;var t=(e.prototype,GroupChatAuthorityChangedNotification.prototype);t.getRoomId=function(){return this._roomId},t.setRoomId=function(e){null!=e&&"string"==typeof e&&(this._roomId=e)},t.setRoomInfo=function(e){this._roomInfo=e},t.getRoomInfo=function(){return this._roomInfo},t.setPolicy=function(e){this._policy=e},t.getPolicy=function(){return this._policy}}(),function(){var e=function(){};e.prototype=Notification_model.prototype,MailMessageNotification.prototype=new e;var t=(e.prototype,MailMessageNotification.prototype);t.getMailMessage=function(){return this._mailMessage},t.setMailMessage=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._mailMessage=e)}}(),function(){var e=function(){};e.prototype=MessageOptionNotification.prototype,DemandTaskNotification.prototype=new e;var t=(e.prototype,DemandTaskNotification.prototype);t.getTitle=function(){return this._taskTitle},t.setTitle=function(e){null!=e&&"string"==typeof e&&(this._taskTitle=e)},t.getOwner=function(){return this._taskOwner},t.setOwner=function(e){null!=e&&"string"==typeof e&&(this._taskOwner=e)},t.getClient=function(){return this._taskClient},t.setClient=function(e){null!=e&&"string"==typeof e&&(this._taskClient=e)},t.getStatus=function(){return this._taskStatus},t.setStatus=function(e){null!=e&&"number"==typeof e&&(this._taskStatus=e)},t.getDemandStatus=function(){return this._taskDemandStatus},t.setDemandStatus=function(e){null!=e&&"number"==typeof e&&(this._taskDemandStatus=e)},t.getDemandDate=function(){return this._taskDemandDate},t.setDemandDate=function(e){null!=e&&"string"==typeof e&&(this._taskDemandDate=e)},t.getJid=function(){return this._fromJid},t.setJid=function(e){null!=e&&"string"==typeof e&&(this._fromJid=e)},t.getNickName=function(){return this._fromName},t.setNickName=function(e){null!=e&&"string"==typeof e&&(this._fromName=e)}}(),function(){var e=function(){};e.prototype=MessageOptionNotification.prototype,SetReadMessageNotification.prototype=new e;var t=(e.prototype,SetReadMessageNotification.prototype);t.getExistingReaderItem=function(){return this._existingReaderItem},t.setExistingReaderItem=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._existingReaderItem=e)}}(),function(){CommunityNotification.SUB_TYPE_UNKNOWN=0,CommunityNotification.SUB_TYPE_UPDATE_ROOM_INFO=1,CommunityNotification.SUB_TYPE_ADD_MEMBER=2,CommunityNotification.SUB_TYPE_UPDATE_OWNER=3,CommunityNotification.SUB_TYPE_REMOVE_MEMBER=4,CommunityNotification.SUB_TYPE_MESSAGE=5,CommunityNotification.SUB_TYPE_AUTHORITY_CHANGED=6;var e=function(){};e.prototype=Notification_model.prototype,CommunityNotification.prototype=new e;var t=(e.prototype,CommunityNotification.prototype);t.getSubType=function(){return this._subType}}(),function(){var e=function(){};e.prototype=CommunityNotification.prototype,CommunityInfoUpdateNotification.prototype=new e;var t=(e.prototype,CommunityInfoUpdateNotification.prototype);t.getUpdatedCommunityInfo=function(){return this._updatedCommunityInfo},t.getPreviousCommunityInfo=function(){return this._previousCommunityInfo},t.setData=function(e,t){(null==e||"object"==("undefined"==typeof e?"undefined":_typeof(e)))&&(null==t||"object"==("undefined"==typeof t?"undefined":_typeof(t)))&&(this._updatedCommunityInfo=e,this._previousCommunityInfo=t)}}(),function(){var e=function(){};e.prototype=CommunityNotification.prototype,CommunityMemberAddNotification.prototype=new e;var t=(e.prototype,CommunityMemberAddNotification.prototype);t.getRoomId=function(){return this._roomId},t.setRoomId=function(e){null!=e&&"string"==typeof e&&(this._roomId=e)},t.getRoomName=function(){return this._roomName},t.setRoomName=function(e){null!=e&&"string"==typeof e&&(this._roomName=e)},t.getAddedBy=function(){return this._addedBy},t.setAddedBy=function(e){null!=e&&"string"==typeof e&&(this._addedBy=e)},t.getAddedMemberList=function(){return this._addedMemberList}}(),function(){var e=function(){};e.prototype=CommunityNotification.prototype,CommunityOwnerUpdateNotification.prototype=new e;var t=(e.prototype,CommunityOwnerUpdateNotification.prototype);t.getRoomId=function(){return this._roomId},t.setRoomId=function(e){null!=e&&"string"==typeof e&&(this._roomId=e)},t.getOwnerList=function(){return this._ownerList},t.getPreOwnerList=function(){return this._preOwnerList}}(),function(){var e=function(){};e.prototype=CommunityNotification.prototype,CommunityMemberRemoveNotification.prototype=new e;var t=(e.prototype,CommunityMemberRemoveNotification.prototype);t.getRoomId=function(){return this._roomId},t.setRoomId=function(e){null!=e&&"string"==typeof e&&(this._roomId=e)},t.getRoomName=function(){return this._roomName},t.setRoomName=function(e){null!=e&&"string"==typeof e&&(this._roomName=e)},t.getRemovedBy=function(){return this._removedBy},t.setRemovedBy=function(e){null!=e&&"string"==typeof e&&(this._removedBy=e)},t.getRemovedMemberList=function(){return this._removedMemberList}}(),function(){var e=function(){};e.prototype=CommunityNotification.prototype,CommunityMessageNotification.prototype=new e;var t=(e.prototype,CommunityMessageNotification.prototype);t.getCommunityMessage=function(){return this._communityMessage},t.setCommunityMessage=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._communityMessage=e)}}(),function(){var e=function(){};e.prototype=CommunityNotification.prototype,CommunityAuthorityChangedNotification.prototype=new e;var t=(e.prototype,CommunityAuthorityChangedNotification.prototype);t.getRoomId=function(){return this._roomId},t.setRoomId=function(e){null!=e&&"string"==typeof e&&(this._roomId=e)},t.getRoomName=function(){return this._roomName},t.setRoomName=function(e){null!=e&&"string"==typeof e&&(this._roomName=e)},t.setPolicy=function(e){this._policy=e},t.getPolicy=function(){return this._policy}}(),function(){MurmurNotification.SUB_TYPE_UNKNOWN=0,MurmurNotification.SUB_TYPE_MESSAGE=5,MurmurNotification.SUB_TYPE_SET_COLUMN_NAME=6}(),function(){var e=function(){};e.prototype=Notification_model.prototype,MurmurMessageNotification.prototype=new e;var t=(e.prototype,MurmurMessageNotification.prototype);t.getSubType=function(){return this._subType},t.getMurmurMessage=function(){return this._murmurMessage},t.setMurmurMessage=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._murmurMessage=e)}}(),function(){AuthorityInfoUpdateNotification.SUB_TYPE_ASSIGN_ROLE="AssignRoleToUser",AuthorityInfoUpdateNotification.SUB_TYPE_POLICY_ASSIGN="AssignPolicyToUsers",AuthorityInfoUpdateNotification.SUB_TYPE_POLICY_UNASSIGN="UnassignPolicyFromUser";var e=function(){};e.prototype=Notification_model.prototype,AuthorityInfoUpdateNotification.prototype=new e;var t=(e.prototype,AuthorityInfoUpdateNotification.prototype);t.getSubType=function(){return this._subType},t.setSubType=function(e){null!=e&&"string"==typeof e&&(this._subType=e)},t.getUpdatedItem=function(){return this._updatedItem},t.setUpdatedItem=function(e){this._updatedItem=e},t.getTriger=function(){return this._triger},t.setTriger=function(e){this._triger=e}}(),function(){var e=function(){};e.prototype=Notification_model.prototype,MurmurSetColumnNameNotification.prototype=new e;var t=(e.prototype,MurmurSetColumnNameNotification.prototype);t.getSubType=function(){return this._subType},t.getJid=function(){return this._jid},t.setJid=function(e){null!=e&&"string"==typeof e&&(this._jid=e)},t.getColumnName=function(){return this._columnName},t.setColumnName=function(e){this._columnName=e}}(),function(){var e=function(){};e.prototype=Notification_model.prototype,ThreadTitleUpdateNotification.prototype=new e;var t=(e.prototype,ThreadTitleUpdateNotification.prototype);t.getSubType=function(){return this._subType},t.setSubType=function(e){null!=e&&"string"==typeof e&&(this._subType=e)},t.getThreadRootId=function(){return this._threadRootId},t.setThreadRootId=function(e){this._threadRootId=e},t.getThreadTitle=function(){return this._threadTitle},t.setThreadTitle=function(e){this._threadTitle=e},t.getItemId=function(){return this._itemId},t.setItemId=function(e){this._itemId=e}}(),function(){MessageUpdateNotification.ACTION_TYPE_UPDATE=2;var e=function(){};e.prototype=Notification_model.prototype,MessageUpdateNotification.prototype=new e;var t=(e.prototype,MessageUpdateNotification.prototype);t.getMessage=function(){return this._message},t.setMessage=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._message=e)}}(),function(){EmotionPointNotification.prototype=$.extend({},Notification_model.prototype,Profile.prototype);var e=(Notification_model.prototype,EmotionPointNotification.prototype);e.getItemId=function(){return this._itemId},e.setItemId=function(e){null!=e&&"string"==typeof e&&(this._itemId=e)},e.getFromJid=function(){return this._fromJid},e.setFromJid=function(e){null!=e&&"string"==typeof e&&(this._fromJid=e)},e.getFromName=function(){return this._fromName},e.setFromName=function(e){null!=e&&"string"==typeof e&&(this._fromName=e)},e.getCreatedAt=function(){return this._created_at},e.setCreatedAt=function(e){null!=e&&"string"==typeof e&&(this._created_at=e)},e.getUpdatedAt=function(){return this._updated_at},e.setUpdatedAt=function(e){null!=e&&"string"==typeof e&&(this._updated_at=e)},e.getEmotionPoint=function(){return this._emotion_point},e.setEmotionPoint=function(e){null!=e&&"number"==typeof e&&""!=e&&(this._emotion_point=e)},e.getMessage=function(){return this._message},e.setMessage=function(e){null!=e&&"string"==typeof e&&(this._message=e)},e.getMsgOwnJid=function(){return this._msgOwnJid},e.setMsgOwnJid=function(e){null!=e&&"string"==typeof e&&(this._msgOwnJid=e)},e.getMsgTo=function(){return this._msgTo},e.setMsgTo=function(e){null!=e&&"string"==typeof e&&(this._msgTo=e)},e.getMsgType=function(){return this._msgType},e.setMsgType=function(e){null!=e&&"number"==typeof e&&(this._msgType=e)}}(),function(){var e=function(){};e.prototype=Notification_model.prototype,NoteAssignChangedNotification.prototype=new e;var t=(e.prototype,NoteAssignChangedNotification.prototype);t.getNoteTitle=function(){return this._noteTitle},t.setNoteTitle=function(e){this._noteTitle=e},t.getNoteUrl=function(){return this._noteUrl},t.setNoteUrl=function(e){this._noteUrl=e},t.getOldThreadRootId=function(){return this._oldThreadRootId},t.setOldThreadRootId=function(e){this._oldThreadRootId=e},t.getThreadRootId=function(){return this._threadRootId},t.setThreadRootId=function(e){this._threadRootId=e},t.getRoomId=function(){return this._roomId},t.setRoomId=function(e){this._roomId=e},t.getOwnJid=function(){return this._ownJid},t.setOwnJid=function(e){this._ownJid=e}}(),function(){var e=function(){};e.prototype=Notification_model.prototype,NoteDeleteNotification.prototype=new e;var t=(e.prototype,NoteDeleteNotification.prototype);t.getNoteTitle=function(){return this._noteTitle},t.setNoteTitle=function(e){this._noteTitle=e},t.getNoteUrl=function(){return this._noteUrl},t.setNoteUrl=function(e){this._noteUrl=e},t.getThreadRootId=function(){return this._threadRootId},t.setThreadRootId=function(e){this._threadRootId=e},t.getRoomId=function(){return this._roomId},t.setRoomId=function(e){this._roomId=e},t.getOwnJid=function(){return this._ownJid},t.setOwnJid=function(e){this._ownJid=e}}(),function(){UserFollowNotification.ACTION_TYPE_NONE="",UserFollowNotification.ACTION_TYPE_ADD="addUserFollow",UserFollowNotification.ACTION_TYPE_DEL="delUserFollow";var e=function(){};e.prototype=Notification_model.prototype,UserFollowNotification.prototype=new e;var t=(e.prototype,UserFollowNotification.prototype);t.getActionType=function(){return this._actionType},t.setActionType=function(e){null==e||"string"!=typeof e||e!=UserFollowNotification.ACTION_TYPE_ADD&&e!=UserFollowNotification.ACTION_TYPE_DEL||(this._actionType=e)},t.getFolloweeJid=function(){return this._followeeJid},t.setFolloweeJid=function(e){null!=e&&"string"==typeof e&&(this._followeeJid=e)},t.getFollowerJid=function(){return this._followerJid},t.setFollowerJid=function(e){null!=e&&"string"==typeof e&&(this._followerJid=e)},t.getPersonInfo=function(){return this._personInfo},t.setPersonInfo=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._personInfo=e)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=function(){};e.prototype=ArrayList.prototype,GoodJobList.prototype=new e;var t=e.prototype,n=GoodJobList.prototype;n.add=function(e){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==e.getJid)return!1;var o=e.getJid();if(null==o||""==o)return!1;var i=n.getByJid(o);return null!=i?!1:t.add.call(this,e)},n.getByJid=function(e){var t=this;if(null==e||"string"!=typeof e)return null;for(var n=null,o=t._length,i=0;o>i;i++)if(t._array[i].getJid()==e){n=t._array[i];break}return n},n.removeByJid=function(e){var n=this;if(null==e||"string"!=typeof e)return null;for(var o=null,i=n._length,a=0;i>a;a++)if(n._array[a].getJid()==e){o=t.remove.call(this,a);break}return o},n.removeAll=function(){t.removeAll.call(this)}}(),function(){GoodJobData.prototype=$.extend({},Profile.prototype);var e=GoodJobData.prototype;e.getJid=function(){return this._jid},e.setJid=function(e){null!=e&&"string"==typeof e&&""!=e&&(this._jid=e)},e.getDate=function(){return this._date},e.setDate=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._date=e)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){Message.TYPE_UNKNOWN=0,Message.TYPE_PUBLIC=1,Message.TYPE_CHAT=2,Message.TYPE_GROUP_CHAT=3,Message.TYPE_TASK=4,Message.TYPE_COMMUNITY=5,Message.TYPE_SYSTEM=6,Message.TYPE_MAIL=9,Message.TYPE_QUESTIONNAIRE=10,Message.TYPE_MURMUR=11,Message.READ_STATUS_UNREAD=0,Message.READ_STATUS_READ=1,Message.BODYTYPE_MESSAGE=0,Message.BODYTYPE_STAMP=1;var e=Message.prototype;e.getType=function(){return this._type},e.getFrom=function(){return this._from},e.setFrom=function(e){null!=e&&"string"==typeof e&&(this._from=e)},e.getMessage=function(){return this._message},e.setMessage=function(e){null!=e&&"string"==typeof e&&(this._message=e)},e.getDate=function(){return this._date},e.setDate=function(e){null!=e&&"string"==typeof e&&(this._date=e)},e.getItemId=function(){return this._itemId},e.setItemId=function(e){null!=e&&"string"==typeof e&&(this._itemId=e)},e.getId=function(){return this._id},e.setId=function(e){null!=e&&"number"==typeof e&&(this._id=e)},e.isHistory=function(){return this._history},e.setHistory=function(e){null!=e&&"boolean"==typeof e&&(this._history=e)},e.getDeleteFlag=function(){return this._deleteFlag},e.setDeleteFlag=function(e){null!=e&&"number"==typeof e&&(this._deleteFlag=e)},e.getGoodJobList=function(){return this._goodJobList},e.getEmotionPointList=function(){return this._emotionPointList},e.getEmotionIconList=function(){return this._emotionIconList},e.setEmotionIconList=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._emotionIconList=e)},e.isReadMore=function(){return this._readMore},e.setReadMore=function(e){null!=e&&"boolean"==typeof e&&(this._readMore=e)},e.getAttachedFileUrlList=function(){return this._attachedFileUrlList},e.addAttachedFileUrl=function(e){null!=e&&"string"==typeof e&&this._attachedFileUrlList.add(e)},e.getReadFlag=function(){return this._readFlag},e.setReadFlag=function(e){null!=e&&"number"==typeof e&&(this._readFlag=e)},e.getExistingReaderInfo=function(){return this._existingReaderInfo},e.setExistingReaderInfo=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._existingReaderInfo=e)},e.getProfileMap=function(){return this._profileMap},e.setProfileMap=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._profileMap=e)},e.getProfileByJid=function(e){return null!=e&&"string"==typeof e?this._profileMap.getByKey(e):void 0},e.setThreadTitle=function(e){null!=e&&"string"==typeof e&&(this._threadTitle=e)},e.getThreadTitle=function(){return this._threadTitle},e.setThreadRootId=function(e){null!=e&&"string"==typeof e&&(this._threadRootId=e)},e.getThreadRootId=function(){return this._threadRootId},e.setUpdatedAt=function(e){null!=e&&"string"==typeof e&&(this._updatedAt=e)},e.getUpdatedAt=function(){return this._updatedAt},e.setQuotationItem=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._quotation=e)},e.getQuotationItem=function(){return this._quotation},e.setNoteTitle=function(e){null!=e&&"string"==typeof e&&(this._noteTitle=e)},e.getNoteTitle=function(){return this._noteTitle},e.setNoteUrl=function(e){null!=e&&"string"==typeof e&&(this._noteUrl=e)},e.getNoteUrl=function(){return this._noteUrl},e.setBodyType=function(e){null!=e&&"number"==typeof e&&(this._bodyType=e)},e.getBodyType=function(){return this._bodyType},e.addAttachedFileMessage=function(){var e=this,t=e.getAttachedFileUrlList(),n=this._message,o=t.getCount(),a="";for(i=0;i<o;i++)a+=t.get(i);this._message=n+a},e.isMatchFilterCondition=function(e,t){var n=this,o=!1;switch(e){case"id":o=n.getId()==t;break;case"item_id":o=n.getItemId()==t;break;case"msgtype":o=n.getType()==t;break;case"msgfrom":o=n.getFrom()==t;break;case"created_at":o=n.getDate()==t}return o},e.hasKeyword=function(e,t){var n=this,o=Utils.hasSubStringWithCaseIgnored(n.getMessage(),e);if(o)return o;if(null!=t&&null!=t[KeywordCondition.INCLUDE_TYPE_MSGFROM]){var i=n.getFrom(),a=n.getProfileByJid(i);if(null==a)return o;var r=a.getLoginAccount(),s=a.getNickName();o=Utils.hasSubStringWithCaseIgnored(r,e),o||(o=Utils.hasSubStringWithCaseIgnored(s,e)),o||"@"!=e.slice(0,1)||(o=Utils.hasSubStringWithCaseIgnored(r,e.slice(1)))}return o},e.isColmunChangeableFilterCondition=function(e,t){var n=this;return n.isMatchFilterCondition(e,t)},e.hasKeywordPreInfomation=function(e,t){var n=!1;return n},e.isMatchGraterThanCondition=function(e,t){var n=this,o=!1;switch(e){case"id":o=n.getId()>t;break;case"item_id":o=!1;break;case"msgtype":o=n.getType()>t;break;case"msgfrom":o=!1;break;case"created_at":o=new Date(n.getDate()).isAfter(t)}return o},e.isColmunChangeableGraterThanCondition=function(e,t){var n=this;return n.isMatchGraterThanCondition(e,t)},e.isMatchLessThanCondition=function(e,t){var n=this,o=!1;switch(e){case"id":o=n.getId()<t;break;case"item_id":o=!1;break;case"msgtype":o=n.getType()<t;break;case"msgfrom":o=!1;break;case"created_at":o=new Date(n.getDate()).isBefore(t)}return o},e.isColmunChangeableLessThanCondition=function(e,t){var n=this;return n.isMatchLessThanCondition(e,t)},e.setUIShortenUrls=function(e){var t=this;null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(t._uiShortenUrls=e)},e.getUIShortenUrls=function(){var e=this;return e._uiShortenUrls}}(),function(){var e=function(){};e.prototype=Message.prototype,PublicMessage.prototype=new e;var t=e.prototype,n=PublicMessage.prototype;n.getReplyItemId=function(){return this._replyItemId},n.setReplyItemId=function(e){null!=e&&"string"==typeof e&&(this._replyItemId=e)},n.getPublishNode=function(){return this._publishNode},n.setPublishNode=function(e){null!=e&&"string"==typeof e&&(this._publishNode=e)},n.getReplyTo=function(){return this._replyTo},n.setReplyTo=function(e){null!=e&&"string"==typeof e&&(this._replyTo=e)},n.isMatchFilterCondition=function(e,n){var o=this,i=t.isMatchFilterCondition.call(o,e,n);if(i)return i;switch(e){case"msgto":i=!0;break;case"publish_nodename":i=o.getPublishNode()==n;break;case"reply_id":i=o.getReplyItemId()==n;break;case"reply_to":i=o.getReplyTo()==n}return i},n.hasKeyword=function(e,n){var o=this,i=t.hasKeyword.call(o,e,n);return i?i:i},n.hasKeywordPreInfomation=function(e,n){var o=this,i=t.hasKeywordPreInfomation.call(o,e,n);return i?i:i},n.isMatchGraterThanCondition=function(e,n){var o=this,i=t.isMatchGraterThanCondition.call(o,e,n);if(i)return i;switch(e){case"msgto":i=!1;break;case"publish_nodename":i=!1;break;case"reply_id":i=!1;break;case"reply_to":i=!1}return i},n.isMatchLessThanCondition=function(e,n){var o=this,i=t.isMatchLessThanCondition.call(o,e,n);if(i)return i;switch(e){case"msgto":i=!1;break;case"publish_nodename":i=!1;break;case"reply_id":i=!1;break;case"reply_to":i=!1}return i}}(),function(){ChatMessage.DIRECTION_SEND=0,ChatMessage.DIRECTION_RECEIVE=1;var e=function(){};e.prototype=Message.prototype,ChatMessage.prototype=new e;var t=e.prototype,n=ChatMessage.prototype;n.getTo=function(){return this._to},n.setTo=function(e){null!=e&&"string"==typeof e&&(this._to=e)},n.getDirection=function(){return this._direction},n.setDirection=function(e){null!=e&&"number"==typeof e&&(e<ChatMessage.DIRECTION_SEND||e>ChatMessage.DIRECTION_RECEIVE||(this._direction=e))},n.getReplyItemId=function(){return this._replyItemId},n.setReplyItemId=function(e){null!=e&&"string"==typeof e&&(this._replyItemId=e)},n.getReplyTo=function(){return this._replyTo},n.setReplyTo=function(e){null!=e&&"string"==typeof e&&(this._replyTo=e)},n.isMatchFilterCondition=function(e,n){var o=this,i=t.isMatchFilterCondition.call(o,e,n);if(i)return i;switch(e){case"msgto":i=o.getTo()==n;break;case"reply_id":i=o.getReplyItemId()==n;break;case"reply_to":i=o.getReplyTo()==n}return i},n.hasKeyword=function(e,n){var o=this,i=t.hasKeyword.call(o,e,n);return i?i:i},n.hasKeywordPreInfomation=function(e,n){var o=this,i=t.hasKeywordPreInfomation.call(o,e,n);return i?i:i},n.isMatchGraterThanCondition=function(e,n){var o=this,i=t.isMatchGraterThanCondition.call(o,e,n);if(i)return i;switch(e){case"msgto":i=!1;break;case"reply_id":i=!1;break;case"reply_to":i=!1}return i},n.isMatchLessThanCondition=function(e,n){var o=this,i=t.isMatchLessThanCondition.call(o,e,n);if(i)return i;switch(e){case"msgto":i=!1;break;case"reply_id":i=!1;break;case"reply_to":i=!1}return i}}(),function(){var e=function(){};e.prototype=ChatMessage.prototype,GroupChatMessage.prototype=new e;var t=e.prototype,n=GroupChatMessage.prototype;n.getRoomName=function(){return this._roomName},n.setRoomName=function(e){null!=e&&"string"==typeof e&&(this._roomName=e);
},n.getParentRoomId=function(){return this._parentRoomId},n.setParentRoomId=function(e){null!=e&&"string"==typeof e&&(this._parentRoomId=e)},n.isMatchFilterCondition=function(e,n){var o=this,i=t.isMatchFilterCondition.call(o,e,n);return i?i:i},n.hasKeyword=function(e,n){var o=this,i=t.hasKeyword.call(o,e,n);return i?i:i},n.hasKeywordPreInfomation=function(e,n){var o=this,i=t.hasKeywordPreInfomation.call(o,e,n);return i?i:i},n.isMatchGraterThanCondition=function(e,n){var o=this,i=t.isMatchGraterThanCondition.call(o,e,n);return i?i:i},n.isMatchLessThanCondition=function(e,n){var o=this,i=t.isMatchLessThanCondition.call(o,e,n);return i?i:i}}(),function(){var e=function(){};e.prototype=Message.prototype,MailMessage.prototype=new e;var t=e.prototype,n=MailMessage.prototype;n.getTo=function(){return this._to},n.setTo=function(e){null!=e&&"string"==typeof e&&(this._to=e)},n.getPriority=function(){return this._priority},n.setPriority=function(e){null!=e&&"number"==typeof e&&(this._priority=e)},n.getMailMessageId=function(){return this._mailMessageId},n.setMailMessageId=function(e){null!=e&&"string"==typeof e&&(this._mailMessageId=e)},n.getMailInReplyTo=function(){return this._mailInReplyTo},n.setMailInReplyTo=function(e){null!=e&&"string"==typeof e&&(this._mailInReplyTo=e)},n.getReplyItemId=function(){return this._replyItemId},n.setReplyItemId=function(e){null!=e&&"string"==typeof e&&(this._replyItemId=e)},n.getBodyInfo=function(){return this._mailBodyInfo},n.setBodyInfo=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._mailBodyInfo=e)},n.isMatchFilterCondition=function(e,n){var o=this,i=t.isMatchFilterCondition.call(o,e,n);return i?i:i},n.hasKeyword=function(e,n){var o=this,i=t.hasKeyword.call(o,e,n);return i?i:i},n.hasKeywordPreInfomation=function(e,n){var o=this,i=t.hasKeywordPreInfomation.call(o,e,n);return i?i:i},n.isMatchGraterThanCondition=function(e,n){var o=this,i=t.isMatchGraterThanCondition.call(o,e,n);return i?i:i},n.isMatchLessThanCondition=function(e,n){var o=this,i=t.isMatchLessThanCondition.call(o,e,n);return i?i:i}}(),function(){var e=MailBody.prototype;e.getItemId=function(){return this._itemId},e.setItemId=function(e){null!=e&&"string"==typeof e&&(this._itemId=e)},e.getId=function(){return this._id},e.setId=function(e){null!=e&&"number"==typeof e&&(this._id=e)},e.getJid=function(){return this._jid},e.setJid=function(e){null!=e&&"string"==typeof e&&""!=e&&(this._jid=e)},e.getBody=function(){return this._mailBody},e.setBody=function(e){null!=e&&"string"==typeof e&&(this._mailBody=e)}}(),function(){TaskMessage.PRIORITY_LOW=1,TaskMessage.PRIORITY_MEDIUM=2,TaskMessage.PRIORITY_HIGH=3,TaskMessage.PRIORITY_TOP=4,TaskMessage.STATUS_UNKNOWN=0,TaskMessage.STATUS_INBOX=1,TaskMessage.STATUS_ASSIGNING=2,TaskMessage.STATUS_NEW=3,TaskMessage.STATUS_DOING=4,TaskMessage.STATUS_SOLVED=5,TaskMessage.STATUS_FEEDBACK=6,TaskMessage.STATUS_FINISHED=7,TaskMessage.STATUS_REJECTED=8,TaskMessage.ALERT_NORMAL=0,TaskMessage.ALERT_INFO=1,TaskMessage.ALERT_WARNING=2,TaskMessage.ALERT_COUTION=3,TaskMessage.DEMAND_OFF=0,TaskMessage.DEMAND_ON=1;var e=function(){};e.prototype=Message.prototype,TaskMessage.prototype=new e;var t=e.prototype,n=TaskMessage.prototype;n.getTitle=function(){return this._title},n.setTitle=function(e){null!=e&&"string"==typeof e&&(this._title=e)},n.getStartDate=function(){return this._startDate},n.setStartDate=function(e){"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._startDate=e)},n.getDueDate=function(){return this._dueDate},n.setDueDate=function(e){"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._dueDate=e)},n.getCommunityId=function(){return this._communityId},n.setCommunityId=function(e){null!=e&&"string"==typeof e&&(this._communityId=e)},n.getCommunityName=function(){return this._communityName},n.setCommunityName=function(e){null!=e&&"string"==typeof e&&(this._communityName=e)},n.getOwnerJid=function(){return this._ownerJid},n.setOwnerJid=function(e){null!=e&&"string"==typeof e&&(this._ownerJid=e)},n.getPriority=function(){return this._priority},n.setPriority=function(e){null!=e&&"number"==typeof e&&(this._priority=e)},n.getProgress=function(){return this._progress},n.setProgress=function(e){null!=e&&"number"==typeof e&&(this._progress=e)},n.getNoteArray=function(){return this._noteArray},n.getStatus=function(){return this._status},n.setStatus=function(e){null!=e&&"number"==typeof e&&(this._status=e)},n.getReminderList=function(){return this._reminderList},n.getSpentTime=function(){return this._spentTime},n.setSpentTime=function(e){null!=e&&"number"==typeof e&&(this._spentTime=e)},n.getEstimatedTime=function(){return this._estimatedTime},n.setEstimatedTime=function(e){null!=e&&"number"==typeof e&&(this._estimatedTime=e)},n.getRemainingTime=function(){return this._remainingTime},n.setRemainingTime=function(e){null!=e&&"number"==typeof e&&(this._remainingTime=e)},n.getParentItemId=function(){return this._parentItemId},n.setParentItemId=function(e){null!=e&&"string"==typeof e&&(this._parentItemId=e)},n.getChildItemIdList=function(){return this._childrenItemIdList},n.getGoal=function(){return this._goal},n.setGoal=function(e){null!=e&&"string"==typeof e&&(this._goal=e)},n.getAlert=function(){return this._alert},n.setAlert=function(e){null!=e&&"number"==typeof e&&(this._alert=e)},n.getReferenceMessageItemId=function(){return this._referenceMessageItemId},n.setReferenceMessageItemId=function(e){null!=e&&"string"==typeof e&&(this._referenceMessageItemId=e)},n.getCompleteDate=function(){return this._completeDate},n.setCompleteDate=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._completeDate=e)},n.getReplyTo=function(){return this._replyTo},n.setReplyTo=function(e){null!=e&&"string"==typeof e&&(this._replyTo=e)},n.getUpdatedAt=function(){return this._updatedAt},n.setUpdatedAt=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._updatedAt=e)},n.getUpdatedBy=function(){return this._updatedBy},n.setUpdatedBy=function(e){null!=e&&"string"==typeof e&&(this._updatedBy=e)},n.getClient=function(){return this._client},n.setClient=function(e){null!=e&&"string"==typeof e&&(this._client=e)},n.getSiblingTaskDataList=function(){return this._siblingTaskDataList},n.getPreStatus=function(){return this._preStatus},n.setPreStatus=function(e){null!=e&&"number"==typeof e&&(this._preStatus=e)},n.getPreOwnerJid=function(){return this._preOwnerJid},n.setPreOwnerJid=function(e){null!=e&&"string"==typeof e&&(this._preOwnerJid=e)},n.getPreTitle=function(){return this._preTitle},n.setPreTitle=function(e){null!=e&&"string"==typeof e&&(this._preTitle=e)},n.getPreMessage=function(){return this._preMessage},n.setPreMessage=function(e){null!=e&&"string"==typeof e&&(this._preMessage=e)},n.getPreProgress=function(){return this._PreProgress},n.setPreProgress=function(e){null!=e&&"number"==typeof e&&(this._preProgress=e)},n.getPreSpentTime=function(){return this._preSpentTime},n.setPreSpentTime=function(e){null!=e&&"number"==typeof e&&(this._preSpentTime=e)},n.getPreEstimatedTime=function(){return this._preEstimatedTime},n.setPreEstimatedTime=function(e){null!=e&&"number"==typeof e&&(this._preEstimatedTime=e)},n.getPreRemainingTime=function(){return this._preRemainingTime},n.setPreRemainingTime=function(e){null!=e&&"number"==typeof e&&(this._preRemainingTime=e)},n.getPreGoal=function(){return this._preGoal},n.setPreGoal=function(e){null!=e&&"string"==typeof e&&(this._preGoal=e)},n.getPreAlert=function(){return this._preAlert},n.setPreAlert=function(e){null!=e&&"number"==typeof e&&(this._preAlert=e)},n.getSiblingTaskDataList=function(){return this._siblingTaskDataList},n.getDemandStatus=function(){return this._demandStatus},n.setDemandStatus=function(e){null!=e&&"number"==typeof e&&(this._demandStatus=e)},n.getDemandDate=function(){return this._demandDate},n.setDemandDate=function(e){"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._demandDate=e)},n.getPropertyByFilterKey=function(e){var t="",n=this;if(null==e||"string"!=typeof e)return t;switch(e){case TaskFilterAndSortCondition.FILTER_KEY_OWNER:t=n.getOwnerJid();break;case TaskFilterAndSortCondition.FILTER_KEY_STATUS:t=n.getStatus();break;case TaskFilterAndSortCondition.FILTER_KEY_GROUP:t=n.getCommunityName();break;case TaskFilterAndSortCondition.FILTER_KEY_START_DATE:t=n.getStartDate();break;case TaskFilterAndSortCondition.FILTER_KEY_END_DATE:t=n.getDueDate();break;case TaskFilterAndSortCondition.FILTER_KEY_CLIENT:t=n.getClient()}return t},n.copy=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this;t.setFrom(e.getFrom()),t.setMessage(e.getMessage()),t.setDate(e.getDate()),t.setItemId(e.getItemId()),t.setId(e.getId()),t.setHistory(e.isHistory()),t._goodJobList.copy(e.getGoodJobList()),t.setReadMore(e.isReadMore()),t._attachedFileUrlList.copy(e.getAttachedFileUrlList()),e.getType()==Message.TYPE_TASK&&(t.setTitle(e.getTitle()),t.setStartDate(e.getStartDate()),t.setDueDate(e.getDueDate()),t.setCommunityId(e.getCommunityId()),t.setCommunityName(e.getCommunityName()),t.setOwnerJid(e.getOwnerJid()),t.setPriority(e.getPriority()),t.setProgress(e.getProgress()),t.getNoteArray().copy(e.getNoteArray),t.setStatus(e.getStatus()),t.getReminderList().copy(e.getReminderList()),t.setSpentTime(e.getSpentTime()),t.setEstimatedTime(e.getEstimatedTime()),t.setRemainingTime(e.getRemainingTime()),t.setParentItemId(e.getParentItemId()),t.getChildItemIdList().copy(e.getChildItemIdList()),t.setGoal(e.getGoal()),t.setAlert(e.getAlert()),t.setReferenceMessageItemId(e.getReferenceMessageItemId()),t.setCompleteDate(e.getCompleteDate()),t.setReplyTo(e.getReplyTo()),t.setUpdatedAt(e.getUpdatedAt()),t.setUpdatedBy(e.getUpdatedBy()),t.setClient(e.getClient()),t.getSiblingTaskDataList().copy(e.getSiblingTaskDataList()),t.setDemandStatus(e.getDemandStatus()),t.setDemandDate(e.getDemandDate()),t.setDeleteFlag(e.getDeleteFlag()))}},n.isMatchFilterCondition=function(e,n){var o=this,i=t.isMatchFilterCondition.call(o,e,n);if(i)return i;switch(e){case"msgto":i=!0;break;case"reply_id":i=o.getReferenceMessageItemId()==n;break;case"reply_to":i=o.getReplyTo()==n;break;case"start_date":i=Utils.getDate(o.getStartDate(),Utils.DISPLAY_STANDARD_DATE_FORMAT)==n;break;case"due_date":i=Utils.getDate(o.getDueDate(),Utils.DISPLAY_STANDARD_DATE_FORMAT)==n;break;case"owner":i=o.getOwnerJid()==n;break;case"group_name":i=o.getCommunityId()==n;break;case"status":i=o.getStatus()==n;break;case"complete_date":i=Utils.getDate(o.getCompleteDate(),Utils.DISPLAY_STANDARD_DATE_FORMAT)==n;break;case"priority":i=o.getPriority()==n;break;case"updated_at":i=Utils.getDate(o.getUpdatedAt(),Utils.DISPLAY_STANDARD_DATE_FORMAT)==n;break;case"updated_by":i=o.getUpdatedBy()==n;break;case"client":i=o.getClient()==n;break;case"parent_item_id":i=o.getParentItemId()==n}return i},n.hasKeyword=function(e,n){var o=this,i=t.hasKeyword.call(o,e,n);return i?i:i=Utils.hasSubStringWithCaseIgnored(o.getTitle(),e)?!0:Utils.hasSubStringWithCaseIgnored(""+o.getProgress(),e)?!0:Utils.hasSubStringWithCaseIgnored(""+o.getSpentTime(),e)?!0:Utils.hasSubStringWithCaseIgnored(""+o.getEstimatedTime(),e)?!0:Utils.hasSubStringWithCaseIgnored(""+o.getRemainingTime(),e)?!0:Utils.hasSubStringWithCaseIgnored(o.getGoal(),e)?!0:Utils.hasSubStringWithCaseIgnored(""+o.getAlert(),e)?!0:!1},n.isColmunChangeableFilterCondition=function(e,t){var n=this,o=n.isMatchFilterCondition(e,t);if(o)return o;switch(e){case"owner":o=n.getPreOwnerJid()==t;break;case"status":o=n.getPreStatus()==t}return o},n.hasKeywordPreInfomation=function(e,n){var o=this,i=t.hasKeywordPreInfomation.call(o,e,n);return i?i:i=Utils.hasSubStringWithCaseIgnored(o.getPreTitle(),e)?!0:Utils.hasSubStringWithCaseIgnored(o.getPreMessage(),e)?!0:Utils.hasSubStringWithCaseIgnored(""+o.getPreProgress(),e)?!0:Utils.hasSubStringWithCaseIgnored(""+o.getPreSpentTime(),e)?!0:Utils.hasSubStringWithCaseIgnored(""+o.getPreEstimatedTime(),e)?!0:Utils.hasSubStringWithCaseIgnored(""+o.getPreRemainingTime(),e)?!0:Utils.hasSubStringWithCaseIgnored(o.getPreGoal(),e)?!0:Utils.hasSubStringWithCaseIgnored(""+o.getPreAlert(),e)?!0:!1},n.isMatchGraterThanCondition=function(e,n){var o=this,i=t.isMatchGraterThanCondition.call(o,e,n);if(i)return i;switch(e){case"msgto":i=!1;break;case"reply_id":i=!1;break;case"reply_to":i=!1;break;case"start_date":i=new Date(o.getStartDate()).isAfter(n);break;case"due_date":i=new Date(o.getDueDate()).isAfter(n);break;case"owner":i=!1;break;case"group_name":i=!1;break;case"status":i=o.getStatus()>n;break;case"complete_date":i=new Date(o.getCompleteDate()).isAfter(n);break;case"priority":i=o.getPriority()>n;break;case"updated_at":i=new Date(o.getUpdatedAt()).isAfter(n);break;case"updated_by":i=!1;break;case"client":i=!1;break;case"parent_item_id":i=!1}return i},n.isColmunChangeableGraterThanCondition=function(e,t){var n=this,o=n.isMatchGraterThanCondition(e,t);if(o)return o;switch(e){case"owner":o=!1;break;case"status":o=!1}return o},n.isMatchLessThanCondition=function(e,n){var o=this,i=t.isMatchLessThanCondition.call(o,e,n);if(i)return i;switch(e){case"msgto":i=!1;break;case"reply_id":i=!1;break;case"reply_to":i=!1;break;case"start_date":i=new Date(o.getStartDate()).isBefore(n);break;case"due_date":i=new Date(o.getDueDate()).isBefore(n);break;case"owner":i=!1;break;case"group_name":i=!1;break;case"status":i=o.getStatus()<n;break;case"complete_date":i=new Date(o.getCompleteDate()).isBefore(n);break;case"priority":i=o.getPriority()<n;break;case"updated_at":i=new Date(o.getUpdatedAt()).isBefore(n);break;case"updated_by":i=!1;break;case"client":i=!1;break;case"parent_item_id":i=!1}return i},n.isColmunChangeableLessThanCondition=function(e,t){var n=this,o=n.isMatchLessThanCondition(e,t);if(o)return o;switch(e){case"owner":o=!1;break;case"status":o=!1}return o}}(),function(){CommunityMessage.DIRECTION_SEND=0,CommunityMessage.DIRECTION_RECEIVE=1;var e=function(){};e.prototype=GroupChatMessage.prototype,CommunityMessage.prototype=new e;var t=e.prototype,n=CommunityMessage.prototype;n.isMatchFilterCondition=function(e,n){var o=this,i=t.isMatchFilterCondition.call(o,e,n);return i?i:i},n.hasKeyword=function(e,n){var o=this,i=t.hasKeyword.call(o,e,n);return i?i:i},n.hasKeywordPreInfomation=function(e,n){var o=this,i=t.hasKeywordPreInfomation.call(o,e,n);return i?i:i},n.isMatchGraterThanCondition=function(e,n){var o=this,i=t.isMatchGraterThanCondition.call(o,e,n);return i?i:i},n.isMatchLessThanCondition=function(e,n){var o=this,i=t.isMatchLessThanCondition.call(o,e,n);return i?i:i}}(),function(){SystemMessage.TRIGGER_ACTION_NONE=0,SystemMessage.TRIGGER_ACTION_ADD_TASK=1,SystemMessage.TRIGGER_ACTION_FINISH_TASK=2,SystemMessage.TRIGGER_ACTION_REQUEST_TASK=3;var e=function(){};e.prototype=Message.prototype,SystemMessage.prototype=new e;var t=(e.prototype,SystemMessage.prototype);t.getTriggerAction=function(){return this._triggerAction},t.setTriggerAction=function(e){null!=e&&"number"==typeof e&&(this._triggerAction=e)},t.getReplyItemId=function(){return this._replyItemId},t.setReplyItemId=function(e){null!=e&&"string"==typeof e&&(this._replyItemId=e)},t.getReplyTo=function(){return this._replyTo},t.setReplyTo=function(e){null!=e&&"string"==typeof e&&(this._replyTo=e)},t.isMatchFilterCondition=function(e,t){return!1},t.hasKeyword=function(e,t){return!1},t.hasKeywordPreInfomation=function(e,t){return!1},t.isMatchGraterThanCondition=function(e,t){return!1},t.isMatchLessThanCondition=function(e,t){return!1}}(),function(){var e=function(){};e.prototype=StringMapedArrayList.prototype,MessageDataList.prototype=new e;var t=e.prototype,n=MessageDataList.prototype;n.add=function(e){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==e.getItemId)return!1;var o=e.getItemId(),i=t.add.call(n,o,e);return 0==i&&(i=t.setByKey.call(n,o,e)),i},n.getByItemId=function(e){var n=this;return null==e||"string"!=typeof e?null:""==e?null:t.getByKey.call(n,e)}}(),function(){var e=TaskNoteData.prototype;e.getJid=function(){return this._jid},e.setJid=function(e){null!=e&&"string"==typeof e&&""!=e&&(this._jid=e)},e.getDate=function(){return this._date},e.setDate=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._date=e)},e.getMessage=function(){return this._message},e.setMessage=function(e){null!=e&&"string"==typeof e&&(this._message=e)}}(),function(){var e=function(){};e.prototype=ArrayList.prototype,TaskNoteList.prototype=new e;var t=e.prototype,n=TaskNoteList.prototype;n.add=function(e){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==e.getJid)return!1;var o=e.getJid();if(null==o||""==o)return!1;var i=n.getByJid(o);return null!=i?!1:t.add.call(this,e)},n.getByJid=function(e){var t=this;if(null==e||"string"!=typeof e)return null;for(var n=null,o=t._length,i=0;o>i;i++)if(t._array[i].getJid()==e){n=t._array[i];break}return n},n.removeByJid=function(e){var n=this;if(null==e||"string"!=typeof e)return null;for(var o=null,i=n._length,a=0;i>a;a++)if(n._array[a].getJid()==e){o=t.remove.call(this,a);break}return o},n.removeAll=function(){t.removeAll.call(this)}}(),function(){SiblingTaskData.prototype=$.extend({},Profile.prototype);var e=SiblingTaskData.prototype;e.getItemId=function(){return this._itemId},e.setItemId=function(e){null!=e&&"string"==typeof e&&""!=e&&(this._itemId=e)},e.getSiblingItemId=function(){return this._siblingItemId},e.setSiblingItemId=function(e){null!=e&&"string"==typeof e&&""!=e&&(this._siblingItemId=e)},e.getSiblingOwnerJid=function(){return this._siblingOwnerJid},e.setSiblingOwnerJid=function(e){null!=e&&"string"==typeof e&&""!=e&&(this._siblingOwnerJid=e)},e.getSiblingTaskStatus=function(){return this._siblingTaskStatus},e.setSiblingTaskStatus=function(e){null!=e&&"number"==typeof e&&(this._siblingTaskStatus=e)}}(),function(){var e=function(){};e.prototype=ArrayList.prototype,SiblingTaskDataList.prototype=new e;var t=e.prototype,n=SiblingTaskDataList.prototype;n.add=function(e){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==e.getSiblingItemId)return!1;var o=e.getSiblingItemId();if(null==o||""==o)return!1;var i=n.getBySiblingItemId(o);return null!=i?!1:t.add.call(this,e)},n.getBySiblingItemId=function(e){var t=this;if(null==e||"string"!=typeof e)return null;for(var n=null,o=t._length,i=0;o>i;i++)if(t._array[i].getSiblingItemId()==e){n=t._array[i];break}return n},n.getBySiblingOwnerJid=function(e){var t=this;if(null==e||"string"!=typeof e)return null;for(var n=null,o=t._length,i=0;o>i;i++)if(t._array[i].getSiblingOwnerJid()==e){n=t._array[i];break}return n},n.removeBySiblingItemId=function(e){var n=this;if(null==e||"string"!=typeof e)return null;for(var o=null,i=n._length,a=0;i>a;a++)if(n._array[a].getSiblingItemId()==e){o=t.remove.call(this,a);break}return o},n.removeBySiblingOwnerJid=function(e){var n=this;if(null==e||"string"!=typeof e)return null;for(var o=null,i=n._length,a=0;i>a;a++)if(n._array[a].getSiblingOwnerJid()==e){o=t.remove.call(this,a);break}return o},n.removeAll=function(){t.removeAll.call(this)}}(),function(){QuestionnaireMessage.INPUTTYPE_RADIO=1,QuestionnaireMessage.INPUTTYPE_CHECKBOX=2,QuestionnaireMessage.INFORMATION_PUBLIC=1,QuestionnaireMessage.INFORMATION_PRIVATE=2,QuestionnaireMessage.GRAPHTYPE_BAR=1,QuestionnaireMessage.GRAPHTYPE_PIE=2;var e=function(){};e.prototype=Message.prototype,QuestionnaireMessage.prototype=new e;var t=(e.prototype,QuestionnaireMessage.prototype);t.getReplyItemId=function(){return this._replyItemId},t.setReplyItemId=function(e){null!=e&&"string"==typeof e&&(this._replyItemId=e)},t.getStartDate=function(){return this._startDate},t.setStartDate=function(e){"string"==typeof e&&(this._startDate=e)},t.getDueDate=function(){return this._dueDate},t.setDueDate=function(e){"string"==typeof e&&(this._dueDate=e)},t.getInputType=function(){return this._inputType},t.setInputType=function(e){null!=e&&"number"==typeof e&&(this._inputType=e)},t.getResultVisible=function(){return this._resultVisible},t.setResultVisible=function(e){null!=e&&"number"==typeof e&&(this._resultVisible=e)},t.getGraphType=function(){return this._graphType},t.setGraphType=function(e){null!=e&&"number"==typeof e&&(this._graphType=e)},t.getOptionCount=function(){return this._optionCount},t.setOptionCount=function(e){null!=e&&"number"==typeof e&&(this._optionCount=e)},t.getOptionItems=function(){return this._optionItems},t.setOptionItems=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._optionItems=e)},t.getRoomType=function(){return this._roomType},t.setRoomType=function(e){null!=e&&"string"==typeof e&&(this._roomType=e)},t.getRoomId=function(){return this._roomId},t.setRoomId=function(e){null!=e&&"string"==typeof e&&(this._roomId=e)},t.getRoomName=function(){return this._roomName},t.setRoomName=function(e){null!=e&&"string"==typeof e&&(this._roomName=e)},t.getParentRoomId=function(){return this._parentRoomId},t.setParentRoomId=function(e){null!=e&&"string"==typeof e&&(this._parentRoomId=e)},t.getVoteFlag=function(){return this._voteFlag},t.setVoteFlag=function(e){this._voteFlag=e},t.copy=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this;t.setFrom(e.getFrom()),t.setMessage(e.getMessage()),t.setDate(e.getDate()),t.setItemId(e.getItemId()),t.setId(e.getId()),t.setHistory(e.isHistory()),t._goodJobList.copy(e.getGoodJobList()),t.setReadMore(e.isReadMore()),t._attachedFileUrlList.copy(e.getAttachedFileUrlList()),e.getType()==Message.TYPE_QUESTIONNAIRE&&(t.setInputType(e.getInputType()),t.setResultVisible(e.getResultVisible()),t.setGraphType(e.getGraphType()),t.setOptionCount(e.getOptionCount()),t.setOptionItems(e.getOptionItems()),t.setRoomType(e.getRoomType()),t.setRoomId(e.getRoomId()),t.setStartDate(e.getStartDate()),t.setDueDate(e.getDueDate()))}},t.isMatchFilterCondition=function(e,t){var n=this,o=!1;switch(e){case"id":o=n.getId()==t;break;case"item_id":o=n.getItemId()==t;break;case"msgtype":o=n.getType()==t;break;case"msgfrom":o=n.getFrom()==t;break;case"created_at":o=n.getDate()==t;break;case"msgto":n.getRoomType()==Message.TYPE_PUBLIC+""?o=""==n.getRoomId():(n.getRoomType()==Message.TYPE_GROUP_CHAT+""||n.getRoomType()==Message.TYPE_COMMUNITY)&&(o=n.getRoomId()==t)}return o}}(),function(){MurmurMessage.DIRECTION_SEND=0,MurmurMessage.DIRECTION_RECEIVE=1;var e=function(){};e.prototype=ChatMessage.prototype,MurmurMessage.prototype=new e;var t=e.prototype,n=MurmurMessage.prototype;n.isMatchFilterCondition=function(e,n){var o=this,i=t.isMatchFilterCondition.call(o,e,n);return i?i:i},n.hasKeyword=function(e,n){var o=this,i=t.hasKeyword.call(o,e,n);return i?i:i},n.hasKeywordPreInfomation=function(e,n){var o=this,i=t.hasKeywordPreInfomation.call(o,e,n);return i?i:i},n.isMatchGraterThanCondition=function(e,n){var o=this,i=t.isMatchGraterThanCondition.call(o,e,n);return i?i:i},n.isMatchLessThanCondition=function(e,n){var o=this,i=t.isMatchLessThanCondition.call(o,e,n);return i?i:i},n.setColumnName=function(e){var t=this;return"string"!=typeof e?!1:(t._columnName=e,!0)},n.getColumnName=function(){return this._columnName}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t){if(!t||"string"!=typeof t)return null;for(var n=e.getCount(),o=0;n>o;o++){var i=e.get(o);if(i&&i.getJid()==t)return i}return null}CommunityInfo.PRIVACY_TYPE_ITEM_OPEN=0,CommunityInfo.PRIVACY_TYPE_ITEM_CLOSED=1,CommunityInfo.PRIVACY_TYPE_ITEM_SECRET=2,CommunityInfo.MEMBER_ENTRY_TYPE_ITEM_ADD=0,CommunityInfo.MEMBER_ENTRY_TYPE_ITEM_INVITE=1,CommunityInfo.MEMBER_ENTRY_TYPE_ITEM_INVITE_OR_ACCEPT=2,CommunityInfo.MEMBER_ENTRY_TYPE_ITEM_INVITE_OR_FREE=3;var t=CommunityInfo.prototype;t.getId=function(){return this._id},t.setId=function(e){null!=e&&"number"==typeof e&&(this._id=e)},t.getRoomId=function(){return this._roomId},t.setRoomId=function(e){null!=e&&"string"==typeof e&&(this._roomId=e)},t.getRoomName=function(){return this._roomName},t.setRoomName=function(e){null!=e&&"string"==typeof e&&(this._roomName=e)},t.getDescription=function(){return this._description},t.setDescription=function(e){null!=e&&"string"==typeof e&&(this._description=e)},t.getPrivacyType=function(){return this._privacyType},t.setPrivacyType=function(e){null!=e&&"number"==typeof e&&(this._privacyType=e)},t.getMemberEntryType=function(){return this._memberEntryType},t.setMemberEntryType=function(e){null!=e&&"string"==typeof e&&(this._memberEntryType=e)},t.getLogoUrl=function(){return this._logoUrl},t.setLogoUrl=function(e){null!=e&&"string"==typeof e&&(this._logoUrl=e)},t.getCreatedAt=function(){return this._createdAt},t.setCreatedAt=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._createdAt=e)},t.getCreatedBy=function(){return this._createdBy},t.setCreatedBy=function(e){null!=e&&"string"==typeof e&&(this._createdBy=e)},t.getUpdatedAt=function(){return this._updatedAt},t.setUpdatedAt=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._updatedAt=e)},t.getUpdatedBy=function(){return this._updatedBy},t.setUpdatedBy=function(e){null!=e&&"string"==typeof e&&(this._updatedBy=e)},t.getOwnerList=function(){return this._ownerList},t.hasOwner=function(t){return null!=e(this._ownerList,t)},t.getGeneralMemberList=function(){return this._generalMemberList},t.hasGeneralMember=function(t){return null!=e(this._generalMemberList,t)},t.getMemberCount=function(){return this._memberCount},t.setMemberCount=function(e){null!=e&&"number"==typeof e&&(this._memberCount=e)}}(),function(){var e=function(){};e.prototype=StringMapedArrayList.prototype,CommunityList.prototype=new e;var t=e.prototype,n=CommunityList.prototype;n.removeAll=function(){t.removeAll.call(this)}}(),function(){var e=function(){};e.prototype=PersonList.prototype,CommunityMemberList.prototype=new e;e.prototype,CommunityMemberList.prototype}(),function(){CommunityMember.ROLE_TYPE_NOT_JOIN=0,CommunityMember.ROLE_TYPE_GENERAL=1,CommunityMember.ROLE_TYPE_OWNER=2;var e=function(){};e.prototype=Person.prototype,CommunityMember.prototype=new e;var t=(e.prototype,CommunityMember.prototype);t.getRole=function(){return this._role},t.setRole=function(e){null!=e&&"number"==typeof e&&(e<CommunityMember.ROLE_TYPE_NOT_JOIN||e>CommunityMember.ROLE_TYPE_OWNER||(this._role=e))}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=ColumnSearchCondition.prototype;e.getFilterCondition=function(){return this._filterCondition},e.getSortCondition=function(){return this._sortCondition},e.isMatch=function(e){return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?this.getFilterCondition().isMatch(e):!1},e.isColmunChangeable=function(e){return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?this.getFilterCondition().isColmunChangeable(e):!1}}(),function(){var e=ColumnFilterCondition.prototype;ColumnFilterCondition.CONDITION_TYPE_AND="and",ColumnFilterCondition.CONDITION_TYPE_OR="or",ColumnFilterCondition.CONDITION_TYPE_NOT="not",ColumnFilterCondition.CONDITION_TYPE_ITEM="item",ColumnFilterCondition.CONDITION_TYPE_GREATER_THAN="greaterthan",ColumnFilterCondition.CONDITION_TYPE_LESS_THAN="lessthan",ColumnFilterCondition.CONDITION_TYPE_KEYWORD="keyword",ColumnFilterCondition.CONDITION_TYPE_PARTICULAR="particular",e.getJSONObject=function(){return null},e.getConditionObject=function(e){return null},e._createCondition=function(e){var t;switch(e.type){case ColumnFilterCondition.CONDITION_TYPE_AND:t=new AndCondition;break;case ColumnFilterCondition.CONDITION_TYPE_OR:t=new OrCondition;break;case ColumnFilterCondition.CONDITION_TYPE_NOT:t=new NotCondition;break;case ColumnFilterCondition.CONDITION_TYPE_ITEM:t=new ItemCondition;break;case ColumnFilterCondition.CONDITION_TYPE_GREATER_THAN:t=new GreaterThanCondition;break;case ColumnFilterCondition.CONDITION_TYPE_LESS_THAN:t=new LessThanCondition;break;case ColumnFilterCondition.CONDITION_TYPE_KEYWORD:t=new KeywordCondition;break;case ColumnFilterCondition.CONDITION_TYPE_PARTICULAR:t=new ParticularCondition;break;default:return null}return t.getConditionObject(e),t},e.isMatch=function(e){return!1},e.isColmunChangeable=function(e){return!1}}(),function(){var e=ColumnSortCondition.prototype;ColumnSortCondition.SORT_ORDER_ASC="1",ColumnSortCondition.SORT_ORDER_DESC="2",e.getJSONObject=function(){var e=this,t={},n=e._items,o=n.getCount(),i=e._orders,a=i.getCount(),r="",s="",l=!0;(0>=o||0>=a)&&(n=e._getDefaultItems(),o=n.getCount(),i=e._getDefaultOrders(),a=i.getCount());for(var u=0;o>u;u++){var c=n.get(u);l?l=!1:r+=",",r+=c}l=!0;for(var d=0;a>d;d++){var g=i.get(d);l?l=!1:s+=",",s+=g}return t.item=r,t.order=s,t},e.getConditionObject=function(e){for(var t=this,n=this,o=e.item.split(","),i=e.order.split(","),a=0;a<o.length;a++)t.add(o[a],i[a]);return n},e._getDefaultItems=function(){var e=new ArrayList,t="id";return e.add(t),e},e._getDefaultOrders=function(){var e=new ArrayList;return e.add(ColumnSortCondition.SORT_ORDER_DESC),e},e.add=function(e,t){var n=this;if(e&&"string"==typeof e&&""!=e){var o=null;o=t&&"string"==typeof t&&t==ColumnSortCondition.SORT_ORDER_DESC?t:ColumnSortCondition.SORT_ORDER_ASC,n._items.add(e),n._orders.add(o)}},e.getItems=function(){return this._items},e.getOrders=function(){return this._orders}}(),function(){var e=function(){};e.prototype=ColumnFilterCondition.prototype,AndOrCondition.prototype=new e;var t=(e.prototype,AndOrCondition.prototype);t.getJSONObject=function(){var e=this,t=null,n=e._columnFilterConditionList.getCount();if(2>n)return t;for(var o=[],i=0;n>i;i++){var a=e._columnFilterConditionList.get(i),r=a.getJSONObject();if(null==r)return t;o[i]=r}return t={value:o}},t._createChildCondition=function(e){var t=this;if(null==e)return null;var n=e.value.length;if(2>n)return null;for(var o=0;n>o;o++){var i=t._createCondition(e.value[o]);if(null==i)return null;t.addChildCondition(i)}return t._columnFilterConditionList},t.getChildConditionList=function(){var e=this;return e._columnFilterConditionList},t.addChildCondition=function(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this;t._columnFilterConditionList.add(e)}}}(),function(){var e=function(){};e.prototype=AndOrCondition.prototype,AndCondition.prototype=new e;var t=e.prototype,n=AndCondition.prototype;n.getJSONObject=function(){var e=this,n=t.getJSONObject.call(e);return null==n?n:(n.type=e._type,n)},n.getConditionObject=function(e){var t=this;return null==e?null:e.type!=t._type?null:t._createChildCondition(e)},n.isMatch=function(e){for(var t=this,n=t._columnFilterConditionList.getCount(),o=0;n>o;o++){var i=t._columnFilterConditionList.get(o);if(0==i.isMatch(e))return!1}return!0},n.isColmunChangeable=function(e){for(var t=this,n=t._columnFilterConditionList.getCount(),o=0;n>o;o++){var i=t._columnFilterConditionList.get(o);if(0==i.isColmunChangeable(e))return!1}return!0},n.getType=function(){var e=this;return e._type}}(),function(){var e=function(){};e.prototype=AndOrCondition.prototype,OrCondition.prototype=new e;var t=e.prototype,n=OrCondition.prototype;n.getJSONObject=function(){var e=this,n=t.getJSONObject.call(e);return null==n?n:(n.type=e._type,n)},n.getConditionObject=function(e){var t=this;return null==e?null:e.type!=t._type?null:t._createChildCondition(e)},n.isMatch=function(e){for(var t=this,n=t._columnFilterConditionList.getCount(),o=0;n>o;o++){var i=t._columnFilterConditionList.get(o);if(1==i.isMatch(e))return!0}return!1},n.isColmunChangeable=function(e){for(var t=this,n=t._columnFilterConditionList.getCount(),o=0;n>o;o++){var i=t._columnFilterConditionList.get(o);
if(1==i.isColmunChangeable(e))return!0}return!1},n.getType=function(){var e=this;return e._type}}(),function(){var e=function(){};e.prototype=ColumnFilterCondition.prototype,NotCondition.prototype=new e;var t=(e.prototype,NotCondition.prototype);t.getJSONObject=function(){var e=this,t=null;if(null==e._columnFilterCondition)return t;var n=e._columnFilterCondition.getJSONObject();return null==n?t:t={type:e._type,value:n}},t.getConditionObject=function(e){var t=this;if(null==e)return null;if(e.type!=t._type)return null;if(!e.value)return null;if(void 0!=e.value.length&&1!=e.value.length)return null;var n=t._createCondition(e.value);if(null==n)return null;var o=null;return o=this,this.setChildCondition(n),o},t.getChildCondition=function(){var e=this;return e._columnFilterCondition},t.setChildCondition=function(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this;t._columnFilterCondition=e}},t.isMatch=function(e){var t=this;return null==t._columnFilterCondition?!1:!t._columnFilterCondition.isMatch(e)},t.isColmunChangeable=function(e){var t=this;return null==t._columnFilterCondition?!1:!t._columnFilterCondition.isColmunChangeable(e)},t.getType=function(){var e=this;return e._type}}(),function(){var e=function(){};e.prototype=ColumnFilterCondition.prototype,ItemCondition.prototype=new e;var t=(e.prototype,ItemCondition.prototype);t.getJSONObject=function(){var e=this,t=null;return null==e._name||""==e._name?t:null==e._value?t:t={type:e._type,name:e._name,value:e._value}},t.getConditionObject=function(e){var t=this;if(null==e)return null;if(e.type!=t._type)return null;if("object"==_typeof(e.value))return null;var n=null;return n=this,n.setData(e.name,e.value),n},t.setData=function(e,t){var n=this;e&&"string"==typeof e&&""!=e&&(null==t||"string"!=typeof t&&"number"!=typeof t||(n._name=e,n._value=t))},t.isMatch=function(e){var t=this;return t._name&&"string"==typeof t._name&&""!=t._name?null==t._value||"string"!=typeof t._value&&"number"!=typeof t._value?!1:e.isMatchFilterCondition(t._name,t._value):!1},t.isColmunChangeable=function(e){var t=this;return t._name&&"string"==typeof t._name&&""!=t._name?null==t._value||"string"!=typeof t._value&&"number"!=typeof t._value?!1:e.isColmunChangeableFilterCondition(t._name,t._value):!1},t.getType=function(){var e=this;return e._type},t.getValue=function(){var e=this;return e._value},t.getName=function(){var e=this;return e._name}}(),function(){var e=function(){};e.prototype=ItemCondition.prototype,GreaterThanCondition.prototype=new e;var t=(e.prototype,GreaterThanCondition.prototype);t.isMatch=function(e){var t=this;return t._name&&"string"==typeof t._name&&""!=t._name?null==t._value||"string"!=typeof t._value&&"number"!=typeof t._value?!1:e.isMatchGraterThanCondition(t._name,t._value):!1},t.isColmunChangeable=function(e){var t=this;return t._name&&"string"==typeof t._name&&""!=t._name?null==t._value||"string"!=typeof t._value&&"number"!=typeof t._value?!1:e.isColmunChangeableGraterThanCondition(t._name,t._value):!1}}(),function(){var e=function(){};e.prototype=ItemCondition.prototype,LessThanCondition.prototype=new e;var t=(e.prototype,LessThanCondition.prototype);t.isMatch=function(e){var t=this;return t._name&&"string"==typeof t._name&&""!=t._name?null==t._value||"string"!=typeof t._value&&"number"!=typeof t._value?!1:e.isMatchLessThanCondition(t._name,t._value):!1},t.isColmunChangeable=function(e){var t=this;return t._name&&"string"==typeof t._name&&""!=t._name?null==t._value||"string"!=typeof t._value&&"number"!=typeof t._value?!1:e.isColmunChangeableLessThanCondition(t._name,t._value):!1}}(),function(){KeywordCondition.INCLUDE_TYPE_MSGFROM="msgfrom";var e=function(){};e.prototype=ColumnFilterCondition.prototype,KeywordCondition.prototype=new e;var t=(e.prototype,KeywordCondition.prototype);t.getJSONObject=function(){var e=this,t=null;if(null==e._value||"string"!=typeof e._value||""==e._value)return t;var n=[];if(null!=e._include)for(var o in e._include)n.push(o);return t={type:e._type,value:e._value,include:n}},t.getConditionObject=function(e){var t=this;if(null==e)return null;if(e.type!=t._type)return null;if("object"==_typeof(e.value))return null;var n=null;if(n=this,n.setData(e.value),null!=e.include)for(var o=0;o<e.include.length;o++)n._addInclude(e.include[o]);return n},t.setData=function(e){if(e&&"string"==typeof e&&""!=e){var t=this;t._value=e}},t.isMatch=function(e){var t=this;return t._value&&"string"==typeof t._value&&""!=t._value?e.hasKeyword(t._value,t._include):!1},t.isColmunChangeable=function(e){var t=this,n=t.isMatch(e);return 1==n?n:n=e.hasKeywordPreInfomation(t._value,t._include)},t.getType=function(){var e=this;return e._type},t.getValue=function(){var e=this;return e._value},t.setAddIncludeMessageFrom=function(){var e=this;e._addInclude(KeywordCondition.INCLUDE_TYPE_MSGFROM)},t._addInclude=function(e){var t=this;e&&"string"==typeof e&&""!=e&&((null==t._include||"object"!=_typeof(t._include))&&(t._include={}),t._include[e]=e)},t._deleteInclude=function(e){var t=this;e&&"string"==typeof e&&""!=e&&null!=t._include&&"object"==_typeof(t._include)&&delete t._include[e]}}(),function(){var e=function(){};e.prototype=ItemCondition.prototype,ParticularCondition.prototype=new e;e.prototype;ParticularCondition.CONDITION_TYPE_TASK_REQUESTING="TaskRequesting",ParticularCondition.CONDITION_TYPE_TASK_REQUESTED="TaskRequested",ParticularCondition.CONDITION_TYPE_TASK_SELF="TaskSelf",ParticularCondition.CONDITION_TYPE_TASK_OWNER="TaskOwner",ParticularCondition.CONDITION_TYPE_COMMUNITY_JOINED="CommunityJoined",ParticularCondition.CONDITION_TYPE_COMMUNITY_TASK_DEMANDED="CommunityTaskDemanded",ParticularCondition.CONDITION_TYPE_MESSAGE_HAVING_URL_EXCEPT_ATTACHED_FILE="MessageHavingUrlExceptAttachedFile",ParticularCondition.CONDITION_TYPE_UNREAD_MESSAGE="UnreadMessage";var t=ParticularCondition.prototype;ParticularCondition.createTaskRequestingCondition=function(e){var t=new ParticularCondition;return t.setData(ParticularCondition.CONDITION_TYPE_TASK_REQUESTING,e),t},ParticularCondition.createTaskRequestedCondition=function(e){var t=new ParticularCondition;return t.setData(ParticularCondition.CONDITION_TYPE_TASK_REQUESTED,e),t},ParticularCondition.createTaskSelfCondition=function(e){var t=new ParticularCondition;return t.setData(ParticularCondition.CONDITION_TYPE_TASK_SELF,e),t},ParticularCondition.createTaskOwnerCondition=function(e){var t=new ParticularCondition;return t.setData(ParticularCondition.CONDITION_TYPE_TASK_OWNER,e),t},ParticularCondition.createCommunityJoinedCondition=function(e){var t=new ParticularCondition;return t.setData(ParticularCondition.CONDITION_TYPE_COMMUNITY_JOINED,e),t},ParticularCondition.createCommunityTaskDemandedCondition=function(e){var t=new ParticularCondition;return t.setData(ParticularCondition.CONDITION_TYPE_COMMUNITY_TASK_DEMANDED,e),t},ParticularCondition.createMessageHavingUrlExceptAttachedFileCondition=function(e){var t=new ParticularCondition;return t.setData(ParticularCondition.CONDITION_TYPE_MESSAGE_HAVING_URL_EXCEPT_ATTACHED_FILE,e),t},ParticularCondition.createUnreadMessageFileCondition=function(e){var t=new ParticularCondition;return t.setData(ParticularCondition.CONDITION_TYPE_UNREAD_MESSAGE,e),t},t.isMatch=function(e){var t=this;if(!t._name||"string"!=typeof t._name||""==t._name)return!1;if(null==t._value||"string"!=typeof t._value&&"number"!=typeof t._value)return!1;var n=!1;switch(t._name){case ParticularCondition.CONDITION_TYPE_TASK_REQUESTING:n=t._isMatchTaskRequestingCondition(e);break;case ParticularCondition.CONDITION_TYPE_TASK_REQUESTED:n=t._isMatchTaskRequestedCondition(e);break;case ParticularCondition.CONDITION_TYPE_TASK_SELF:n=t._isMatchTaskSelfCondition(e);break;case ParticularCondition.CONDITION_TYPE_TASK_OWNER:n=t._isMatchTaskOwnerCondition(e);break;case ParticularCondition.CONDITION_TYPE_COMMUNITY_JOINED:n=t._isMatchCommunityJoinedComdition(e);break;case ParticularCondition.CONDITION_TYPE_COMMUNITY_TASK_DEMANDED:n=t._isMatchCommunityTaskDemandedCondition(e);break;case ParticularCondition.CONDITION_TYPE_MESSAGE_HAVING_URL_EXCEPT_ATTACHED_FILE:n=t._isMatchMessageHavingUrlExceptAttachedFileCondition(e);break;case ParticularCondition.CONDITION_TYPE_UNREAD_MESSAGE:n=t._isMatchUnreadMessageCondition(e)}return n},t.isColmunChangeable=function(e){var t=this;if(!t._name||"string"!=typeof t._name||""==t._name)return!1;if(null==t._value||"string"!=typeof t._value&&"number"!=typeof t._value)return!1;var n=!1;switch(t._name){case ParticularCondition.CONDITION_TYPE_TASK_REQUESTING:n=t._isColmunChangeableTaskRequestingCondition(e);break;case ParticularCondition.CONDITION_TYPE_TASK_REQUESTED:n=t._isColmunChangeableTaskRequestedCondition(e);break;case ParticularCondition.CONDITION_TYPE_TASK_SELF:n=t._isColmunChangeableTaskSelfCondition(e);break;case ParticularCondition.CONDITION_TYPE_TASK_OWNER:n=t._isColmunChangeableTaskOwnerCondition(e);break;case ParticularCondition.CONDITION_TYPE_COMMUNITY_JOINED:n=t._isColmunChangeableCommunityJoinedCondition(e);break;case ParticularCondition.CONDITION_TYPE_COMMUNITY_TASK_DEMANDED:n=t._isColmunChangeableCommunityTaskDemandCondition(e);break;case ParticularCondition.CONDITION_TYPE_MESSAGE_HAVING_URL_EXCEPT_ATTACHED_FILE:n=t._isColmunChangeableMessageHavingUrlExceptAttachedFileCondition(e);break;case ParticularCondition.CONDITION_TYPE_UNREAD_MESSAGE:n=t._isColmunChangeableUnreadMessageCondition(e)}return n},t._isMatchTaskRequestingCondition=function(e){var t=this,n=!1;if(null==e)return n;if(e.getType()!=Message.TYPE_TASK)return n;if(t._value!=e.getOwnerJid())return n;var o=e.getItemId(),i=CubeeController.getInstance().getChildrenTaskItemIds(o);return null==i||i.getCount()<=0?n:n=!0},t._isMatchTaskRequestedCondition=function(e){var t=this,n=!1;if(null==e)return n;if(e.getType()!=Message.TYPE_TASK)return n;if(t._value!=e.getOwnerJid())return n;var o=e.getParentItemId();return null==o||""==o?n:n=!0},t._isMatchTaskSelfCondition=function(e){var t=this,n=!1;if(null==e)return n;if(e.getType()!=Message.TYPE_TASK)return n;if(t._value!=e.getOwnerJid())return n;var o=e.getParentItemId();if(null!=o&&""!=o)return n;var i=e.getItemId(),a=CubeeController.getInstance().getChildrenTaskItemIds(i);return null!=a&&a.getCount()>0?n:n=!0},t._isMatchTaskOwnerCondition=function(e){var t=this,n=!1;if(null==e)return n;if(e.getType()!=Message.TYPE_TASK)return n;if(t._value==e.getOwnerJid())return n=!0;var o=e.getItemId(),i=CubeeController.getInstance().getChildrenTaskItemIds(o);if(null==i)return n;for(var a=i.getCount(),r=0;a>r;r++){var s=i.get(r),l=CubeeController.getInstance().getMessage(s);if(null!=l&&t._value==l.getOwnerJid())return n=!0}return n},t._isMatchCommunityJoinedComdition=function(e){var t=!1;if(null==e)return t;var n=e.getType();if(n==Message.TYPE_COMMUNITY)t=!0;else if(n==Message.TYPE_TASK){var o=e.getCommunityId();if(null!=o&&""!=o){var i=e.getStatus();i>TaskMessage.STATUS_INBOX&&(t=!0)}}return t},t._isMatchCommunityTaskDemandedCondition=function(e){var t=!1;if(!e||e.getType()!=Message.TYPE_TASK||""!=e.getParentItemId()&&""==e.getCommunityId())return t;var n=e.getItemId(),o=CubeeController.getInstance().getChildrenTaskItemIds(n);if(null==o)return t;for(var i=o.getCount(),a=0;i>a;a++){var r=o.get(a),s=CubeeController.getInstance().getMessage(r);if(null!=s&&1==s.getDemandStatus())return t=!0}return t},t._isMatchMessageHavingUrlExceptAttachedFileCondition=function(e){var t=this,n=!1;if(null==e)return n;var o=new RegExp("https?://(?!"+t._value+")"),i=e.getMessage().match(o);return null!=i&&i.length>0&&(n=!0),n},t._isMatchUnreadMessageCondition=function(e){var t=!1;if(null==e)return t;var n=e.getType();if(n==Message.TYPE_TASK||n==Message.TYPE_SYSTEM)return t;var o=e.getReadFlag();return o==Message.READ_STATUS_UNREAD},t._isColmunChangeableTaskRequestingCondition=function(e){var t=this,n=!1;if(null==e)return n;if(n=t._isMatchTaskRequestingCondition(e))return n;if(e.getType()!=Message.TYPE_TASK)return n;if(t._value!=e.getPreOwnerJid())return n;var o=e.getItemId(),i=CubeeController.getInstance().getChildrenTaskItemIds(o);return null==i||i.getCount()<=0?n:n=!0},t._isColmunChangeableTaskRequestedCondition=function(e){var t=this,n=!1;if(null==e)return n;if(n=t._isMatchTaskRequestedCondition(e))return n;if(e.getType()!=Message.TYPE_TASK)return n;if(t._value!=e.getPreOwnerJid())return n;var o=e.getParentItemId();return null==o||""==o?n:n=!0},t._isColmunChangeableTaskSelfCondition=function(e){var t=this,n=!1;if(null==e)return n;if(n=t._isMatchTaskSelfCondition(e))return n;if(e.getType()!=Message.TYPE_TASK)return n;if(t._value!=e.getPreOwnerJid())return n;var o=e.getParentItemId();if(null!=o&&""!=o)return n;var i=e.getItemId(),a=CubeeController.getInstance().getChildrenTaskItemIds(i);return null!=a&&a.getCount()>0?n:n=!0},t._isColmunChangeableTaskOwnerCondition=function(e){var t=this,n=!1;if(null==e)return n;if(n=t._isMatchTaskOwnerCondition(e))return n;if(e.getType()!=Message.TYPE_TASK)return n;if(t._value==e.getPreOwnerJid())return n=!0;var o=e.getItemId(),i=CubeeController.getInstance().getChildrenTaskItemIds(o);if(null==i)return n;for(var a=i.getCount(),r=0;a>r;r++){var s=i.get(r),l=CubeeController.getInstance().getMessage(s);if(null!=l&&t._value==l.getPreOwnerJid())return n=!0}return n},t._isColmunChangeableCommunityJoinedCondition=function(e){var t=!1;if(null==e)return t;var n=e.getType();if(n==Message.TYPE_COMMUNITY)t=!0;else if(n==Message.TYPE_TASK){var o=e.getCommunityId();if(null!=o&&""!=o){var i=e.getStatus();i>TaskMessage.STATUS_INBOX&&(t=!0)}}return t},t._isColmunChangeableCommunityTaskDemandCondition=function(e){return e&&e.getType()==Message.TYPE_TASK&&""==e.getParentItemId()&&""!=e.getCommunityId},t._isColmunChangeableMessageHavingUrlExceptAttachedFileCondition=function(e){var t=this,n=!1;if(null==e)return n;if(n=t._isMatchMessageHavingUrlExceptAttachedFileCondition(e))return n;var o=e.getType();if(o==Message.TYPE_TASK){var i=new RegExp("https?://(?!"+t._value+")"),a=e.getPreMessage().match(i);null!=a&&a.length>0&&(n=!0)}return n},t._isColmunChangeableUnreadMessageCondition=function(e){var t=!1;if(null==e)return t;var n=e.getType();if(n==Message.TYPE_TASK||n==Message.TYPE_SYSTEM)return t;var o=e.getReadFlag(),t=o==Message.READ_STATUS_UNREAD||o==Message.READ_STATUS_READ;return t}}(),function(){var e=FilterCondition.prototype;FilterCondition.CONDITION_TYPE_AND="and",FilterCondition.CONDITION_TYPE_OR="or",FilterCondition.CONDITION_TYPE_NOT="not",FilterCondition.CONDITION_TYPE_ITEM="item",e.getJsonString=function(){return this._jsonString},e.setJsonString=function(e){null!=e&&"string"==typeof e&&(this._jsonString=e)},e.getJSONObject=function(){var e=this,t=JSON.parse(e._jsonString);return t},e.isMatch=function(e){return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?!1:_ret}}(),function(){var e=SortCondition.prototype;SortCondition.SORT_ORDER_ASC="1",SortCondition.SORT_ORDER_DESC="2",e.getJsonString=function(){return this._jsonString},e.setJsonString=function(e){null!=e&&"string"==typeof e&&(this._jsonString=e=e)},e.getJSONObject=function(){var e=this,t=JSON.parse(e._jsonString);return t},e._getDefaultSortConditionJsonString=function(){var e={item:"id",order:SortCondition.SORT_ORDER_DESC};return JSON.stringify(e)}}(),function(){var e=function(){};e.prototype=FilterCondition.prototype,TaskFilterCondition.prototype=new e;var t=(e.prototype,TaskFilterCondition.prototype);t._getDefaultFilterJsonString=function(){var e=FilterCondition.CONDITION_TYPE_AND,t=(FilterCondition.CONDITION_TYPE_OR,FilterCondition.CONDITION_TYPE_NOT),n=FilterCondition.CONDITION_TYPE_ITEM,o={type:e,value:[{type:n,name:"msgtype",value:Message.TYPE_TASK},{type:n,name:"owner",value:LoginUser.getInstance().getJid()},{type:e,value:[{type:t,value:{type:n,name:"status",value:TaskMessage.STATUS_INBOX}},{type:t,value:{type:e,value:[{type:n,name:"status",value:TaskMessage.STATUS_ASSIGNING},{type:t,value:{type:n,name:"parent_item_id",value:""}}]}}]}]};return JSON.stringify(o)},t.isMatch=function(e){return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?!1:_ret}}(),function(){var e=function(){};e.prototype=FilterCondition.prototype,InboxFilterCondition.prototype=new e;var t=(e.prototype,InboxFilterCondition.prototype);t._getDefaultFilterJsonString=function(){var e={type:FilterCondition.CONDITION_TYPE_AND,value:[{type:FilterCondition.CONDITION_TYPE_ITEM,name:"msgtype",value:Message.TYPE_TASK},{type:FilterCondition.CONDITION_TYPE_ITEM,name:"owner",value:LoginUser.getInstance().getJid()},{type:FilterCondition.CONDITION_TYPE_OR,value:[{type:FilterCondition.CONDITION_TYPE_ITEM,name:"status",value:TaskMessage.STATUS_INBOX},{type:FilterCondition.CONDITION_TYPE_AND,value:[{type:FilterCondition.CONDITION_TYPE_ITEM,name:"status",value:TaskMessage.STATUS_ASSIGNING},{type:FilterCondition.CONDITION_TYPE_NOT,value:{type:FilterCondition.CONDITION_TYPE_ITEM,name:"parent_item_id",value:""}}]}]}]};return JSON.stringify(e)},t.isMatch=function(e){return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?!1:_ret}}(),function(){var e=function(){};e.prototype=FilterCondition.prototype,TaskSortCondition.prototype=new e;e.prototype;TaskSortCondition.DB_COLOMN_STATUS="status",TaskSortCondition.DB_COLOMN_DUE_DATE="due_date",TaskSortCondition.DB_COLOMN_COMPLETE_DATE="complete_date",TaskSortCondition.DB_COLUMN_PRIORITY="priority",TaskSortCondition.DB_COLUMN_UPDATE_AT="updated_at";var t=TaskSortCondition.prototype;t._getDefaultFilterJsonString=function(){var e={item:TaskSortCondition.DB_COLOMN_STATUS+","+TaskSortCondition.DB_COLUMN_PRIORITY+","+TaskSortCondition.DB_COLOMN_COMPLETE_DATE+","+TaskSortCondition.DB_COLOMN_DUE_DATE,order:SortCondition.SORT_ORDER_ASC+","+SortCondition.SORT_ORDER_DESC+","+SortCondition.SORT_ORDER_DESC+","+SortCondition.SORT_ORDER_ASC};return JSON.stringify(e)}}(),function(){ColumnFilterManager.prototype;ColumnFilterManager.getColumnFilter=function(e,t){var n=null;switch(e){case ColumnInformation.TYPE_COLUMN_TIMELINE:n=FeedColumnFilter.getFilter();break;case ColumnInformation.TYPE_COLUMN_MENTION:n=MentionColumnFilter.getFilter();break;case ColumnInformation.TYPE_COLUMN_TOME:n=ToMeColumnFilter.getFilter();break;case ColumnInformation.TYPE_COLUMN_CHAT:n=ChatColumnFilter.getFilter(t);break;case ColumnInformation.TYPE_COLUMN_TASK:n=TaskColumnFilter.getFilter();break;case ColumnInformation.TYPE_COLUMN_INBOX:n=InboxColumnFilter.getFilter();break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:n=GroupChatColumnFilter.getFilter(t);break;case ColumnInformation.TYPE_COLUMN_MAIL:n=MailColumnFilter.getFilter();break;case ColumnInformation.TYPE_COLUMN_RECENT:n=RecentColumnFilter.getFilter(t);break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:n=CommunityFeedColumnFilter.getFilter(t);break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:n=CommunityTaskColumnFilter.getFilter(t);break;case ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE:n=QuestionnaireColumnFilter.getFilter();break;case ColumnInformation.TYPE_COLUMN_MURMUR:n=MurmurColumnFilter.getFilter(t)}return n},ColumnFilterManager.getColumnFilterList=function(e){var t=null,n=e.getCount();if(n>1){t=new OrCondition;for(var o=0;n>o;o++){var i=ColumnFilterManager.getColumnFilter(e.get(o));null!=i&&t.addChildCondition(i)}}else{var i=ColumnFilterManager.getColumnFilter(e.get(0));null!=i&&(t=i)}return t},ColumnFilterManager.getColumnFilterForCommunity=function(e,t){var n=null,o=e.getCount();if(o>1){n=new OrCondition;for(var i=0;o>i;i++){var a=e.get(i),r=null;(a==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED||a==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK)&&(r=t);var s=ColumnFilterManager.getColumnFilter(a,r);null!=s&&n.addChildCondition(s)}}else{var l=e.get(0),r=null;(l==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED||l==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK)&&(r=t);var s=ColumnFilterManager.getColumnFilter(l,r);null!=s&&(n=s)}return n}}(),function(){FeedColumnFilter.prototype;FeedColumnFilter.getFilter=function(){var e=new ItemCondition;e.setData("msgtype",Message.TYPE_PUBLIC);var t=new ItemCondition;t.setData("msgtype",Message.TYPE_QUESTIONNAIRE);var n=new OrCondition,o=new AndCondition;n.addChildCondition(e),n.addChildCondition(t),o.addChildCondition(n);var i=new ItemCondition,a=LoginUser.getInstance().getJid(),r=a.slice(a.lastIndexOf("@")+1);return i.setData("msgto",r),o.addChildCondition(i),o}}(),function(){MyfeedColumnFilter.prototype;MyfeedColumnFilter.getFilter=function(){var e=LoginUser.getInstance().getJid(),t=new AndCondition,n=new ItemCondition;n.setData("msgtype",Message.TYPE_PUBLIC),t.addChildCondition(n);var o=CubeeController.getInstance().getFollowList(),i=new ArrayList;i.add(e);for(var a=0;a<o.getCount();a++)i.add(o.get(a).getJid());var r=new OrCondition,s=i.getCount();if(s>1){for(var a=0;s>a;a++){var l=new ItemCondition;l.setData("msgfrom",i.get(a)),r.addChildCondition(l)}t.addChildCondition(r)}else{var u=new ItemCondition;u.setData("msgfrom",i.get(0)),t.addChildCondition(u)}return t}}(),function(){ChatColumnFilter.prototype;ChatColumnFilter.getFilter=function(e){var t=LoginUser.getInstance().getJid(),n=new AndCondition,o=new ItemCondition;if(o.setData("msgtype",Message.TYPE_CHAT),n.addChildCondition(o),null==e||null==e.partner||"string"!=typeof e.partner){var i=new OrCondition,a=new ItemCondition;a.setData("msgfrom",t),i.addChildCondition(a);var r=new ItemCondition;r.setData("msgto",t),i.addChildCondition(r),n.addChildCondition(i)}else{var i=new OrCondition,s=new AndCondition,l=new ItemCondition;l.setData("msgfrom",t),s.addChildCondition(l);var u=new ItemCondition;u.setData("msgto",e.partner),s.addChildCondition(u),i.addChildCondition(s);var c=new AndCondition,d=new ItemCondition;d.setData("msgfrom",e.partner),c.addChildCondition(d);var g=new ItemCondition;g.setData("msgto",t),c.addChildCondition(g),i.addChildCondition(c),n.addChildCondition(i)}return n}}(),function(){TaskColumnFilter.prototype;TaskColumnFilter.getFilter=function(){var e=new AndCondition,t=new ItemCondition;t.setData("msgtype",Message.TYPE_TASK),e.addChildCondition(t);var n=new ItemCondition;n.setData("owner",LoginUser.getInstance().getJid()),e.addChildCondition(n);var o=new AndCondition,i=new NotCondition,a=new ItemCondition;a.setData("status",TaskMessage.STATUS_INBOX),i.setChildCondition(a),o.addChildCondition(i);var r=new OrCondition,s=new NotCondition,l=new ItemCondition;l.setData("status",TaskMessage.STATUS_ASSIGNING),s.setChildCondition(l),r.addChildCondition(s);var u=new ItemCondition;return u.setData("parent_item_id",""),r.addChildCondition(u),o.addChildCondition(r),e.addChildCondition(o),e}}(),function(){InboxColumnFilter.prototype;InboxColumnFilter.getFilter=function(){var e=new AndCondition,t=new ItemCondition;t.setData("msgtype",Message.TYPE_TASK),e.addChildCondition(t);var n=new ItemCondition;n.setData("owner",LoginUser.getInstance().getJid()),e.addChildCondition(n);var o=new OrCondition,i=new ItemCondition;i.setData("status",TaskMessage.STATUS_INBOX),o.addChildCondition(i);var a=new AndCondition,r=new ItemCondition;r.setData("status",TaskMessage.STATUS_ASSIGNING),a.addChildCondition(r);var s=new NotCondition,l=new ItemCondition;return l.setData("parent_item_id",""),s.setChildCondition(l),a.addChildCondition(s),o.addChildCondition(a),e.addChildCondition(o),e}}(),function(){MyfeedColumnFilter.prototype;MentionColumnFilter.getFilter=function(e){var t=LoginUser.getInstance().getLoginAccount(),n=new AndCondition,o=new ItemCondition;o.setData("msgtype",Message.TYPE_PUBLIC),n.addChildCondition(o);var i=new OrCondition,a="@"+t,r=new KeywordCondition;r.setData(a),i.addChildCondition(r);var s="@all",l=new KeywordCondition;return l.setData(s),i.addChildCondition(l),n.addChildCondition(i),n}}(),function(){GroupChatColumnFilter.prototype;GroupChatColumnFilter.getFilter=function(e){var t=new ItemCondition;if(t.setData("msgtype",Message.TYPE_GROUP_CHAT),null==e||null==e.roomId||"string"!=typeof e.roomId)return t;var n=new ItemCondition;n.setData("msgtype",Message.TYPE_QUESTIONNAIRE);var o=new AndCondition,i=new OrCondition;i.addChildCondition(t),i.addChildCondition(n),o.addChildCondition(i);var a=new ItemCondition;return a.setData("msgto",e.roomId),o.addChildCondition(a),o}}(),function(){CommunityFeedColumnFilter.prototype;CommunityFeedColumnFilter.getFilter=function(e){var t=new ItemCondition;if(t.setData("msgtype",Message.TYPE_COMMUNITY),null==e||null==e.roomId||"string"!=typeof e.roomId)return t;var n=new ItemCondition;n.setData("msgtype",Message.TYPE_QUESTIONNAIRE);var o=new AndCondition,i=new OrCondition;i.addChildCondition(t),i.addChildCondition(n),o.addChildCondition(i);var a=new ItemCondition;return a.setData("msgto",e.roomId),o.addChildCondition(a),o}}(),function(){QuestionnaireColumnFilter.prototype;QuestionnaireColumnFilter.getFilter=function(){var e=new ItemCondition;return e.setData("msgtype",Message.TYPE_QUESTIONNAIRE),e}}(),function(){CommunityTaskColumnFilter.prototype;CommunityTaskColumnFilter.getFilter=function(e){var t=new ItemCondition;if(t.setData("msgtype",Message.TYPE_TASK),null==e||null==e.roomId||"string"!=typeof e.roomId)return t;var n=new AndCondition,o=new ItemCondition;o.setData("group_name",e.roomId);var i=new ItemCondition;i.setData("parent_item_id","");var a=new NotCondition,r=new ItemCondition;return r.setData("status",TaskMessage.STATUS_INBOX),a.setChildCondition(r),n.addChildCondition(o),n.addChildCondition(i),n.addChildCondition(a),n},CommunityTaskColumnFilter.getFilterWithoutCompletedTask=function(e){var t=new ItemCondition;if(t.setData("msgtype",Message.TYPE_TASK),null==e||null==e.roomId||"string"!=typeof e.roomId)return t;var n=new AndCondition,o=new ItemCondition;o.setData("group_name",e.roomId);var i=new ItemCondition;i.setData("parent_item_id","");var a=new OrCondition,r=new ItemCondition;r.setData("status",TaskMessage.STATUS_ASSIGNING);var s=new ItemCondition;s.setData("status",TaskMessage.STATUS_NEW);var l=new ItemCondition;return l.setData("status",TaskMessage.STATUS_DOING),a.addChildCondition(r),a.addChildCondition(s),a.addChildCondition(l),n.addChildCondition(o),n.addChildCondition(i),n.addChildCondition(a),n}}(),function(){MailColumnFilter.prototype;MailColumnFilter.getFilter=function(e){var t=new ItemCondition;return t.setData("msgtype",Message.TYPE_MAIL),t}}(),function(){function e(e,t){if(!e)return null;var n=e.length;if(1>n)return null;for(var o=[],i=0;n>i;i++){var a=null,r=parseInt(e[i].type);switch(r){case ColumnInformation.TYPE_COLUMN_CHAT:a=new AndCondition;var s=new ItemCondition;s.setData("msgtype",Message.TYPE_CHAT);var l=new OrCondition,u=new ItemCondition;u.setData("msgfrom",e[i].id);var c=new ItemCondition;c.setData("msgto",e[i].id),l.addChildCondition(u),l.addChildCondition(c),a.addChildCondition(s),a.addChildCondition(l);break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:a=new AndCondition;var s=new ItemCondition;s.setData("msgtype",Message.TYPE_GROUP_CHAT);var c=new ItemCondition;c.setData("msgto",e[i].id),a.addChildCondition(s),a.addChildCondition(c);break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:a=new AndCondition;var s=new ItemCondition;s.setData("msgtype",Message.TYPE_COMMUNITY);var c=new ItemCondition;c.setData("msgto",e[i].id),a.addChildCondition(s),a.addChildCondition(c);break;case ColumnInformation.TYPE_COLUMN_MENTION:case ColumnInformation.TYPE_COLUMN_TOME:a=ToMeColumnFilter.getFilter();break;case ColumnInformation.TYPE_COLUMN_TASK:a=TaskColumnFilter.getFilter(t);break;case ColumnInformation.TYPE_COLUMN_INBOX:a=InboxColumnFilter.getFilter(t);break;case ColumnInformation.TYPE_COLUMN_MAIL:a=MailColumnFilter.getFilter(t);break;default:continue}a&&o.push(a)}var d=new NotCondition,g=o.length;if(1==g)d.setChildCondition(o[0]);else{for(var m=new OrCondition,i=0;g>i;i++)m.addChildCondition(o[i]);d.setChildCondition(m)}return d}RecentColumnFilter.prototype;RecentColumnFilter.getFilter=function(t){var n=new OrCondition,o=MentionColumnFilter.getFilter(t);n.addChildCondition(o);var i=TaskColumnFilter.getFilter(t);n.addChildCondition(i);var a=InboxColumnFilter.getFilter();n.addChildCondition(a);var r=MailColumnFilter.getFilter(t);n.addChildCondition(r);var s=CommunityFeedColumnFilter.getFilter(t);n.addChildCondition(s);var l=ChatColumnFilter.getFilter(t);n.addChildCondition(l);var u=GroupChatColumnFilter.getFilter(t);n.addChildCondition(u);var c=new ItemCondition;c.setData("msgtype",Message.TYPE_QUESTIONNAIRE),n.addChildCondition(c);var d=MyMurmurColumnFilter.getFilter(t);n.addChildCondition(d);var g=e(NotificationSettingManager.getInstance().getNotificationInfo(),t),m=RecentColumnFilter._getOutSideFilter(t);if(null!=g||null!=m){var _=new AndCondition;return _.addChildCondition(n),null!=g&&_.addChildCondition(g),null!=m&&_.addChildCondition(m),_}return n},RecentColumnFilter._getOutSideFilter=function(e){return null}}(),function(){MurmurColumnFilter.prototype;MurmurColumnFilter.getFilter=function(e){var t=new ItemCondition;if(t.setData("msgtype",Message.TYPE_MURMUR),null==e||null==e.jid||"string"!=typeof e.jid)return t;var n=new AndCondition;n.addChildCondition(t);var o=new ItemCondition;return o.setData("msgto",e.jid),n.addChildCondition(o),n}}(),function(){MyMurmurColumnFilter.prototype;MyMurmurColumnFilter.getFilter=function(){var e=new AndCondition,t=new ItemCondition;t.setData("msgtype",Message.TYPE_MURMUR),e.addChildCondition(t);var n=LoginUser.getInstance().getFolloweeList(),o=new OrCondition;e.addChildCondition(o);var i=LoginUser.getInstance().getJid(),a=new ItemCondition;a.setData("msgto",i),o.addChildCondition(a);var r=new ItemCondition;r.setData("msgfrom",i),o.addChildCondition(r);var s=LoginUser.getInstance().getLoginAccount(),l="@"+s,u=new KeywordCondition;u.setData(l),o.addChildCondition(u);var c="@all",d=new KeywordCondition;if(d.setData(c),o.addChildCondition(d),n.getCount()>0)for(var g=0;g<n.getCount();g++){var m=new ItemCondition;m.setData("msgto",n.get(g).getJid()),o.addChildCondition(m)}return e}}(),function(){AllMurmurColumnFilter.prototype;AllMurmurColumnFilter.getFilter=function(){var e=new ItemCondition;return e.setData("msgtype",Message.TYPE_MURMUR),e}}(),function(){function e(e){var t=new AndCondition;t.addChildCondition(e);var n=new OrCondition,o=LoginUser.getInstance().getLoginAccount(),i="@"+o,a=new KeywordCondition;a.setData(i),n.addChildCondition(a);var r="@all",s=new KeywordCondition;return s.setData(r),n.addChildCondition(s),t.addChildCondition(n),t}ToMeColumnFilter.prototype;ToMeColumnFilter.getFilter=function(t){var n=new OrCondition,o=MentionColumnFilter.getFilter(t);n.addChildCondition(o);var i=TaskColumnFilter.getFilter(t);n.addChildCondition(i);var a=InboxColumnFilter.getFilter();n.addChildCondition(a);var r=MailColumnFilter.getFilter(t);n.addChildCondition(r);var s=CommunityFeedColumnFilter.getFilter(t),l=e(s);n.addChildCondition(l);var u=ChatColumnFilter.getFilter(t);n.addChildCondition(u);var c=GroupChatColumnFilter.getFilter(t),d=e(c);n.addChildCondition(d);var g=MurmurColumnFilter.getFilter({jid:LoginUser.getInstance().getJid()});n.addChildCondition(g);for(var m=LoginUser.getInstance().getFolloweeList(),_=0;_<m.getCount();_++){var f=m.get(_).getJid();if(null!=f){var p=MurmurColumnFilter.getFilter({jid:f}),h=e(p);n.addChildCondition(h)}}return n}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ChatRoomInformation.PRIVACY_TYPE_ITEM_OPEN=0,ChatRoomInformation.PRIVACY_TYPE_ITEM_CLOSED=1,ChatRoomInformation.PRIVACY_TYPE_ITEM_SECRET=2;var e=ChatRoomInformation.prototype;e.getRoomName=function(){return this._roomName},e.setRoomName=function(e){null!=e&&"string"==typeof e&&(this._roomName=e)},e.getRoomId=function(){return this._roomId},e.setRoomId=function(e){null!=e&&"string"==typeof e&&(this._roomId=e)},e.getParentRoomId=function(){return this._parentRoomId},e.setParentRoomId=function(e){null!=e&&"string"==typeof e&&(this._parentRoomId=e)},e.getMemberList=function(){
return this._memberList},e.getMemberListWithData=function(){return this._memberListWithData},e.getMembersAction=function(e){return"action"in this._memberListWithData[e]?this._memberListWithData[e].action:null},e.getMembersAccountName=function(e){return"accountName"in this._memberListWithData[e]?this._memberListWithData[e].accountName:null},e.removeMemberList=function(e){if(null!=e&&"string"==typeof e){for(var t=-1,n=this._memberList,o=n.getCount(),i=0;o>i;i++)if(n.get(i)==e){t=i;break}this._memberList.remove(t),this._memberListWithData[e]=null}},e.addMemberList=function(e,t,n){if(null!=e&&"string"==typeof e){(void 0==t||null==t||"string"!=typeof t)&&(t=""),(void 0==n||null==n||"string"!=typeof n)&&(n="");for(var o=-1,i=this._memberList,a=i.getCount(),r=0;a>r;r++)if(i.get(r)==e){o=r;break}0>o&&(this._memberList.add(e),this._memberListWithData[e]={action:t,accountName:n})}},e.getCreatedBy=function(){return this._createdBy},e.setCreatedBy=function(e){null!=e&&"string"==typeof e&&(this._createdBy=e)},e.getCreatedAt=function(){return this._createdAt},e.setCreatedAt=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._createdAt=e)},e.getUpdatedBy=function(){return this._updatedBy},e.setUpdatedBy=function(e){null!=e&&"string"==typeof e&&(this._updatedBy=e)},e.getUpdatedAt=function(){return this._updatedAt},e.setUpdatedAt=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._updatedAt=e)},e.getOwner=function(){return this._owner},e.setOwner=function(e){null!=e&&"string"==typeof e&&(this._owner=e)},e.getId=function(){return this._id},e.setId=function(e){null!=e&&"number"==typeof e&&(this._id=e)},e.getPreRoomName=function(){return this._preRoomName},e.setPreRoomName=function(e){null!=e&&"string"==typeof e&&(this._preRoomName=e)},e.getProfileMap=function(){return this._profileMap},e.setProfileMap=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._profileMap=e)},e.getPrivacyType=function(){return this._privacyType},e.setPrivacyType=function(e){null!=e&&"number"==typeof e&&(this._privacyType=e)}}(),function(){var e=function(){};e.prototype=StringMapedArrayList.prototype,ChatRoomInfoList.prototype=new e;var t=e.prototype,n=ChatRoomInfoList.prototype;n.add=function(e){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==e.getRoomId())return!1;var o=e.getRoomId(),i=t.add.call(n,o,e);return 0==i&&(i=t.setByKey.call(n,o,e)),i},n.getByRoomId=function(e){var n=this;return null==e||"string"!=typeof e?null:""==e?null:t.getByKey.call(n,e)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=MailServerInformation.prototype;e.getId=function(){return this._id},e.setId=function(e){null!=e&&"number"==typeof e&&(this._id=e)},e.getDisplayName=function(){return this._displayName},e.setDisplayName=function(e){null!=e&&"string"==typeof e&&(this._displayName=e)},e.getServerType=function(){return this._serverType},e.setServerType=function(e){null!=e&&"number"==typeof e&&(this._serverType=e)},e.getCreatedBy=function(){return this._createdBy},e.setCreatedBy=function(e){null!=e&&"string"==typeof e&&(this._createdBy=e)},e.getCreatedAt=function(){return this._createdAt},e.setCreatedAt=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._createdAt=e)},e.getUpdatedBy=function(){return this._updatedBy},e.setUpdatedBy=function(e){null!=e&&"string"==typeof e&&(this._updatedBy=e)},e.getUpdatedAt=function(){return this._updatedAt},e.setUpdatedAt=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._updatedAt=e)},e.getPopHost=function(){return this._popHost},e.setPopHost=function(e){null!=e&&"string"==typeof e&&(this._popHost=e)},e.getPopPort=function(){return this._popPort},e.setPopPort=function(e){null!=e&&"number"==typeof e&&(this._popPort=e)},e.getPopAuthMode=function(){return this._popAuthMode},e.setPopAuthMode=function(e){null!=e&&"number"==typeof e&&(this._popAuthMode=e)},e.getPopResponseTimeout=function(){return this._popResponseTimeout},e.setPopResponseTimeout=function(e){null!=e&&"number"==typeof e&&(this._popResponseTimeout=e)}}(),function(){var e=function(){};e.prototype=ArrayList.prototype,MailServerInfoList.prototype=new e;e.prototype,MailServerInfoList.prototype}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){MailCooperationInformation.SERVER_TYPE_NON=0,MailCooperationInformation.SERVER_TYPE_SMTP=1,MailCooperationInformation.SERVER_TYPE_POP=2,MailCooperationInformation.SERVER_TYPE_IMAP=3,MailCooperationInformation.SERVER_TYPE_SMTP_POP=4;var e=MailCooperationInformation.prototype;e.getId=function(){return this._id},e.setId=function(e){null!=e&&"number"==typeof e&&(this._id=e)},e.getServerId=function(){return this._serverId},e.setServerId=function(e){null!=e&&"number"==typeof e&&(this._serverId=e)},e.getServerName=function(){return this._serverName},e.setServerName=function(e){null!=e&&"string"==typeof e&&(this._serverName=e)},e.getJid=function(){return this._jid},e.setJid=function(e){null!=e&&"string"==typeof e&&(this._jid=e)},e.getMailAddress=function(){return this._mailAddress},e.setMailAddress=function(e){null!=e&&"string"==typeof e&&(this._mailAddress=e)},e.getBranchNumber=function(){return this._branchNumber},e.setBranchNumber=function(e){null!=e&&"number"==typeof e&&(this._branchNumber=e)},e.getCooperationType=function(){return this._cooperationType},e.setCooperationType=function(e){null!=e&&"number"==typeof e&&(this._cooperationType=e)},e.getSettingInfo=function(){return this._settingInfo},e.setSettingInfo=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._settingInfo=e)}}(),function(){var e=function(){};e.prototype=ArrayList.prototype,MailCooperationInfoList.prototype=new e;e.prototype,MailCooperationInfoList.prototype}(),function(){AccountSettingInfomation.SERVER_TYPE_SMTP=1,AccountSettingInfomation.SERVER_TYPE_POP=2,AccountSettingInfomation.SERVER_TYPE_IMAP=3,AccountSettingInfomation.SERVER_TYPE_SMTP_POP=4;var e=AccountSettingInfomation.prototype;e.getAccount=function(){return this._account},e.setAccount=function(e){null!=e&&"string"==typeof e&&(this._account=e)},e.getPassword=function(){return this._password},e.setPassword=function(e){null!=e&&"string"==typeof e&&(this._password=e)}}(),function(){var e=function(){};e.prototype=AccountSettingInfomation.prototype,PopSettingInfomation.prototype=new e;var t=(e.prototype,PopSettingInfomation.prototype);t.getType=function(){return this._type}}(),function(){FilterManager.TYPE_UNKNOWN=0,FilterManager.TYPE_MESSAGE_COUNT_DEMAND_TASK=1;FilterManager.prototype;FilterManager.getFilter=function(e,t){var n=null;switch(e){case FilterManager.TYPE_MESSAGE_COUNT_DEMAND_TASK:n=DemandTaskFilter.getFilter(t)}return n}}(),function(){DemandTaskFilter.prototype;DemandTaskFilter.getFilter=function(e){var t=new AndCondition,n=new ItemCondition;n.setData("msgtype",Message.TYPE_TASK),t.addChildCondition(n);var o=new ItemCondition;o.setData("owner",LoginUser.getInstance().getJid()),t.addChildCondition(o);var i=new ItemCondition;if(i.setData("demand_status",TaskMessage.DEMAND_ON),t.addChildCondition(i),null==e||"number"!=typeof e)return t;switch(e){case ColumnInformation.TYPE_COLUMN_TASK:var a=new OrCondition,r=new ItemCondition,s=new ItemCondition,l=new ItemCondition,u=new ItemCondition;r.setData("status",TaskMessage.STATUS_NEW),s.setData("status",TaskMessage.STATUS_DOING),l.setData("status",TaskMessage.STATUS_FINISHED),u.setData("status",TaskMessage.STATUS_REJECTED),a.addChildCondition(r),a.addChildCondition(s),a.addChildCondition(l),a.addChildCondition(u),t.addChildCondition(a);break;case ColumnInformation.TYPE_COLUMN_INBOX:var c=new ItemCondition;c.setData("status",TaskMessage.STATUS_ASSIGNING),t.addChildCondition(c)}return t}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=MessageExistingReaderInfo.prototype;e.getAllCount=function(){return this._allCount},e.setAllCount=function(e){null!=e&&"number"==typeof e&&(this._allCount=e)},e.getExistingReaderItemList=function(){return this._existingReaderItemList}}(),function(){var e=ExistingReaderItem.prototype;e.getPerson=function(){return this._person},e.setPerson=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._person=e)},e.getDate=function(){return this._date},e.setDate=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._date=e)}}(),function(){var e=ShortenURLInfo.prototype;ShortenURLInfo.create=function(){var e=new ShortenURLInfo;return e},e.getDisplayedURL=function(){return this.DisplayedURL},e.setDisplayedURL=function(e){null!=e&&"string"==typeof e&&(this.DisplayedURL=e)},e.getShortenPath=function(){return this.ShortenPath},e.setShortenPath=function(e){null!=e&&"string"==typeof e&&(this.ShortenPath=e)},e.getOriginalURL=function(){return this.OriginalURL},e.setOriginalURL=function(e){null!=e&&"string"==typeof e&&(this.OriginalURL=e)}}();var _aes_key=null,_aes_password="123456789abcdefg",_aes_salt="abcdefghijklmnopqrstuv1234567890",_aes_iv_string="12345678901234567890123456789012";!function(){LoginTicket.read=function(){var e=localStorage.getItem(LoginView.URI_PARAM_LOGIN_TICKET);return e&&(e=decrypt(e,createKey(_aes_password,_aes_salt),_aes_iv_string)),e},LoginTicket.write=function(e){e?localStorage.setItem(LoginView.URI_PARAM_LOGIN_TICKET,encrypt(e,createKey(_aes_password,_aes_salt),_aes_iv_string)):this.remove()},LoginTicket.remove=function(){localStorage.removeItem(LoginView.URI_PARAM_LOGIN_TICKET)},LoginTicket.readAccount=function(){var e=this.read();return this.loginTicket2Account(e)},LoginTicket.writeAccount=function(e,t,n){if(t&&n){var o=this.account2LoginTicket(e,t,n);o&&this.write(o)}else this.remove()},LoginTicket.password=function(e){if(e){var t=this.readAccount();t&&t.id&&t.pw&&this.writeAccount(t.tenant,t.id,e)}},LoginTicket.loginTicket2Account=function(e){if(e){var t=null;try{t=JSON.parse(e)}catch(n){return null}if(t&&t.id&&t.pw)return t}return null},LoginTicket.account2LoginTicket=function(e,t,n){return t&&n?e?'{"tenant":"'+e+'","id":"'+t+'","pw":"'+n+'"}':'{"id":"'+t+'","pw":"'+n+'"}':null}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=new AuthorityInfo;AuthorityInfo.getInstance=function(){return e};var t=AuthorityInfo.prototype;t.getRoleId=function(){return this._roleId},t.setRoleId=function(e){null!=e&&"string"==typeof e&&(this._roleId=e)},t.getRoleName=function(){return this._roleName},t.setRoleName=function(e){null!=e&&"string"==typeof e&&(this._roleName=e)},t.getRights=function(){return this._rights},t.setRights=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._rights=e)},t.removeRightForResource=function(e,t){if(null==e||"string"!=typeof e)return!1;if(null==t||"string"!=typeof t)return!1;for(var n=0,o=!1;n<this._rights.length;++n)if(this._rights[n].hasOwnProperty("resource")&&this._rights[n].resource==t){o=!0;break}return o&&this._rights.splice(n,1),o},t.setRightForResource=function(e,t){if(null==e||"string"!=typeof e)return!1;if(null==t||"string"!=typeof t)return!1;var n=!0,o=!1,i=void 0;try{for(var a,r=this._rights[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;if(s.hasOwnProperty("resource")&&s.resource==t)return s.action=e,!0}}catch(l){o=!0,i=l}finally{try{!n&&r["return"]&&r["return"]()}finally{if(o)throw i}}return this._rights.push({action:e,resource:t,enable_flag:!0}),!0},t.checkRights=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null==e||"string"!=typeof e)return!1;if(null!=t&&"string"!=typeof t)return!1;if(null==t){var n=!0,o=!1,i=void 0;try{for(var a,r=this._rights[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;if(s.hasOwnProperty("action")&&!s.hasOwnProperty("resource")&&s.action==e)return!0}}catch(l){o=!0,i=l}finally{try{!n&&r["return"]&&r["return"]()}finally{if(o)throw i}}}else{var u=!0,c=!1,d=void 0;try{for(var g,m=this._rights[Symbol.iterator]();!(u=(g=m.next()).done);u=!0){var _=g.value;if(_.hasOwnProperty("action")&&_.hasOwnProperty("resource")&&_.action==e&&_.resource==t)return!0}}catch(l){c=!0,d=l}finally{try{!u&&m["return"]&&m["return"]()}finally{if(c)throw d}}}return!1},t.getWhichRightToResource=function(e,t){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return null;if(null==t||"string"!=typeof t||""==t)return null;var n=this,o=!0,i=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){var l=r.value,u=!0,c=!1,d=void 0;try{for(var g,m=n._rights[Symbol.iterator]();!(u=(g=m.next()).done);u=!0){var _=g.value;if(_.hasOwnProperty("action")&&_.hasOwnProperty("resource")&&_.action==l&&_.resource==t)return l}}catch(f){c=!0,d=f}finally{try{!u&&m["return"]&&m["return"]()}finally{if(c)throw d}}}}catch(f){i=!0,a=f}finally{try{!o&&s["return"]&&s["return"]()}finally{if(i)throw a}}return null},t.getWhichRightToGroupchatResource=function(e){if(null==e||"string"!=typeof e||""==e)return null;var t=this,n=[AuthorityDef.AUTHORITY_ACTIONS.GC_MANAGE,AuthorityDef.AUTHORITY_ACTIONS.GC_SEND,AuthorityDef.AUTHORITY_ACTIONS.GC_VIEW];return t.getWhichRightToResource(n,e)},t.getWhichRightToCommunityResource=function(e){if(null==e||"string"!=typeof e||""==e)return null;var t=this,n=[AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_MANAGE,AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_SEND,AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_VIEW];return t.getWhichRightToResource(n,e)}}(),function(){AuthorityDef.AUTHORITY_ACTIONS={FEED_VIEW:"viewMessageInFeed",FEED_SEND:"sendMessageToFeed",GC_VIEW:"viewMessageInGroupchat",GC_SEND:"sendMessageToGroupchat",GC_MANAGE:"manageGroupchat",GC_CREATE:"createGroupchat",COMMUNITY_VIEW:"viewMessageInCommunity",COMMUNITY_SEND:"sendMessageToCommunity",COMMUNITY_MANAGE:"manageCommunity",COMMUNITY_CREATE:"createCommunity",MURMUR_VIEW:"viewMessageInMurmur",MURMUR_SEND:"sendMessageToMurmur"}}();try{module.exports=AuthorityInfo}catch(e){}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=Policy.prototype;e.getId=function(){return this._id},e.setId=function(e){null!=e&&"string"==typeof e&&(this._id=e,this._action=Utils.getActionInPolicyId(this._id),this._resource_id=Utils.getResourceIdInPolicyId(this._id),this._room_type=Utils.getRoomTypeInPolicyId(this._id))},e.getAction=function(){return this._action},e.getResourceId=function(){return this._resource_id},e.getRoomType=function(){return this._room_type},e.getTranslations=function(){return this._translations},e.setTranslations=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._translations=new Translations,this._translations.setTranslations(e))}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=Role.prototype;e.getId=function(){return this._id},e.setId=function(e){null!=e&&"string"==typeof e&&(this._id=e)},e.getTranslations=function(){return this._translations},e.setTranslations=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=new Translations;t.setTranslations(e),0!=t.getCount()&&(this._translations=t)}},e.cleanUp=function(){var e=this;e._id=null,e._translations=null}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){Translations.LANG_JA="ja";var e=Translations.prototype;e.getTranslations=function(){return this._translations},e.setTranslations=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=[];Object.keys(e).forEach(function(n){switch(n){case Translations.LANG_JA:t.push({key:e[n]})}}),0!=t.length&&(this._translations=t)}},e.getCount=function(){return this._translations.length},e.cleanUp=function(){var e=this;e._translations=null}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=function(){};e.prototype=ArrayList.prototype,EmotionPointList.prototype=new e;var t=e.prototype,n=EmotionPointList.prototype;n.add=function(e){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==e.getJid)return!1;var o=e.getJid();if(null==o||""==o)return!1;var i=n.getByJid(o);return null!=i?!1:t.add.call(this,e)},n.getByJid=function(e){var t=this;if(null==e||"string"!=typeof e)return null;for(var n=null,o=t._length,i=0;o>i;i++)if(t._array[i].getJid()==e){n=t._array[i];break}return n},n.removeByJid=function(e){var n=this;if(null==e||"string"!=typeof e)return null;for(var o=null,i=n._length,a=0;i>a;a++)if(n._array[a].getJid()==e){o=t.remove.call(this,a);break}return o},n.removeAll=function(){t.removeAll.call(this)}}(),function(){EmotionPointData.prototype=$.extend({},Profile.prototype);var e=EmotionPointData.prototype;e.getJid=function(){return this._jid},e.setJid=function(e){null!=e&&"string"==typeof e&&""!=e&&(this._jid=e)},e.getCreatedAt=function(){return this._created_at},e.setCreatedAt=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&""!=e&&(this._created_at=e)},e.getUpdatedAt=function(){return this._updated_at},e.setUpdatedAt=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&""!=e&&(this._updated_at=e)},e.getEmotionPoint=function(){return this._emotion_point},e.setEmotionPoint=function(e){null!=e&&"number"==typeof e&&""!=e&&(this._emotion_point=e)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){Utils.STANDARD_DATE_FORMAT="{yyyy}/{MM}/{dd} {HH}:{mm}:{ss}",Utils.DISPLAY_STANDARD_DATE_FORMAT="{yyyy}/{MM}/{dd} {HH}:{mm}",Utils.DISPLAY_DATEPICKER_DATE_FORMAT="yy/mm/dd",Utils.DISPLAY_VOTE_END_DATE_FORMAT="{MM}/{dd} {HH}:{mm}",Utils.SERVER_NAME="localhost",Utils.getDate=function(e,t){var n;return n=e?t?Date.create(e).format(t):Date.create().format(e):Date.create().format(Utils.STANDARD_DATE_FORMAT)},Utils.isValidDate=function(e){var t=e.match(/^(\d{4})\/(\d{2})\/(\d{2})\s(\d{2}):(\d{2})$/);return null==t?!1:new Date(e).isValid()},Utils.getRandomNumber=function(e,t){return e+Math.floor(Math.random()*(t-e+1))},Utils.convertPresenceNumToStr=function(e){var t="";if(null==e||"number"!=typeof e)return t;switch(e){case Person.PRESENCE_STATUS_ONLINE:t="chat";break;case Person.PRESENCE_STATUS_AWAY:t="away";break;case Person.PRESENCE_STATUS_EXT_AWAY:t="xa";break;case Person.PRESENCE_STATUS_DO_NOT_DISTURB:t="dnd"}return t},Utils.convertPresenceStrToNum=function(e){var t=Person.PRESENCE_STATUS_OFFLINE;if(null==e||"string"!=typeof e)return t;switch(e){case"chat":t=Person.PRESENCE_STATUS_ONLINE;break;case"away":t=Person.PRESENCE_STATUS_AWAY;break;case"xa":t=Person.PRESENCE_STATUS_EXT_AWAY;break;case"dnd":t=Person.PRESENCE_STATUS_DO_NOT_DISTURB}return t},Utils.convertEscapedHtml=function(e,t){if(null==e||"string"!=typeof e)return"";var n=e;return n=n.replace(/&/g,"&amp;"),n=n.replace(/"/g,"&quot;"),n=n.replace(/'/g,"&#039;"),n=n.replace(/</g,"&lt;"),n=n.replace(/>/g,"&gt;"),n=n.replace(/\t/g,"&#x0009;"),n=n.replace(/ /g,"&nbsp;"),t&&(n=n.replace(/\r\n/g,"<br>"),n=n.replace(/\n|\r/g,"<br>")),n},Utils.convertUnEscapedHtml=function(e,t){if(null==e||"string"!=typeof e)return"";var n=e;return n=n.replace(/&quot;/g,'"'),n=n.replace(/&#039;/g,"'"),n=n.replace(/&lt;/g,"<"),n=n.replace(/&gt;/g,">"),n=n.replace(/&#x0009;/g,"	"),n=n.replace(/&nbsp;/g," "),n=n.replace(/&amp;/g,"&"),t&&(n=n.replace(/<br>/g,"\n")),n},Utils.convertPreEscapedHtml=function(e){if(null==e||"string"!=typeof e)return"";var t=Utils.convertEscapedHtml(e,!0);return t="<pre>"+t+"</pre>"},Utils.stringFormat=function(e,t){return t="object"===("undefined"==typeof t?"undefined":_typeof(t))?t:Array.prototype.slice.call(arguments,1),e.replace(/\{\{|\}\}|\{(\w+)\}/g,function(e,n){return"{{"==e?"{":"}}"==e?"}":t[n]})},Utils.replaceAll=function(e,t,n){return e.split(t).join(n)},Utils.urldecode=function(e){var t="";try{t=decodeURIComponent((e+"").replace(/\+/g,"%20"))}catch(n){console.log("Can't decode str")}return t},Utils.getSafeStringData=function(e){var t="";return null==e||"string"!=typeof e?t:e},Utils.getSafeNumberData=function(e){var t=0;return null==e||"number"!=typeof e?t:e},Utils.getSafeArrayData=function(e){return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))||null==e.length?[]:e},Utils.hasSubString=function(e,t){return null==e||"string"!=typeof e||null==t||"string"!=typeof t?!1:e.indexOf(t)>=0?!0:!1},Utils.hasSubStringWithCaseIgnored=function(e,t){if(null==e||"string"!=typeof e||null==t||"string"!=typeof t)return!1;var n=e.toLowerCase(),o=t.toLowerCase();return Utils.hasSubString(n,o)},Utils.trimString=function(e){return null==e||"string"!=typeof e?"":e.replace(/(^\s+)|(\s+$)/g,"")},Utils.convertArrayListToString=function(e,t){var n="";if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return n;if(null==t||"string"!=typeof t)return n;for(var o=e.getCount(),i=!0,a=0;o>a;a++){var r=e.get(a);i?i=!1:n+=t,n+=r}return n},Utils.convertStringToArrayList=function(e,t){if(null==e||"string"!=typeof e)return null;if(null==t||"string"!=typeof t)return null;for(var n=e.split(t),o=new ArrayList,i=n.length,a=0;i>a;a++){var r=n[a];o.add(r)}return o},Utils.convertStringToArray=function(e,t){if(null==e||"string"!=typeof e)return null;if(null==t||"string"!=typeof t)return null;var n=e.split(t);return n},Utils.trimStringMulutiByteSpace=function(e){return null==e||"string"!=typeof e?"":e.replace(/^[\s]+|[\s]+$/g,"")},Utils.getSafeValue=function(e,t,n){var o=n;return null!=e&&null!=e[t]&&(o=e[t]),o},Utils.getDocumentRootUrl=function(){return location.protocol+"//"+Utils.getDocumentRootUrlWithoutProtocol()},Utils.getDocumentRootUrlWithoutProtocol=function(){var e=location.hostname,t=location.pathname,n=t.lastIndexOf("/"),o=t.substring(n+1,t.length);return e+=0!=o.length?o.lastIndexOf(".")<0?t+"/":t.substring(0,n+1):t},Utils.convertEscapedTag=function(e){if(null==e||"string"!=typeof e)return"";var t=e;return t=t.replace(/&/g,"&amp;"),t=t.replace(/"/g,"&quot;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;")},Utils.excludeControleCharacters=function(e){if(null==e||"string"!=typeof e||""==e)return"";var t=e;return t=t.replace(/[\u0009\u000B\u000C\u001C\u001D\u001E\u001F\u00A0\u2028\u2029]+/g," ")},Utils.ROOMTYPE_GROUPCHAT="room",Utils.ROOMTYPE_COMMUNITY="community";var e={action:1,room_type:2,resource_id:3};Utils.getPolicyIdByActionAndResource=function(e,t){return null==e||"string"!=typeof e||""==e||null==t||"string"!=typeof t||""==t?"":"p_"+e+"_"+t},Utils.getActionInPolicyId=function(t){return Utils.getInfoInPolicyId(t,e.action)},Utils.getRoomTypeInPolicyId=function(t){return Utils.getInfoInPolicyId(t,e.room_type)},Utils.getResourceIdInPolicyId=function(t){return Utils.getInfoInPolicyId(t,e.resource_id)},Utils.getInfoInPolicyId=function(t,n){if(null==t||"string"!=typeof t||""==t)return"";var o=t.split("_");if(o.length<3)return"";switch(n){case e.action:return o[n];case e.room_type:if(o[n]==Utils.ROOMTYPE_GROUPCHAT)return Utils.ROOMTYPE_GROUPCHAT;if(o[n]==Utils.ROOMTYPE_COMMUNITY)return Utils.ROOMTYPE_COMMUNITY;break;case e.resource_id:return o.slice(2).join("_")}return""},Utils.avatarCreate=function(e){var t={name:"",color:""};if("user"===e.type){var n=e.name.replace(/( | |)+/g," ").replace(/^ /,"").replace(/ $/,"");if(e.name)if(n.match(/( | |)/)){var o=n.split(" ");t.name=Array.from(o[0])[0]+Array.from(o[1])[0]}else chars=Array.from(n),t.name=chars[0]+(1<chars.length?chars[1]:""),t.name=Utils.convertEscapedHtml(t.name);else t.name=""}else n=e.name.replace(/( | )+/g,""),chars=Array.from(n),t.name=chars[0];for(var i="",a=0,r=["#e96363","#e98463","#e9a663","#e9c763","#b23333","#b25333","#b27333","#b29233"],s=["#6379e9","#639be9","#63bce9","#63dee9","#3348b2","#3368b2","#3388b2","#33a8b2"],l=["#d32f2f","#C2185B","#7B1FA2","#512DA8","#303F9F","#1976D2","#0288D1","#0097A7","#00796B","#388E3C","#689F38","#AFB42B","#FBC02D","#FFA000","#F57C00","#E64A19"],u=0;u<e.name.length;++u){var c=e.name.charCodeAt(u).toString(8);i+=c}for(var u=0;u<i.length;++u)a=Number(a)+Number(i.substr(u,1));return"user"===e.type?t.color=r[a%8]:"hashtag"===e.type?t.color=l[a%16]:t.color=s[a%8],t}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,n){for(var o=0;o<n.getCount();o++){var i=n.get(o),a={id:i.getId(),jid:i.getJid(),branchNumber:i.getBranchNumber(),mailAddress:i.getMailAddress(),serverId:i.getServerId(),settingInfo:t(i.getSettingInfo()),mailCooperationType:i.getCooperationType()};e[o]=a}}function t(e){var t=e.getType(),n={};switch(t){case AccountSettingInfomation.SERVER_TYPE_POP:n={popServer:{mailAccount:e.getAccount(),mailPassword:e.getPassword()}}}return n}function n(e){for(var t=e.getStartDate(),n=e.getDueDate(),o=(new ArrayList,e.getOptionItems()),i={type:ApiCubee.CONTENT_TYPE_QUESTIONNAIRE,body:encodeURIComponent(e.getMessage()),inputType:e.getInputType(),resultVisible:e.getResultVisible(),graphType:e.getGraphType(),roomType:e.getRoomType(),roomId:e.getRoomId(),optionCount:e.getOptionCount(),optionItems:[],startDate:t,dueDate:n,attachedCount:0,attachedItems:[],context:""},a=0;a<e.getOptionItems()._length;a++){var r=o.get(a);i.optionItems.add({option:encodeURIComponent(r)})}return i.roomType&&"number"!=typeof i.roomType&&(i.roomType=parseInt(i.roomType)),i}function o(e){var t=e.getStartDate(),n="";null!=t&&(n=t.format(Utils.STANDARD_DATE_FORMAT));var o=e.getDueDate(),i="";null!=o&&(i=o.format(Utils.STANDARD_DATE_FORMAT));var a={type:ApiCubee.CONTENT_TYPE_TASK,title:encodeURIComponent(e.getTitle()),body:encodeURIComponent(e.getMessage()),progress:e.getProgress(),spentTime:e.getSpentTime(),estimatedTime:e.getEstimatedTime(),remainingTime:e.getRemainingTime(),goal:encodeURIComponent(e.getGoal()),alert:e.getAlert(),parentItemId:e.getParentItemId(),priority:e.getPriority(),replyId:e.getReferenceMessageItemId(),replyTo:e.getReplyTo(),startDate:n,dueDate:i,owner:e.getOwnerJid(),group:e.getCommunityId(),client:e.getClient(),status:e.getStatus(),attachedCount:0,attachedItems:[],context:""};return""!=e.getQuotationItem()&&1==a.status&&(a.shareItemId=e.getReferenceMessageItemId()),a}function i(e,t){for(var n=t.getMemberList(),o=0;o<n.getCount();o++)e[o]=n.get(o)}function a(e){var t,n=(t={},_defineProperty(t,AuthorityDef.AUTHORITY_ACTIONS.GC_MANAGE,[]),_defineProperty(t,AuthorityDef.AUTHORITY_ACTIONS.GC_SEND,[]),_defineProperty(t,AuthorityDef.AUTHORITY_ACTIONS.GC_VIEW,[]),t),o=e.getMemberListWithData();for(var i in o)n[o[i].action].push(o[i].accountName);return n}function r(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return null;var t=e.type;switch(t){case"and":case"or":for(var n=e.value.length,o=0;n>o;o++)e.value[o]=r(e.value[o]);break;case"not":e.value=r(e.value);break;case"item":break;case"keyword":e.value=encodeURIComponent(e.value)}return e}ApiCubee.API_LOGIN="Login",ApiCubee.API_LOGOUT="Logout",ApiCubee.API_CONTROL_CONNECTION="ControlConnection",ApiCubee.API_GET_PERSON_LIST="GetPersonList",ApiCubee.API_SET_LOGIN_PERSON_DATA="SetLoginPersonData",ApiCubee.API_GET_LOGIN_PERSON_DATA="GetLoginPersonData",ApiCubee.API_GET_USER_PROFILE="GetUserProfile",ApiCubee.API_GET_MESSAGE="GetMessage",ApiCubee.API_SEND_MESSAGE="SendMessage",ApiCubee.API_UPDATE_MESSAGE="UpdateMessage",ApiCubee.API_DELETE_MESSAGE="DeleteMessage",ApiCubee.API_MESSAGE_OPTION="MessageOption",ApiCubee.API_GET_COUNT="GetCount",ApiCubee.API_MURMUR="Murmur",ApiCubee.API_CHANGE_PERSON_DATA="ChangePersonData",ApiCubee.API_NOTIFICATION="Notification",ApiCubee.API_MESSAGE="Message",ApiCubee.API_CREATE_GROUP="CreateGroup",ApiCubee.API_GET_GROUP="GetGroup",ApiCubee.API_ADD_MEMBER="AddMember",ApiCubee.API_UPDATE_MEMBER="UpdateMember",ApiCubee.API_REMOVE_MEMBER="RemoveMember",ApiCubee.API_GET_SERVER_LIST="GetServerList",ApiCubee.API_UPDATE_GROUP="UpdateGroup",ApiCubee.API_THREAD_TITLE="ThreadTitle",ApiCubee.API_UPDATE_NOTE="UpdateNoteInfo",ApiCubee.API_DELETE_NOTE="DeleteNote",ApiCubee.API_GET_RIGHTS="GetRights",ApiCubee.API_GET_ROLE_ASSIGNMENT_FOR_USER="GetRoleAssignmentForUser",ApiCubee.API_CREATE_POLICY="CreatePolicy",ApiCubee.API_CREATE_RIGHTS="CreateRight",ApiCubee.API_ASSIGN_POLISY_TO_USER="AssignPolicyToUsers",ApiCubee.API_GET_USER_POLICIES_BY_RESOURCE="GetUserPoliciesByResource",ApiCubee.API_UNASSIGN_POLICY_FROM_USER="UnassignPolicyFromUser",ApiCubee.API_AUTHORIY_CHANGED="AuthorityDataChanged",ApiCubee.API_UPDATE_THREAD_TITLE="UpdateThreadTitle",ApiCubee.API_GET_THREAD_TITLE_LIST="GetThreadTitles",ApiCubee.API_PUBLIC_GROUP_MEMBER="PublicGroupMember",ApiCubee.API_PUBLIC_GROUP="PublicGroup",ApiCubee.API_PUBLIC_COMMUNITY_MEMBER="PublicCommunityMember",ApiCubee.API_PUBLIC_COMMUNITY="PublicCommunity",ApiCubee.API_USER_FOLLOW="UserFollow",ApiCubee.CONTENT_TYPE_FOLLOWER_LIST="FollowerList",ApiCubee.CONTENT_TYPE_FOLLOWEE_LIST="FolloweeList",ApiCubee.CONTENT_TYPE_CONTACT_LIST="ContactList",ApiCubee.CONTENT_TYPE_PRESENCE="Presence",ApiCubee.CONTENT_TYPE_MY_FEED="MyFeed",ApiCubee.CONTENT_TYPE_CHAT="Chat",ApiCubee.CONTENT_TYPE_PUBLIC="Public",ApiCubee.CONTENT_TYPE_TASK="Task",ApiCubee.CONTENT_TYPE_QUESTIONNAIRE="Questionnaire",ApiCubee.CONTENT_TYPE_ADD_GOOD_JOB="AddGoodJob",ApiCubee.CONTENT_TYPE_UPDATE_SIBLING_TASK="UpdateSiblingTask",ApiCubee.CONTENT_TYPE_SYSTEM="System",ApiCubee.CONTENT_TYPE_PROFILE="Profile",ApiCubee.CONTENT_TYPE_PASSWORD="Password",ApiCubee.CONTENT_TYPE_SEARCH="Search",ApiCubee.CONTENT_TYPE_DELETE="Delete",ApiCubee.CONTENT_TYPE_GROUP_CHAT="GroupChat",ApiCubee.CONTENT_TYPE_GROUP_CHAT_ROOM="GroupChatRoom",ApiCubee.CONTENT_TYPE_GROUP_CHAT_ROOM_LIST="GroupChatRoomList",ApiCubee.CONTENT_TYPE_GROUP_CHAT_ROOM_INFO="GroupChatRoomInfo",ApiCubee.CONTENT_TYPE_MAIL_SERVER="MailServer",ApiCubee.CONTENT_TYPE_MAIL_COOPERATION_SETTING="MailCooperationSetting",ApiCubee.CONTENT_TYPE_MAIL="Mail",ApiCubee.CONTENT_TYPE_MAIL_BODY="MailBody",ApiCubee.CONTENT_TYPE_THREAD="Thread",ApiCubee.CONTENT_TYPE_SWITCH_PROTOCOL="SwitchProtocol",ApiCubee.CONTENT_TYPE_DEMAND_TASK="DemandTask",ApiCubee.CONTENT_TYPE_CLEAR_DEMANDED_TASK="ClearDemandedTask",ApiCubee.CONTENT_TYPE_GET_EXISTING_READER_LIST="GetExistingReaderList",ApiCubee.CONTENT_TYPE_SET_READ_MESSAGE="SetReadMessage",ApiCubee.CONTENT_TYPE_MESSAGE="Message",ApiCubee.CONTENT_TYPE_COMMUNITY_ROOM="CommunityRoom",ApiCubee.CONTENT_TYPE_MY_COMMUNITY_LIST="MyCommunityList",ApiCubee.CONTENT_TYPE_COMMUNITY_INFO="CommunityInfo",ApiCubee.CONTENT_TYPE_COMMUNITY_MEMBER_INFO="CommunityMemberInfo",ApiCubee.CONTENT_TYPE_COMMUNITY_ROOM_INFO="CommunityRoomInfo",ApiCubee.CONTENT_TYPE_COMMUNITY_OWNER="CommunityOwner",
ApiCubee.CONTENT_TYPE_COMMUNITY="Community",ApiCubee.CONTENT_TYPE_PERSON_INFO="PersonInfo",ApiCubee.CONTENT_TYPE_ADD_EMOTIONPOINT="AddEmotionPoint",ApiCubee.CONTENT_TYPE_MURMUR="Murmur",ApiCubee.CONTENT_TYPE_GET_MURMUR_TOTAL="MurmurTotal",ApiCubee.CONTENT_TYPE_MURMUR_RANKING="MurmurRanking",ApiCubee.CONTENT_TYPE_GET_GOODJOB_TOTAL="GetGoodJobTotal",ApiCubee.CONTENT_TYPE_GET_GOODJOB_TOTAL_RANKING="GetGoodJobRanking",ApiCubee.CONTENT_TYPE_GET_THANKS_POINT_TOTAL="GetThanksPointsTotal",ApiCubee.CONTENT_TYPE_GET_THANKS_POINT_RANKING="GetThanksPointsRanking",ApiCubee.CONTENT_TYPE_GET_HASHTAG_RANKING="GetHashtagRanking",ApiCubee.CONTENT_TYPE_GET_MURMUR_COLUMN_NAME="GetColumnName",ApiCubee.CONTENT_TYPE_SET_MURMUR_COLUMN_NAME="SetColumnName",ApiCubee.EXTRAS_SUBTYPE_CHANGE_ROOM_NAME="ChangeRoomName",ApiCubee.EXTRAS_SUBTYPE_CHANGE_ROOM_IMAGE="ChangeImage",ApiCubee.EXTRAS_SUBTYPE_CHANGE_ROOM_PRIVACY_TYPE="ChangePrivacyType",ApiCubee.CONTENT_SUBTYPE_ALL_USERS="AllUsers",ApiCubee.CONTENT_EXTRAS_LOGGED="Logged",ApiCubee.CONTENT_TYPE_KEYWORD="keyword",ApiCubee.CONTENT_SORT_ITEM_LOGIN_ACCOUNT="login_account",ApiCubee.CONTENT_ROOM_MEMBER_JOINING="Joining",ApiCubee.CONTENT_ROOM_MEMBER_WITHDRAW="Withdraw",ApiCubee.CONTENT_GET_MURMUR_TOTAL_LIST="getList",ApiCubee.CONTENT_GET_MURMUR_RANKING_LIST="getList",ApiCubee.CONTENT_GET_PUBLIC_COMM_ROOM_LIST="getRoomList",ApiCubee.CONTENT_GET_PUBLIC_GC_ROOM_LIST="getRoomList",ApiCubee.CONTENT_TYPE_GET_FOLLOWEE_LIST="getFolloweeList",ApiCubee.CONTENT_TYPE_GET_FOLLOWER_LIST="getFollowerList",ApiCubee.CONTENT_TYPE_GET_FOLLOW_INFO="getFollowInfo",ApiCubee.CONTENT_TYPE_ADD_USER_FOLLOW="addUserFollow",ApiCubee.CONTENT_TYPE_DEL_USER_FOLLOW="delUserFollow",ApiCubee.createLoginRequest=function(e,t,n){var o=ApiCubee.API_LOGIN,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a={request:o,id:i,version:1,content:{user:t,password:n,tenantName:e}};return[JSON.stringify(a),i]},ApiCubee.createLogoutRequest=function(e){var t=ApiCubee.API_LOGOUT,n=t+Utils.getRandomNumber(0,Math.pow(2,31)-1),o={accessToken:e,request:t,id:n,version:1,content:{}};return[JSON.stringify(o),n]},ApiCubee.createGetContactListRequest=function(e){var t=ApiCubee.API_GET_PERSON_LIST,n=t+Utils.getRandomNumber(0,Math.pow(2,31)-1),o={accessToken:e,request:t,id:n,version:1,content:{type:ApiCubee.CONTENT_TYPE_CONTACT_LIST}};return[JSON.stringify(o),n]},ApiCubee.createGetServerListRequest=function(e){var t=ApiCubee.API_GET_SERVER_LIST,n=t+Utils.getRandomNumber(0,Math.pow(2,31)-1),o={accessToken:e,request:t,id:n,version:1,content:{type:ApiCubee.CONTENT_TYPE_MAIL_SERVER}};return[JSON.stringify(o),n]},ApiCubee.createGetMailBodyRequest=function(e,t){var n=ApiCubee.API_GET_MESSAGE,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_MAIL_BODY,itemId:t}};return[JSON.stringify(i),o]},ApiCubee.createChangePresenceRequest=function(e,t,n){var o=ApiCubee.API_SET_LOGIN_PERSON_DATA,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a=encodeURIComponent(n),r={accessToken:e,request:o,id:i,version:1,content:{type:ApiCubee.CONTENT_TYPE_PRESENCE,presence:t,myMemo:a}};return[JSON.stringify(r),i]},ApiCubee.createChangeMailCooperationSettingRequest=function(t,n){var o=ApiCubee.API_SET_LOGIN_PERSON_DATA,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a={accessToken:t,request:o,id:i,version:1,content:{type:ApiCubee.CONTENT_TYPE_MAIL_COOPERATION_SETTING,count:n.getCount(),items:[]}};return e(a.content.items,n),[JSON.stringify(a),i]},ApiCubee.createGetPublicMessageRequest=function(e,t,n){var o=ApiCubee.API_GET_MESSAGE,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a={accessToken:e,request:o,id:i,version:1,content:{type:ApiCubee.CONTENT_TYPE_MY_FEED,condition:{},startId:t,count:n}};return[JSON.stringify(a),i]},ApiCubee.createSendChatMessageRequest=function(e,t){var n=ApiCubee.API_SEND_MESSAGE,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i=encodeURIComponent(t.getMessage()),a=encodeURIComponent(t.getThreadTitle()),r={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_CHAT,to:t.getTo(),body:i,replyId:t.getReplyItemId(),replyTo:t.getReplyTo(),attachedCount:0,attachedItems:[],context:"",threadTitle:a}};return null!=t.getBodyType()&&(r.content.bodyType=parseInt(t.getBodyType())),[JSON.stringify(r),o]},ApiCubee.createGetChatMessageRequest=function(e,t,n,o){var i=ApiCubee.API_GET_MESSAGE,a=i+Utils.getRandomNumber(0,Math.pow(2,31)-1),r={accessToken:e,request:i,id:a,version:1,content:{type:ApiCubee.CONTENT_TYPE_CHAT,condition:{partner:t},startId:n,count:o}};return[JSON.stringify(r),a]},ApiCubee.createGetQuestionnaireMessagesRequest=function(e,t,n,o){var i=ApiCubee.API_GET_MESSAGE,a=i+Utils.getRandomNumber(0,Math.pow(2,31)-1),r={accessToken:e,request:i,id:a,version:1,content:{type:ApiCubee.CONTENT_TYPE_QUESTIONNAIRE,startId:t,condition:{sort:o},count:n}};return[JSON.stringify(r),a]},ApiCubee.createSendVoteMessageRequest=function(e,t,n,o){var i=ApiCubee.API_UPDATE_MESSAGE,a=i+Utils.getRandomNumber(0,Math.pow(2,31)-1),r={accessToken:e,request:i,id:a,version:1,content:{type:ApiCubee.CONTENT_TYPE_QUESTIONNAIRE,msgto:t,itemId:n,optionCount:o.getCount(),optionItems:o._array}};return[JSON.stringify(r),a]},ApiCubee.createSendPublicMessageRequest=function(e,t){var n=ApiCubee.API_SEND_MESSAGE,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i=encodeURIComponent(t.getMessage()),a=encodeURIComponent(t.getThreadTitle()),r="";null!=t.getReplyItemId()&&(r=t.getReplyItemId());var s={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_PUBLIC,body:i,replyId:r,attachedCount:0,attachedItems:[],context:"",threadTitle:a}};return null!=t.getBodyType()&&(s.content.bodyType=parseInt(t.getBodyType())),[JSON.stringify(s),o]},ApiCubee.createGetTaskListRequest=function(e,t,n,o,i){var a=ApiCubee.API_GET_MESSAGE,r=a+Utils.getRandomNumber(0,Math.pow(2,31)-1),s={accessToken:e,request:a,id:r,version:1,content:{type:ApiCubee.CONTENT_TYPE_TASK,condition:{filter:t,sort:n},startId:o,count:i}};return[JSON.stringify(s),r]},ApiCubee.createSendQuestionnaireRequest=function(e,t){var o=ApiCubee.API_SEND_MESSAGE,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a={accessToken:e,request:o,id:i,version:1,content:n(t)};return[JSON.stringify(a),i]},ApiCubee.createSendTaskRequest=function(e,t){var n=ApiCubee.API_SEND_MESSAGE,i=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),a={accessToken:e,request:n,id:i,version:1,content:o(t)};return[JSON.stringify(a),i]},ApiCubee.createUpdateTaskRequest=function(e,t){var n=ApiCubee.API_UPDATE_MESSAGE,i=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),a={accessToken:e,request:n,id:i,version:1,content:o(t)};return a.content.itemId=t.getItemId(),[JSON.stringify(a),i]},ApiCubee.createSendGoodJobRequest=function(e,t){var n=ApiCubee.API_MESSAGE_OPTION,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_ADD_GOOD_JOB,itemId:t}};return[JSON.stringify(i),o]},ApiCubee.createChangeProfileRequest=function(e,t){var n=ApiCubee.API_SET_LOGIN_PERSON_DATA,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i=encodeURIComponent(t.getNickName()),a=encodeURIComponent(t.getMailAddress()),r={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_PROFILE,nickName:i,mailAddress:a,avatarType:t.getAvatarType(),avatarData:t.getAvatarData(),group:t.getGroup()}};return[JSON.stringify(r),o]},ApiCubee.createChangeProfileOnlyAvaterRequest=function(e,t){var n=ApiCubee.API_SET_LOGIN_PERSON_DATA,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_PROFILE,avatarType:t.getAvatarType(),avatarData:t.getAvatarData()}};return[JSON.stringify(i),o]},ApiCubee.createChangeLoggedRequest=function(e,t){var n=ApiCubee.API_SET_LOGIN_PERSON_DATA,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_PROFILE,avatarType:t.avatarType,avatarData:t.avatarData,extras:'{"Logged":1}'}};return[JSON.stringify(i),o]},ApiCubee.createChangeExtrasRequest=function(e,t){var n=ApiCubee.API_SET_LOGIN_PERSON_DATA,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_PROFILE,avatarType:LoginUser.getInstance().getAvatarType(),avatarData:LoginUser.getInstance().getAvatarData(),extras:t}};return[JSON.stringify(i),o]},ApiCubee.createGetUserGroupRequest=function(e,t,n,o){var i=ApiCubee.API_GET_PERSON_LIST,a=i+Utils.getRandomNumber(0,Math.pow(2,31)-1),r=encodeURIComponent(t),s={accessToken:e,request:i,id:a,version:1,content:{type:ApiCubee.CONTENT_TYPE_SEARCH,subType:ApiCubee.CONTENT_SUBTYPE_ALL_USERS,condition:{filter:{type:ApiCubee.CONTENT_TYPE_KEYWORD,value:r},sort:{item:ApiCubee.CONTENT_SORT_ITEM_LOGIN_ACCOUNT,order:1}},startId:n,count:o}};return[JSON.stringify(s),a]},ApiCubee.createChangePasswordRequest=function(e,t,n){var o=ApiCubee.API_SET_LOGIN_PERSON_DATA,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a={accessToken:e,request:o,id:i,version:1,content:{type:ApiCubee.CONTENT_TYPE_PASSWORD,oldPassword:t,newPassword:n}};return[JSON.stringify(a),i]},ApiCubee.createSearchMessageRequest=function(e,t,n,o){var i=ApiCubee.API_GET_MESSAGE,a=i+Utils.getRandomNumber(0,Math.pow(2,31)-1),s=o.getFilterCondition(),l=o.getSortCondition(),u={};u.filter=r(s.getJSONObject()),u.sort=l.getJSONObject();var c={accessToken:e,request:i,id:a,version:1,content:{type:ApiCubee.CONTENT_TYPE_SEARCH,condition:u,startId:t,count:n}};return[JSON.stringify(c),a]},ApiCubee.createDeleteMessageRequest=function(e,t,n){var o=ApiCubee.API_DELETE_MESSAGE,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a={accessToken:e,request:o,id:i,version:1,content:{type:ApiCubee.CONTENT_TYPE_DELETE,itemId:n.getItemId(),deleteFlag:t}};return[JSON.stringify(a),i]},ApiCubee.createGetRoomInfoRequest=function(e,t){var n=ApiCubee.API_GET_GROUP,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_GROUP_CHAT_ROOM_INFO,roomId:t}};return[JSON.stringify(i),o]},ApiCubee.createGetRoomInfoListRequest=function(e,t,n,o,i){var a=ApiCubee.API_GET_GROUP,r=a+Utils.getRandomNumber(0,Math.pow(2,31)-1),s={};s.sort=i.getJSONObject();var l={accessToken:e,request:a,id:r,version:1,content:{type:ApiCubee.CONTENT_TYPE_GROUP_CHAT_ROOM_LIST,startId:t,count:n,condition:s}};return o?l.content.parentRoomId=o:"",[JSON.stringify(l),r]},ApiCubee.createGetPublicGroupRoomInfoListRequest=function(e,t,n,o){var i=ApiCubee.API_PUBLIC_GROUP,a=i+Utils.getRandomNumber(0,Math.pow(2,31)-1),r={};r.sort=o.getJSONObject();var s={accessToken:e,request:i,id:a,version:1,content:{type:ApiCubee.CONTENT_GET_PUBLIC_GC_ROOM_LIST,startId:t,count:n,condition:r}};return[JSON.stringify(s),a]},ApiCubee.createAddPublicGroupMemberRequest=function(e,t){var n=ApiCubee.API_PUBLIC_GROUP_MEMBER,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_ROOM_MEMBER_JOINING,roomId:t}};return[JSON.stringify(i),o]},ApiCubee.createDelPublicGroupMemberRequest=function(e,t){var n=ApiCubee.API_PUBLIC_GROUP_MEMBER,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_ROOM_MEMBER_WITHDRAW,roomId:t}};return[JSON.stringify(i),o]},ApiCubee.createGetPublicCommunityRoomInfoListRequest=function(e,t,n,o){var i=ApiCubee.API_PUBLIC_COMMUNITY,a=i+Utils.getRandomNumber(0,Math.pow(2,31)-1),r={};r.sort=o.getJSONObject();var s={accessToken:e,request:i,id:a,version:1,content:{type:ApiCubee.CONTENT_GET_PUBLIC_COMM_ROOM_LIST,startId:t,count:n,condition:r}};return[JSON.stringify(s),a]},ApiCubee.createAddPublicCommunityMemberRequest=function(e,t){var n=ApiCubee.API_PUBLIC_COMMUNITY_MEMBER,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_ROOM_MEMBER_JOINING,roomId:t}};return[JSON.stringify(i),o]},ApiCubee.createDelPublicCommunityMemberRequest=function(e,t){var n=ApiCubee.API_PUBLIC_COMMUNITY_MEMBER,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_ROOM_MEMBER_WITHDRAW,roomId:t}};return[JSON.stringify(i),o]},ApiCubee.createCreateChatRoomRequest=function(e,t){var n=ApiCubee.API_CREATE_GROUP,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),r=a(t),s={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_GROUP_CHAT_ROOM,roomName:encodeURIComponent(t.getRoomName()),parentRoomId:encodeURIComponent(t.getParentRoomId()),memberCount:t.getMemberList().getCount(),memberItems:[],manageGroupchat:r[AuthorityDef.AUTHORITY_ACTIONS.GC_MANAGE],sendMessageToGroupchat:r[AuthorityDef.AUTHORITY_ACTIONS.GC_SEND],viewMessageInGroupchat:r[AuthorityDef.AUTHORITY_ACTIONS.GC_VIEW]}};return i(s.content.memberItems,t),[JSON.stringify(s),o]},ApiCubee.createSendGroupChatMessageRequest=function(e,t){var n=ApiCubee.API_SEND_MESSAGE,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i=encodeURIComponent(t.getMessage()),a=encodeURIComponent(t.getThreadTitle()),r={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_GROUP_CHAT,roomId:t.getTo(),body:i,replyId:t.getReplyItemId(),replyTo:t.getReplyTo(),attachedCount:0,attachedItems:[],context:"",threadTitle:a}};return null!=t.getBodyType()&&(r.content.bodyType=parseInt(t.getBodyType())),[JSON.stringify(r),o]},ApiCubee.createAddGroupChatRoomMemberRequest=function(e,t,n){var o=ApiCubee.API_ADD_MEMBER,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a=n.getCount();if(1!=a)return null;var r=Utils.convertArrayListToString(n,",");if(""==r)return null;var s={accessToken:e,request:o,id:i,version:1,content:{type:ApiCubee.CONTENT_TYPE_GROUP_CHAT_ROOM,roomId:t,member:r}};return[JSON.stringify(s),i]},ApiCubee.createUpdateChatRoomInfoRequest=function(e,t){var n=ApiCubee.API_UPDATE_GROUP,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_GROUP_CHAT_ROOM_INFO,extras:{subType:[ApiCubee.EXTRAS_SUBTYPE_CHANGE_ROOM_NAME,ApiCubee.EXTRAS_SUBTYPE_CHANGE_ROOM_PRIVACY_TYPE]},roomId:t.getRoomId(),roomName:encodeURIComponent(t.getRoomName()),privacyType:t.getPrivacyType()}};return[JSON.stringify(i),o]},ApiCubee.createRemoveChatRoomMemberRequest=function(e,t,n,o){for(var i=ApiCubee.API_REMOVE_MEMBER,a=i+Utils.getRandomNumber(0,Math.pow(2,31)-1),r=[],s=n.getCount(),l=0;s>l;l++)r.push(n.get(l));var u={accessToken:e,request:i,id:a,version:1,content:{type:ApiCubee.CONTENT_TYPE_GROUP_CHAT_ROOM,removeType:o,roomId:t,count:r.length,members:r}};return[JSON.stringify(u),a]},ApiCubee.createGetCountRequest=function(e,t,n){var o=ApiCubee.API_GET_COUNT,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a={};a.filter=r(n.getJSONObject());var s={accessToken:e,request:o,id:i,version:1,content:{type:t,condition:a}};return[JSON.stringify(s),i]},ApiCubee.createGetThreadMessageRequest=function(e,t){var n=ApiCubee.API_GET_MESSAGE,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_THREAD,itemId:t}};return[JSON.stringify(i),o]},ApiCubee.createSwitchProtocolRequest=function(e){var t=ApiCubee.API_CONTROL_CONNECTION,n=t+Utils.getRandomNumber(0,Math.pow(2,31)-1),o={accessToken:e,request:t,id:n,version:1,content:{type:ApiCubee.CONTENT_TYPE_SWITCH_PROTOCOL}};return[JSON.stringify(o),n]},ApiCubee.createGetLoginUserInfoRequest=function(e){var t=ApiCubee.API_GET_LOGIN_PERSON_DATA,n=t+Utils.getRandomNumber(0,Math.pow(2,31)-1),o={accessToken:e,request:t,id:n,version:1,content:{}};return[JSON.stringify(o),n]},ApiCubee.createDemandTaskRequest=function(e,t){var n=ApiCubee.API_MESSAGE_OPTION,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_DEMAND_TASK,itemId:t,clearCondition:""}};return[JSON.stringify(i),o]},ApiCubee.createClearDemandTaskRequest=function(e,t){var n=ApiCubee.API_MESSAGE_OPTION,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_CLEAR_DEMANDED_TASK,itemId:t}};return[JSON.stringify(i),o]},ApiCubee.createGetExistingReaderListRequest=function(e,t){var n=ApiCubee.API_MESSAGE_OPTION,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_GET_EXISTING_READER_LIST,itemId:t}};return[JSON.stringify(i),o]},ApiCubee.createSetReadMessageRequest=function(e,t){for(var n=ApiCubee.API_MESSAGE_OPTION,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i=t.getCount(),a={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_SET_READ_MESSAGE,itemCount:i,items:[]}},r=0;i>r;r++){var s={};s.itemId=t.get(r),a.content.items.push(s)}return[JSON.stringify(a),o]},ApiCubee.createCreateCommunityRequest=function(e,t){var n=ApiCubee.API_CREATE_GROUP,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_COMMUNITY_ROOM,roomName:encodeURIComponent(t.getRoomName()),description:encodeURIComponent(t.getDescription()),privacyType:t.getPrivacyType(),memberEntryType:t.getMemberEntryType(),logoUrl:t.getLogoUrl()}};return[JSON.stringify(i),o]},ApiCubee.createGetJoinedCommunityInfoListRequest=function(e,t,n,o){var i=ApiCubee.API_GET_GROUP,a=i+Utils.getRandomNumber(0,Math.pow(2,31)-1),r={};r.sort=o.getJSONObject();var s={accessToken:e,request:i,id:a,version:1,content:{type:ApiCubee.CONTENT_TYPE_MY_COMMUNITY_LIST,startId:t,count:n,condition:r}};return[JSON.stringify(s),a]},ApiCubee.createGetCommunityInfoRequest=function(e,t){var n=ApiCubee.API_GET_GROUP,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_COMMUNITY_INFO,roomId:t}};return[JSON.stringify(i),o]},ApiCubee.createGetCommunityMemberInfoRequest=function(e,t){var n=ApiCubee.API_GET_GROUP,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_COMMUNITY_MEMBER_INFO,roomId:t}};return[JSON.stringify(i),o]},ApiCubee.createUpdateCommunityRequest=function(e,t){var n=ApiCubee.API_UPDATE_GROUP,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_COMMUNITY_ROOM_INFO,roomId:t.getRoomId(),roomName:encodeURIComponent(t.getRoomName()),description:encodeURIComponent(t.getDescription()),privacyType:t.getPrivacyType(),memberEntryType:t.getMemberEntryType(),logoUrl:t.getLogoUrl()}};return[JSON.stringify(i),o]},ApiCubee.createAddCommunityMemberRequest=function(e,t,n){for(var o=ApiCubee.API_ADD_MEMBER,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a=[],r=n.getCount(),s=0;r>s;s++)a.push(n.get(s));var l={accessToken:e,request:o,id:i,version:1,content:{type:ApiCubee.CONTENT_TYPE_COMMUNITY_ROOM,roomId:t,count:a.length,members:a}};return[JSON.stringify(l),i]},ApiCubee.createUpdateCommunityOwnerRequest=function(e,t,n){for(var o=ApiCubee.API_UPDATE_MEMBER,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a=[],r=n.getCount(),s=0;r>s;s++)a.push(n.get(s));var l={accessToken:e,request:o,id:i,version:1,content:{type:ApiCubee.CONTENT_TYPE_COMMUNITY_OWNER,roomId:t,ownerCount:a.length,ownerItems:a}};return[JSON.stringify(l),i]},ApiCubee.createRemoveCommunityMemberRequest=function(e,t,n){for(var o=ApiCubee.API_REMOVE_MEMBER,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a=[],r=n.getCount(),s=0;r>s;s++)a.push(n.get(s));var l={accessToken:e,request:o,id:i,version:1,content:{type:ApiCubee.CONTENT_TYPE_COMMUNITY_ROOM,roomId:t,count:a.length,members:a}};return[JSON.stringify(l),i]},ApiCubee.createSendCommunityMessageRequest=function(e,t){var n=ApiCubee.API_SEND_MESSAGE,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i=encodeURIComponent(t.getMessage()),a=encodeURIComponent(t.getThreadTitle()),r={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_COMMUNITY,roomId:t.getTo(),body:i,replyId:t.getReplyItemId(),replyTo:t.getReplyTo(),attachedCount:0,attachedItems:[],context:"",threadTitle:a}};return null!=t.getBodyType()&&(r.content.bodyType=parseInt(t.getBodyType())),[JSON.stringify(r),o]},ApiCubee.createSendMurmurMessageRequest=function(e,t){var n=ApiCubee.API_SEND_MESSAGE,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i=encodeURIComponent(t.getMessage()),a=encodeURIComponent(t.getThreadTitle()),r={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_MURMUR,body:i,replyId:t.getReplyItemId(),replyTo:t.getReplyTo(),attachedCount:0,attachedItems:[],context:"",threadTitle:a}};return null!=t.getBodyType()&&("string"==typeof t.getBodyType()&&t.getBodyType().match(/^\d+$/)||"number"==typeof t.getBodyType())&&(r.content.bodyType=parseInt(t.getBodyType())),[JSON.stringify(r),o]},ApiCubee.createAddContactListMemberRequest=function(e,t){for(var n=ApiCubee.API_ADD_MEMBER,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i=[],a=t.getCount(),r=0;a>r;r++)i.push({jid:t.get(r).jid,contactListGroup:t.get(r).contactListGroup});var s={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_CONTACT_LIST,count:i.length,members:i}};return[JSON.stringify(s),o]},ApiCubee.createRemoveContactListMemberRequest=function(e,t){for(var n=ApiCubee.API_REMOVE_MEMBER,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i=[],a=t.getCount(),r=0;a>r;r++)i.push({jid:t.get(r).jid});var s={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_CONTACT_LIST,count:i.length,members:i}};return[JSON.stringify(s),o]},ApiCubee.createSearchPersonRequest=function(e,t,n,o){var i=ApiCubee.API_GET_PERSON_LIST,a=i+Utils.getRandomNumber(0,Math.pow(2,31)-1),s=o.getFilterCondition(),l=o.getSortCondition(),u={};u.filter=r(s.getJSONObject()),u.sort=l.getJSONObject();var c={accessToken:e,request:i,id:a,version:1,content:{type:ApiCubee.CONTENT_TYPE_SEARCH,subType:ApiCubee.CONTENT_SUBTYPE_ALL_USERS,condition:u,startId:t,count:n}};return[JSON.stringify(c),a]},ApiCubee.getRights=function(e,t){var n=ApiCubee.API_GET_RIGHTS+Utils.getRandomNumber(0,Math.pow(2,31)-1),o={accessToken:e,request:ApiCubee.API_GET_RIGHTS,id:n,version:1,content:{user_id:t}};return[JSON.stringify(o),n]},ApiCubee.getRoleAssignmentForUser=function(e,t){var n=ApiCubee.API_GET_ROLE_ASSIGNMENT_FOR_USER+Utils.getRandomNumber(0,Math.pow(2,31)-1),o={accessToken:e,request:ApiCubee.API_GET_ROLE_ASSIGNMENT_FOR_USER,id:n,version:1,content:{user_id:t}};return[JSON.stringify(o),n]},ApiCubee.createPolicy=function(e,t,n,o,i){var a=ApiCubee.API_CREATE_POLICY+Utils.getRandomNumber(0,Math.pow(2,31)-1),r={accessToken:e,request:ApiCubee.API_CREATE_POLICY,id:a,version:1,content:{user_id:t,policy_id:n,policy_tid:o,translations:i}};return[JSON.stringify(r),a]},ApiCubee.createRight=function(e,t,n,o){var i=ApiCubee.API_CREATE_RIGHTS+Utils.getRandomNumber(0,Math.pow(2,31)-1),a={accessToken:e,request:ApiCubee.API_CREATE_RIGHTS,id:i,version:1,content:{policy_id:t,action:n,resource:o,enable_flag:!0}};return[JSON.stringify(a),i]},ApiCubee.assignPolicyToUser=function(e,t,n){var o=ApiCubee.API_ASSIGN_POLISY_TO_USER+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:ApiCubee.API_ASSIGN_POLISY_TO_USER,id:o,version:1,content:{policy_id:t,users:n}};return[JSON.stringify(i),o]},ApiCubee.getUserPoliciesByResource=function(e,t){var n=ApiCubee.API_GET_USER_POLICIES_BY_RESOURCE+Utils.getRandomNumber(0,Math.pow(2,31)-1),o={accessToken:e,request:ApiCubee.API_GET_USER_POLICIES_BY_RESOURCE,id:n,version:1,content:{resource_id:t}};return[JSON.stringify(o),n]},ApiCubee.unassignPolicyFromUser=function(e,t,n){var o=ApiCubee.API_UNASSIGN_POLICY_FROM_USER+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:ApiCubee.API_UNASSIGN_POLICY_FROM_USER,id:o,version:1,content:{users:t,policy_id:n}};return[JSON.stringify(i),o]},ApiCubee.updateThreadTitle=function(e,t,n){var o=ApiCubee.API_UPDATE_THREAD_TITLE+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={};switch(t.getType()){case Message.TYPE_PUBLIC:i.type="Public";break;case Message.TYPE_CHAT:i.type="Chat",i.msgto=t.getTo();break;case Message.TYPE_COMMUNITY:i.type="Community",i.roomId=t.getTo();break;case Message.TYPE_GROUP_CHAT:i.type="GroupChat",i.roomId=t.getTo();break;case Message.TYPE_MURMUR:i.type="Murmur",i.msgto=t.getTo()}i.threadTitle=encodeURIComponent(n),i.threadRootId=t.getThreadRootId(),i.itemId=t.getItemId();var a={accessToken:e,request:ApiCubee.API_UPDATE_THREAD_TITLE,id:o,version:1,content:i};return[JSON.stringify(a),o]},ApiCubee.getThreadTitleList=function(e,t){var n=ApiCubee.API_GET_THREAD_TITLE_LIST+Utils.getRandomNumber(0,Math.pow(2,31)-1),o={};switch(t.getColumnType()){case ColumnInformation.TYPE_COLUMN_TIMELINE:o.type="Public";break;case ColumnInformation.TYPE_COLUMN_CHAT:o.type="Chat",o.msgto=t.getFilterCondition();break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:o.type="Community",o.roomId=t.getCommunityInfomation().getRoomId();break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:o.type="GroupChat",o.roomId=t.getChatRoomInfomation().getRoomId();break;case ColumnInformation.TYPE_COLUMN_RECENT:o.type="all";break;case ColumnInformation.TYPE_COLUMN_MURMUR:o.type="Murmur";var i=MurmurColumnInformation.getOwnJidFromSearchCondition(t);o.msgto=i}var a={accessToken:e,request:ApiCubee.API_GET_THREAD_TITLE_LIST,id:n,version:1,content:o};return[JSON.stringify(a),n]},ApiCubee.updateMessage=function(e,t,n){var o=ApiCubee.API_GET_THREAD_TITLE_LIST+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={};switch(n.getType()){case Message.TYPE_PUBLIC:i.type="Public";break;case Message.TYPE_CHAT:i.type="Chat";break;case Message.TYPE_COMMUNITY:i.type="Community",i.roomId=n.getTo();break;case Message.TYPE_GROUP_CHAT:i.type="GroupChat",i.roomId=n.getTo();break;case Message.TYPE_MURMUR:i.type="Murmur"}i.itemId=n.getItemId(),i.body=encodeURIComponent(t);var a={accessToken:e,request:ApiCubee.API_UPDATE_MESSAGE,id:o,version:1,content:i};return[JSON.stringify(a),o]},ApiCubee.sendQuoteMessage=function(e,t){var n=ApiCubee.API_SEND_MESSAGE+Utils.getRandomNumber(0,Math.pow(2,31)-1),o={};switch(t.type){case Message.TYPE_PUBLIC:o.type="Public";break;case Message.TYPE_CHAT:o.type="Chat",o.to=t.sendto;break;case Message.TYPE_COMMUNITY:o.type="Community",o.roomId=t.sendto;break;case Message.TYPE_GROUP_CHAT:o.type="GroupChat",o.roomId=t.sendto;break;case Message.TYPE_Murmur:o.type="Murmur",o.to=t.sendto}o.shareItemId=t.quotationItemId,o.body=encodeURIComponent(t.body);var i={accessToken:e,request:ApiCubee.API_SEND_MESSAGE,id:n,version:1,content:o};return[JSON.stringify(i),n]},ApiCubee.createSendEmotionPointRequest=function(e,t,n){var o=ApiCubee.API_MESSAGE_OPTION,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a={accessToken:e,request:o,id:i,version:1,content:{type:ApiCubee.CONTENT_TYPE_ADD_EMOTIONPOINT,itemId:t,emotionPoint:n}};return[JSON.stringify(a),i]},ApiCubee.getGoodJobTotal=function(e,t,n){var o=ApiCubee.API_MESSAGE_OPTION,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a=new Date,r=a.getFullYear(),s=("00"+(a.getMonth()+1)).slice(-2),l=("00"+a.getDate()).slice(-2),u=r+"/"+s+"/"+l,c={accessToken:e,request:o,id:i,version:1,content:{type:ApiCubee.CONTENT_TYPE_GET_GOODJOB_TOTAL,jid:t,dateTo:u}};return n&&(c.content.dateFrom=n),[JSON.stringify(c),i]},ApiCubee.getThanksPointsTotal=function(e,t,n){var o=ApiCubee.API_MESSAGE_OPTION,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a=new Date,r=a.getFullYear(),s=("00"+(a.getMonth()+1)).slice(-2),l=("00"+a.getDate()).slice(-2),u=r+"/"+s+"/"+l,c={accessToken:e,request:o,id:i,version:1,content:{type:ApiCubee.CONTENT_TYPE_GET_THANKS_POINT_TOTAL,jid:t,dateTo:u}};return n&&(c.content.dateFrom=n),[JSON.stringify(c),i]},ApiCubee.getGoodJobRanking=function(e,t,n,o,i){var a=ApiCubee.API_MESSAGE_OPTION,r=a+Utils.getRandomNumber(0,Math.pow(2,31)-1),s=new Date,l=s.getFullYear(),u=("00"+(s.getMonth()+1)).slice(-2),c=("00"+s.getDate()).slice(-2),d=l+"/"+u+"/"+c,g={accessToken:e,request:a,id:r,version:1,content:{type:ApiCubee.CONTENT_TYPE_GET_GOODJOB_TOTAL_RANKING,dateFrom:t,dateTo:d,rankBottom:n,offset:o,limit:i}};return[JSON.stringify(g),r]},ApiCubee.getThanksPointsRanking=function(e,t,n,o,i){var a=ApiCubee.API_MESSAGE_OPTION,r=a+Utils.getRandomNumber(0,Math.pow(2,31)-1),s=new Date,l=s.getFullYear(),u=("00"+(s.getMonth()+1)).slice(-2),c=("00"+s.getDate()).slice(-2),d=l+"/"+u+"/"+c,g={accessToken:e,request:a,id:r,version:1,content:{type:ApiCubee.CONTENT_TYPE_GET_THANKS_POINT_RANKING,dateFrom:t,dateTo:d,rankBottom:n,offset:o,limit:i}};return[JSON.stringify(g),r]},ApiCubee.getHashtagRanking=function(e,t,n,o,i,a,r){var s=ApiCubee.API_MESSAGE_OPTION,l=s+Utils.getRandomNumber(0,Math.pow(2,31)-1),u={accessToken:e,request:s,id:l,version:1,content:{type:ApiCubee.CONTENT_TYPE_GET_HASHTAG_RANKING,msgTo:t,dateFrom:n,dateTo:o,rankBottom:i,offset:a,limit:r}};return[JSON.stringify(u),l]},ApiCubee.getMurmurTotal=function(e,t,n){var o=ApiCubee.CONTENT_TYPE_GET_MURMUR_TOTAL,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a=new Date,r=a.getFullYear(),s=("00"+(a.getMonth()+1)).slice(-2),l=("00"+a.getDate()).slice(-2),u=r+"/"+s+"/"+l,c={accessToken:e,request:o,id:i,version:0,content:{type:ApiCubee.CONTENT_GET_MURMUR_TOTAL_LIST,jid:t,dateFrom:n,dateTo:u}};return[JSON.stringify(c),i]},ApiCubee.getMurmurRanking=function(e,t,n,o,i){var a=ApiCubee.CONTENT_TYPE_MURMUR_RANKING,r=a+Utils.getRandomNumber(0,Math.pow(2,31)-1),s=new Date,l=s.getFullYear(),u=("00"+(s.getMonth()+1)).slice(-2),c=("00"+s.getDate()).slice(-2),d=l+"/"+u+"/"+c,g={accessToken:e,request:a,id:r,version:0,content:{type:ApiCubee.CONTENT_GET_MURMUR_RANKING_LIST,dateFrom:t,dateTo:d,rankBottom:n,offset:o,limit:i}};return[JSON.stringify(g),r]},ApiCubee.getGroupList=function(e){var t=ApiCubee.API_GET_USER_PROFILE,n=t+Utils.getRandomNumber(0,Math.pow(2,31)-1),o={accessToken:e,request:t,id:n,version:1,content:{type:"getAffiliationList"}};return[JSON.stringify(o),n]},ApiCubee.getFolloweeList=function(e,t){var n=ApiCubee.API_USER_FOLLOW,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_GET_FOLLOWEE_LIST,jid:t}};return[JSON.stringify(i),o]},ApiCubee.getFollowerList=function(e,t){var n=ApiCubee.API_USER_FOLLOW,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_GET_FOLLOWER_LIST,jid:t}};return[JSON.stringify(i),o]},ApiCubee.getFollowInfo=function(e,t){var n=ApiCubee.API_USER_FOLLOW,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_GET_FOLLOW_INFO,jid:t}};return[JSON.stringify(i),o]},ApiCubee.addUserFollow=function(e,t){var n=ApiCubee.API_USER_FOLLOW,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_ADD_USER_FOLLOW,followeeJid:t}};return[JSON.stringify(i),o]},ApiCubee.delUserFollow=function(e,t){var n=ApiCubee.API_USER_FOLLOW,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_DEL_USER_FOLLOW,followeeJid:t}};return[JSON.stringify(i),o]},ApiCubee.getMurmurColumnName=function(e,t){var n=ApiCubee.API_MURMUR,o=n+Utils.getRandomNumber(0,Math.pow(2,31)-1),i={accessToken:e,request:n,id:o,version:1,content:{type:ApiCubee.CONTENT_TYPE_GET_MURMUR_COLUMN_NAME,jid:t}};return[JSON.stringify(i),o]},ApiCubee.setMurmurColumnName=function(e,t,n){var o=ApiCubee.API_MURMUR,i=o+Utils.getRandomNumber(0,Math.pow(2,31)-1),a={accessToken:e,request:o,id:i,version:1,content:{type:ApiCubee.CONTENT_TYPE_SET_MURMUR_COLUMN_NAME,jid:t,columnName:n}};return[JSON.stringify(a),i]}}(),function(){var e=SocketIoConnector.prototype;e.connect=function(e,t,n,o,i,a){var r=this;return null==e||"string"!=typeof e?!1:null==t||"number"!=typeof t?!1:null==n||"function"!=typeof n?!1:null==o||"function"!=typeof o?!1:null==i||"function"!=typeof i?!1:null==a||"function"!=typeof a?!1:(null!=r._socket,setTimeout(function(){r._onConnectCallBack=n,
r._onDisconnectCallBack=o,r._onErrorCallBack=i,r._onMessageReceivedCallback=a,r._socket=io.connect(location.protocol+"//"+e+":"+t+"/",{transports:["websocket","xhr-polling"],reconnectionAttempts:10}),r._socket.socket&&(r._socket.socket.redoTransports=!0),r._socket.on("connect",function(e){console.log("connected"),null!=r&&null!=r._onConnectCallBack&&r._onConnectCallBack()}),r._socket.on("message",function(e){console.log(e),null!=r&&null!=r._onMessageReceivedCallback&&r._onMessageReceivedCallback(e)}),r._socket.on("XMPP server disconnect",function(e){console.log("disconnected"),delete r._socket,null!=r&&null!=r._onDisconnectCallBack&&r._onDisconnectCallBack(),r._onConnectCallBack=null,r._onDisconnectCallBack=null,r._onErrorCallBack=null,r._onMessageReceivedCallback=null}),r._socket.on("disconnect",function(){console.log("socket.io disconnected")}),r._socket.on("error",function(e){console.log("error : "+e),null!=r&&null!=r._onErrorCallBack&&r._onErrorCallBack(e)}),r._socket.on("reconnect_failed",function(){console.log("reconnect failed"),delete r._socket,null!=r&&null!=r._onDisconnectCallBack&&r._onDisconnectCallBack(),r._onConnectCallBack=null,r._onDisconnectCallBack=null,r._onErrorCallBack=null,r._onMessageReceivedCallback=null}),r._socket.on("connect_failed",function(){console.log("connect failed"),delete r._socket,null!=r&&null!=r._onDisconnectCallBack&&r._onDisconnectCallBack(),r._onConnectCallBack=null,r._onDisconnectCallBack=null,r._onErrorCallBack=null,r._onMessageReceivedCallback=null}),r._socket.on("reconnecting",function(){console.log("reconnecting...")})},1),!0)},e.disconnect=function(){var e=this;null!=e._socket&&e._socket.disconnect(),e._onConnectCallBack=null,e._onDisconnectCallBack=null,e._onErrorCallBack=null,e._onMessageReceivedCallback=null},e.sendData=function(e){var t=this;return null!=t._socket?(t._socket.send(e),!0):!1}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){null!=e._serverConnector&&delete e._serverConnector,e._xmppServerHostName="",e._user="",e._password="",e._onConnectCallBack=null,e._onDisconnectCallBack=null,e._onErrorCallBack=null,e._onProfileChangedNotifyCallback=null,e._onMessageReceivedCallback=null,e._onNotificationCallback=null,e._onLoginWizardCallback=null,e._nickName=null,e._isLogined=!1,e._callBacks={},e._accessToken="",e._jid="",e._loginStatus=CubeeServerConnector._LOGIN_STATUS_TYPE_NO_LOGIN}function t(e){for(var t=e.content,n=Utils.getSafeArrayData(t.items),o=n.length,i=new ContactList,a=0;o>a;a++){var r=n[a],s=new Person;s.setJid(Utils.getSafeStringData(r.jid));var l=Utils.getSafeStringData(r.nickName);""==l&&(l=Utils.getSafeStringData(r.userName)),l=Utils.urldecode(l),s.setUserName(l);for(var u=Utils.getSafeArrayData(r.groupItems),c=[],d=0;d<u.length;d++)c.push(Utils.urldecode(u[d]));s.setGroup(c),s.setPresence(Utils.getSafeNumberData(r.presence)),s.setMyMemo(Utils.urldecode(Utils.getSafeStringData(r.myMemo))),s.setAvatarType(Utils.getSafeStringData(r.avatarType)),s.setAvatarData(Utils.getSafeStringData(r.avatarData)),s.setLoginAccount(Utils.getSafeStringData(r.userName)),s.setStatus(Utils.getSafeNumberData(r.status)),i.add(s)}return i}function n(e,t){var n=new LoginUser,o=t.userInfo;null==o&&Le(e,"LoginError"),n.setJid(o.jid),e._jid=n.getJid();var i=Utils.getSafeStringData(o.nickName);""==i&&(i=Utils.getSafeStringData(o.name)),i=Utils.urldecode(i),n.setUserName(i),n.setLoginAccount(o.name);var a=Utils.getSafeStringData(o.mailAddress);a=Utils.urldecode(a),n.setMailAddress(a),null!=o.avatarType&&n.setAvatarType(o.avatarType),null!=o.avatarData&&n.setAvatarData(o.avatarData),n.setLoginAccount(Utils.getSafeStringData(o.name)),n.setStatus(Utils.getSafeNumberData(o.status));var r=Utils.getSafeNumberData(o.mailCooperationCount),s=Utils.getSafeArrayData(o.mailCooperationItems);null==s&&Le(e,"LoginError");for(var l=new UserSettings,u=0;r>u;u++){var c=new MailCooperationInformation,d=s[u];c.setId(Utils.getSafeNumberData(d.id)),c.setServerId(Utils.getSafeNumberData(d.serverId)),c.setJid(Utils.getSafeStringData(d.jid)),c.setMailAddress(Utils.getSafeStringData(d.mailAddress)),c.setBranchNumber(Utils.getSafeNumberData(d.branchNumber)),c.setCooperationType(Utils.getSafeNumberData(d.mailCooperationType));var g=d.settingInfo;null==g&&Le(e,"LoginError");var m=g.popServer;if(null!=m){var _=new PopSettingInfomation;_.setAccount(Utils.getSafeStringData(m.mailAccount)),_.setPassword(Utils.getSafeStringData(m.mailPassword)),c.setSettingInfo(_)}l.getMailCooperationList().add(c)}return n.setTenantInfo(t.tenantInfo),n.setSettings(l),n}function o(e,o,i,a){function r(t){if(0!=t.errorCode||null==t.content||0==t.content.result)return void Le(e,"GetChatGroupListError");var n=t.accessToken;if(null==n)return void Le(e,"GetChatGroupListError");var o=t.content.items[0].groupCount;if(0==parseInt(o)){var i=new ContactList;return C.setContactList(i),void e._onLoginWizardCallback(C)}var a=t.content.items[0],r=a.groupItems[0],l=Utils.getSafeStringData(r);l=Utils.urldecode(l);var u=ApiCubee.createGetUserGroupRequest(e._accessToken,l,0,Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST")),c=u[0];if(null==c||""==c)return void Le(e,"GetChatGroupListError");var d=u[1];setTimeout(function(){Re(e,c,d,s)},1)}function s(n){if(0!=n.errorCode||null==n.content||0==n.content.result)return void Le(e,"_onGetChatUserList");var o=t(n);C.setContactList(o),e._isLogined=!0,e._loginStatus=CubeeServerConnector._LOGIN_STATUS_TYPE_LOGINED,e._onLoginWizardCallback(C)}function l(t){if(0!=t.errorCode||null==t.content||0==t.content.result)return void Le(e,"LoggedUserInfoError");var n=t.accessToken;if(null==n)return void Le(e,"LoggedUserInfoError");var o=t.content.extras;if(o)try{o=JSON.parse(o)}catch(i){o={}}LoginUser.getInstance().setExtras(o);var a=C.getLoginUserPerson().getLoginAccount(),s=ApiCubee.createGetUserGroupRequest(e._accessToken,a,0,1),l=s[0];if(null==l||""==l)return void Le(e,"LoggedUserInfoError");var u=s[1];setTimeout(function(){Re(e,l,u,r)},1)}function u(t){if(0!=t.errorCode||null==t.content)return void Le(e,"GetLoginPersonData Error");var n=t.content.accessToken;if(null==n)return void Le(e,"GetLoginPersonData Error");var o=t.content;if(0==o.result)return void Le(e,"GetLoginPersonData Error");if(y=o.userInfo,null==y)return void Le(e,"GetLoginPersonData Error");var i=t.content.userInfo.extras;if(i)try{i=JSON.parse(i)}catch(a){i={}}LoginUser.getInstance().setExtras(i),LoginTicket.read()?ViewUtils.wizard_overlayClose():i.Logged&&1==i.Logged?ViewUtils.wizard_overlayClose():(v=!0,LoginUser.getInstance().setFirstLogin()),m(t)}function c(t,n){var o=ApiCubee.createChangeLoggedRequest(t,n),i=o[0],a=o[1];setTimeout(function(){Re(e,i,a,l)},1)}function d(n){if(0!=n.errorCode||null==n.content||0==n.content.result)return void Le(e,"_onGetContactListError");var o=t(n);C.setContactList(o),e._isLogined=!0,e._loginStatus=CubeeServerConnector._LOGIN_STATUS_TYPE_LOGINED,e._onConnectCallBack(C)&&v&&c(e._accessToken,y)}function g(t){if(0!=t.errorCode||null==t.content||0==t.content.result)return void Le(e,"_onGetFollowList 1");var n=t.accessToken;if(null==n)return void Le(e,"_onGetFollowList 2");var o=C.getLoginUserPerson().getJid();Promise.all([e.getFolloweeList(o),e.getFollowerList(o)]).then(function(e){e[0]&&LoginUser.getInstance().setFolloweeList(e[0]),e[1]&&LoginUser.getInstance().setFollowerList(e[1]),d(t)})["catch"](function(t){Le(e,"_onGetFollowList 3 "+JSON.stringify(t))})}function m(t){if(0!=t.errorCode||null==t.content)return void Le(e,"_onGetLoginUserInfo Error");var n=t.content;if(0==n.result&&4==n.reason)return void Le(e,"_onGetLoginUserInfo Error");var o=ApiCubee.createGetContactListRequest(e._accessToken),i=o[0];if(null==i||""==i)return void Le(e,"_onGetLoginUserInfo Error");var a=o[1];setTimeout(function(){Re(e,i,a,g)},1)}function _(t){if(0!=t.errorCode||null==t.content)return void Le(e,"LoginError");var o=t.content;if(0==o.result&&4==o.reason)return void Le(e,"Not Authorized");var i=t.content.accessToken;if(null==i)return void Le(e,"LoginError");e._isLogined=!0,e._loginStatus=CubeeServerConnector._LOGIN_STATUS_TYPE_LOGINED,e._accessToken=i;var a=n(e,o);C.setLoginUserPerson(a);var r=ApiCubee.createGetLoginUserInfoRequest(e._accessToken),s=r[0];if(null==s||""==s)return void Le(e,"LoginError");var l=r[1];setTimeout(function(){Re(e,s,l,u)},1)}if(e._loginStatus!=CubeeServerConnector._LOGIN_STATUS_TYPE_CONNECTING)return void console.log("CubeeServerConnector - _onConnected - Maybe Reconnected");e._loginStatus=CubeeServerConnector._LOGIN_STATUS_TYPE_CONNECTED;var f=ApiCubee.createLoginRequest(o,i,a),p=f[0];if(null==p||""==p)return void Le(e,"LoginError");var h=f[1],C=new ConnectReceiveData,v=!1,y=null;setTimeout(function(){Re(e,p,h,_)},1)}function i(e){function o(n){if(0!=n.errorCode||null==n.content||0==n.content.result)return void Le(e,"SkipLoginError");var o=t(n);u.setContactList(o),e._isLogined=!0,e._loginStatus=CubeeServerConnector._LOGIN_STATUS_TYPE_LOGINED,setTimeout(function(){e._onConnectCallBack(u)},1)}function i(t){if(0!=t.errorCode||null==t.content)return void Le(e,"SkipLoginError");var i=t.content;if(0==i.result&&4==i.reason)return void Le(e,"Not Authorized");var a=n(e,i);u.setLoginUserPerson(a);var r=ApiCubee.createGetContactListRequest(e._accessToken),s=r[0];if(null==s||""==s)return void Le(e,"SkipLoginError");var l=r[1];setTimeout(function(){Re(e,s,l,o)},1)}function a(t){if(0!=t.errorCode||null==t.content)return void Le(e,"Failed Switch Protocol");var n=t.content;if(0==n.result&&4==n.reason)return void Le(e,"Not Authorized");var o=ApiCubee.createGetLoginUserInfoRequest(e._accessToken),a=o[0];if(null==a||""==a)return void Le(e,"SkipLoginError");var r=o[1];setTimeout(function(){Re(e,a,r,i)},1)}if(e._loginStatus!=CubeeServerConnector._LOGIN_STATUS_TYPE_CONNECTING)return console.log("CubeeServerConnector - _onConnected - Maybe Reconnected"),void Le(e,"SkipLoginError");e._loginStatus=CubeeServerConnector._LOGIN_STATUS_TYPE_CONNECTED;var r=ApiCubee.createSwitchProtocolRequest(e._accessToken),s=r[0];if(null==s||""==s)return void Le(e,"SkipLoginError");var l=r[1],u=new ConnectReceiveData;setTimeout(function(){Re(e,s,l,a)},1)}function a(e,t){var n=t.content;if(null==n)return void console.log("_content is null");switch(n.type){case ApiCubee.CONTENT_TYPE_PRESENCE:r(e,n);break;case ApiCubee.CONTENT_TYPE_PROFILE:s(e,n);break;default:console.log("_content.type is invalid")}}function r(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=new PresenceChangeNotice;r.setJid(Utils.getSafeStringData(a.jid)),r.setPresence(Utils.getSafeNumberData(a.presence));var s=Utils.urldecode(Utils.getSafeStringData(a.myMemo));r.setMyMemo(s),l(e,r)}}function s(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=new Profile,s=Utils.urldecode(Utils.getSafeStringData(a.nickName));r.setNickName(s);var u=Utils.urldecode(Utils.getSafeStringData(a.mailAddress));if(r.setMailAddress(u),r.setAvatarType(Utils.getSafeStringData(a.avatarType)),r.setAvatarData(Utils.getSafeStringData(a.avatarData)),a.group.length<=5)for(var c=0;c<a.group.length;c++)a.group[c]=Utils.urldecode(Utils.getSafeStringData(a.group[c]));r.setGroup(a.group);var d=new ProfileChangeData;d.setProfile(r),d.setJid(Utils.getSafeStringData(a.jid)),d.setUpdateTime(Utils.getSafeStringData(a.updateTime)),l(e,d)}}function l(e,t){e._onProfileChangedNotifyCallback(t)}function u(e,t){var n=t.content;if(null==n)return void console.log("_content is null");switch(n.type){case ApiCubee.CONTENT_TYPE_CHAT:c(e,n);break;default:console.log("_content.type is invalid")}}function c(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=new ChatMessage;r.setFrom(Utils.getSafeStringData(a.from)),r.setTo(Utils.getSafeStringData(a.to));var s=Utils.urldecode(Utils.getSafeStringData(a.body));r.setMessage(s),r.setDirection(ChatMessage.DIRECTION_RECEIVE),r.setHistory(!1);var l=new ChatNotification;l.setChatMessage(r),e._onNotificationCallback(l)}}function d(e,t){var n=t.content;if(null==n)return void console.log("_content is null");var o=0;if(n.extras&&n.extras.subType){o=n.extras.subType;var i=[ApiCubee.CONTENT_TYPE_CHAT,ApiCubee.CONTENT_TYPE_PUBLIC,ApiCubee.CONTENT_TYPE_GROUP_CHAT,ApiCubee.CONTENT_TYPE_COMMUNITY,ApiCubee.CONTENT_TYPE_MURMUR];if(n.type&&i.includes(n.type)&&o==MessageUpdateNotification.ACTION_TYPE_UPDATE)return void Se(e,n)}switch(n.type){case ApiCubee.CONTENT_TYPE_CHAT:g(e,n);break;case ApiCubee.CONTENT_TYPE_PUBLIC:m(e,n);break;case ApiCubee.CONTENT_TYPE_TASK:f(e,n);break;case ApiCubee.CONTENT_TYPE_SYSTEM:p(e,n);break;case ApiCubee.CONTENT_TYPE_DELETE:h(e,n);break;case ApiCubee.CONTENT_TYPE_GROUP_CHAT:C(e,n);break;case ApiCubee.CONTENT_TYPE_MAIL:v(e,n);break;case ApiCubee.CONTENT_TYPE_COMMUNITY:y(e,n);break;case ApiCubee.CONTENT_TYPE_QUESTIONNAIRE:_(e,n);break;case ApiCubee.CONTENT_TYPE_MURMUR:T(e,n);break;default:console.log("_content.type is invalid")}}function g(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=I(e,a);b(e,r)}}function m(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=I(e,a);b(e,r)}}function _(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");var n=Utils.getSafeArrayData(t.items);if(null==t.extras)return void console.log("questionnaire message notify :: extras is null.");for(var o=n.length,i=0;o>i;i++){var a=n[i],r=I(e,a),s=new QuestionnaireNotification;s.setQuestionnaireMessage(r);for(var l=QuestionnaireNotification.ACTION_TYPE_ADD,u=(r.getFrom(),0);u<r.getOptionCount();u++)if(r.getOptionItems()._array[u].optionValue>0){l=QuestionnaireNotification.ACTION_TYPE_UPDATE;break}s.setActionType(l),e._onNotificationCallback(s)}}function f(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");var n=Utils.getSafeArrayData(t.items);if(null==t.extras)return void console.log("task message notify :: extras is null.");var o=Utils.getSafeNumberData(t.extras.subType);if(0==o)return void console.log("task message notify :: subType is 0.");for(var i=n.length,a=0;i>a;a++){var r=n[a],s=I(e,r),l=new TaskNotification;switch(l.setTaskMessage(s),o){case 1:l.setActionType(TaskNotification.ACTION_TYPE_ADD);break;case 2:l.setActionType(TaskNotification.ACTION_TYPE_UPDATE);break;default:return void console.log("task message notify :: subType is invalid.")}e._onNotificationCallback(l)}}function p(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=I(e,a),s=new SystemNotification;s.setSystemMessage(r),e._onNotificationCallback(s)}}function h(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=we(a),s=Ne(a),l=Ae(a),u=new DeleteMessageNotification;u.setItemId(r),u.setDeleteFlag(s),u.setAdminDeleted(l),e._onNotificationCallback(u)}}function C(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=I(e,a),s=new ChatRoomInformation;s.setRoomId(r.getTo()),s.setParentRoomId(r.getParentRoomId()),s.setRoomName(r.getRoomName());var l=new GroupChatMessageNotification;l.setRoomInfo(s),l.setGroupChatMessage(r),e._onNotificationCallback(l)}}function v(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=I(e,a),s=new MailMessageNotification;s.setMailMessage(r),e._onNotificationCallback(s)}}function y(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=I(e,a),s=new CommunityMessageNotification;s.setCommunityMessage(r),e._onNotificationCallback(s)}}function T(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=I(e,a),s=new MurmurMessageNotification;s.setMurmurMessage(r),e._onNotificationCallback(s)}}function b(e,t){e._onMessageReceivedCallback(t)}function I(e,t){if(null==t)return null;var n=t.type,o=null;switch(n){case Message.TYPE_PUBLIC:o=w(t);break;case Message.TYPE_CHAT:o=U(e,t);break;case Message.TYPE_GROUP_CHAT:o=L(e,t);break;case Message.TYPE_TASK:o=A(t);break;case Message.TYPE_COMMUNITY:o=D(e,t);break;case Message.TYPE_SYSTEM:o=k(t);break;case Message.TYPE_MAIL:o=O(t);break;case Message.TYPE_QUESTIONNAIRE:o=N(t);break;case Message.TYPE_MURMUR:o=V(e,t);break;default:console.log("ColumnView::_getHistoryMessage  Unknown type>>>"+n)}return o=M(o,t),o=E(o,t)}function M(e,t){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return null;if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return null;var n=e,o=Utils.getSafeNumberData(t.readFlg);n.setReadFlag(o);var i=x(t);return null!=i&&n.setExistingReaderInfo(i),n}function E(e,t){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return e;if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return e;var n=t.personInfo;if(!n&&"object"!=("undefined"==typeof n?"undefined":_typeof(n)))return e;for(var o in n){var i=n[o];if(i){var a=S(i);a&&e.getProfileMap().add(o,a)}}return e}function S(e){if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return null;var t=new Profile;return t.setNickName(Utils.urldecode(Utils.getSafeStringData(e.nickName))),t.setMailAddress(Utils.urldecode(Utils.getSafeStringData(e.mailAddress))),t.setAvatarType(Utils.getSafeStringData(e.avatarType)),t.setAvatarData(Utils.getSafeStringData(e.avatarData)),t.setLoginAccount(Utils.getSafeStringData(e.userName)),t.setStatus(Utils.getSafeNumberData(e.status)),t}function w(e){var t=new PublicMessage;t.setId(Utils.getSafeNumberData(e.id)),t.setFrom(Utils.getSafeStringData(e.from)),t.setMessage(Utils.urldecode(Utils.getSafeStringData(e.body))),t.setDate(Utils.getDate(Utils.getSafeStringData(e.createdAt),Utils.STANDARD_DATE_FORMAT)),t.setUpdatedAt(e.updatedAt?Utils.getSafeStringData(Date.create(e.updatedAt).format(Utils.STANDARD_DATE_FORMAT)):""),t.setItemId(Utils.getSafeStringData(e.itemId)),t.setPublishNode(Utils.getSafeStringData(e.nodeName)),t.setReplyItemId(Utils.getSafeStringData(e.replyId)),t.setReplyTo(Utils.getSafeStringData(e.replyTo)),t.setDeleteFlag(Utils.getSafeNumberData(e.deleteFlag)),t.setThreadTitle(Utils.urldecode(Utils.getSafeStringData(e.threadTitle))),t.setThreadRootId(Utils.getSafeStringData(e.threadRootId)),e.noteCount&&e.noteItems.length&&(t.setNoteTitle(Utils.urldecode(Utils.getSafeStringData(e.noteItems[0].noteTitle))),t.setNoteUrl(Utils.getSafeStringData(e.noteItems[0].noteUrl))),t.setBodyType(Utils.getSafeNumberData(e.bodyType));for(var n=Utils.getSafeArrayData(e.goodJobItems),o=n.length,i=0;o>i;i++){var a=n[i],r=G(a);null!=r&&t.getGoodJobList().add(r)}var s={},l=e.emotionPointIcons?e.emotionPointIcons:{};0==Object.keys(l).length&&LoginUser.getInstance().getTenantInfo().emotionPointBasicIcon&&(l=LoginUser.getInstance().getTenantInfo().emotionPointBasicIcon);for(var u in l)s[u]=Utils.urldecode(l[u]);t.setEmotionIconList(s);for(var c=Utils.getSafeArrayData(e.emotionPointItems),d=c.length,i=0;d>i;i++){var g=c[i],m=B(g);null!=m&&t.getEmotionPointList().add(m)}for(var _=Utils.getSafeArrayData(e.shortenItems),f=_.length,p=new ArrayList,i=0;f>i;i++){var h=new ShortenURLInfo;null!=h&&(h.setDisplayedURL(Utils.urldecode(_[i].DisplayedURL)),h.setShortenPath(Utils.urldecode(_[i].ShortenPath)),h.setOriginalURL(Utils.urldecode(_[i].OriginalURL)),p.add(h))}return t.setUIShortenUrls(p),t}function N(e){var t=new QuestionnaireMessage;t.setId(Utils.getSafeNumberData(e.id)),t.setItemId(Utils.getSafeStringData(e.itemId)),t.setFrom(Utils.getSafeStringData(e.from)),t.setMessage(Utils.urldecode(Utils.getSafeStringData(e.body))),t.setInputType(Utils.getSafeNumberData(e.inputType)),t.setResultVisible(Utils.getSafeNumberData(e.resultVisible)),t.setGraphType(Utils.getSafeNumberData(e.graphType)),t.setRoomType(Utils.getSafeStringData(e.roomType)),t.setRoomId(Utils.getSafeStringData(e.roomId)),t.setRoomName(Utils.urldecode(Utils.getSafeStringData(e.roomName))),t.setParentRoomId(Utils.getSafeStringData(e.parentRoomId)),t.setDate(e.createdAt),t.setVoteFlag(!!e.voteFlag),t.setStartDate(e.startDate),t.setDueDate(e.dueDate),t.setOptionCount(Utils.getSafeNumberData(e.optionCount));for(var n=new ArrayList,o=0;o<e.optionCount;o++){var i=e.optionItems[o],a=Utils.urldecode(Utils.getSafeStringData(i.option)),r=new Object;r.option=a,r.optionId=i.optionId,r.optionValue=i.optionValue,n.add(r)}t.setOptionItems(n),t.setDeleteFlag(Utils.getSafeNumberData(e.deleteFlag)),""!=Utils.getSafeStringData(e.startDate)&&t.setStartDate(new Date(Utils.getSafeStringData(e.startDate))),""!=Utils.getSafeStringData(e.dueDate)&&t.setDueDate(new Date(Utils.getSafeStringData(e.dueDate)));for(var s=Utils.getSafeArrayData(e.goodJobItems),l=s.length,u=0;l>u;u++){var c=s[u],d=G(c);null!=d&&t.getGoodJobList().add(d)}return E(t,e),t}function A(e){var t=new TaskMessage;t.setId(Utils.getSafeNumberData(e.id)),t.setItemId(Utils.getSafeStringData(e.itemId)),t.setFrom(Utils.getSafeStringData(e.from)),t.setTitle(Utils.urldecode(Utils.getSafeStringData(e.title))),t.setMessage(Utils.urldecode(Utils.getSafeStringData(e.body))),t.setProgress(Utils.getSafeNumberData(e.progress)),t.setSpentTime(Utils.getSafeNumberData(e.spentTime)),t.setEstimatedTime(Utils.getSafeNumberData(e.estimatedTime)),t.setRemainingTime(Utils.getSafeNumberData(e.remainingTime)),t.setGoal(Utils.urldecode(Utils.getSafeStringData(e.goal))),t.setAlert(Utils.getSafeNumberData(e.alert)),t.setParentItemId(Utils.getSafeStringData(e.parentItemId)),t.setPriority(Utils.getSafeNumberData(e.priority)),t.setDate(Utils.getSafeStringData(e.createdAt)),t.setReferenceMessageItemId(Utils.getSafeStringData(e.replyId)),t.setReplyTo(Utils.getSafeStringData(e.replyTo)),t.setDeleteFlag(Utils.getSafeNumberData(e.deleteFlag)),""!=Utils.getSafeStringData(e.startDate)&&t.setStartDate(new Date(Utils.getSafeStringData(e.startDate))),""!=Utils.getSafeStringData(e.dueDate)&&t.setDueDate(new Date(Utils.getSafeStringData(e.dueDate))),""!=Utils.getSafeStringData(e.completeDate)&&t.setCompleteDate(new Date(Utils.getSafeStringData(e.completeDate))),t.setOwnerJid(Utils.getSafeStringData(e.owner)),t.setCommunityId(Utils.getSafeStringData(e.group)),t.setCommunityName(Utils.urldecode(Utils.getSafeStringData(e.groupName))),t.setClient(Utils.getSafeStringData(e.client)),t.setStatus(Utils.getSafeNumberData(e.status)),""!=Utils.getSafeStringData(e.updatedAt)&&t.setUpdatedAt(new Date(Utils.getSafeStringData(e.updatedAt))),t.setUpdatedBy(Utils.getSafeStringData(e.updatedBy));for(var n=Utils.getSafeArrayData(e.goodJobItems),o=n.length,i=0;o>i;i++){var a=n[i],r=G(a);null!=r&&t.getGoodJobList().add(r)}for(var s=Utils.getSafeArrayData(e.shortenItems),l=s.length,u=new ArrayList,i=0;l>i;i++){var c=new ShortenURLInfo;null!=c&&(c.setDisplayedURL(Utils.urldecode(s[i].DisplayedURL)),c.setShortenPath(Utils.urldecode(s[i].ShortenPath)),c.setOriginalURL(Utils.urldecode(s[i].OriginalURL)),u.add(c))}t.setUIShortenUrls(u);for(var d=Utils.getSafeArrayData(e.noteItems),g=d.length,m=0;g>m;m++){var _=d[m],f=Utils.getSafeStringData(_.senderJid),p=Utils.getSafeStringData(_.date),h=Utils.urldecode(Utils.getSafeStringData(_.body)),C=new TaskNoteData;C.setJid(f),""!=p&&C.setDate(new Date(p)),C.setMessage(Utils.urldecode(h)),t.getNoteArray().add(C)}for(var v=Utils.getSafeArrayData(e.reminderItems),y=v.length,m=0;y>m;m++){v[m]}for(var T=Utils.getSafeArrayData(e.siblingItems),b=T.length,m=0;b>m;m++){var I=T[m],M=Utils.getSafeStringData(I.siblingItemId),S=Utils.getSafeStringData(I.ownerJid),w=Utils.getSafeNumberData(I.status),N=Utils.urldecode(Utils.getSafeStringData(I.nickName)),A=Utils.getSafeStringData(I.avatarType),U=Utils.getSafeStringData(I.avatarData),L=Utils.getSafeStringData(I.userName),O=Utils.getSafeNumberData(I.userStatus),P=new SiblingTaskData;P.setItemId(t.getItemId()),P.setSiblingItemId(M),P.setSiblingOwnerJid(S),P.setSiblingTaskStatus(w),P.setNickName(N),P.setAvatarType(A),P.setAvatarData(U),P.setLoginAccount(L),P.setStatus(O),t.getSiblingTaskDataList().add(P)}return""==t.getClient()&&t.setClient(t.getOwnerJid()),t.setDemandStatus(Utils.getSafeNumberData(e.demandStatus)),""!=Utils.getSafeStringData(e.demandDate)&&t.setCompleteDate(new Date(Utils.getSafeStringData(e.demandDate))),null!=e.quotation&&Object.keys(e.quotation).length&&t.setQuotationItem(R(e.quotation)),E(t,e),t}function U(e,t){var n=new ChatMessage;n.setId(Utils.getSafeNumberData(t.id)),n.setItemId(Utils.getSafeStringData(t.itemId)),n.setFrom(Utils.getSafeStringData(t.from)),n.setTo(Utils.getSafeStringData(t.to)),n.setMessage(Utils.urldecode(Utils.getSafeStringData(t.body))),n.setDate(Utils.getSafeStringData(t.createdAt)),n.setUpdatedAt(t.updatedAt?Utils.getSafeStringData(Date.create(t.updatedAt).format(Utils.STANDARD_DATE_FORMAT)):""),n.setReplyItemId(Utils.getSafeStringData(t.replyId)),n.setReplyTo(Utils.getSafeStringData(t.replyTo)),n.setDeleteFlag(Utils.getSafeNumberData(t.deleteFlag)),n.setThreadTitle(Utils.urldecode(Utils.getSafeStringData(t.threadTitle))),n.setThreadRootId(Utils.getSafeStringData(t.threadRootId)),t.noteCount&&t.noteItems.length&&(n.setNoteTitle(Utils.urldecode(Utils.getSafeStringData(t.noteItems[0].noteTitle))),n.setNoteUrl(Utils.getSafeStringData(t.noteItems[0].noteUrl))),n.setBodyType(Utils.getSafeNumberData(t.bodyType));for(var o=Utils.getSafeArrayData(t.goodJobItems),i=o.length,a=0;i>a;a++){var r=o[a],s=G(r);null!=s&&n.getGoodJobList().add(s)}var l={},u=t.emotionPointIcons?t.emotionPointIcons:{};0==Object.keys(u).length&&LoginUser.getInstance().getTenantInfo().emotionPointBasicIcon&&(u=LoginUser.getInstance().getTenantInfo().emotionPointBasicIcon);for(var c in u)l[c]=Utils.urldecode(u[c]);n.setEmotionIconList(l);for(var d=Utils.getSafeArrayData(t.emotionPointItems),g=d.length,a=0;g>a;a++){var m=d[a],_=B(m);null!=_&&n.getEmotionPointList().add(_)}for(var f=Utils.getSafeArrayData(t.shortenItems),p=f.length,h=new ArrayList,a=0;p>a;a++){var C=new ShortenURLInfo;null!=C&&(C.setDisplayedURL(Utils.urldecode(f[a].DisplayedURL)),C.setShortenPath(Utils.urldecode(f[a].ShortenPath)),C.setOriginalURL(Utils.urldecode(f[a].OriginalURL)),h.add(C))}n.setUIShortenUrls(h);var v=e._jid;return v==n.getFrom()?n.setDirection(ChatMessage.DIRECTION_SEND):n.setDirection(ChatMessage.DIRECTION_RECEIVE),null!=t.quotation&&Object.keys(t.quotation).length&&n.setQuotationItem(R(t.quotation)),n}function L(e,t){var n=new GroupChatMessage;n.setId(Utils.getSafeNumberData(t.id)),n.setItemId(Utils.getSafeStringData(t.itemId)),n.setFrom(Utils.getSafeStringData(t.from)),n.setTo(Utils.getSafeStringData(t.to)),n.setParentRoomId(Utils.urldecode(Utils.getSafeStringData(t.parentRoomId))),n.setRoomName(Utils.urldecode(Utils.getSafeStringData(t.roomName))),n.setMessage(Utils.urldecode(Utils.getSafeStringData(t.body))),n.setDate(Utils.getSafeStringData(t.createdAt)),n.setUpdatedAt(t.updatedAt?Utils.getSafeStringData(Date.create(t.updatedAt).format(Utils.STANDARD_DATE_FORMAT)):""),n.setReplyItemId(Utils.getSafeStringData(t.replyId)),n.setReplyTo(Utils.getSafeStringData(t.replyTo)),n.setDeleteFlag(Utils.getSafeNumberData(t.deleteFlag)),n.setThreadTitle(Utils.urldecode(Utils.getSafeStringData(t.threadTitle))),n.setThreadRootId(Utils.getSafeStringData(t.threadRootId)),t.noteCount&&t.noteItems.length&&(n.setNoteTitle(Utils.urldecode(Utils.getSafeStringData(t.noteItems[0].noteTitle))),n.setNoteUrl(Utils.getSafeStringData(t.noteItems[0].noteUrl))),n.setBodyType(Utils.getSafeNumberData(t.bodyType));for(var o=Utils.getSafeArrayData(t.goodJobItems),i=o.length,a=0;i>a;a++){var r=o[a],s=G(r);null!=s&&n.getGoodJobList().add(s)}var l={},u=t.emotionPointIcons?t.emotionPointIcons:{};0==Object.keys(u).length&&LoginUser.getInstance().getTenantInfo().emotionPointBasicIcon&&(u=LoginUser.getInstance().getTenantInfo().emotionPointBasicIcon);for(var c in u)l[c]=Utils.urldecode(u[c]);n.setEmotionIconList(l);for(var d=Utils.getSafeArrayData(t.emotionPointItems),g=d.length,a=0;g>a;a++){var m=d[a],_=B(m);null!=_&&n.getEmotionPointList().add(_)}for(var f=Utils.getSafeArrayData(t.shortenItems),p=f.length,h=new ArrayList,a=0;p>a;a++){var C=new ShortenURLInfo;null!=C&&(C.setDisplayedURL(Utils.urldecode(f[a].DisplayedURL)),C.setShortenPath(Utils.urldecode(f[a].ShortenPath)),C.setOriginalURL(Utils.urldecode(f[a].OriginalURL)),h.add(C))}n.setUIShortenUrls(h);var v=e._jid;return v==n.getFrom()?n.setDirection(ChatMessage.DIRECTION_SEND):n.setDirection(ChatMessage.DIRECTION_RECEIVE),null!=t.quotation&&Object.keys(t.quotation).length&&n.setQuotationItem(R(t.quotation)),n}function R(e){var t="";switch(e.msgtype){case Message.TYPE_PUBLIC:t=new PublicMessage;break;case Message.TYPE_CHAT:t=new ChatMessage;break;case Message.TYPE_GROUP_CHAT:t=new GroupChatMessage;break;case Message.TYPE_COMMUNITY:t=new CommunityMessage;break;case Message.TYPE_MURMUR:t=new MurmurMessage;break;default:return}t.setId(Utils.getSafeNumberData(e.id)),t.setItemId(Utils.getSafeStringData(e.shareItemId)),t.setMessage(Utils.urldecode(Utils.getSafeStringData(e.body))),t.setDate(Utils.getSafeStringData(e.createdAt)),t.setUpdatedAt(e.updatedAt?Utils.getSafeStringData(Date.create(e.updatedAt).format(Utils.STANDARD_DATE_FORMAT)):""),e.msgfrom&&t.setFrom(Utils.getSafeStringData(e.msgfrom));for(var n=Utils.getSafeArrayData(e.shortenItems),o=n.length,i=new ArrayList,a=0;o>a;a++){var r=new ShortenURLInfo;null!=r&&(r.setDisplayedURL(Utils.urldecode(n[a].DisplayedURL)),r.setShortenPath(Utils.urldecode(n[a].ShortenPath)),r.setOriginalURL(Utils.urldecode(n[a].OriginalURL)),i.add(r))}return t.setUIShortenUrls(i),t=E(t,e)}function O(e){var t=new MailMessage;t.setId(Utils.getSafeNumberData(e.id)),t.setItemId(Utils.getSafeStringData(e.itemId)),t.setFrom(Utils.getSafeStringData(e.from)),t.setTo(Utils.getSafeStringData(e.to)),t.setMessage(Utils.urldecode(Utils.getSafeStringData(e.body))),t.setDate(Utils.getSafeStringData(e.createdAt)),t.setPriority(Utils.getSafeNumberData(e.priority)),t.setMailMessageId(Utils.getSafeStringData(e.mailMessageId)),t.setMailInReplyTo(Utils.getSafeStringData(e.mailInReplyTo)),t.setReplyItemId(Utils.getSafeStringData(e.replyId)),t.setDeleteFlag(Utils.getSafeNumberData(e.deleteFlag));for(var n=Utils.getSafeArrayData(e.goodJobItems),o=n.length,i=0;o>i;i++){var a=n[i],r=G(a);null!=r&&t.getGoodJobList().add(r)}return t}function P(e){var t=new MailBody;return t.setId(Utils.getSafeNumberData(e.id)),t.setItemId(Utils.getSafeStringData(e.itemId)),t.setJid(Utils.getSafeStringData(e.jid)),t.setBody(Utils.urldecode(Utils.getSafeStringData(e.mailBody))),t}function k(e){var t=new SystemMessage;t.setId(Utils.getSafeNumberData(e.id)),t.setItemId(Utils.getSafeStringData(e.itemId)),t.setFrom(Utils.getSafeStringData(e.from)),t.setMessage(Utils.urldecode(Utils.getSafeStringData(e.body))),t.setTriggerAction(Utils.getSafeNumberData(e.triggerAction)),t.setDate(Utils.getSafeStringData(e.createdAt)),t.setReplyItemId(Utils.getSafeStringData(e.replyId)),t.setReplyTo(Utils.getSafeStringData(e.replyTo)),t.setDeleteFlag(Utils.getSafeNumberData(e.deleteFlag));
for(var n=Utils.getSafeArrayData(e.goodJobItems),o=n.length,i=0;o>i;i++){var a=n[i],r=G(a);null!=r&&t.getGoodJobList().add(r)}for(var s=Utils.getSafeArrayData(e.shortenItems),l=s.length,u=new ArrayList,i=0;l>i;i++){var c=new ShortenURLInfo;null!=c&&(c.setDisplayedURL(Utils.urldecode(s[i].DisplayedURL)),c.setShortenPath(Utils.urldecode(s[i].ShortenPath)),c.setOriginalURL(Utils.urldecode(s[i].OriginalURL)),u.add(c))}return t.setUIShortenUrls(u),t}function D(e,t){var n=new CommunityMessage;n.setId(Utils.getSafeNumberData(t.id)),n.setItemId(Utils.getSafeStringData(t.itemId)),n.setFrom(Utils.getSafeStringData(t.from)),n.setTo(Utils.getSafeStringData(t.to)),n.setRoomName(Utils.urldecode(Utils.getSafeStringData(t.roomName))),n.setMessage(Utils.urldecode(Utils.getSafeStringData(t.body))),n.setDate(Utils.getSafeStringData(t.createdAt)),n.setUpdatedAt(t.updatedAt?Utils.getSafeStringData(Date.create(t.updatedAt).format(Utils.STANDARD_DATE_FORMAT)):""),n.setReplyItemId(Utils.getSafeStringData(t.replyId)),n.setReplyTo(Utils.getSafeStringData(t.replyTo)),n.setDeleteFlag(Utils.getSafeNumberData(t.deleteFlag)),n.setThreadTitle(Utils.urldecode(Utils.getSafeStringData(t.threadTitle))),n.setThreadRootId(Utils.getSafeStringData(t.threadRootId)),t.noteCount&&t.noteItems.length&&(n.setNoteTitle(Utils.urldecode(Utils.getSafeStringData(t.noteItems[0].noteTitle))),n.setNoteUrl(Utils.getSafeStringData(t.noteItems[0].noteUrl))),n.setBodyType(Utils.getSafeNumberData(t.bodyType));for(var o=Utils.getSafeArrayData(t.goodJobItems),i=o.length,a=0;i>a;a++){var r=o[a],s=G(r);null!=s&&n.getGoodJobList().add(s)}var l={},u=t.emotionPointIcons?t.emotionPointIcons:{};0==Object.keys(u).length&&LoginUser.getInstance().getTenantInfo().emotionPointBasicIcon&&(u=LoginUser.getInstance().getTenantInfo().emotionPointBasicIcon);for(var c in u)l[c]=Utils.urldecode(u[c]);n.setEmotionIconList(l);for(var d=Utils.getSafeArrayData(t.emotionPointItems),g=d.length,a=0;g>a;a++){var m=d[a],_=B(m);null!=_&&n.getEmotionPointList().add(_)}for(var f=Utils.getSafeArrayData(t.shortenItems),p=f.length,h=new ArrayList,a=0;p>a;a++){var C=new ShortenURLInfo;null!=C&&(C.setDisplayedURL(Utils.urldecode(f[a].DisplayedURL)),C.setShortenPath(Utils.urldecode(f[a].ShortenPath)),C.setOriginalURL(Utils.urldecode(f[a].OriginalURL)),h.add(C))}n.setUIShortenUrls(h);var v=e._jid;return v==n.getFrom()?n.setDirection(CommunityMessage.DIRECTION_SEND):n.setDirection(CommunityMessage.DIRECTION_RECEIVE),null!=t.quotation&&Object.keys(t.quotation).length&&n.setQuotationItem(R(t.quotation)),n}function V(e,t){var n=new MurmurMessage;n.setId(Utils.getSafeNumberData(t.id)),n.setItemId(Utils.getSafeStringData(t.itemId)),n.setFrom(Utils.getSafeStringData(t.from)),n.setTo(Utils.getSafeStringData(t.to)),n.setMessage(Utils.urldecode(Utils.getSafeStringData(t.body))),n.setDate(Utils.getSafeStringData(t.createdAt)),n.setUpdatedAt(t.updatedAt?Utils.getSafeStringData(Date.create(t.updatedAt).format(Utils.STANDARD_DATE_FORMAT)):""),n.setReplyItemId(Utils.getSafeStringData(t.replyId)),n.setReplyTo(Utils.getSafeStringData(t.replyTo)),n.setDeleteFlag(Utils.getSafeNumberData(t.deleteFlag)),n.setThreadTitle(Utils.urldecode(Utils.getSafeStringData(t.threadTitle))),n.setThreadRootId(Utils.getSafeStringData(t.threadRootId)),n.setColumnName(Utils.getSafeStringData(Utils.urldecode(t.columnName))),t.noteCount&&t.noteItems.length&&(n.setNoteTitle(Utils.urldecode(Utils.getSafeStringData(t.noteItems[0].noteTitle))),n.setNoteUrl(Utils.getSafeStringData(t.noteItems[0].noteUrl))),n.setBodyType(Utils.getSafeNumberData(t.bodyType));for(var o=Utils.getSafeArrayData(t.goodJobItems),i=o.length,a=0;i>a;a++){var r=o[a],s=G(r);null!=s&&n.getGoodJobList().add(s)}var l={},u=t.emotionPointIcons?t.emotionPointIcons:{};0==Object.keys(u).length&&LoginUser.getInstance().getTenantInfo().emotionPointBasicIcon&&(u=LoginUser.getInstance().getTenantInfo().emotionPointBasicIcon);for(var c in u)l[c]=Utils.urldecode(u[c]);n.setEmotionIconList(l);for(var d=Utils.getSafeArrayData(t.emotionPointItems),g=d.length,a=0;g>a;a++){var m=d[a],_=B(m);null!=_&&n.getEmotionPointList().add(_)}for(var f=Utils.getSafeArrayData(t.shortenItems),p=f.length,h=new ArrayList,a=0;p>a;a++){var C=new ShortenURLInfo;null!=C&&(C.setDisplayedURL(Utils.urldecode(f[a].DisplayedURL)),C.setShortenPath(Utils.urldecode(f[a].ShortenPath)),C.setOriginalURL(Utils.urldecode(f[a].OriginalURL)),h.add(C))}n.setUIShortenUrls(h);var v=e._jid;return v==n.getFrom()?n.setDirection(MurmurMessage.DIRECTION_SEND):n.setDirection(MurmurMessage.DIRECTION_RECEIVE),null!=t.quotation&&Object.keys(t.quotation).length&&n.setQuotationItem(R(t.quotation)),n}function x(e){if(null==e)return null;if(void 0==e.readAllCount||void 0==!e.readItems)return null;var t=new MessageExistingReaderInfo;t.setAllCount(Utils.getSafeNumberData(e.readAllCount));for(var n=Utils.getSafeArrayData(e.readItems),o=n.length,i=0;o>i;i++){var a=n[i],r=H(a);null!=r&&t.getExistingReaderItemList().add(r)}return t}function Y(e){if(null==e)return null;if(void 0==e.itemCount||void 0==e.items)return null;var t=new MessageExistingReaderInfo;t.setAllCount(Utils.getSafeNumberData(e.readAllCount));for(var n=Utils.getSafeArrayData(e.items),o=n.length,i=0;o>i;i++){var a=n[i],r=H(a);null!=r&&t.getExistingReaderItemList().add(r)}return t}function F(e){if(null==e)return null;if(void 0==e.itemCount||void 0==e.items)return null;for(var t=new ArrayList,n=Utils.getSafeArrayData(e.items),o=n.length,i=0;o>i;i++){var a=n[i],r=a.itemId;null!=r&&t.add(r)}return t}function H(e){if(null==e)return null;var t=new Person;t.setJid(e.jid),t.setLoginAccount(Utils.getSafeStringData(e.account)),t.setUserName(Utils.urldecode(Utils.getSafeStringData(e.nickName))),t.setAvatarType(Utils.getSafeStringData(e.avatarType)),t.setAvatarData(Utils.getSafeStringData(e.avatarData));var n=new ExistingReaderItem;n.setPerson(t);var o=new Date(Utils.getSafeStringData(e.date));return n.setDate(o),n}function G(e){if(null==e)return null;var t=Utils.urldecode(Utils.getSafeStringData(e.nickName)),n=Utils.getSafeStringData(e.avatarType),o=Utils.getSafeStringData(e.avatarData),i=Utils.getSafeStringData(e.userName),a=Utils.getSafeNumberData(e.status),r=new GoodJobData,s=new Date(Utils.getSafeStringData(e.date));return r.setJid(Utils.getSafeStringData(e.fromJid)),r.setDate(s),r.setNickName(t),r.setAvatarType(n),r.setAvatarData(o),r.setLoginAccount(i),r.setStatus(a),r}function B(e){if(null==e)return null;var t=Utils.urldecode(Utils.getSafeStringData(e.nickName)),n=Utils.getSafeStringData(e.avatarType),o=Utils.getSafeStringData(e.avatarData),i=Utils.getSafeStringData(e.userName),a=Utils.getSafeNumberData(e.status),r=Utils.getSafeNumberData(e.emotionPoint),s=new EmotionPointData,l=new Date(Utils.getSafeStringData(e.createdAt)),u=new Date(Utils.getSafeStringData(e.updatedAt));return s.setJid(Utils.getSafeStringData(e.fromJid)),s.setCreatedAt(l),s.setUpdatedAt(u),s.setNickName(t),s.setAvatarType(n),s.setAvatarData(o),s.setLoginAccount(i),s.setStatus(a),s.setEmotionPoint(r),s}function j(e){var t=new ChatRoomInformation;t.setId(Utils.getSafeNumberData(e.id)),t.setRoomId(Utils.getSafeStringData(e.roomId)),t.setRoomName(Utils.urldecode(Utils.getSafeStringData(e.roomName))),t.setParentRoomId(Utils.getSafeStringData(e.parentRoomId)),t.setCreatedAt(new Date(Utils.getSafeStringData(e.createdAt))),t.setCreatedBy(Utils.getSafeStringData(e.createdBy)),t.setUpdatedAt(new Date(Utils.getSafeStringData(e.updatedAt))),t.setUpdatedBy(Utils.getSafeStringData(e.updatedBy)),t.setOwner(Utils.getSafeStringData(e.updatedBy)),t.setPrivacyType(Utils.getSafeNumberData(e.privacyType));for(var n=Utils.getSafeArrayData(e.memberItems),o=n.length,i=0;o>i;i++){var a=n[i];null!=a&&""!=a&&t.getMemberList().add(a)}var r=t.getProfileMap(),s=e.personInfo;if(s&&"object"==("undefined"==typeof s?"undefined":_typeof(s)))for(var l in s){var u=s[l];if(u){var c=S(u);c&&r.add(l,c)}}return t}function J(e){var t=new MailServerInformation;return t.setId(Utils.getSafeNumberData(e.id)),t.setDisplayName(Utils.urldecode(Utils.getSafeStringData(e.displayName))),t.setServerType(Utils.getSafeNumberData(e.serverType)),t.setCreatedAt(Utils.getSafeStringData(e.createdAt)),t.setCreatedBy(Utils.getSafeStringData(e.createdBy)),t.setUpdatedBy(Utils.getSafeStringData(e.updatedAt)),t.setUpdatedAt(Utils.getSafeStringData(e.updatedBy)),t.setPopHost(Utils.getSafeStringData(e.popHost)),t.setPopPort(Utils.getSafeNumberData(e.popPort)),t.setPopAuthMode(Utils.getSafeNumberData(e.popAuthMode)),t.setPopResponseTimeout(Utils.getSafeNumberData(e.popResponseTimeout)),t}function q(e){if(null==e)return null;var t=new CommunityInfo;return t.setId(Utils.getSafeNumberData(e.id)),t.setRoomId(Utils.getSafeStringData(e.roomId)),t.setRoomName(Utils.urldecode(Utils.getSafeStringData(e.roomName))),t.setDescription(Utils.urldecode(Utils.getSafeStringData(e.description))),t.setMemberCount(Utils.getSafeNumberData(e.memberCount)),t.setPrivacyType(Utils.getSafeNumberData(e.privacyType)),t.setMemberEntryType(Utils.getSafeStringData(e.memberEntryType)),t.setLogoUrl(Utils.getSafeStringData(e.logoUrl)),t.setCreatedAt(new Date(Utils.getSafeStringData(e.createdAt))),t.setCreatedBy(Utils.getSafeStringData(e.createdBy)),t.setUpdatedAt(new Date(Utils.getSafeStringData(e.updatedAt))),t.setUpdatedBy(Utils.getSafeStringData(e.updatedBy)),t}function K(e){if(null==e)return null;var t=new CommunityInfo;t.setId(Utils.getSafeNumberData(e.id)),t.setRoomId(Utils.getSafeStringData(e.roomId)),t.setMemberCount(Utils.getSafeNumberData(e.memberCount));var n=t.getOwnerList(),o=e.memberItems;if(null==o)return null;var i=o.ownerItems;if(null==i)return null;var a=o.generalMemberItems;if(null==a)return null;for(var n=t.getOwnerList(),r=i.length,s=0;r>s;s++){var l=i[s];if(null!=l){var u=W(l);null!=u&&n.add(u)}}var c=t.getGeneralMemberList();r=a.length;for(var s=0;r>s;s++){var d=a[s];if(null!=d){var u=W(d);null!=u&&c.add(u)}}return t}function W(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=new CommunityMember;return n.setRole(Utils.getSafeNumberData(e.role)),n.setJid(Utils.getSafeStringData(e.jid)),n.setLoginAccount(Utils.getSafeStringData(e.userName)),n.setUserName(Utils.urldecode(Utils.getSafeStringData(e.nickName))),n.setAvatarType(Utils.getSafeStringData(e.avatarType)),n.setAvatarData(Utils.getSafeStringData(e.avatarData)),n.setStatus(Utils.getSafeNumberData(e.status)),t=n}function z(e,t){var n=t.content;if(null==n)return void console.log("_content is null");switch(n.type){case ApiCubee.CONTENT_TYPE_ADD_GOOD_JOB:Z(e,n);break;case ApiCubee.CONTENT_TYPE_UPDATE_SIBLING_TASK:te(e,n);break;case ApiCubee.CONTENT_TYPE_DEMAND_TASK:case ApiCubee.CONTENT_TYPE_CLEAR_DEMANDED_TASK:ne(e,n);break;case ApiCubee.CONTENT_TYPE_SET_READ_MESSAGE:ie(e,n);break;case ApiCubee.CONTENT_TYPE_ADD_EMOTIONPOINT:Q(e,n);break;default:console.log("_content.type is invalid")}}function Q(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=X(a);e._onNotificationCallback(r)}}function X(e){var t=e;if(t){var n=Utils.getSafeStringData(t.itemId),o=Utils.getSafeStringData(t.fromJid),i=Utils.urldecode(Utils.getSafeStringData(t.fromName)),a=Utils.getSafeStringData(t.createdAt),r=Utils.getSafeStringData(t.updatedAt),s=Utils.urldecode(Utils.getSafeStringData(t.nickName)),l=Utils.getSafeStringData(t.avatarType),u=Utils.getSafeStringData(t.avatarData),c=Utils.getSafeStringData(t.userName),d=Utils.getSafeNumberData(t.status),g=Utils.getSafeNumberData(t.emotionPoint),m=Utils.urldecode(Utils.getSafeStringData(t.body)),_=Utils.getSafeStringData(t.msgOwnJid),f=Utils.getSafeStringData(t.msgTo),p=Utils.getSafeNumberData(t.msgType),h=new EmotionPointNotification;return h.setItemId(n),h.setFromJid(o),h.setFromName(i),h.setCreatedAt(a),h.setUpdatedAt(r),h.setNickName(s),h.setAvatarType(l),h.setAvatarData(u),h.setLoginAccount(c),h.setStatus(d),h.setEmotionPoint(g),h.setMessage(m),h.setMsgOwnJid(_),h.setMsgTo(f),h.setMsgType(p),h}}function Z(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=ee(a);e._onNotificationCallback(r)}}function ee(e){var t=e;if(t){var n=Utils.getSafeStringData(t.itemId),o=Utils.getSafeStringData(t.fromJid),i=Utils.urldecode(Utils.getSafeStringData(t.fromName)),a=Utils.getSafeStringData(t.date),r=Utils.urldecode(Utils.getSafeStringData(t.nickName)),s=Utils.getSafeStringData(t.avatarType),l=Utils.getSafeStringData(t.avatarData),u=Utils.getSafeStringData(t.userName),c=Utils.getSafeNumberData(t.status),d=Utils.urldecode(Utils.getSafeStringData(t.body)),g=Utils.getSafeStringData(t.msgOwnJid),m=Utils.getSafeStringData(t.msgTo),_=Utils.getSafeNumberData(t.msgType),f=new GoodJobNotification;return f.setItemId(n),f.setFromJid(o),f.setFromName(i),f.setDate(a),f.setNickName(r),f.setAvatarType(s),f.setAvatarData(l),f.setLoginAccount(u),f.setStatus(c),f.setMessage(d),f.setMsgOwnJid(g),f.setMsgTo(m),f.setMsgType(_),f}}function te(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=Utils.getSafeStringData(a.itemId),s=Utils.getSafeStringData(a.siblingItemId),l=Utils.getSafeStringData(a.ownerJid),u=Utils.urldecode(Utils.getSafeStringData(a.ownerName)),c=Utils.getSafeNumberData(a.status),d=Utils.urldecode(Utils.getSafeStringData(a.nickName)),g=Utils.getSafeStringData(a.avatarType),m=Utils.getSafeStringData(a.avatarData),_=Utils.getSafeStringData(a.userName),f=Utils.getSafeNumberData(a.userStatus),p=new SiblingTaskNotification;p.setItemId(r),p.setSiblingItemId(s),p.setOwnerJid(l),p.setOwnerName(u),p.setStatus(c),p.setNickName(d),p.setAvatarType(g),p.setAvatarData(m),p.setLoginAccount(_),p.setUserStatus(f),e._onNotificationCallback(p)}}function ne(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");var n=Utils.getSafeArrayData(t.items),o=n.length,i=TaskMessage.DEMAND_ON;t.type==ApiCubee.CONTENT_TYPE_CLEAR_DEMANDED_TASK&&(i=TaskMessage.DEMAND_OFF);for(var a=0;o>a;a++){var r=n[a],s=oe(r,i);null!=s&&e._onNotificationCallback(s)}}function oe(e,t){var n=e.taskInfo,o=e.fromUserInfo;if(null==n||null==o)return null;var i=new DemandTaskNotification;return i.setItemId(Utils.getSafeStringData(n.itemId)),i.setTitle(Utils.getSafeStringData(n.title)),i.setOwner(Utils.getSafeStringData(n.owner)),i.setClient(Utils.getSafeStringData(n.client)),i.setStatus(Utils.getSafeNumberData(n.status)),i.setDemandStatus(Utils.getSafeNumberData(t)),i.setDemandDate(Utils.getSafeStringData(n.demandDate)),i.setJid(Utils.getSafeStringData(o.jid)),i.setNickName(Utils.urldecode(Utils.getSafeStringData(o.nickName))),i}function ie(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=ae(a);null!=r&&e._onNotificationCallback(r)}}function ae(e){if(null==e)return null;var t=new SetReadMessageNotification;t.setItemId(Utils.getSafeStringData(e.itemId));var n=new Person;n.setJid(Utils.getSafeStringData(e.jid)),n.setUserName(Utils.urldecode(Utils.getSafeStringData(e.nickName))),n.setAvatarData(Utils.getSafeStringData(e.avatarData)),n.setAvatarType(Utils.getSafeStringData(e.avatarType)),n.setLoginAccount(Utils.getSafeStringData(e.account));var o=new ExistingReaderItem;o.setPerson(n);var i=new Date(Utils.getSafeStringData(e.date));return o.setDate(i),t.setExistingReaderItem(o),t}function re(e,t){var n=t.content;if(null==n)return void console.log("_content is null");switch(n.type){case ApiCubee.CONTENT_TYPE_GROUP_CHAT_ROOM:se(e,n);break;default:console.log("_content.type is invalid")}}function se(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=j(a),s=new GroupChatCreateNotification;s.setRoomInfo(r),e._onNotificationCallback(s)}}function le(e,t){var n=t.content;if(null==n)return void console.log("_content is null");switch(n.type){case ApiCubee.CONTENT_TYPE_GROUP_CHAT_ROOM_INFO:if(ue(e,n),null==n.items||!Array.isArray(n.items))return void console.log("content or content.items is null.");break;case ApiCubee.CONTENT_TYPE_COMMUNITY_ROOM_INFO:ce(e,n);break;default:console.log("_content.type is invalid")}}function ue(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=t.extras.subType,a=Utils.urldecode(Utils.getSafeStringData(t.extras.preRoomName)),r=Utils.getSafeNumberData(t.extras.prePrivacyType),s=0;o>s;s++){var l=n[s],u=j(l),c=new GroupChatInfoUpdateNotification;c.setRoomInfo(u);for(var s=0;s<i.length;s++)c.getUpdatedItems().push(i[s]);""!=a&&c.setPreviousRoomName(a),"number"==typeof r&&r>=0&&2>=r&&c.setPreviousPrivacyType(r),e._onNotificationCallback(c)}}function ce(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");var n=t.extras,o=null;if(null!=n){var i=n.preInfo;null!=i&&(o=q(i))}var a=Utils.getSafeArrayData(t.items),r=a.length;if(!(0>=r)){var s=a[0],l=q(s);null!=l&&null!=o&&(o.setCreatedAt(l.getCreatedAt()),o.setCreatedBy(l.getCreatedBy()),o.setUpdatedAt(l.getUpdatedAt()),o.setUpdatedBy(l.getUpdatedBy()));var u=new CommunityInfoUpdateNotification;u.setData(l,o),e._onNotificationCallback(u)}}function de(e,t){var n=t.content;if(null==n)return void console.log("_content is null");switch(n.type){case ApiCubee.CONTENT_TYPE_GROUP_CHAT_ROOM:ge(e,n);break;case ApiCubee.CONTENT_TYPE_COMMUNITY_ROOM:me(e,n);break;default:console.log("_content.type is invalid")}}function ge(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=j(a),s=new GroupChatAddMemberNotification;s.setRoomInfo(r),s.setAddedBy(a.addedBy);for(var l=Utils.getSafeArrayData(a.members),u=l.length,c=0;u>c;c++){var d=l[c];null!=d&&""!=d&&s.getAddedMemberList().add(d)}r.getProfileMap()&&s.setProfileMap(r.getProfileMap()),e._onNotificationCallback(s)}}function me(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=new CommunityMemberAddNotification;r.setRoomId(Utils.getSafeStringData(a.roomId)),r.setRoomName(Utils.urldecode(Utils.getSafeStringData(a.roomName))),r.setAddedBy(Utils.getSafeStringData(a.addedBy));for(var s=r.getAddedMemberList(),l=Utils.getSafeArrayData(a.members),u=l.length,c=0;u>c;c++){var d=l[c];if(null!=d){var g=W(d);null!=g&&s.add(g)}}e._onNotificationCallback(r)}}function _e(e,t){var n=t.content;if(null==n)return void console.log("_content is null");switch(n.type){case ApiCubee.CONTENT_TYPE_COMMUNITY_OWNER:fe(e,n);break;default:console.log("_content.type is invalid")}}function fe(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");var n=t.extras,o=new CommunityOwnerUpdateNotification,i=o.getPreOwnerList();if(null!=n)for(var a=Utils.getSafeArrayData(n.preOwnerItems),r=0;r<a.length;r++)i.add(Utils.getSafeStringData(a[r]));var s=Utils.getSafeArrayData(t.items);if(!(s.length<=0)){var l=s[0];o.setRoomId(Utils.getSafeStringData(l.roomId));for(var u=o.getOwnerList(),c=Utils.getSafeArrayData(l.ownerItems),r=0;r<c.length;r++)u.add(Utils.getSafeStringData(c[r]));e._onNotificationCallback(o)}}function pe(e,t){var n=t.content;if(null==n)return void console.log("_content is null");switch(n.type){case ApiCubee.CONTENT_TYPE_COMMUNITY_ROOM:he(e,n);break;case ApiCubee.CONTENT_TYPE_GROUP_CHAT_ROOM:Ce(e,n);break;default:console.log("_content.type is invalid")}}function he(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i],r=new CommunityMemberRemoveNotification;r.setRoomId(Utils.getSafeStringData(a.roomId)),r.setRoomName(Utils.urldecode(Utils.getSafeStringData(a.roomName))),r.setRemovedBy(Utils.getSafeStringData(a.removedBy));for(var s=r.getRemovedMemberList(),l=Utils.getSafeArrayData(a.members),u=l.length,c=0;u>c;c++)s.add(l[c]);e._onNotificationCallback(r)}}function Ce(e,t){if(null==t||null==t.items)return void console.log("content or content.items is null.");for(var n=Utils.getSafeArrayData(t.items),o=n.length,i=0;o>i;i++){var a=n[i];if(null!=a.members){var r=j(a),s=new GroupChatRemoveMemberNotification;s.setRoomInfo(r),s.setRemovedBy(a.removedBy);for(var l=Utils.getSafeArrayData(a.members),u=l.length,c=0;u>c;c++){var d=l[c];null!=d&&""!=d&&s.getRemovedMemberList().add(d)}e._onNotificationCallback(s)}}}function ve(e,t){if(null==t||null==t.content)return void console.log("received or received.content null.");var n=t.content,o=n.type,i=null;switch(o){case AuthorityInfoUpdateNotification.SUB_TYPE_ASSIGN_ROLE:i=xe(n.role);break;case AuthorityInfoUpdateNotification.SUB_TYPE_POLICY_ASSIGN:case AuthorityInfoUpdateNotification.SUB_TYPE_POLICY_UNASSIGN:i=Ye(n.policy);break;default:return}var a=new AuthorityInfoUpdateNotification;t.content.hasOwnProperty("triger")&&a.setTriger(t.content.triger),a.setSubType(o),a.setUpdatedItem(i),e._onNotificationCallback(a)}function ye(e,t){var n=t.content;if(null==n)return void console.log("_content is null");switch(t.content.type){case"addUserFollow":Te(e,n);break;case"delUserFollow":be(e,n);break;default:console.log("_content.type is invalid")}}function Te(e,t){if(null==t||!t.type||!t.followeeJid||!t.followerJid)return void console.log("content or content.items is null.");var n=new UserFollowNotification;_actionType=UserFollowNotification.ACTION_TYPE_ADD,n.setActionType(Utils.getSafeStringData(t.type)),n.setFolloweeJid(Utils.getSafeStringData(t.followeeJid)),n.setFollowerJid(Utils.getSafeStringData(t.followerJid));for(var o=t.personInfo,i=Object.keys(o).length,a=new ArrayList,r={},s=0;i>s;s++)Object.keys(o).forEach(function(e){var t=new Person;t.setJid(Utils.getSafeStringData(e));for(var n=[],i=o[e].group,l=0;l<i.length;l++)n.push(Utils.urldecode(Utils.getSafeStringData(i[l])));var u=Utils.getSafeStringData(o[e].nickName);""==u&&(u=Utils.getSafeStringData(o[e].userName)),u=Utils.urldecode(u),t.setUserName(u),t.setGroup(n),t.setLoginAccount(Utils.urldecode(Utils.getSafeStringData(o[e].userName))),t.setAvatarData(Utils.getSafeStringData(o[e].avatarData)),t.setAvatarType(Utils.getSafeStringData(o[e].avatarType)),r[t.getJid()]||(a.insert(s,t),r[t.getJid()]=!0)}),n.setPersonInfo(a);e._onNotificationCallback(n)}function be(e,t){if(null==t||!t.type||!t.followeeJid||!t.followerJid)return void console.log("content or content.items is null.");var n=new UserFollowNotification;_actionType=UserFollowNotification.ACTION_TYPE_DEL,n.setActionType(Utils.getSafeStringData(t.type)),n.setFolloweeJid(Utils.getSafeStringData(t.followeeJid)),n.setFollowerJid(Utils.getSafeStringData(t.followerJid));for(var o=t.personInfo,i=Object.keys(o).length,a=new ArrayList,r={},s=0;i>s;s++)Object.keys(o).forEach(function(e){var t=new Person;t.setJid(Utils.getSafeStringData(e));for(var n=[],i=o[e].group,l=0;l<i.length;l++)n.push(Utils.urldecode(Utils.getSafeStringData(i[l])));var u=Utils.getSafeStringData(o[e].nickName);""==u&&(u=Utils.getSafeStringData(o[e].userName)),u=Utils.urldecode(u),t.setUserName(u),t.setGroup(n),t.setLoginAccount(Utils.urldecode(Utils.getSafeStringData(o[e].userName))),t.setAvatarData(Utils.getSafeStringData(o[e].avatarData)),t.setAvatarType(Utils.getSafeStringData(o[e].avatarType)),r[t.getJid()]||(a.insert(s,t),r[t.getJid()]=!0)}),n.setPersonInfo(a);e._onNotificationCallback(n)}function Ie(e,t){if(null==t||null==t.content)return void console.log("receive or received.content null.");if(!t.content.items||!Array.isArray(t.content.items))return void console.log("threadtitle update receive object is error");var n=new ThreadTitleUpdateNotification;t.content.items[0].hasOwnProperty("threadRootId")&&t.content.items[0].hasOwnProperty("threadTitle")&&t.content.items[0].hasOwnProperty("itemId")||console.log("threadTitle update error"),n.setThreadRootId(t.content.items[0].threadRootId),n.setThreadTitle(decodeURIComponent(t.content.items[0].threadTitle)),n.setItemId(t.content.items[0].itemId),e._onNotificationCallback(n)}function Me(e,t){if(null==t||null==t.content)return void console.log("receive or received.content null.");switch(t.notify){case ApiCubee.API_UPDATE_NOTE:var n=new NoteAssignChangedNotification;t.content.hasOwnProperty("note_title")&&t.content.hasOwnProperty("note_url")&&t.content.hasOwnProperty("old_thread_root_id")&&t.content.hasOwnProperty("thread_root_id")&&t.content.hasOwnProperty("room_id")&&t.content.hasOwnProperty("ownjid")||console.log("note update error"),n.setNoteTitle(decodeURIComponent(t.content.note_title)),n.setNoteUrl(t.content.note_url),n.setOldThreadRootId(t.content.old_thread_root_id),n.setThreadRootId(t.content.thread_root_id),n.setRoomId(t.content.room_id),n.setOwnJid(t.content.ownjid),e._onNotificationCallback(n);break;case ApiCubee.API_DELETE_NOTE:var n=new NoteDeleteNotification;t.content.hasOwnProperty("note_title")&&t.content.hasOwnProperty("note_url")&&t.content.hasOwnProperty("thread_root_id")&&t.content.hasOwnProperty("room_id")&&t.content.hasOwnProperty("ownjid")||console.log("note update error"),n.setNoteTitle(decodeURIComponent(t.content.note_title)),n.setNoteUrl(t.content.note_url),n.setThreadRootId(t.content.thread_root_id),n.setRoomId(t.content.room_id),n.setOwnJid(t.content.ownjid),e._onNotificationCallback(n)}}function Ee(e,t){if(null==t||null==t.content)return void console.log("receive or received.content null.");if("string"==typeof t.content.type)switch(t.content.type){case"SetColumnName":var n=new MurmurSetColumnNameNotification;if("string"==!_typeof(t.content.jid)||"string"==!_typeof(t.content.columnName)){console.log("threadTitle update error");break}n.setJid(t.content.jid),n.setColumnName(decodeURIComponent(t.content.columnName)),e._onNotificationCallback(n)}}function Se(e,t){if(null==t||null==t.items)return void console.log("content or content.items null.");for(var n=Utils.getSafeArrayData(t.items),o=0;o<n.length;o++){var i=n[o],a=I(e,i),r=new MessageUpdateNotification;r.setMessage(a),e._onNotificationCallback(r)}}function we(e){var t=e.itemId;return t}function Ne(e){var t=e.deleteFlag;return t}function Ae(e){var t=!1;return"AdminDeleted"in e&&(t=e.AdminDeleted),t}function Ue(t){null!=t._onDisconnectCallBack&&t._onDisconnectCallBack(),e(t)}function Le(e,t){var n={};n.message=t,e._onErrorCallBack(n)}function Re(e,t,n,o){if(null==e)return!1;if(null==t||"string"!=typeof t)return!1;if(null!=n){if("string"!=typeof n||""==n)return!1;if(null==o||"function"!=typeof o)return!1}return null==e._serverConnector?!1:(null!=n&&Pe(e,n,o),e._serverConnector.sendData(t))}function Oe(e,t){var n=null;try{n=JSON.parse(t)}catch(o){return void console.log("receive data is not json format. receive data : "+t)}if(null!=n.request){var i=n.id,r=ke(e,i);return void(null!=r&&(De(e,i),"function"==typeof r&&setTimeout(function(){r(n)},1)))}if(null==n.notify);else switch(n.notify){case ApiCubee.API_CHANGE_PERSON_DATA:a(e,n);break;case ApiCubee.API_NOTIFICATION:u(e,n);break;case ApiCubee.API_MESSAGE:d(e,n);break;case ApiCubee.API_MESSAGE_OPTION:z(e,n);break;case ApiCubee.API_CREATE_GROUP:re(e,n);break;case ApiCubee.API_ADD_MEMBER:de(e,n);break;case ApiCubee.API_UPDATE_GROUP:le(e,n);break;case ApiCubee.API_UPDATE_MEMBER:_e(e,n);break;case ApiCubee.API_REMOVE_MEMBER:pe(e,n);break;case ApiCubee.API_AUTHORIY_CHANGED:ve(e,n);break;case ApiCubee.API_USER_FOLLOW:ye(e,n);break;case ApiCubee.API_THREAD_TITLE:Ie(e,n);break;case ApiCubee.API_UPDATE_NOTE:case ApiCubee.API_DELETE_NOTE:Me(e,n);break;case ApiCubee.API_MURMUR:Ee(e,n);break;default:console.log("_receiveObject.notify is invalid")}}function Pe(e,t,n){null!=e&&null!=t&&"string"==typeof t&&""!=t&&null!=n&&"function"==typeof n&&null!=e._callBacks&&(e._callBacks[t]=n)}function ke(e,t){return null==e?null:null==t||"string"!=typeof t||""==t?null:null==e._callBacks?null:e._callBacks[t]}function De(e,t){null!=e&&null!=t&&"string"==typeof t&&""!=t&&null!=e._callBacks&&delete e._callBacks[t]}function Ve(e){var t=new Person;t.setId(Utils.getSafeNumberData(e.id)),t.setJid(Utils.getSafeStringData(e.jid));var n=Utils.getSafeStringData(e.nickName);""==n&&(n=Utils.getSafeStringData(e.userName)),n=Utils.urldecode(n),t.setUserName(n);var o=Utils.getSafeStringData(e.mailAddress);o&&t.setMailAddress(Utils.getSafeStringData(o));for(var i=Utils.getSafeArrayData(e.groupItems),a=[],r=0;r<i.length;r++)a.push(Utils.urldecode(i[r]));return t.setGroup(a),t.setPresence(Utils.getSafeNumberData(e.presence)),t.setMyMemo(Utils.urldecode(Utils.getSafeStringData(e.myMemo))),t.setAvatarType(Utils.getSafeStringData(e.avatarType)),t.setAvatarData(Utils.getSafeStringData(e.avatarData)),t.setLoginAccount(Utils.getSafeStringData(e.userName)),t.setStatus(Utils.getSafeNumberData(e.status)),t}function xe(e){var t=new Role;return t.setId(Utils.getSafeStringData(e.id)),t.setTranslations(e.t),t}function Ye(e){var t=new Policy;return t.setId(Utils.getSafeStringData(e.id)),t.setTranslations(e.t),t}function Fe(e){var t=!1,n=null;if(0!=e.errorCode||null==e.content||0==e.content.result)return[t,n];var o=e.content,n=Utils.getSafeArrayData(o.items);return n.length<=0?[t,n]:(t=!0,[t,n])}CubeeServerConnector._LOGIN_STATUS_TYPE_NO_LOGIN=0,CubeeServerConnector._LOGIN_STATUS_TYPE_CONNECTING=1,CubeeServerConnector._LOGIN_STATUS_TYPE_CONNECTED=2,CubeeServerConnector._LOGIN_STATUS_TYPE_LOGINED=3;var He=new CubeeServerConnector;CubeeServerConnector.getInstance=function(){return He};var Ge=CubeeServerConnector.prototype;Ge.connect=function(e,t,n,i,a,r,s,l,u,c,d,g){var m=this;if(null==e||"string"!=typeof e)return!1;if(null==i||"string"!=typeof i)return!1;if(null==a||"string"!=typeof a)return!1;if(null==r||"function"!=typeof r)return!1;if(null==s||"function"!=typeof s)return!1;if(null==l||"function"!=typeof l)return!1;if(null==u||"function"!=typeof u)return!1;if(null==c||"function"!=typeof c)return!1;if(null==d||"function"!=typeof d)return!1;if(null==g||"function"!=typeof g)return!1;m._user=i,m._onConnectCallBack=r,m._onDisconnectCallBack=s,m._onErrorCallBack=l,m._onProfileChangedNotifyCallback=u,m._onMessageReceivedCallback=c,m._onNotificationCallback=d,m._onLoginWizardCallback=g;var _=function(){o(m,n,i,a)},f=function(){Ue(m)},p=function(e){Le(m,e)},h=function(e){Oe(m,e)},C=!1;return null!=m._serverConnector?(m._loginStatus!=CubeeServerConnector._LOGIN_STATUS_TYPE_NO_LOGIN&&m.disconnect(),m._loginStatus=CubeeServerConnector._LOGIN_STATUS_TYPE_CONNECTING,setTimeout(function(){o(m,n,i,a)},1),!0):(m._serverConnector=new SocketIoConnector,C=m._serverConnector.connect(e,t,_,f,p,h),C&&(m._loginStatus=CubeeServerConnector._LOGIN_STATUS_TYPE_CONNECTING),C)},Ge.skipLoginConnect=function(e,t,n,o,a,r,s,l,u){var c=this;if(null==e||"string"!=typeof e)return!1;if(null==n||"string"!=typeof n)return!1;if(null==o||"function"!=typeof o)return!1;if(null==a||"function"!=typeof a)return!1;if(null==r||"function"!=typeof r)return!1;if(null==s||"function"!=typeof s)return!1;if(null==l||"function"!=typeof l)return!1;if(null==u||"function"!=typeof u)return!1;c._accessToken=n,c._onConnectCallBack=o,c._onDisconnectCallBack=a,c._onErrorCallBack=r,c._onProfileChangedNotifyCallback=s,c._onMessageReceivedCallback=l,c._onNotificationCallback=u;var d=function(){i(c)},g=function(){Ue(c)},m=function(e){Le(c,e)},_=function(e){Oe(c,e)},f=!1;return c._serverConnector=new SocketIoConnector,f=c._serverConnector.connect(e,t,d,g,m,_),f&&(c._loginStatus=CubeeServerConnector._LOGIN_STATUS_TYPE_CONNECTING),f},Ge.disconnect=function(){var t=this;if(null!=t._serverConnector){if(t._loginStatus==CubeeServerConnector._LOGIN_STATUS_TYPE_LOGINED){var n=ApiCubee.createLogoutRequest(t._accessToken),o=n[0];
if(null==o||""==o)return;Re(t,o)}}else e(t)},Ge.changePresence=function(e,t){var n=this;if(null==e||"number"!=typeof e)return!1;if(e<Person.PRESENCE_STATUS_ONLINE||e>Person.PRESENCE_STATUS_DO_NOT_DISTURB)return!1;if(null==t||"string"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createChangePresenceRequest(n._accessToken,e,t),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){};return Re(n,i,a,r)},Ge.sendChatMessage=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==t||"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createSendChatMessageRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1];return Re(n,i,a,t)},Ge.sendPublicMessage=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==t||"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createSendPublicMessageRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1];return Re(n,i,a,t)},Ge.getPublicMessages=function(e,t,n){var o=this;if(null==e||"number"!=typeof e||0>e)return!1;if(null==t||"number"!=typeof t||1>t)return!1;if(null==n||"function"!=typeof n)return!1;if(null==o._serverConnector)return!1;if(0==o._isLogined)return!1;var i=ApiCubee.createGetPublicMessageRequest(o._accessToken,e,t),a=i[0];if(null==a||""==a)return!1;var r=i[1],s=function(e){var t=null;if(0!=e.errorCode||null==e.content||0==e.content.result)return void n(t);var o=e.content,i=Utils.getSafeArrayData(o.items),a=i.length;if(0>=a)return void n(t);t=new Array(a);for(var r=0;a>r;r++){var s=i[r];t[r]={},t[r].id=Utils.getSafeNumberData(s.id),t[r].itemId=Utils.getSafeStringData(s.itemId),t[r].from=Utils.getSafeStringData(s.from),t[r].to=Utils.getSafeStringData(s.to),t[r].type=Utils.getSafeNumberData(s.type),t[r].body=Utils.urldecode(Utils.getSafeStringData(s.body)),t[r].triggerAction=Utils.getSafeNumberData(s.triggerAction),t[r].publishNode=Utils.getSafeStringData(s.nodeName),t[r].date=Utils.getDate(Utils.getSafeStringData(s.createdAt),Utils.STANDARD_DATE_FORMAT),t[r].updatedAt=s.updatedAt?Utils.getSafeStringData(Date.create(s.updatedAt).format(Utils.STANDARD_DATE_FORMAT)):"",t[r].replyId=Utils.getSafeStringData(s.replyId),t[r].replyTo=Utils.getSafeStringData(s.replyTo),t[r].deleteFlag=Utils.getSafeNumberData(s.deleteFlag),t[r].inputType=Utils.getSafeNumberData(s.inputType),t[r].resultVisible=Utils.getSafeNumberData(s.resultVisible),t[r].graphType=Utils.getSafeNumberData(s.graphType),t[r].roomType=Utils.getSafeStringData(s.roomType),t[r].roomId=Utils.getSafeNumberData(s.roomId),t[r].startDate=Utils.getSafeStringData(s.startDate),t[r].dueDate=Utils.getSafeStringData(s.dueDate),t[r].optionCount=Utils.getSafeNumberData(s.optionCount);for(var l=Utils.getSafeArrayData(s.optionItems),u=l.length,c=new ArrayList,d=0;u>d;d++){var g=new Object;g.optionId=l[d].optionId,g.option=l[d].option,g.optionValue=l[d].optionValue,c.add(g)}t[r].optionItems=c,t[r].voteFlag=Utils.getSafeNumberData(s.voteFlag),t[r].goodJob=new ArrayList,t[r].emotionPoint=new ArrayList,t[r].emotionPointIcons={},t[r].threadTitle=Utils.urldecode(Utils.getSafeStringData(s.threadTitle)),t[r].threadRootId=Utils.getSafeStringData(s.threadRootId),s.noteCount&&s.noteItems.length?(t[r].noteTitle=Utils.getSafeStringData(s.noteItems[0].noteTitle),t[r].noteUrl=Utils.getSafeStringData(s.noteItems[0].noteUrl)):(t[r].noteTitle="",t[r].noteUrl=""),t[r].bodyType=Utils.getSafeNumberData(s.bodyType);for(var m=Utils.getSafeArrayData(s.goodJobItems),_=m.length,d=0;_>d;d++){var f=m[d];f.itemId||(f.itemId=t[r].itemId);var p=ee(f);t[r].goodJob.add(p)}var h=s.emotionPointIcons?s.emotionPointIcons:{};0==Object.keys(h).length&&LoginUser.getInstance().getTenantInfo().emotionPointBasicIcon&&(h=LoginUser.getInstance().getTenantInfo().emotionPointBasicIcon);for(var C in h)t[r].emotionPointIcons[C]=Utils.urldecode(h[C]);for(var v=Utils.getSafeArrayData(s.emotionPointItems),y=v.length,d=0;y>d;d++){var T=v[d],b=B(T);null!=b&&t[r].emotionPoint.add(b)}for(var I=Utils.getSafeArrayData(s.shortenItems),M=I.length,E=new ArrayList,d=0;M>d;d++){var w=new ShortenURLInfo;null!=w&&(w.setDisplayedURL(Utils.urldecode(I[d].DisplayedURL)),w.setShortenPath(Utils.urldecode(I[d].ShortenPath)),w.setOriginalURL(Utils.urldecode(I[d].OriginalURL)),E.add(w))}t[r].shortenItems=E,t[r].shortenUrlCount=M;var N=Utils.getSafeNumberData(s.readFlg);t[r].readFlag=N;var A=x(s);null!=A&&(t[r].existingReaderInfo=A),t[r].profileMap=new StringMapedArrayList;var U=s.personInfo;if(U)for(var L in U){var R=S(U[L]);R&&t[r].profileMap.add(L,R)}}n(t)};return Re(o,a,r,s)},Ge.sendGoodJob=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null==t||"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createSendGoodJobRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){t(0==e.errorCode&&null!=e.content&&1==e.content.result?!0:!1)};return Re(n,i,a,r)},Ge.addQuestionnaire=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==t||"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createSendQuestionnaireRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){t(0==e.errorCode&&null!=e.content&&1==e.content.result?e:e)};return Re(n,i,a,r)},Ge.addTask=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==t||"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createSendTaskRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){t(0==e.errorCode&&null!=e.content&&1==e.content.result?!0:!1)};return Re(n,i,a,r)},Ge.updateTask=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==t||"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createUpdateTaskRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){t(0==e.errorCode&&null!=e.content&&1==e.content.result?!0:!1)};return Re(n,i,a,r)},Ge.sendDemandTask=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null==t||"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createDemandTaskRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){t(0==e.errorCode&&null!=e.content&&1==e.content.result?!0:!1)};return Re(n,i,a,r)},Ge.sendClearDemandedTask=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null==t||"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createClearDemandTaskRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){t(0==e.errorCode&&null!=e.content&&1==e.content.result?!0:!1)};return Re(n,i,a,r)},Ge.sendGetExistingReaderList=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null==t||"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createGetExistingReaderListRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){var n=null;0==e.errorCode&&null!=e.content&&1==e.content.result?(n=Y(e.content),t(n)):t(n)};return Re(n,i,a,r)},Ge.sendSetReadOneMessage=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null==t||"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=new ArrayList;o.add(e);var i=ApiCubee.createSetReadMessageRequest(n._accessToken,o),a=i[0];if(null==a||""==a)return!1;var r=i[1],s=function(e){var n=null;0==e.errorCode&&null!=e.content&&1==e.content.result?(n=F(e.content),t(n)):t(n)};return Re(n,a,r,s)},Ge.deleteMessage=function(e,t,n){var o=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==t||"number"!=typeof t)return!1;if(null==n||"function"!=typeof n)return!1;if(null==o._serverConnector)return!1;if(0==o._isLogined)return!1;var i=ApiCubee.createDeleteMessageRequest(o._accessToken,t,e),a=i[0];if(null==a||""==a)return!1;var r=i[1],s=function(e){n(0==e.errorCode&&null!=e.content&&1==e.content.result?!0:!1)};return Re(o,a,r,s)},Ge.getTaskMessages=function(e,t,n,o,i){var a=this;if(null==e||"number"!=typeof e||0>e)return!1;if(null==t||"number"!=typeof t||1>t)return!1;if(null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))||$.isEmptyObject(n))return!1;if(null==o||"object"!=("undefined"==typeof o?"undefined":_typeof(o)))return!1;if(null==i||"function"!=typeof i)return!1;if(null==a._serverConnector)return!1;if(0==a._isLogined)return!1;var r=ApiCubee.createGetTaskListRequest(a._accessToken,n,o,e,t),s=r[0];if(null==s||""==s)return!1;var l=r[1],u=function(e){var t=new MessageDataList,n=new MessageDataList,o=0;if(0!=e.errorCode||null==e.content||0==e.content.result)return void i(t,o,n);var a=e.content,r=Utils.getSafeArrayData(a.items),s=r.length;if(0>=s)return void i(t,o,n);for(var l=0;s>l;l++){var u=r[l],c=A(u);t.add(c)}if(null!=a.extras){var d=a.extras;o=Utils.getSafeNumberData(d.unfinishedTaskCount);for(var g=Utils.getSafeArrayData(d.childrenItems),m=g.length,l=0;m>l;l++){var _=g[l],f=A(_);n.add(f)}}i(t,o,n)};return Re(a,s,l,u)},Ge.getChatMessages=function(e,t,n,o){var i=this;if(null==e||"number"!=typeof e||0>e)return!1;if(null==t||"number"!=typeof t||1>t)return!1;if(null==n||"string"!=typeof n)return!1;if(null==o||"function"!=typeof o)return!1;if(null==i._serverConnector)return!1;if(0==i._isLogined)return!1;var a=ApiCubee.createGetChatMessageRequest(i._accessToken,n,e,t),r=a[0];if(null==r||""==r)return!1;var s=a[1],l=function(e){var t=new MessageDataList;if(0!=e.errorCode||null==e.content||0==e.content.result)return void o(t);var n=e.content,a=Utils.getSafeArrayData(n.items),r=a.length;if(0>=r)return void o(t);for(var s=0;r>s;s++){var l=a[s],u=I(i,l);t.add(u)}o(t)};return Re(i,r,s,l)},Ge.getQuestionnaireMessages=function(e,t,n,o){var i=this;if(null==e||"number"!=typeof e||0>e)return!1;if(null==t||"number"!=typeof t||1>t)return!1;if(null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n)))return!1;if(null==o||"function"!=typeof o)return!1;if(null==i._serverConnector)return!1;if(0==i._isLogined)return!1;var a=ApiCubee.createGetQuestionnaireMessagesRequest(i._accessToken,e,t,n),r=a[0],s=a[1],l=function(e){var t=new MessageDataList;if(!e||0!=e.errorCode||!e.content||!e.content.result)return o(t),!1;for(var n=e.content,a=Utils.getSafeArrayData(n.items),r=a.length,s=0;r>s;s++){var l=a[s],u=I(i,l);t.add(u)}o(t)};return Re(i,r,s,l)},Ge.sendVoteMessage=function(e,t,n,o){var i=this;if(null==e||"function"!=typeof e)return!1;if(null==t||"string"!=typeof t)return!1;if(null==n||"string"!=typeof n)return!1;if(null==o||"object"!=("undefined"==typeof o?"undefined":_typeof(o)))return!1;if(null==i._serverConnector)return!1;if(0==i._isLogined)return!1;var a=ApiCubee.createSendVoteMessageRequest(i._accessToken,t,n,o),r=a[0],s=a[1],l=function(t){e(0==t.errorCode&&null!=t.content&&1==t.content.result?!0:!1)};return Re(i,r,s,l)},Ge.changeProfile=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;null==e.getNickName()&&e.setNickName(""),null==e.getMailAddress()&&e.setMailAddress(""),null==e.getGroup()&&e.setGroup([]);var o=e.getAvatarType(),i=e.getAvatarData();(null==o||""==o||null==i||""==i)&&(e.setAvatarType(""),e.setAvatarData(""));var a=null;LoginUser.getInstance().isUpdatablePersonData()?_api=ApiCubee.createChangeProfileRequest(n._accessToken,e):_api=ApiCubee.createChangeProfileOnlyAvaterRequest(n._accessToken,e);var a=_api[0];if(null==a||""==a)return!1;var r=_api[1],s=function(n){if(0==n.errorCode&&null!=n.content&&1==n.content.result){LoginUser.getInstance().setMailAddress(e.getMailAddress());var o=e.getGroup();if(o.length<=5)for(var i=0;i<o.length;i++)o[i]=Utils.urldecode(Utils.getSafeStringData(o[i]));LoginUser.getInstance().setGroup(o),t(!0)}else t(!1)};return Re(n,a,r,s)},Ge.changePassword=function(e,t,n){var o=this;if(null==e||"string"!=typeof e)return!1;if(null==t||"string"!=typeof t)return!1;if(null!=n&&"function"!=typeof n)return!1;if(null==o._serverConnector)return!1;if(0==o._isLogined)return!1;var i=ApiCubee.createChangePasswordRequest(o._accessToken,e,t),a=i[0];if(null==a||""==a)return!1;var r=i[1],s=function(e){null==e||null==e.errorCode||0!=e.errorCode||null==e.content||null==e.content.result?n(!1,1):1==e.content.result?n(!0,0):null==e.content.reason?n(!1,1):n(!1,e.content.reason)};return Re(o,a,r,s)},Ge.searchMessage=function(e,t,n,o){var i=this;if(null==e||"number"!=typeof e)return!1;if(null==t||"number"!=typeof t)return!1;if(null!=n&&"object"!=("undefined"==typeof n?"undefined":_typeof(n)))return!1;if(null!=o&&"function"!=typeof o)return!1;if(null==i._serverConnector)return!1;if(0==i._isLogined)return!1;var a=ApiCubee.createSearchMessageRequest(i._accessToken,e,t,n),r=a[0];if(null==r||""==r)return!1;var s=a[1],l=function(e){var t=new MessageDataList,n=new MessageDataList,a=0,r={};if(r.messageDataList=t,r.childrenMessageDataList=n,r.allItemCount=a,0!=e.errorCode||null==e.content||0==e.content.result)return void o(r);var s=e.content,l=s.extras;if(null!=l){a=Utils.getSafeNumberData(l.allItemCount),r.allItemCount=a;for(var u=Utils.getSafeArrayData(l.childrenItems),c=u.length,d=0;c>d;d++){var g=u[d],m=A(g);n.add(m)}}var _=Utils.getSafeArrayData(s.items),f=_.length;if(0>=f)return void o(r);for(var d=0;f>d;d++){var p=_[d],h=I(i,p);null!=h&&t.add(h)}o(r)};return Re(i,r,s,l)},Ge.getMessageCount=function(e,t){var n=this;if(null!=e&&"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createGetCountRequest(n._accessToken,ApiCubee.CONTENT_TYPE_MESSAGE,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){return 0!=e.errorCode||null==e.content||0==e.content.result?void t(!1,0):void t(e.content.result,e.content.count)};return Re(n,i,a,r)},Ge.getRoomInfo=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createGetRoomInfoRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){var n=null;if(0!=e.errorCode||null==e.content||0==e.content.result)return void t(n);var o=e.content,i=Utils.getSafeArrayData(o.items),a=i.length;return 1!=a?void t(n):(n=j(i[0]),void t(n))};return Re(n,i,a,r)},Ge.getRoomInfoList=function(e,t,n,o,i){var a=this;if(null==e||"number"!=typeof e)return!1;if(null==t||"number"!=typeof t)return!1;if(null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n)))return!1;if(null!=o&&"object"!=("undefined"==typeof o?"undefined":_typeof(o)))return!1;if(null!=i&&"function"!=typeof i)return!1;if(null==a._serverConnector)return!1;if(0==a._isLogined)return!1;for(var r=n.getCount(),s=0;r>s;s++){var l=n.get(s).getRoomId(),u=ApiCubee.createGetRoomInfoListRequest(a._accessToken,e,t,l,o),c=u[0];if(null==c||""==c)return!1;var d=u[1],g=function(e){var t=new ChatRoomInfoList;(0!=e.errorCode||null==e.content||0==e.content.result)&&i(t);var n=e.content,o=Utils.getSafeArrayData(n.items),a=o.length;0>=a&&i(t);for(var r=0;a>r;r++)t.add(j(o[r]));i(t)};return Re(a,c,d,g)}},Ge.getPublicGroupRoomInfoList=function(e,t,n,o){var i=this;if(null==e||"number"!=typeof e)return!1;if(null==t||"number"!=typeof t)return!1;if(null!=n&&"object"!=("undefined"==typeof n?"undefined":_typeof(n)))return!1;if(null==i._serverConnector)return!1;if(0==i._isLogined)return!1;var a=ApiCubee.createGetPublicGroupRoomInfoListRequest(i._accessToken,e,t,n);if(null==a[0]||""==a[0])return!1;var r=a[1],s=function(e){var t=new ChatRoomInfoList;if(0!=e.errorCode||null==e.content||0==e.content.result)return void o(e);var n=e.content,i=Utils.getSafeArrayData(n.items),a=i.length;0>=a&&o(t);for(var r=0;a>r;r++)t.add(j(i[r]));o(t)};return Re(i,a[0],r,s)},Ge.createChatRoom=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==t||"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createCreateChatRoomRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){t(0==e.errorCode&&null!=e.content&&1==e.content.result?e:e)};return Re(n,i,a,r)},Ge.sendGroupChatMessage=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==t||"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createSendGroupChatMessageRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1];return Re(n,i,a,t)},Ge.addGroupChatRoomMember=function(e,t,n){var o=this;if(null==e||"string"!=typeof e)return!1;if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return!1;if(null==n||"function"!=typeof n)return!1;if(null==o._serverConnector)return!1;if(0==o._isLogined)return!1;var i=ApiCubee.createAddGroupChatRoomMemberRequest(o._accessToken,e,t);if(null==i)return!1;var a=i[0];if(null==a||""==a)return!1;var r=i[1],s=function(e){n(e)};return Re(o,a,r,s)},Ge.addPublicGroupChatRoomMember=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null==t||"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createAddPublicGroupMemberRequest(n._accessToken,e);if(null==o)return!1;var i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){t(e)};return Re(n,i,a,r)},Ge.updateChatRoomInfo=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==t||"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createUpdateChatRoomInfoRequest(n._accessToken,e);if(null==o)return!1;var i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){};return Re(n,i,a,r)},Ge.removeChatRoomMember=function(e,t,n,o){var i=this;if(null==e||"string"!=typeof e)return!1;if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return!1;if(null==n||"string"!=typeof n||"own"!=n&&"member"!=n)return!1;if(null!=o&&"function"!=typeof o)return!1;if(null==i._serverConnector)return!1;if(0==i._isLogined)return!1;var a=ApiCubee.createRemoveChatRoomMemberRequest(i._accessToken,e,t,n),r=a[0];if(null==r||""==r)return!1;var s=a[1],l=function(e){if(0!=e.errorCode||null==e.content||0==e.content.result)return void o(e);var t=e.content,n=Utils.getSafeArrayData(t.items);if(n.length<=0||!n[0].members)return void onRemoveCommunityMemberCallback(e);for(var i=Utils.getSafeArrayData(n[0].members.successMembers),a=Utils.getSafeArrayData(n[0].members.failureMembers),r=i.length,s=a.length,l=new ArrayList,u=new ArrayList,c=0;r>c;c++)l.add(i[c]);for(var d=0;s>d;d++)u.add(a[d]);o({removedSuccessMemberList:l,removedFailureMemberList:u})};return Re(i,r,s,l)},Ge.removePublicChatRoomMember=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createDelPublicGroupMemberRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){if(0!=e.errorCode||null==e.content||0==e.content.result)return void t(e);var n=e.content,o=Utils.getSafeArrayData(n.items);if(o.length<=0||!o[0].members)return void onRemoveCommunityMemberCallback(e);for(var i=Utils.getSafeArrayData(o[0].members.successMembers),a=Utils.getSafeArrayData(o[0].members.failureMembers),r=i.length,s=a.length,l=new ArrayList,u=new ArrayList,c=0;r>c;c++)l.add(i[c]);for(var d=0;s>d;d++)u.add(a[d]);t({removedSuccessMemberList:l,removedFailureMemberList:u})};return Re(n,i,a,r)},Ge.getServerList=function(e){var t=this;if(null!=e&&"function"!=typeof e)return!1;if(null==t._serverConnector)return!1;if(0==t._isLogined)return!1;var n=ApiCubee.createGetServerListRequest(t._accessToken),o=n[0];if(null==o||""==o)return!1;var i=n[1],a=function(t){var n=new MailServerInfoList;if(0!=t.errorCode||null==t.content||0==t.content.result)return void e(n);var o=t.content,i=Utils.getSafeArrayData(o.items),a=i.length;if(0>=a)return void e(n);for(var r=0;a>r;r++){var s=J(i[r]);n.add(s)}e(n)};return Re(t,o,i,a)},Ge.changeMailCooperationSetting=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createChangeMailCooperationSettingRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){t(0==e.errorCode&&null!=e.content&&1==e.content.result?!0:!1)};return Re(n,i,a,r)},Ge.getMailBody=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createGetMailBodyRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){var n=null;if(0!=e.errorCode||null==e.content||0==e.content.result)return void t(n);var o=e.content,i=Utils.getSafeArrayData(o.items),a=i.length;return 1!=a?void t(n):(n=P(i[0]),void t(n))};return Re(n,i,a,r)},Ge.getThreadMessage=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createGetThreadMessageRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){var o=new MessageDataList;if(0!=e.errorCode||null==e.content||0==e.content.result)return void t(o);var i=e.content,a=Utils.getSafeArrayData(i.items),r=a.length;if(0>=r)return void t(o);for(var s=0;r>s;s++){var l=a[s],u=I(n,l);null!=u&&o.add(u)}t(o)};return Re(n,i,a,r)},Ge.createCommunity=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createCreateCommunityRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){if(0!=e.errorCode||null==e.content||0==e.content.result)return void(null!=t&&t(e));var n=e.content,o=Utils.getSafeArrayData(n.items),i=o.length;if(0>=i)return void(null!=t&&t(e));var a=o[0],r=q(a);null!=t&&t(r)};return Re(n,i,a,r)},Ge.getJoinedCommunityInfoList=function(e,t,n,o){var i=this;if(null==e||"number"!=typeof e||0>e)return!1;if(null==t||"number"!=typeof t||1>t)return!1;if(null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n)))return!1;if(null!=o&&"function"!=typeof o)return!1;if(null==i._serverConnector)return!1;if(0==i._isLogined)return!1;var a=ApiCubee.createGetJoinedCommunityInfoListRequest(i._accessToken,e,t,n),r=a[0];if(null==r||""==r)return!1;var s=a[1],l=function(e){if(0!=e.errorCode||null==e.content||0==e.content.result)return void(null!=o&&o(null));for(var t=e.content,n=Utils.getSafeArrayData(t.items),i=new CommunityList,a=n.length,r=0;a>r;r++){var s=n[r];if(null!=s){var l=q(s);null!=l&&i.add(l.getRoomId(),l)}}null!=o&&o(i)};return Re(i,r,s,l)},Ge.getNotJoinedPublicCommunityInfoList=function(e,t,n,o){var i=this;if(null==e||"number"!=typeof e||0>e)return!1;if(null==t||"number"!=typeof t||1>t)return!1;if(null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n)))return!1;if(null!=o&&"function"!=typeof o)return!1;if(null==i._serverConnector)return!1;if(0==i._isLogined)return!1;var a=ApiCubee.createGetPublicCommunityRoomInfoListRequest(i._accessToken,e,t,n),r=a[0];if(null==r||""==r)return!1;var s=a[1],l=function(e){if(0!=e.errorCode||null==e.content||0==e.content.result)return void(null!=o&&o(null));for(var t=e.content,n=Utils.getSafeArrayData(t.items),a=new CommunityList,r=n.length,s=0;r>s;s++){var l=n[s];if(null!=l&&!(Array.isArray(t.items[s].memberItems)&&t.items[s].memberItems.indexOf(i._jid)>=0)){var u=q(l);null!=u&&a.add(u.getRoomId(),u)}}null!=o&&o(a)};return Re(i,r,s,l)},Ge.getCommunityInfo=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createGetCommunityInfoRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){if(0!=e.errorCode||null==e.content||0==e.content.result)return void(null!=t&&t(null));var n=e.content,o=Utils.getSafeArrayData(n.items),i=o.length;if(0>=i)return void(null!=t&&t(null));var a=o[0],r=q(a);null!=t&&t(r)};return Re(n,i,a,r)},Ge.getCommunityMemberInfo=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createGetCommunityMemberInfoRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){if(0!=e.errorCode||null==e.content||0==e.content.result)return void(null!=t&&t(null));var n=e.content,o=Utils.getSafeArrayData(n.items),i=o.length;if(0>=i)return void(null!=t&&t(null));var a=o[0],r=K(a);null!=t&&t(r)};return Re(n,i,a,r)},Ge.updateCommunity=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createUpdateCommunityRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){if(0!=e.errorCode||null==e.content||0==e.content.result)return void(null!=t&&t(null,null));var n=e.content,o=n.extras,i=null;if(null!=o){var a=o.preInfo;null!=a&&(i=q(a))}var r=Utils.getSafeArrayData(n.items),s=r.length;if(0>=s)return void(null!=t&&t(null,null));var l=r[0],u=q(l);null!=u&&null!=i&&(i.setCreatedAt(u.getCreatedAt()),i.setCreatedBy(u.getCreatedBy()),i.setUpdatedAt(u.getUpdatedAt()),i.setUpdatedBy(u.getUpdatedBy())),null!=t&&t(u,i)};return Re(n,i,a,r)},Ge.addCommunityMember=function(e,t,n){var o=this;if(null==e||"string"!=typeof e)return!1;if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return!1;if(null!=n&&"function"!=typeof n)return!1;if(null==o._serverConnector)return!1;if(0==o._isLogined)return!1;var i=ApiCubee.createAddCommunityMemberRequest(o._accessToken,e,t),a=i[0];if(null==a||""==a)return!1;var r=i[1],s=function(e){if(0!=e.errorCode||null==e.content||0==e.content.result)return void(null!=n&&n(e));var t=e.content,o=Utils.getSafeArrayData(t.items),i=o.length;if(0>=i)return void(null!=n&&n(e));for(var a=o[0],r=Utils.getSafeArrayData(a.members),s=r.length,l=new CommunityMemberList,u=0;s>u;u++){var c=r[u];if(null!=c){var d=W(c);null!=d&&l.add(d)}}null!=n&&n(l)};return Re(o,a,r,s)},Ge.addPublicCommunityMember=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createAddPublicCommunityMemberRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){if(0!=e.errorCode||null==e.content||0==e.content.result)return void(null!=t&&t(e));var n=e.content,o=Utils.getSafeArrayData(n.items),i=o.length;if(0>=i)return void(null!=t&&t(e));for(var a=o[0],r=Utils.getSafeArrayData(a.members),s=r.length,l=new CommunityMemberList,u=0;s>u;u++){var c=r[u];if(null!=c){var d=W(c);null!=d&&l.add(d)}}null!=t&&t(l)};return Re(n,i,a,r)},Ge.updateCommunityOwner=function(e,t,n){var o=this;if(null==e||"string"!=typeof e)return!1;if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return!1;if(null!=n&&"function"!=typeof n)return!1;if(null==o._serverConnector)return!1;if(0==o._isLogined)return!1;var i=ApiCubee.createUpdateCommunityOwnerRequest(o._accessToken,e,t),a=i[0];if(null==a||""==a)return!1;var r=i[1],s=function(e){if(0!=e.errorCode||null==e.content||0==e.content.result)return void(null!=n&&n(e,null));var t=e.content,o=new ArrayList,i=t.extras;if(null!=i||null!=i.preOwnerItems)for(var a=Utils.getSafeArrayData(i.preOwnerItems),r=0;r<a.length;r++)o.add(a[r]);var s=Utils.getSafeArrayData(t.items);if(s.length<=0)return void(null!=n&&n(e,null));for(var l=new ArrayList,u=s[0],c=Utils.getSafeArrayData(u.ownerItems),r=0;r<c.length;r++)l.add(c[r]);null!=n&&n(l,o)};return Re(o,a,r,s)},Ge.removeCommunityMember=function(e,t,n){var o=this;if(null==e||"string"!=typeof e)return!1;if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return!1;if(null!=n&&"function"!=typeof n)return!1;if(null==o._serverConnector)return!1;if(0==o._isLogined)return!1;var i=ApiCubee.createRemoveCommunityMemberRequest(o._accessToken,e,t),a=i[0];if(null==a||""==a)return!1;var r=i[1],s=function(e){if(0!=e.errorCode||null==e.content||0==e.content.result)return void(null!=n&&n(e));var t=e.content,o=Utils.getSafeArrayData(t.items),i=o.length;if(0>=i)return void(null!=n&&n(e));for(var a=o[0],r=Utils.getSafeArrayData(a.members),s=r.length,l=new ArrayList,u=0;s>u;u++)l.add(r[u]);null!=n&&n(l)};return Re(o,a,r,s)},Ge.removePublicCommunityMember=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createDelPublicCommunityMemberRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){if(0!=e.errorCode||null==e.content||0==e.content.result)return void(null!=t&&t(e));var n=e.content,o=Utils.getSafeArrayData(n.items),i=o.length;if(0>=i)return void(null!=t&&t(e));for(var a=o[0],r=Utils.getSafeArrayData(a.members),s=r.length,l=new ArrayList,u=0;s>u;u++)l.add(r[u]);null!=t&&t(l)};return Re(n,i,a,r)},Ge.sendCommunityMessage=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createSendCommunityMessageRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){if(0!=e.errorCode||null==e.content||0==e.content.result)return void(null!=t&&t(null,e));var o=e.content,i=Utils.getSafeArrayData(o.items),a=i.length;if(0>=a)return void(null!=t&&t(null,e));var r=i[0],s=I(n,r);null!=t&&t(s,e)};return Re(n,i,a,r)},Ge.sendMurmurMessage=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createSendMurmurMessageRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){if(0!=e.errorCode||null==e.content)return void(null!=t&&t(null));var o=e.content,i=Utils.getSafeArrayData(o.items),a=i.length;if(0>=a)return void(null!=t&&t(e));var r=i[0];I(n,r);null!=t&&t(e)};return Re(n,i,a,r)},Ge.getAccessToken=function(){return this._accessToken},Ge.addContactListMember=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createAddContactListMemberRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){var n=Fe(e);if(!n[0])return void(null!=t&&t(!1,e.errorCode));for(var o=n[1],i=Utils.getSafeArrayData(o[0].members.successMembers),a=Utils.getSafeArrayData(o[0].members.failureMembers),r=i.length,s=a.length,l=new ArrayList,u=new ArrayList,c=0;r>c;c++){
var d=new AddContactListMember,g=Ve(i[c]);if(null!=g){d.setPerson(g);for(var m=Utils.getSafeArrayData(i[c].contactListGroup),_=[],f=0;f<m.length;f++)_.push(Utils.urldecode(m[f]));d.setContactListGroup(_);var p=Utils.getSafeArrayData(i[c].position);d.setPosition(p),l.add(d)}}for(var h=0;s>h;h++){var d={jid:a[h].jid,contactListGroup:a[h].contactListGroup};u.add(d)}null!=t&&t({addSuccessMemberList:l,addFailureMemberList:u},null)};return Re(n,i,a,r)},Ge.removeContactListMember=function(e,t){var n=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null!=t&&"function"!=typeof t)return!1;if(null==n._serverConnector)return!1;if(0==n._isLogined)return!1;var o=ApiCubee.createRemoveContactListMemberRequest(n._accessToken,e),i=o[0];if(null==i||""==i)return!1;var a=o[1],r=function(e){var n=Fe(e);if(!n[0])return void(null!=t&&t(!1,e.errorCode));for(var o=n[1],i=Utils.getSafeArrayData(o[0].members.successMembers),a=Utils.getSafeArrayData(o[0].members.failureMembers),r=i.length,s=a.length,l=new ArrayList,u=new ArrayList,c=0;r>c;c++){var d={jid:i[c].jid};l.add(d)}for(var c=0;s>c;c++){var d={jid:a[c].jid};u.add(d)}null!=t&&t({removeSuccessMemberList:l,removeFailureMemberList:u},null)};return Re(n,i,a,r)},Ge.searchPerson=function(e,t,n,o){var i=this;if(null==e||"number"!=typeof e)return!1;if(null==t||"number"!=typeof t)return!1;if(null!=n&&"object"!=("undefined"==typeof n?"undefined":_typeof(n)))return!1;if(null!=o&&"function"!=typeof o)return!1;if(null==i._serverConnector)return!1;if(0==i._isLogined)return!1;var a=ApiCubee.createSearchPersonRequest(i._accessToken,e,t,n),r=a[0];if(null==r||""==r)return!1;var s=a[1],l=function(e){var t=new SearchResultPersonList;if(0!=e.errorCode||null==e.content||0==e.content.result)return void(null!=o&&o(t));var n=e.content,i=n.extras;if(null!=i){var a=Utils.getSafeNumberData(i.allItemCount);t.setAllItemCount(a)}var r=Utils.getSafeArrayData(n.items),s=r.length;if(0>=s)return void(null!=o&&o(t));for(var l=0;s>l;l++){var u=Ve(r[l]);null!=u&&t.add(u)}null!=o&&o(t)};return Re(i,r,s,l)},Ge.getRights=function(e){var t=this,n=ApiCubee.getRights(t._accessToken,e);return new Promise(function(e,o){var i=function(t){0!=t.errorCode||null==t.content||0==t.content.result?o(t):e(t)};Re(t,n[0],n[1],i)})},Ge.getRoleAssignmentForUser=function(e){var t=this,n=ApiCubee.getRoleAssignmentForUser(t._accessToken,e);return new Promise(function(e,o){var i=function(t){0!=t.errorCode||null==t.content||0==t.content.result?o(t):e(t)};Re(t,n[0],n[1],i)})},Ge.createPolicy=function(e,t,n,o){var i=this,a=ApiCubee.createPolicy(i._accessToken,e,t,n,o);return new Promise(function(e,t){var n=function(n){0!=n.errorCode||null==n.content||0==n.content.result?t(n):e(n)};Re(i,a[0],a[1],n)})},Ge.createRight=function(e,t,n){var o=this,i=ApiCubee.createRight(o._accessToken,e,t,n);return new Promise(function(e,t){var n=function(n){0!=n.errorCode||null==n.content||0==n.content.result?t(n):e(n)};Re(o,i[0],i[1],n)})},Ge.assignPolicyToUser=function(e,t){var n=this,o=ApiCubee.assignPolicyToUser(n._accessToken,e,t);return new Promise(function(e,t){var i=function(n){0!=n.errorCode||null==n.content||0==n.content.result?t(n):e(n)};Re(n,o[0],o[1],i)})},Ge.getUserPoliciesByResource=function(e){var t=this,n=ApiCubee.getUserPoliciesByResource(t._accessToken,e);return new Promise(function(e,o){var i=function(t){0!=t.errorCode||null==t.content||0==t.content.result?o(t):e(t)};Re(t,n[0],n[1],i)})},Ge.unassignPolicyFromUser=function(e,t){var n=this,o=ApiCubee.unassignPolicyFromUser(n._accessToken,e,t);return new Promise(function(e,t){var i=function(n){0!=n.errorCode||null==n.content||0==n.content.result?t(n):e(n)};Re(n,o[0],o[1],i)})},Ge.updateThreadTitle=function(e,t){var n=this,o=ApiCubee.updateThreadTitle(n._accessToken,e,t);return new Promise(function(e,t){var i=function(n){return 0!=n.errorCode||null==n.content||0==n.content.result?void t(n):void e(n)};Re(n,o[0],o[1],i)})},Ge.getThreadTitleList=function(e){var t=this,n=ApiCubee.getThreadTitleList(t._accessToken,e);return new Promise(function(e,o){var i=function(t){return 0!=t.errorCode||null==t.content||0==t.content.result?void o(t):void e(t)};Re(t,n[0],n[1],i)})},Ge.updateMessage=function(e,t){var n=this,o=ApiCubee.updateMessage(n._accessToken,e,t);return new Promise(function(e,t){var i=function(n){return 0!=n.errorCode||null==n.content||0==n.content.result?void t(n):void e(n)};Re(n,o[0],o[1],i)})},Ge.sendQuoteMessage=function(e){var t=this,n=ApiCubee.sendQuoteMessage(t._accessToken,e);return new Promise(function(e,o){var i=function(t){return 0!=t.errorCode||null==t.content||0==t.content.result?void o(t):void e(t)};Re(t,n[0],n[1],i)})},Ge.sendEmotionPoint=function(e,t,n){var o=this;if(null==e||"string"!=typeof e)return!1;if(null==t||"number"!=typeof t)return!1;if(null==n||"function"!=typeof n)return!1;if(null==o._serverConnector)return!1;if(0==o._isLogined)return!1;var i=ApiCubee.createSendEmotionPointRequest(o._accessToken,e,t),a=i[0];if(null==a||""==a)return!1;var r=i[1],s=function(e){n(0==e.errorCode&&null!=e.content&&1==e.content.result?!0:!1)};return Re(o,a,r,s)},Ge.getGoodJobTotal=function(e,t){var n=this,o=ApiCubee.getGoodJobTotal(n._accessToken,e,t);return new Promise(function(e,t){var i=function(n){return 0!=n.errorCode||null==n.content||0==n.content.result?void t(n):void e(n)};Re(n,o[0],o[1],i)})},Ge.getThanksPointsTotal=function(e,t){var n=this,o=ApiCubee.getThanksPointsTotal(n._accessToken,e,t);return new Promise(function(e,t){var i=function(n){return 0!=n.errorCode||null==n.content||0==n.content.result?void t(n):void e(n)};Re(n,o[0],o[1],i)})},Ge.getGoodJobRanking=function(e,t,n,o){var i=this,a=ApiCubee.getGoodJobRanking(i._accessToken,e,t,n,o);return new Promise(function(e,t){var n=function(n){return 0!=n.errorCode||null==n.content||0==n.content.result?void t(n):void e(n)};Re(i,a[0],a[1],n)})},Ge.getThanksPointsRanking=function(e,t,n,o){var i=this,a=ApiCubee.getThanksPointsRanking(i._accessToken,e,t,n,o);return new Promise(function(e,t){var n=function(n){return 0!=n.errorCode||null==n.content||0==n.content.result?void t(n):void e(n)};Re(i,a[0],a[1],n)})},Ge.getMurmurTotal=function(e,t){var n=this,o=ApiCubee.getMurmurTotal(n._accessToken,e,t);return new Promise(function(e,t){var i=function(n){return 0!=n.errorCode||null==n.content||0==n.content.result?void t(n):void e(n)};Re(n,o[0],o[1],i)})},Ge.getMurmurRanking=function(e,t,n,o){var i=this,a=ApiCubee.getMurmurRanking(i._accessToken,e,t,n,o);return new Promise(function(e,t){var n=function(n){return 0!=n.errorCode||null==n.content||0==n.content.result?void t(n):void e(n)};Re(i,a[0],a[1],n)})},Ge.getGroupList=function(){var e=this,t=ApiCubee.getGroupList(e._accessToken);return new Promise(function(n,o){var i=function(e){return 0!=e.errorCode||null==e.content||0==e.content.result?void o(e):void n(e)};Re(e,t[0],t[1],i)})},Ge.getHashtagRanking=function(e,t,n,o,i,a){var r=this,s=ApiCubee.getHashtagRanking(r._accessToken,e,t,n,o,i,a);return new Promise(function(e,t){var n=function(n){return 0!=n.errorCode||null==n.content||0==n.content.result?void t(n):void e(n)};Re(r,s[0],s[1],n)})},Ge.getFolloweeList=function(e){var t=this,n=ApiCubee.getFolloweeList(t._accessToken,e);return new Promise(function(e,o){var i=function(t){if(0!=t.errorCode||null==t.content||0==t.content.result)return void o(t);for(var n=new ArrayList,i=t.content.items,a=0;a<i.length;a++){var r=new Person;r.setJid(Utils.getSafeStringData(i[a].jid));for(var s=[],l=i[a].group,u=0;u<l.length;u++)s.push(Utils.urldecode(Utils.getSafeStringData(l[u])));var c=Utils.getSafeStringData(i[a].nickName);""==c&&(c=Utils.getSafeStringData(i[a].name)),c=Utils.urldecode(c),r.setUserName(c),r.setGroup(s),r.setLoginAccount(Utils.urldecode(Utils.getSafeStringData(i[a].name))),r.setAvatarData(Utils.getSafeStringData(i[a].avatarData)),r.setAvatarType(Utils.getSafeStringData(i[a].avatarType)),n.insert(a,r)}return void e(n)};Re(t,n[0],n[1],i)})},Ge.getFollowerList=function(e){var t=this,n=ApiCubee.getFollowerList(t._accessToken,e);return new Promise(function(e,o){var i=function(t){if(0!=t.errorCode||null==t.content||0==t.content.result)return void o(t);for(var n=new ArrayList,i=t.content.items,a=0;a<i.length;a++){var r=new Person;r.setJid(Utils.getSafeStringData(i[a].jid));for(var s=[],l=i[a].group,u=0;u<l.length;u++)s.push(Utils.urldecode(Utils.getSafeStringData(l[u])));var c=Utils.getSafeStringData(i[a].nickName);""==c&&(c=Utils.getSafeStringData(i[a].name)),c=Utils.urldecode(c),r.setUserName(c),r.setGroup(s),r.setLoginAccount(Utils.urldecode(Utils.getSafeStringData(i[a].name))),r.setAvatarData(Utils.getSafeStringData(i[a].avatarData)),r.setAvatarType(Utils.getSafeStringData(i[a].avatarType)),n.insert(a,r)}return void e(n)};Re(t,n[0],n[1],i)})},Ge.getFollowInfo=function(e){var t=this,n=ApiCubee.getFollowInfo(t._accessToken,e);return new Promise(function(e,o){var i=function(t){return 0!=t.errorCode||null==t.content||0==t.content.result?void o(t):void e(t)};Re(t,n[0],n[1],i)})},Ge.addUserFollow=function(e){var t=this,n=ApiCubee.addUserFollow(t._accessToken,e);return new Promise(function(e,o){var i=function(t){return 0!=t.errorCode||null==t.content||0==t.content.result?void o(t):void e(t)};Re(t,n[0],n[1],i)})},Ge.delUserFollow=function(e){var t=this,n=ApiCubee.delUserFollow(t._accessToken,e);return new Promise(function(e,o){var i=function(t){return 0!=t.errorCode||null==t.content||0==t.content.result?void o(t):void e(t)};Re(t,n[0],n[1],i)})},Ge.getMurmurColumnName=function(e){var t=this,n=ApiCubee.getMurmurColumnName(t._accessToken,e);return new Promise(function(e,o){var i=function(t){return 0!=t.errorCode||null==t.content||0==t.content.result?void o(t):void e(t)};Re(t,n[0],n[1],i)})},Ge.setMurmurColumnName=function(e,t){var n=this,o=ApiCubee.setMurmurColumnName(n._accessToken,e,t);return new Promise(function(e,t){var i=function(n){return 0!=n.errorCode||null==n.content||0==n.content.result?void t(n):void e(n)};Re(n,o[0],o[1],i)})},Ge.setLoginUserExtras=function(e){var t=this;return new Promise(function(n,o){var i=function(e){return 0!=e.errorCode||null==e.content||0==e.content.result?void o(e):void n(e)};e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))||o(!1);var a="";if(e)try{a=JSON.stringify(e)}catch(r){o(!1)}for(key in e)"Logged"!=key&&"recentFilter"!=key&&"backgroundImage"!=key&&o(!1);var s=ApiCubee.createChangeExtrasRequest(t._accessToken,a);Re(t,s[0],s[1],i)})}}(),function(){var e=ConnectReceiveData.prototype;e.getLoginUserPerson=function(){return this._loginUserPerson},e.setLoginUserPerson=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._loginUserPerson=e)},e.getContactList=function(){return this._contactList},e.setContactList=function(e){null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._contactList=e)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),AuthorityManager=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getRoleAssignmentForUser",value:function(e){return new Promise(function(t,n){return null==e||"string"!=typeof e?void n(!1):void CubeeServerConnector.getInstance().getRoleAssignmentForUser(e).then(function(e){t(e)})["catch"](function(e){n(e)})})}},{key:"getRights",value:function(e){return new Promise(function(t,n){return null==e||"string"!=typeof e?void n(!1):void CubeeServerConnector.getInstance().getRights(e).then(function(e){t(e)})["catch"](function(e){n(e)})})}},{key:"createPolicy",value:function(e,t,n){return new Promise(function(o,i){if(null==e||"string"!=typeof e)return void i(!1);if(null==t||"string"!=typeof t)return void i(!1);if(null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n)))return void i(!1);var a=LoginUser.getInstance().getLoginAccount();CubeeServerConnector.getInstance().createPolicy(a,e,t,n).then(function(e){o(e)})["catch"](function(e){i(e)})})}},{key:"createRight",value:function(e,t,n){return new Promise(function(o,i){return null==e||"string"!=typeof e?void i(!1):null==t||"string"!=typeof t?void i(!1):null==n||"string"!=typeof n?void i(!1):void CubeeServerConnector.getInstance().createRight(e,t,n).then(function(e){o(e)})["catch"](function(e){i(e)})})}},{key:"assignPolicyToUser",value:function(e,t){return new Promise(function(n,o){return null==e||"string"!=typeof e?void o(!1):null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t))?void o(!1):void CubeeServerConnector.getInstance().assignPolicyToUser(e,t).then(function(e){n(e)})["catch"](function(e){o(e)})})}},{key:"getUserPoliciesByResource",value:function(e){return new Promise(function(t,n){return null==e||"string"!=typeof e?void n(!1):void CubeeServerConnector.getInstance().getUserPoliciesByResource(e).then(function(e){t(e)})["catch"](function(e){n(e)})})}},{key:"unassignPolicyFromUser",value:function(e,t){return new Promise(function(n,o){return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?void o(!1):null==t||"string"!=typeof t?void o(!1):void CubeeServerConnector.getInstance().unassignPolicyFromUser(e,t).then(function(e){n(e)})["catch"](function(e){o(e)})})}}]),e}();try{module.exports=AuthorityManager}catch(e){}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=CommunityManager.prototype;e.onNotificationReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getType){var n=e.getType();if(n==Notification_model.TYPE_COMMUNITY){var o=e.getSubType();switch(o){case CommunityNotification.SUB_TYPE_UPDATE_ROOM_INFO:var i=e.getUpdatedCommunityInfo();if(null==i&&console.log("_updatedCommunityInfo is null"),null==t._joinedCommunityList)return;var a=i.getRoomId(),r=t._joinedCommunityList.getByKey(a);if(null==r)return;for(var s=i.getOwnerList(),l=r.getOwnerList(),u=l.getCount(),c=0;u>c;c++)s.add(l.get(c));var d=i.getGeneralMemberList(),g=r.getGeneralMemberList();u=g.getCount();for(var c=0;u>c;c++)d.add(g.get(c));t._joinedCommunityList.setByKey(a,i);break;case CommunityNotification.SUB_TYPE_ADD_MEMBER:if(null==t._joinedCommunityList)return;var a=e.getRoomId(),r=t._joinedCommunityList.getByKey(a);if(null==r){var m=function(e){null!=e&&t._joinedCommunityList.insert(0,e.getRoomId(),e)};return void t.getCommunityInfo(a,m)}var l=r.getOwnerList(),u=l.getCount();if(0>=u)return;for(var g=r.getGeneralMemberList(),_=e.getAddedMemberList(),f=_.getCount(),c=0;f>c;c++){var p=_.get(c);if(null!=p){var h=p.getRole();if(l.getByKey(p))break;switch(h){case CommunityMember.ROLE_TYPE_GENERAL:g.add(p);break;case CommunityMember.ROLE_TYPE_OWNER:l.add(p)}}}break;case CommunityNotification.SUB_TYPE_UPDATE_OWNER:if(null==t._joinedCommunityList)return;var a=e.getRoomId(),r=t._joinedCommunityList.getByKey(a);if(null==r)return;var l=r.getOwnerList(),u=l.getCount();if(0>=u)return;var g=r.getGeneralMemberList(),C=t._getChangeOwners(e),v=C.addOwners.getCount(),y=C.removeOwners.getCount(),T=function(e){var t=l.getByKey(e);return t?t:g.getByKey(e)},b=function(){for(var e=new ArrayList,t=0;v>t;t++){var n=C.addOwners.get(t);g.getByKey(n)||e.add(n)}return e},I=function(e){for(var n=t._joinedCommunityList.getByKey(a),o=n.getGeneralMemberList(),i=0;i<e.getCount();i++){var r=new CommunityMember;r.setJid(e.get(i).getJid()),r.setUserName(e.get(i).getUserName()),r.setLoginAccount(e.get(i).getLoginAccount()),l.add(r),o.getByKey(e.get(i).getJid())&&o.removeByKey(e.get(i).getJid())}},M=b();if(M.getCount())CubeeController.getInstance().getPersonDataByJidFromServer(M,I);else for(var E=0;v>E;E++){var S=C.addOwners.get(E);if(!l.getByKey(S)){var w=T(S);w&&l.add(w)}g.getByKey(S)&&g.removeByKey(S)}for(var E=0;y>E;E++){var N=C.removeOwners.get(E);if(!g.getByKey(N)){var w=T(N);w&&g.add(w)}l.getByKey(N)&&l.removeByKey(N)}break;case CommunityNotification.SUB_TYPE_REMOVE_MEMBER:if(null==t._joinedCommunityList)return;var a=e.getRoomId(),r=t._joinedCommunityList.getByKey(a);if(null==r)return;var l=r.getOwnerList(),u=l.getCount();if(0>=u)return;for(var g=r.getGeneralMemberList(),A=e.getRemovedMemberList(),U=A.getCount(),c=0;U>c;c++){var L=A.get(c);l.removeByKey(L),g.removeByKey(L)}}}}},e._getChangeOwners=function(e){for(var t=e.getOwnerList(),n=t.getCount(),o=e.getPreOwnerList(),i=o.getCount(),a=new ArrayList,r=new ArrayList,s=0;n>s;s++)a.add(t.get(s));for(var l=0;i>l;l++)r.add(o.get(l));for(var u=n-1;u>=0;u--)for(var c=a.get(u),d=r.getCount(),g=d-1;g>=0;g--)if(c==r.get(g)){a.remove(u),r.remove(g);break}return{addOwners:a,removeOwners:r}},e.createCommunity=function(e,t){function n(e){null!=t&&t(e)}return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:CubeeServerConnector.getInstance().createCommunity(e,n)},e.getJoinedCommunityInfoList=function(e,t,n,o){function i(e){if(null!=e)if(null==a._joinedCommunityList)a._joinedCommunityList=e;else for(var t=e.getCount(),n=0;t>n;n++){var i=e.get(n);null==a._joinedCommunityList.getByKey(i.getRoomId())&&a._joinedCommunityList.add(i.getRoomId(),i)}null!=o&&o(e)}var a=this;return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))?!1:null!=o&&"function"!=typeof o?!1:CubeeServerConnector.getInstance().getJoinedCommunityInfoList(e,t,n,i)},e.getNoJoinedPublicCommunityInfoList=function(e,t,n,o){function i(e){null!=o&&o(e)}return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))?!1:null!=o&&"function"!=typeof o?!1:CubeeServerConnector.getInstance().getNotJoinedPublicCommunityInfoList(e,t,n,i)},e.getCommunityInfo=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null!=t&&"function"!=typeof t)return!1;var o=null;if(null!=n._joinedCommunityList&&(o=n._joinedCommunityList.getByKey(e)),null!=o)return setTimeout(function(){null!=t&&t(o)},1),!0;if(n._getRoomInfoRequestList[e])return n._getRoomInfoRequestList[e].push(t),!0;n._getRoomInfoRequestList[e]=[],n._getRoomInfoRequestList[e].push(t);var i=function(t){if(null!=n._joinedCommunityList&&null==n._joinedCommunityList.getByKey(e)&&n._joinedCommunityList.add(e,t),n._getRoomInfoRequestList[e]){var o=function(){for(var o=n._getRoomInfoRequestList[e].length,i=0;o>i;i++)n._getRoomInfoRequestList[e][i]&&n._getRoomInfoRequestList[e][i](t);delete n._getRoomInfoRequestList[e]};setTimeout(function(){o()},1)}},a=CubeeServerConnector.getInstance().getCommunityInfo(e,i);return a||delete n._getRoomInfoRequestList[e],a},e.getCommunityMemberInfo=function(e,t){function n(e){if(null!=i&&null!=e){var n=e.getOwnerList(),o=i.getOwnerList();o.removeAll();for(var a=n.getCount(),r=0;a>r;r++){var s=n.get(r);null!=s&&o.add(s)}var l=e.getGeneralMemberList(),u=i.getGeneralMemberList();u.removeAll(),a=l.getCount();for(var r=0;a>r;r++){var s=l.get(r);null!=s&&u.add(s)}e=i}null!=t&&t(e)}var o=this;if(null==e||"string"!=typeof e)return!1;if(null!=t&&"function"!=typeof t)return!1;var i=null;if(null!=o._joinedCommunityList&&(i=o._joinedCommunityList.getByKey(e)),null!=i){var a=i.getOwnerList();if(null!=a&&a.getCount()>0)return setTimeout(function(){null!=t&&t(i)},1),!0}return CubeeServerConnector.getInstance().getCommunityMemberInfo(e,n)},e.getCachedCommunityMember=function(e,t){var n=this;if(null==e||"string"!=typeof e)return null;if(null!=t&&"string"!=typeof t)return null;var o=null;if(null!=n._joinedCommunityList&&(o=n._joinedCommunityList.getByKey(e)),null!=o){var i=o.getOwnerList();if(null==i)return null;for(var a=i.getCount(),r=0;a>r;r++){var s=i.get(r);if(null!=s){var l=s.getJid();if(l==t)return s}}for(var u=o.getGeneralMemberList(),a=u.getCount(),r=0;a>r;r++){var s=u.get(r);if(null!=s){var l=s.getJid();if(l==t)return s}}return null}return null},e.updateCommunity=function(e,t){function n(e,n){null!=t&&t(e,n)}return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:CubeeServerConnector.getInstance().updateCommunity(e,n)},e.addCommunityMember=function(e,t,n){function o(e){null!=n&&n(e)}return null==e||"string"!=typeof e?!1:null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t))?!1:null!=n&&"function"!=typeof n?!1:CubeeServerConnector.getInstance().addCommunityMember(e,t,o)},e.updateCommunityOwner=function(e,t,n){function o(e,t){null!=n&&n(e,t)}return null==e||"string"!=typeof e?!1:null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t))?!1:null!=n&&"function"!=typeof n?!1:CubeeServerConnector.getInstance().updateCommunityOwner(e,t,o)},e.removeCommunityMember=function(e,t,n){function o(e){null!=n&&n(e)}return null==e||"string"!=typeof e?!1:null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t))?!1:null!=n&&"function"!=typeof n?!1:CubeeServerConnector.getInstance().removeCommunityMember(e,t,o)},e.removePublicCommunityMember=function(e,t){function n(e){null!=t&&t(e)}return null==e||"string"!=typeof e?!1:null!=t&&"function"!=typeof t?!1:CubeeServerConnector.getInstance().removePublicCommunityMember(e,n)},e.onProfileChanged=function(e){function t(){setTimeout(function(){if(!(a>=i)&&n._joinedCommunityList){var r=n._joinedCommunityList.get(a);if(null!=r){var s=null,l=r.getOwnerList();null!=l&&(s=l.getByJid(o));var u=r.getGeneralMemberList();if(null==s&&null!=u&&(s=u.getByJid(o)),null!=s)switch(e.getType()){case ProfileChangeNotice.TYPE_PRESENCE:s.setPresence(e.getPresence()),s.setMyMemo(e.getMyMemo());break;case ProfileChangeNotice.TYPE_PROFILE:var c=e.getProfile();if(null==c)return;s.setUserName(c.getNickName()),s.setAvatarType(c.getAvatarType()),s.setAvatarData(c.getAvatarData()),s.setGroup(c.getGroup())}}a++,t()}},1)}var n=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=n._joinedCommunityList){var o=e.getJid(),i=n._joinedCommunityList.getCount(),a=0;t()}},e.hasCreatingRoomIdList=function(e){return this._creatingRoomIdList.indexOf(e)<0?!1:!0},e.disconnected=function(){var e=this;null!=e._joinedCommunityList&&(e._joinedCommunityList.removeAll(),e._joinedCommunityList=null)}}(),function(){function e(e,t,n,o,i,a,r){return null==e||"function"!=typeof e?!1:null==t||"function"!=typeof t?!1:null==n||"function"!=typeof n?!1:null==o||"function"!=typeof o?!1:null==i||"function"!=typeof i?!1:null==a||"function"!=typeof a?!1:null==r||"function"!=typeof r?!1:!0}var t=LoginManager.prototype;t.login=function(t,n,o,i,a,r,s,l,u,c){function d(e){return i(e)}function g(e){c(e)}if(null==n||"string"!=typeof n)return!1;if(null==o||"string"!=typeof o)return!1;if(!e(i,a,r,s,l,u,c))return!1;var m=d_host,_=d_socketio_port;return CubeeServerConnector.getInstance().connect(m,_,t,n,o,d,a,r,s,l,u,g)},t.skipLogin=function(t,n,o,i,a,r,s){function l(e){n(e)}if(null==t||"string"!=typeof t)return!1;if(!e(n,o,i,a,r,s))return!1;var u=d_host,c=d_socketio_port;return CubeeServerConnector.getInstance().skipLoginConnect(u,c,t,l,o,i,a,r,s)},t.logout=function(){CubeeServerConnector.getInstance().disconnect()},t.onNotificationReceived=function(e){},t.disconnected=function(){}}(),function(){var e=FavoriteManager.prototype;e.onNotificationReceived=function(e){},e.disconnected=function(){}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(){return CubeeController.getInstance()._personManager}function t(){return CubeeController.getInstance()._notificationManager}function n(){return CubeeController.getInstance()._searchManager}var o=MessageManager.prototype;o.getTaskMessages=function(e,t,n,o,i){function a(e,t,n){for(var o=e.getCount(),a=0;o>a;a++)r._addMessage(e.get(a));if(void 0!=n&&null!=n)for(var s=n.getCount(),a=0;s>a;a++)r._addMessage(n.get(a));i(e,t)}var r=this;return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))||$.isEmptyObject(n)?!1:null==o||"object"!=("undefined"==typeof o?"undefined":_typeof(o))?!1:null==i||"function"!=typeof i?!1:CubeeServerConnector.getInstance().getTaskMessages(e,t,n,o,a)},o.getChatMessages=function(e,t,n,o){function i(e){for(var t=e.getCount(),n=0;t>n;n++)a._addMessage(e.get(n));o(e)}var a=this;return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"string"!=typeof n?!1:null==o||"function"!=typeof o?!1:CubeeServerConnector.getInstance().getChatMessages(e,t,n,i)},o.getQuestionnaireMessages=function(e,t,n,o){function i(e){for(var t=e.getCount(),n=0;t>n;n++)a._addMessage(e.get(n));o(e)}var a=this;return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))?!1:null==o||"function"!=typeof o?!1:CubeeServerConnector.getInstance().getQuestionnaireMessages(e,t,n,i)},o.sendVoteMessage=function(e,t,n,o){return null==t||"string"!=typeof t?!1:null==n||"string"!=typeof n?!1:null==o||"object"!=("undefined"==typeof o?"undefined":_typeof(o))?!1:null==e||"function"!=typeof e?!1:CubeeServerConnector.getInstance().sendVoteMessage(e,t,n,o)},o.sendPublicMessage=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments[3];if(null==e||"string"!=typeof e)return!1;if(null==t||"string"!=typeof t)return!1;if(null==o||"function"!=typeof o)return!1;var i=new PublicMessage;return i.setMessage(e),i.setReplyItemId(t),i.setThreadTitle(n),CubeeServerConnector.getInstance().sendPublicMessage(i,o)},o.getPublicMessages=function(e,n,o){function i(e){if(null==e)return void o(null);for(var n=e.length,i=0;n>i;i++){var r=e[i],s=null;switch(r.type){case Message.TYPE_PUBLIC:s=new PublicMessage,s.setReplyTo(r.replyTo),s.setReplyItemId(r.replyId),s.setPublishNode(r.publishNode),s.setDeleteFlag(r.deleteFlag);break;case Message.TYPE_CHAT:s=new ChatMessage,s.setTo(r.to),s.setDirection(r.direction),s.setDeleteFlag(r.deleteFlag);break;case Message.TYPE_GROUP_CHAT:s=new GroupChatMessage,s.setTo(r.to),s.setDirection(r.direction),s.setRoomName(r.roomName),s.setReplyTo(r.replyTo),s.setReplyItemId(r.replyId),s.setDeleteFlag(r.deleteFlag);break;case Message.TYPE_TASK:s=new TaskMessage;break;case Message.TYPE_COMMUNITY:s=new CommunityMessage;break;case Message.TYPE_SYSTEM:s=new SystemMessage,s.setReplyTo(r.replyTo),s.setReplyItemId(r.replyId),s.setTriggerAction(r.triggerAction);break;case Message.TYPE_QUESTIONNAIRE:s=new QuestionnaireMessage,s.setRoomType(r.roomType),s.setRoomId(r.roomId),s.setRoomName(r.roomName),s.setGraphType(r.graphType),s.setInputType(r.inputType),s.setResultVisible(r.resultVisible);for(var l=new ArrayList,u=0;u<r.optionCount;u++){var c=r.optionItems.get(u),d=Utils.urldecode(Utils.getSafeStringData(c.option)),g=new Object;g.option=d,g.optionId=c.optionId,g.optionValue=c.optionValue,l.add(g)}s.setOptionItems(l),s.setOptionCount(r.optionCount),s.setVoteFlag(!!r.voteFlag),s.setStartDate(r.startDate),s.setDueDate(r.dueDate),s.setDeleteFlag(r.deleteFlag);break;case Message.TYPE_UNKNOWN:default:s=new Message}s.setFrom(r.from),s.setMessage(r.body),s.setDate(r.date),s.setUpdatedAt(r.updatedAt),s.setItemId(r.itemId),s.setId(r.id),s.setHistory(!0),s.setReadFlag(r.readFlag),s.setProfileMap(r.profileMap),s.setThreadTitle(r.threadTitle),s.setThreadRootId(r.threadRootId),s.setNoteTitle(r.noteTitle),s.setNoteUrl(r.noteUrl),s.setBodyType(r.bodyType),null!=r.existingReaderInfo&&s.setExistingReaderInfo(r.existingReaderInfo),s.setEmotionIconList(r.emotionPointIcons);for(var u=0;u<r.emotionPoint._length;u++)s.getEmotionPointList().add(r.emotionPoint.get(u));s.setUIShortenUrls(r.shortenItems),a._addMessage(s);var m=r.goodJob;if(null!=m){var _=m.getCount(),f=t();if(null!=f)for(var p=0;_>p;p++)f.onNotificationReceived(m.get(p))}i+1==n?o(s,!0):o(s,!1)}}var a=this;return null==e||"number"!=typeof e||0>e?!1:null==n||"number"!=typeof n||1>n?!1:null==o||"function"!=typeof o?!1:CubeeServerConnector.getInstance().getPublicMessages(e,n,i)},o.sendGroupChatMessage=function(e,t){return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"function"!=typeof t?!1:CubeeServerConnector.getInstance().sendGroupChatMessage(e,t)},o.sendCommunityMessage=function(e,t){function n(e){null!=t&&t(e)}return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:CubeeServerConnector.getInstance().sendCommunityMessage(e,n)},o.sendMurmurMessage=function(e,t){function n(e){null!=t&&t(e)}return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:CubeeServerConnector.getInstance().sendMurmurMessage(e,n)},o.getReplyReverseItemIds=function(e){var t=this;return null==e||"string"!=typeof e?null:t._replyManager.getReplyReverseItemIds(e)},o.getChildrenTaskItemIds=function(e){var t=this;return null==e||"string"!=typeof e?null:t._childrenManager.getChildrenTaskItemIds(e)},o.sendChatMessage=function(e,t){return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"function"!=typeof t?!1:CubeeServerConnector.getInstance().sendChatMessage(e,t)},o.onMessageReceived=function(e){var t=this;null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&t._addMessage(e)},o.getMessage=function(e){var t=this;return null==e||"string"!=typeof e?null:t._messageDataList.getByItemId(e)},o.getAllMessage=function(){var e=this;return e._messageDataList},o._addMessage=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getType();switch(n){case Message.TYPE_PUBLIC:case Message.TYPE_GROUP_CHAT:case Message.TYPE_COMMUNITY:case Message.TYPE_MURMUR:t._replyManager.addMessage(e);break;case Message.TYPE_TASK:t._childrenManager.addMessage(e)}t._messageDataList.add(e)}},o.sendGoodJob=function(e,t){return null==e||"string"!=typeof e?!1:null==t||"function"!=typeof t?!1:CubeeServerConnector.getInstance().sendGoodJob(e,t)},o.sendDemandTask=function(e,t){var n=this;if(null==e||"string"!=typeof e)return!1;if(null==t||"function"!=typeof t)return!1;var o=n.getMessage(e);if(null==o)return!1;var i=LoginUser.getInstance().getJid();return null==i||""==i?!1:CubeeServerConnector.getInstance().sendDemandTask(e,t)},o.sendClearDemandedTask=function(e,t){if(null==e||"string"!=typeof e)return!1;if(null==t||"function"!=typeof t)return!1;var n=LoginUser.getInstance().getJid();return null==n||""==n?!1:CubeeServerConnector.getInstance().sendClearDemandedTask(e,t)},o.sendGetExistingReaderList=function(e,t){if(null==e||"string"!=typeof e)return!1;if(null==t||"function"!=typeof t)return!1;var n=LoginUser.getInstance().getJid();return null==n||""==n?!1:CubeeServerConnector.getInstance().sendGetExistingReaderList(e,t)},o.sendSetReadOneMessage=function(e,t){if(null==e||"string"!=typeof e)return!1;if(null==t||"function"!=typeof t)return!1;var n=function(e){if(null==e)return void t(null);var n=e.getCount();if(0==n)return void t(null);var o=e.get(0);t(o)};return CubeeServerConnector.getInstance().sendSetReadOneMessage(e,n)},o.onNotificationReceived=function(t){var n=this;if(null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))&&null!=t.getType){var o=t.getType();switch(o){case Notification_model.TYPE_GOOD_JOB:var i=t,a=i.getItemId(),r=n.getMessage(a);if(null==r)return;var s=i.getFromJid(),l=r.getGoodJobList(),u=l.getByJid(s);u=new GoodJobData,u.setJid(s);var c=new Date(i.getDate());u.setDate(c),u.setNickName(i.getNickName()),u.setAvatarType(i.getAvatarType()),u.setAvatarData(i.getAvatarData()),
u.setLoginAccount(i.getLoginAccount()),u.setStatus(i.getStatus()),l.add(u);var d=e();null!=d&&e().onNotificationReceived(t);break;case Notification_model.TYPE_TASK:n._onTaskNotificationReceived(t);break;case Notification_model.TYPE_SYSTEM:n._onSystemNotificationReceived(t);break;case Notification_model.TYPE_MESSAGE_OPTION:n._onMessageOptionReceived(t);break;case Notification_model.TYPE_DELETE_MESSAGE:n._onDeleteMessageNotificationReceived(t);break;case Notification_model.TYPE_GROUP_CHAT:n._onGroupChatMessageNotificationReceived(t);break;case Notification_model.TYPE_MAIL:n._onMailMessageNotificationReceived(t);break;case Notification_model.TYPE_COMMUNITY:t.getSubType()==CommunityNotification.SUB_TYPE_MESSAGE&&n._onCommunityMessageNotificationReceived(t);break;case Notification_model.TYPE_THREAD_TITLE:n._onThreadTitleUpdateNotificationReceived(t);break;case Notification_model.TYPE_MESSAGE_UPDATE:n._onMessageUpdateNotificationReceived(t);break;case Notification_model.TYPE_EMOTION_POINT:n._onEmotionPointNotificationReceived(t);break;case Notification_model.TYPE_ASSIGN_NOTE:case Notification_model.TYPE_DELETE_NOTE:n._onNoteAssignChangedNotificationReceived(t);break;case Notification_model.TYPE_QUESTIONNAIRE:n._onQuestionnaireNotificationReceived(t);break;case Notification_model.TYPE_MURMUR:t.getSubType()==MurmurNotification.SUB_TYPE_MESSAGE?n._onMurmurMessageNotificationReceived(t):t.getSubType()==MurmurNotification.SUB_TYPE_SET_COLUMN_NAME&&n._onMurmurSetColumnNameNotificationReceived(t)}}},o.addQuestionnaire=function(e,t){return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"function"!=typeof t?!1:CubeeServerConnector.getInstance().addQuestionnaire(e,t)},o.addTask=function(e,t){return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"function"!=typeof t?!1:CubeeServerConnector.getInstance().addTask(e,t)},o.updateTask=function(e,t){return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"function"!=typeof t?!1:CubeeServerConnector.getInstance().updateTask(e,t)},o.deleteMessage=function(e,t,n){return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"number"!=typeof t?!1:null==n||"function"!=typeof n?!1:CubeeServerConnector.getInstance().deleteMessage(e,t,n)},o._onQuestionnaireNotificationReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getType&&e.getType()==Notification_model.TYPE_QUESTIONNAIRE){var n=e.getActionType(),o=e.getQuestionnaireMessage();if(null!=n&&null!=o)switch(n){case QuestionnaireNotification.ACTION_TYPE_ADD:t._addMessage(o);break;case QuestionnaireNotification.ACTION_TYPE_UPDATE:t._addMessage(o)}}},o._onTaskNotificationReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getType&&e.getType()==Notification_model.TYPE_TASK){var n=e.getActionType(),o=e.getTaskMessage();if(null!=n&&null!=o)switch(n){case TaskNotification.ACTION_TYPE_ADD:t._addMessage(o);break;case TaskNotification.ACTION_TYPE_UPDATE:var i=t._messageDataList.getByItemId(o.getItemId());null!=i&&(o.setPreStatus(i.getStatus()),o.setPreOwnerJid(i.getOwnerJid()),o.setPreTitle(i.getTitle()),o.setPreMessage(i.getMessage()),o.setPreProgress(i.getProgress()),o.setPreSpentTime(i.getSpentTime()),o.setPreEstimatedTime(i.getEstimatedTime()),o.setPreRemainingTime(i.getRemainingTime()),o.setPreGoal(i.getGoal()),o.setPreAlert(i.getAlert())),t._addMessage(o)}}},o._onSystemNotificationReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getType&&e.getType()==Notification_model.TYPE_SYSTEM){var n=e.getSystemMessage();null!=n&&t._addMessage(n)}},o._onMessageOptionReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getType&&e.getType()==Notification_model.TYPE_MESSAGE_OPTION){var n=e.getContentType();switch(n){case MessageOptionNotification.CONTENT_TYPE_SIBLING_TASK:t._onUpdateSiblingTaskReceived(e);break;case MessageOptionNotification.CONTENT_TYPE_DEMAND_TASK:t._onDemandTaskReceived(e);break;case MessageOptionNotification.CONTENT_TYPE_SET_READ_MESSAGE:t._onSetReadMessageReceived(e)}}},o._onDeleteMessageNotificationReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getType&&e.getType()==Notification_model.TYPE_DELETE_MESSAGE){var n=e.getItemId();if(null!=n){var o=e.getDeleteFlag(),i=t.getMessage(n);if(null!=i){if(i.setDeleteFlag(e.getDeleteFlag()),2==o){var a=e.getAdminDeleted();a?i.setMessage("deleted_by_admin"):i.setMessage("deleted"),i.getAttachedFileUrlList().removeAll()}t._messageDataList.setByKey(n,i)}2!=o&&t._messageDataList.removeByKey(n)}}},o._onUpdateSiblingTaskReceived=function(t){var n=this;if(null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))&&null!=t.getType&&t.getType()==Notification_model.TYPE_MESSAGE_OPTION){var o=t.getContentType();if(o==MessageOptionNotification.CONTENT_TYPE_SIBLING_TASK){var i=t.getItemId(),a=n.getMessage(i);if(null!=a){var r=t.getSiblingItemId(),s=a.getSiblingTaskDataList(),l=s.getBySiblingItemId(r);null!=l?(l.setItemId(i),l.setSiblingOwnerJid(t.getOwnerJid()),l.setSiblingTaskStatus(t.getStatus())):(l=new SiblingTaskData,l.setItemId(i),l.setSiblingItemId(r),l.setSiblingOwnerJid(t.getOwnerJid()),l.setSiblingTaskStatus(t.getStatus()),l.setNickName(t.getNickName()),l.setAvatarType(t.getAvatarType()),l.setAvatarData(t.getAvatarData()),l.setLoginAccount(t.getLoginAccount()),l.setStatus(t.getUserStatus()),s.add(l));var u=e();null!=u&&e().onNotificationReceived(t)}}}},o._onDemandTaskReceived=function(t){var n=this;if(null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))&&null!=t.getType&&t.getType()==Notification_model.TYPE_MESSAGE_OPTION){var o=t.getContentType();if(o==MessageOptionNotification.CONTENT_TYPE_DEMAND_TASK){var i=n.getMessage(t.getItemId());if(null!=i){i.setDemandStatus(t.getDemandStatus()),i.setDemandDate(t.getDemandDate());var a=e();null!=a&&e().onNotificationReceived(t)}}}},o._onSetReadMessageReceived=function(t){var n=this;if(null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))&&null!=t.getType&&t.getType()==Notification_model.TYPE_MESSAGE_OPTION){var o=t.getContentType();if(o==MessageOptionNotification.CONTENT_TYPE_SET_READ_MESSAGE){var i=n.getMessage(t.getItemId());if(null!=i){var a=e();null!=a&&e().onNotificationReceived(t);var r=t.getExistingReaderItem();if(LoginUser.getInstance().getJid()!=r.getPerson().getJid()||i.getReadFlag()!=Message.READ_STATUS_READ){var s=i.getExistingReaderInfo();if(null==s)return s=new MessageExistingReaderInfo,s.setAllCount(1),s.getExistingReaderItemList().add(r),void i.setExistingReaderInfo(s);var l=s.getAllCount();s.setAllCount(l+1),s.getExistingReaderItemList().removeAll(),s.getExistingReaderItemList().add(r)}}}}},o._onGroupChatMessageNotificationReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getType&&e.getType()==Notification_model.TYPE_GROUP_CHAT&&e.getSubType()==GroupChatNotification.SUB_TYPE_MESSAGE){var n=e.getGroupChatMessage();null!=n&&t._addMessage(n)}},o._onMailMessageNotificationReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getType()&&e.getType()==Notification_model.TYPE_MAIL){var n=e.getMailMessage();null!=n&&t._addMessage(n)}},o._onCommunityMessageNotificationReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&e.getType()==Notification_model.TYPE_COMMUNITY&&e.getSubType()==CommunityNotification.SUB_TYPE_MESSAGE){var n=e.getCommunityMessage();null!=n&&t._addMessage(n)}},o._onMurmurMessageNotificationReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&e.getType()==Notification_model.TYPE_MURMUR&&e.getSubType()==MurmurNotification.SUB_TYPE_MESSAGE){var n=e.getMurmurMessage();null!=n&&t._addMessage(n)}},o._onMurmurSetColumnNameNotificationReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&e.getType()==Notification_model.TYPE_MURMUR&&e.getSubType()==MurmurNotification.SUB_TYPE_SET_COLUMN_NAME)for(var n=0;n<t._messageDataList._length;n++){var o=t._messageDataList.get(n);o.getType()==Message.TYPE_MURMUR&&o.getTo()==e.getJid()&&t._messageDataList.get(n).setColumnName(e.getColumnName())}},o._onThreadTitleUpdateNotificationReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&e.getType()==Notification_model.TYPE_THREAD_TITLE)for(var n=0;n<t._messageDataList._length;n++)t._messageDataList.get(n).getThreadRootId()==e.getThreadRootId()&&t._messageDataList.get(n).setThreadTitle(e.getThreadTitle())},o._onMessageUpdateNotificationReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&e.getType()==Notification_model.TYPE_MESSAGE_UPDATE){var n=e.getMessage().getItemId();t._messageDataList.getByKey(n)&&t._messageDataList.setByKey(n,e.getMessage())}},o._onEmotionPointNotificationReceived=function(t){var n=this,o=t.getItemId(),i=n.getMessage(o);if(null!=i){var a=t.getFromJid(),r=i.getEmotionPointList(),s=r.getByJid(a),l=t.getEmotionPoint();if(s){var u=s.getEmotionPoint();if(u&&""==l)return void r.removeByJid(a);if(l&&l!=u)return void r.getByJid(a).setEmotionPoint(l)}if(""!=l){var c=new EmotionPointData;c.setJid(a);var d=new Date(t.getCreatedAt()),g=new Date(t.getUpdatedAt());c.setCreatedAt(d),c.setUpdatedAt(g),c.setNickName(t.getNickName()),c.setAvatarType(t.getAvatarType()),c.setAvatarData(t.getAvatarData()),c.setLoginAccount(t.getLoginAccount()),c.setStatus(t.getStatus()),c.setEmotionPoint(l),r.add(c);var m=e();null!=m&&e().onNotificationReceived(t)}}},o._onNoteAssignChangedNotificationReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getType();if(n==Notification_model.TYPE_ASSIGN_NOTE||n==Notification_model.TYPE_DELETE_NOTE)if(n==Notification_model.TYPE_ASSIGN_NOTE){var o=e.getThreadRootId(),i=e.getOldThreadRootId();if(o&&!i)for(var a=0;a<t._messageDataList._length;a++)t._messageDataList.get(a).getThreadRootId()==o&&(t._messageDataList.get(a).setNoteTitle(e.getNoteTitle()),t._messageDataList.get(a).setNoteUrl(e.getNoteUrl()));else if(i&&!o)for(var a=0;a<t._messageDataList._length;a++)t._messageDataList.get(a).getThreadRootId()==i&&(t._messageDataList.get(a).setNoteTitle(""),t._messageDataList.get(a).setNoteUrl(""))}else if(n==Notification_model.TYPE_DELETE_NOTE)for(var o=e.getThreadRootId(),a=0;a<t._messageDataList._length;a++)t._messageDataList.get(a).getThreadRootId()==o&&(t._messageDataList.get(a).setNoteTitle(""),t._messageDataList.get(a).setNoteUrl(""))}},o.getMailBody=function(e,t){function n(e){var n=o._messageDataList.getByItemId(e.getItemId());if(null!=n){var i=new MailBody;i.setItemId(e.getItemId()),i.setJid(e.getJid()),i.setBody(e.getBody()),n.setBodyInfo(i)}o._addMessage(n),t(e)}var o=this;return null==e||"string"!=typeof e?!1:null!=t&&"function"!=typeof t?!1:CubeeServerConnector.getInstance().getMailBody(e,n)},o.getThreadMessage=function(e,t){function n(e){t(e)}return null==e||"string"!=typeof e?!1:null!=t&&"function"!=typeof t?!1:CubeeServerConnector.getInstance().getThreadMessage(e,n)},o.searchMessage=function(e,t,o,i){function a(e){for(var t=e.messageDataList.getCount(),n=0;t>n;n++)r._addMessage(e.messageDataList.get(n));if(null!=e.childrenMessageDataList)for(var o=e.childrenMessageDataList.getCount(),n=0;o>n;n++)r._addMessage(e.childrenMessageDataList.get(n));i(e)}var r=this;return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==o||"object"!=("undefined"==typeof o?"undefined":_typeof(o))?!1:null==i||"function"!=typeof i?!1:n().searchMessage(e,t,o,a)},o.onAddMessageView=function(e){var t=this;if(null==e||"string"!=typeof e)return!1;var n=t._messageDataList.getByItemId(e),o=t._viewRefarenceCounter;return null==n?(delete o[e],!1):(null==t._viewRefarenceCounter[e]?o[e]=1:o[e]+=1,!0)},o.onRemoveMessageView=function(e){var t=this;if(null==e||"string"!=typeof e)return!1;var n=t._messageDataList.getByItemId(e),o=t._viewRefarenceCounter;if(null==n)return delete o[e],!1;if(null==t._viewRefarenceCounter[e])return!1;if(o[e]-=1,o[e]<=0){var i=function(){o[e]<=0&&(t._messageDataList.removeByKey(e),t._replyManager.deleteItem(e),t._childrenManager.deleteItem(e),delete o[e])};setTimeout(i,10)}return!0},o.onAddParentMessageRefarence=function(e){var t=this;return t._childrenManager.onAddParentMessageRefarence(e)},o.onRemoveParentMessageRefarence=function(e){var t=this;return t._childrenManager.onRemoveParentMessageRefarence(e)},o.onRemoveAllMessageView=function(){var e=this;return e._messageDataList.removeAll(),e._replyManager.cleanUp(),e._childrenManager.cleanUp(),delete e._viewRefarenceCounter,e._viewRefarenceCounter={},!0},o.updateThreadTitle=function(e,t){return new Promise(function(n,o){return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?void o(!1):null==t||"string"!=typeof t?void o(!1):void CubeeServerConnector.getInstance().updateThreadTitle(e,t).then(function(e){n(e)})["catch"](function(e){o(e)})})},o.getThreadTitleList=function(e){return new Promise(function(t,n){return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?void CubeeServerConnector.getInstance().getThreadTitleList(e).then(function(e){t(e)})["catch"](function(e){n(e)}):void n(!1)})},o.updateMessage=function(e,t){return new Promise(function(n,o){return e&&"string"==typeof e&&t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))?void CubeeServerConnector.getInstance().updateMessage(e,t).then(function(e){n(e)})["catch"](function(e){o(e)}):void o(!1)})},o.sendQuoteMessage=function(e){return new Promise(function(t,n){return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?void CubeeServerConnector.getInstance().sendQuoteMessage(e).then(function(e){t(e)})["catch"](function(e){n(e)}):void n(!1)})},o.sendEmotionPoint=function(e,t,n){return null==e||"string"!=typeof e?!1:null==t||"number"!=typeof t?!1:null==n||"function"!=typeof n?!1:CubeeServerConnector.getInstance().sendEmotionPoint(e,t,n)},o.getGoodJobTotal=function(e,t){return new Promise(function(n,o){return e&&void 0!=t&&"string"==typeof e&&"string"==typeof t?void CubeeServerConnector.getInstance().getGoodJobTotal(e,t).then(function(e){n(e)})["catch"](function(e){o(e)}):void o(!1)})},o.getThanksPointsTotal=function(e,t){return new Promise(function(n,o){return e&&void 0!=t&&"string"==typeof e&&"string"==typeof t?void CubeeServerConnector.getInstance().getThanksPointsTotal(e,t).then(function(e){n(e)})["catch"](function(e){o(e)}):void o(!1)})},o.getGoodJobRanking=function(e,t,n,o){return new Promise(function(i,a){return e&&"string"==typeof e?"number"!=typeof t||"number"!=typeof n||"number"!=typeof o?void a(!1):void CubeeServerConnector.getInstance().getGoodJobRanking(e,t,n,o).then(function(e){i(e)})["catch"](function(e){a(e)}):void a(!1)})},o.getThanksPointsRanking=function(e,t,n,o){return new Promise(function(i,a){return e&&"string"==typeof e?"number"!=typeof t||"number"!=typeof n||"number"!=typeof o?void a(!1):void CubeeServerConnector.getInstance().getThanksPointsRanking(e,t,n,o).then(function(e){i(e)})["catch"](function(e){a(e)}):void a(!1)})},o.getMurmurTotal=function(e,t){return new Promise(function(n,o){return e&&void 0!=t&&"string"==typeof e&&"string"==typeof t?void CubeeServerConnector.getInstance().getMurmurTotal(e,t).then(function(e){n(e)})["catch"](function(e){o(e)}):void o(!1)})},o.getMurmurRanking=function(e,t,n,o){return new Promise(function(i,a){return e&&"string"==typeof e?"number"!=typeof t||"number"!=typeof n||"number"!=typeof o?void a(!1):void CubeeServerConnector.getInstance().getMurmurRanking(e,t,n,o).then(function(e){i(e)})["catch"](function(e){a(e)}):void a(!1)})},o.disconnected=function(){var e=this;e._replyManager.disconnected(),e._childrenManager.disconnected(),e._messageDataList.removeAll()}}(),function(){var e=ReplyManager.prototype;e.addMessage=function(e){var t=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var n=e.getType();if(n!=Message.TYPE_PUBLIC&&n!=Message.TYPE_GROUP_CHAT&&n!=Message.TYPE_COMMUNITY&&n!=Message.TYPE_MURMUR)return!1;var o=e.getItemId();if(null==o||""==o)return!1;var i=e.getReplyItemId();return(null==i||""==i||"no_id"==i)&&(i=""),null!=t._replyChain[o]?!0:(t._replyChain[o]=i,""!=i&&(void 0===t._replyReverseChain[i]&&(t._replyReverseChain[i]=new ArrayList),t._replyReverseChain[i].add(o)),!0)},e.getReplyReverseItemIds=function(e){var t=this;if(null==e||"string"!=typeof e)return null;var n=t._replyReverseChain[e];return void 0===n?null:n},e.deleteItem=function(e){var t=this;if(null!=e&&"string"==typeof e){var n=t._replyChain[e];if(null!=n&&""!=n){var o=t._replyReverseChain[n];if(null!=o){for(var i=o.getCount(),a=0;i>a;a++){var r=o.get(a);if(r==e){o.remove(a);break}}o.getCount()<=0&&delete t._replyReverseChain[n]}}delete t._replyChain[e]}},e.disconnected=function(){var e=this;for(var t in e._replyChain)delete e._replyChain[t];for(var n in e._replyReverseChain)e._replyReverseChain[n].removeAll(),delete e._replyReverseChain[n];delete e._replyChain,delete e._replyReverseChain,e._replyChain={},e._replyReverseChain={}},e.cleanUp=function(){var e=this;delete e._replyChain,delete e._replyReverseChain,e._replyChain={},e._replyReverseChain={}}}(),function(){var e=TaskChildrenManager.prototype;e.addMessage=function(e){var t=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(e.getType()!=Message.TYPE_TASK)return!1;var n=e.getItemId();if(null==n||""==n)return!1;var o=e.getParentItemId();return null==o||""==o?!1:(void 0===t._children[o]&&(t._children[o]=new StringMapedStringArrayList),t._children[o].add(n,n),!0)},e.onAddParentMessageRefarence=function(e){var t=this;if(null==e||"string"!=typeof e)return!1;var n=t._viewRefarenceCounter;return null==t._viewRefarenceCounter[e]?n[e]=1:n[e]+=1,!0},e.onRemoveParentMessageRefarence=function(e){var t=this;if(null==e||"string"!=typeof e)return!1;var n=t._viewRefarenceCounter;if(null==t._viewRefarenceCounter[e])return!1;if(n[e]-=1,n[e]<=0){var o=function(){n[e]<=0&&t.deleteItem(e)};setTimeout(o,10)}return!0},e.getChildrenTaskItemIds=function(e){var t=this;if(null==e||"string"!=typeof e)return null;var n=t._children[e];return void 0===n?null:n},e.deleteItem=function(e){var t=this;return null==e||"string"!=typeof e?null:(delete t._children[e],void delete t._viewRefarenceCounter[e])},e.disconnected=function(){var e=this;for(var t in e._children)e._children[t].removeAll(),delete e._children[t];delete e._children,e._children={}},e.cleanUp=function(){var e=this;delete e._children,e._children={}}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(){return CubeeController.getInstance()._messageManager}function t(){return CubeeController.getInstance().getChatroomManager()}function n(){return CubeeController.getInstance()._communityManager}function o(){return CubeeController.getInstance()._personManager}var i="chat",a=NotificationManager.prototype;a.onNotificationReceived=function(i){if(null!=i&&"object"==("undefined"==typeof i?"undefined":_typeof(i))&&null!=i.getType){var a=i.getType();switch(a){case Notification_model.TYPE_MESSAGE_OPTION:case Notification_model.TYPE_GOOD_JOB:case Notification_model.TYPE_EMOTION_POINT:var r=e();null!=r&&r.onNotificationReceived(i);break;case Notification_model.TYPE_TASK:var r=e();null!=r&&r.onNotificationReceived(i);break;case Notification_model.TYPE_QUESTIONNAIRE:var r=e();null!=r&&r.onNotificationReceived(i);break;case Notification_model.TYPE_CHAT:break;case Notification_model.TYPE_SYSTEM:var r=e();null!=r&&r.onNotificationReceived(i);break;case Notification_model.TYPE_DELETE_MESSAGE:var r=e();null!=r&&r.onNotificationReceived(i);break;case Notification_model.TYPE_GROUP_CHAT:var s=i.getSubType();if(s==GroupChatNotification.SUB_TYPE_MESSAGE){var r=e();null!=r&&r.onNotificationReceived(i)}else{var l=t();null!=l&&l.onNotificationReceived(i)}break;case Notification_model.TYPE_MAIL:var r=e();null!=r&&r.onNotificationReceived(i);break;case Notification_model.TYPE_COMMUNITY:var s=i.getSubType();if(s==CommunityNotification.SUB_TYPE_MESSAGE){var r=e();null!=r&&r.onNotificationReceived(i)}else{var u=n();null!=u&&u.onNotificationReceived(i)}break;case Notification_model.TYPE_MURMUR:var s=i.getSubType();if(s==MurmurNotification.SUB_TYPE_MESSAGE||s==MurmurNotification.SUB_TYPE_SET_COLUMN_NAME){var r=e();null!=r&&r.onNotificationReceived(i)}break;case Notification_model.TYPE_AUTHORITY_CHANGED:var s=i.getSubType(),c=i.getUpdatedItem();if(s==AuthorityInfoUpdateNotification.SUB_TYPE_POLICY_ASSIGN){var d=c.getAction(),g=c.getResourceId();if(null==d||null==g)break;AuthorityInfo.getInstance().setRightForResource(d,g)}else if(s==AuthorityInfoUpdateNotification.SUB_TYPE_POLICY_UNASSIGN){var d=c.getAction(),g=c.getResourceId();if(null==d||null==g)break;AuthorityInfo.getInstance().removeRightForResource(d,g)}break;case Notification_model.TYPE_THREAD_TITLE:case Notification_model.TYPE_MESSAGE_UPDATE:case Notification_model.TYPE_ASSIGN_NOTE:case Notification_model.TYPE_DELETE_NOTE:var r=e();r&&"object"==("undefined"==typeof r?"undefined":_typeof(r))&&r.onNotificationReceived(i);break;case Notification_model.TYPE_USER_FOLLOW:var m=o();m&&"object"==("undefined"==typeof m?"undefined":_typeof(m))&&m.onNotificationReceived(i)}}},a.disconnected=function(){},a.setChatMessageData=function(e,t){var n=this,o=null,a=null;o=n._notificationList.getByKey(i),null==o?(o=new StringMapedArrayList,a=new ArrayList,a.add(t)):(a=o.getByKey(e),null==a?(a=new ArrayList,a.add(t)):(a.add(t),o.removeByKey(e)),n._notificationList.removeByKey(i)),o.add(e,a),n._notificationList.add(i,o)},a.getChatMessageListByJid=function(e){var t=this,n=t._notificationList.getByKey(i),o=n.getByKey(e);return o},a.removeChatMessageListByJid=function(e){var t=this;t._notificationList.getByKey(i).removeByKey(e)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t){if(null==e||"string"!=typeof e)return null;if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return null;var n=null;if(1==t.getCount())n=new ItemCondition,n.setData(e,t.get(0));else{n=new OrCondition;for(var o=t.getCount(),i=0;o>i;i++){var a=new ItemCondition;a.setData(e,t.get(i)),n.addChildCondition(a)}}var r=new ColumnSortCondition;return r.getItems().removeAll(),r.getItems().add("login_account"),r.getOrders().removeAll(),r.getOrders().add(ColumnSortCondition.SORT_ORDER_ASC),new ColumnSearchCondition(n,r)}var t=PersonManager.prototype;t.setLoginedUserData=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getLoginUserPerson&&"function"==typeof e.getLoginUserPerson&&null!=e.getContactList&&"function"==typeof e.getContactList){var n=e.getLoginUserPerson(),o=e.getContactList();t._loginUserManager.setLoginedLoginUserData(n),t._contactListManger.setLoginedContactListData(o)}},t.changePresence=function(e,t){var n=this;return null!=e&&"string"!=typeof e?!1:null!=t&&"string"!=typeof t?!1:n._loginUserManager.changePresence(e,t)},t.decideSendPresence=function(e){var t=this;return null==e||"boolean"!=typeof e?"":t._loginUserManager.decideSendPresence(e)},t.changeProfile=function(e,t){var n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:n._loginUserManager.changeProfile(e,t)},t.changePassword=function(e,t,n){var o=this;return null==e||"string"!=typeof e?!1:null==t||"string"!=typeof t?!1:null!=n&&"function"!=typeof n?!1:o._loginUserManager.changePassword(e,t,n)},t.changeMailCooperationSetting=function(e,t){var n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:n._loginUserManager.changeMailCooperationSetting(e,t)},t.onProfileChanged=function(e){var t=this;null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(t._loginUserManager.onProfileChanged(e),t._contactListManger.onProfileChanged(e),t._followFollowesManager.onProfileChanged(e),t._noConnectionUserManager.onProfileChanged(e))},t.getPersonData=function(e){var t=this;return null==e||"string"!=typeof e?null:t._loginUserManager.getPersonData(e)||t._contactListManger.getPersonData(e)||t._followFollowesManager.getPersonData(e)},t.getPersonDataByLoginAccount=function(e){var t=this;return null==e||"string"!=typeof e?null:t._loginUserManager.getPersonDataByLoginAccount(e)||t._contactListManger.getPersonDataByLoginAccount(e)||t._followFollowesManager.getPersonDataByLoginAccount(e)||t._noConnectionUserManager.getPersonDataByLoginAccount(e)},t.getContactListData=function(e){var t=this;return null==e||"string"!=typeof e?null:t._contactListManger.getPersonData(e)},t.onNotificationReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getType&&(e.getType()==Notification_model.TYPE_GOOD_JOB||e.getType()==Notification_model.TYPE_MESSAGE_OPTION||e.getType()==Notification_model.TYPE_USER_FOLLOW)){var n=e.getType();switch(n){case Notification_model.TYPE_GOOD_JOB:var o=e,i=o.getFromJid(),a=t.getPersonData(i);null!=a?a.setUserName(o.getFromName()):(a=new Person,a.setJid(o.getFromJid()),a.setUserName(o.getFromName()),a.setAvatarType(o.getAvatarType()),a.setAvatarData(o.getAvatarData()),a.setLoginAccount(o.getLoginAccount()),a.setStatus(o.getStatus()),a.setUserName(o.getNickName()),t._noConnectionUserManager.addPersonData(a));break;case Notification_model.TYPE_MESSAGE_OPTION:t._onMessageOptionReceived(e);break;case Notification_model.TYPE_USER_FOLLOW:t._onUserFollowReceived(e)}}},t._onMessageOptionReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getType&&e.getType()==Notification_model.TYPE_MESSAGE_OPTION){var n=e.getContentType();switch(n){case MessageOptionNotification.CONTENT_TYPE_SIBLING_TASK:t._onUpdateSiblingTaskReceived(e);break;case MessageOptionNotification.CONTENT_TYPE_DEMAND_TASK:t._onDemandTaskReceived(e);break;case MessageOptionNotification.CONTENT_TYPE_SET_READ_MESSAGE:t._onSetReadMessageReceived(e)}}},t._onUpdateSiblingTaskReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getType&&e.getType()==Notification_model.TYPE_MESSAGE_OPTION){var n=e.getContentType();if(n==MessageOptionNotification.CONTENT_TYPE_SIBLING_TASK){var o=e.getOwnerJid(),i=t.getPersonData(o);null!=i?i.setUserName(e.getOwnerName()):(i=new Person,i.setJid(o),i.setUserName(e.getOwnerName()),i.setAvatarType(e.getAvatarType()),i.setAvatarData(e.getAvatarData()),i.setLoginAccount(e.getLoginAccount()),i.setStatus(e.getUserStatus()),i.setUserName(e.getNickName()),t._noConnectionUserManager.addPersonData(i))}}},t._onDemandTaskReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getType&&e.getType()==Notification_model.TYPE_MESSAGE_OPTION){var n=e.getContentType();if(n==MessageOptionNotification.CONTENT_TYPE_DEMAND_TASK){var o=e.getJid(),i=e.getNickName(),a=t.getPersonData(o);null!=a?a.setUserName(i):(a=new Person,a.setJid(o),a.setUserName(i),t._noConnectionUserManager.addPersonData(a))}}},t._onSetReadMessageReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getType&&e.getType()==Notification_model.TYPE_MESSAGE_OPTION){var n=e.getContentType();if(n==MessageOptionNotification.CONTENT_TYPE_SET_READ_MESSAGE){var o=e.getExistingReaderItem(),i=o.getPerson(),a=i.getJid(),r=i.getUserName(),s=i.getAvatarData(),l=i.getAvatarType(),u=t.getPersonData(a);null!=u?(u.setUserName(r),u.setAvatarData(s),u.setAvatarType(l)):t._noConnectionUserManager.addPersonData(i)}}},t._onUserFollowReceived=function(e){var t=e._actionType,n=e._followeeJid,o=e._followerJid;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getType&&e.getType()==Notification_model.TYPE_USER_FOLLOW){var i=LoginUser.getInstance().getJid();if("addUserFollow"==t)if(o==i){for(var a=LoginUser.getInstance().getFolloweeList(),r=0;r<a.getCount();r++){var s=a.get(r).getJid();if(n==s)return}for(var l=e.getPersonInfo(),u=0;u<l.getCount();u++){var c=l.get(u).getJid();n==c&&LoginUser.getInstance().getFolloweeList().add(l.get(u))}}else{for(var a=LoginUser.getInstance().getFollowerList(),r=0;r<a.getCount();r++){var s=a.get(r).getJid();if(o==s)return}for(var l=e.getPersonInfo(),u=0;u<l.getCount();u++){var c=l.get(u).getJid();o==c&&LoginUser.getInstance().getFollowerList().add(l.get(u))}}if("delUserFollow"==t)if(o==i){for(var a=LoginUser.getInstance().getFolloweeList(),d=[],r=0;r<a.getCount();r++){var s=a.get(r).getJid();n==s&&d.push(r)}for(var g=d.sort(),u=g.length;u>0;u--)LoginUser.getInstance().getFolloweeList().remove(g[u-1])}else{for(var a=LoginUser.getInstance().getFollowerList(),d=[],r=0;r<a.getCount();r++){var s=a.get(r).getJid();o==s&&d.push(r)}for(var g=d.sort(),u=g.length;u>0;u--)LoginUser.getInstance().getFollowerList().remove(g[u-1])}for(var m=ColumnFilterManager.getColumnFilter(ColumnInformation.TYPE_COLUMN_RECENT,null),_=new ColumnSortCondition,f=new ColumnSearchCondition(m,_),p=ColumnManager.getInstance().getColumnList(),h=0;h<p.getCount();h++){var C=p.get(h);C.getColumnType()==ColumnInformation.TYPE_COLUMN_RECENT&&p.get(h).setSearchCondition(f)}SideMenuRecentView.getInstance().getColumnInfo().setSearchCondition(f),SideMenuMurmurView.getInstance().getColumnInfo().setSearchCondition(f);var v=$("#side-bar-murmur").css("display");$("#side-bar-murmur").css("display","none"),SideMenuMurmurView.getInstance().clearColumn(),SideMenuMurmurView.getInstance().showMurmurHistory(),"none"!=v&&setTimeout(function(){SideMenuMurmurView.getInstance().open()},300)}},t.clearPrePresence=function(){var e=this;e._loginUserManager.clearPrePresence()},t.getFollowList=function(){var e=this;return e._followFollowesManager.getFollowList()},t.disconnected=function(){var e=this;e._loginUserManager.disconnected(),e._contactListManger.disconnected(),e._followFollowesManager.disconnected(),e._noConnectionUserManager.disconnected()},t.isContactListMember=function(e){var t=this;if(null==e||"string"!=typeof e)return!1;var n=!1,o=t._contactListManger.getPersonData(e);return o&&(n=!0),n},t.getPersonDataByJidFromServer=function(t,n){var o=this;if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t))||t.getCount()<=0)return!1;if(null==n||"function"!=typeof n)return!1;for(var i=new StringMapedArrayList,a=new ArrayList,r=0;r<t.getCount();r++){var s=t.get(r),l=o.getPersonData(s);l?i.add(s,l):a.add(s)}if(a.getCount()<=0)return setTimeout(function(){n(i)},1),!0;var u=function(e){if(e)for(var t=e.getCount(),o=0;t>o;o++){var a=e.get(o);null!=a&&i.add(a.getJid(),a)}n(i)},c=0,d=t.getCount(),g=e("jid",a);return g?o.searchPerson(c,d,g,u):!1},t.getPersonDataByLoginAccountFromServer=function(t,n){var o=this;if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t))||t.getCount()<=0)return!1;if(null==n||"function"!=typeof n)return!1;for(var i=new StringMapedArrayList,a=new ArrayList,r=0;r<t.getCount();r++){var s=t.get(r),l=o.getPersonDataByLoginAccount(s);l?i.add(s,l):a.add(s)}if(a.getCount()<=0)return setTimeout(function(){n(i)},1),!0;var u=function(e){if(e)for(var t=e.getCount(),o=0;t>o;o++){var a=e.get(o);null!=a&&i.add(a.getLoginAccount(),a)}n(i)},c=0,d=t.getCount(),g=e("login_account",a);return g?o.searchPerson(c,d,g,u):!1},t.searchPerson=function(e,t,n,o){
function i(e){o(e)}return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))?!1:null==o||"function"!=typeof o?!1:CubeeServerConnector.getInstance().searchPerson(e,t,n,i)},t.addContactListMember=function(e,t){var n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:n._contactListManger.addContactListMember(e,t)},t.removeContactListMember=function(e,t){var n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:n._contactListManger.removeContactListMember(e,t)},PersonManager.setProfile=function(e,t){if(null!=e&&null!=t){var n=t.getNickName();n=null==n||0==n.length?null:n,e.setUserName(n);var o=t.getGroup();o=null!=o&&Array.isArray(o)&&0!=o.length?o:[],e.setGroup(o),e.setAvatarType(t.getAvatarType()),e.setAvatarData(t.getAvatarData())}},t.getGroupList=function(){return new Promise(function(e,t){CubeeServerConnector.getInstance().getGroupList().then(function(t){e(t)})["catch"](function(e){t(e)})})},t.getFolloweeList=function(e){return new Promise(function(t,n){CubeeServerConnector.getInstance().getFolloweeList(e).then(function(e){t(e)})["catch"](function(e){n(e)})})},t.getFollowerList=function(e){return new Promise(function(t,n){CubeeServerConnector.getInstance().getFollowerList(e).then(function(e){t(e)})["catch"](function(e){n(e)})})},t.getFollowInfo=function(e){return new Promise(function(t,n){CubeeServerConnector.getInstance().getFollowInfo(e).then(function(e){t(e)})["catch"](function(e){n(e)})})},t.addUserFollow=function(e){return new Promise(function(t,n){CubeeServerConnector.getInstance().addUserFollow(e).then(function(e){t(e)})["catch"](function(e){n(e)})})},t.delUserFollow=function(e){return new Promise(function(t,n){CubeeServerConnector.getInstance().delUserFollow(e).then(function(e){t(e)})["catch"](function(e){n(e)})})}}(),function(){var e=ContactListManager.prototype;e.setLoginedContactListData=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e)))for(var t=ContactList.getInstance(),n=e.getCount(),o=0;n>o;o++)t.add(e.get(o))},e.onProfileChanged=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=ContactList.getInstance(),n=t.getByJid(e.getJid());if(null!=n)switch(e.getType()){case ProfileChangeNotice.TYPE_PRESENCE:n.setPresence(e.getPresence()),n.setMyMemo(e.getMyMemo());break;case ProfileChangeNotice.TYPE_PROFILE:var o=e.getProfile();if(null==o)return;PersonManager.setProfile(n,o)}}},e.getPersonData=function(e){if(null==e||"string"!=typeof e)return null;var t=ContactList.getInstance();return t.getByJid(e)},e.getPersonDataByLoginAccount=function(e){if(null==e||"string"!=typeof e)return null;var t=ContactList.getInstance();return t.getByLoginAccount(e)},e.disconnected=function(){var e=ContactList.getInstance();e.removeAll()},e.addContactListMember=function(e,t){function n(e,n){if(e)for(var o=e.addSuccessMemberList,i=ContactList.getInstance(),a=o.getCount(),r=0;a>r;r++)i.add(o.get(r).getPerson());t(e,n)}return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:CubeeServerConnector.getInstance().addContactListMember(e,n)},e.removeContactListMember=function(e,t){function n(e,n){if(e)for(var o=e.removeSuccessMemberList,i=ContactList.getInstance(),a=o.getCount(),r=0;a>r;r++)i.removeByJid(o.get(r).jid);t(e,n)}return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:CubeeServerConnector.getInstance().removeContactListMember(e,n)}}(),function(){var e=FollowFollowersManager.prototype;e.onProfileChanged=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=FollowList.getInstance(),n=t.getByJid(e.getJid()),o=FollowerList.getInstance(),i=o.getByJid(e.getJid());switch(e.getType()){case ProfileChangeNotice.TYPE_PRESENCE:null!=n&&(n.setPresence(e.getPresence()),n.setMyMemo(e.getMyMemo())),null!=i&&(i.setPresence(e.getPresence()),i.setMyMemo(e.getMyMemo()));break;case ProfileChangeNotice.TYPE_PROFILE:var a=e.getProfile();if(null==a)return;null!=n&&PersonManager.setProfile(n,a),null!=i&&PersonManager.setProfile(i,a)}}},e.getPersonData=function(e){if(null==e||"string"!=typeof e)return null;var t=FollowList.getInstance(),n=FollowerList.getInstance();return t.getByJid(e)||n.getByJid(e)},e.getPersonDataByLoginAccount=function(e){if(null==e||"string"!=typeof e)return null;var t=FollowList.getInstance(),n=FollowerList.getInstance();return t.getByLoginAccount(e)||n.getByLoginAccount(e)},e.getFollowList=function(){var e=ContactList.getInstance();return e},e.disconnected=function(){var e=FollowList.getInstance();e.removeAll();var t=FollowerList.getInstance();t.removeAll()}}(),function(){var e=LoginUserManager.prototype;e.setLoginedLoginUserData=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=LoginUser.getInstance(),n=Person.PRESENCE_STATUS_ONLINE,o="";t.setPresence(n),t.setMyMemo(o),t.setUserName(e.getUserName()),t.setMailAddress(e.getMailAddress()),t.setJid(e.getJid()),t.setAvatarType(e.getAvatarType()),t.setAvatarData(e.getAvatarData()),t.setSettings(e.getSettings()),t.setLoginAccount(e.getLoginAccount()),t.setStatus(e.getStatus()),t.setGroup(e.getGroup()),t.setTenantInfo(e.getTenantInfo())}},e.changePresence=function(e,t){if(null!=e&&"string"!=typeof e)return!1;if(null!=t&&"string"!=typeof t)return!1;var n,o=LoginUser.getInstance();n=null==e?o.getPresence():Utils.convertPresenceStrToNum(e);var i=t;null==i&&(i=o.getMyMemo());var a=CubeeServerConnector.getInstance().changePresence(n,i);return a&&(o.setPresence(n),o.setMyMemo(i)),a},e.changeProfile=function(e,t){function n(e){t(e)}if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null!=t&&"function"!=typeof t)return!1;var o=LoginUser.getInstance();null==e.getNickName()&&e.setNickName(o.getUserName()),null==e.getMailAddress()&&e.setMailAddress(o.getMailAddress());var i=e.getAvatarType(),a=e.getAvatarData();return(null==i||null==a)&&(null==i&&null==a?(e.setAvatarType(o.getAvatarType()),e.setAvatarData(o.getAvatarData())):(e.setAvatarType(""),e.setAvatarData(""))),CubeeServerConnector.getInstance().changeProfile(e,n)},e.changePassword=function(e,t,n){function o(e,t){n(e,t)}return null==e||"string"!=typeof e?!1:null==t||"string"!=typeof t?!1:null!=n&&"function"!=typeof n?!1:CubeeServerConnector.getInstance().changePassword(e,t,o)},e.changeMailCooperationSetting=function(e,t){function n(n,o){if(n){var i=LoginUser.getInstance();i.getSettings().setMailCooperationList(e)}t(n,o)}return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:CubeeServerConnector.getInstance().changeMailCooperationSetting(e,n)},e.onProfileChanged=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=LoginUser.getInstance();if(e.getJid()==t.getJid())switch(e.getType()){case ProfileChangeNotice.TYPE_PRESENCE:t.setPresence(e.getPresence()),t.setMyMemo(e.getMyMemo());break;case ProfileChangeNotice.TYPE_PROFILE:var n=e.getProfile();if(null==n)return;PersonManager.setProfile(t,n)}}},e.onProfileChanged=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=LoginUser.getInstance();if(e.getJid()==t.getJid())switch(e.getType()){case ProfileChangeNotice.TYPE_PRESENCE:t.setPresence(e.getPresence()),t.setMyMemo(e.getMyMemo());break;case ProfileChangeNotice.TYPE_PROFILE:var n=e.getProfile();if(null==n)return;PersonManager.setProfile(t,n)}}},e.getPersonData=function(e){if(null==e||"string"!=typeof e)return null;var t=LoginUser.getInstance();return t.getJid()!=e?null:t},e.getPersonDataByLoginAccount=function(e){if(null==e||"string"!=typeof e)return null;var t=LoginUser.getInstance();return t.getLoginAccount()!=e?null:t},e.decideSendPresence=function(e){var t=this,n="";if(null==e||"boolean"!=typeof e)return n;var o=LoginUser.getInstance(),i=o.getPresence();if(e){switch(i){case Person.PRESENCE_STATUS_ONLINE:case Person.PRESENCE_STATUS_EXT_AWAY:case Person.PRESENCE_STATUS_DO_NOT_DISTURB:n=Utils.convertPresenceNumToStr(i);break;case Person.PRESENCE_STATUS_AWAY:n=Utils.convertPresenceNumToStr(t._prePresence),""==n&&(n=Utils.convertPresenceNumToStr(i))}t.clearPrePresence()}else{switch(i){case Person.PRESENCE_STATUS_ONLINE:case Person.PRESENCE_STATUS_AWAY:n=Utils.convertPresenceNumToStr(Person.PRESENCE_STATUS_AWAY);break;case Person.PRESENCE_STATUS_EXT_AWAY:n=Utils.convertPresenceNumToStr(Person.PRESENCE_STATUS_EXT_AWAY);break;case Person.PRESENCE_STATUS_DO_NOT_DISTURB:n=Utils.convertPresenceNumToStr(Person.PRESENCE_STATUS_DO_NOT_DISTURB)}t._prePresence=i}return n},e.clearPrePresence=function(){var e=this;e._prePresence=null},e.disconnected=function(){var e=LoginUser.getInstance();e.cleanUp()}}(),function(){var e=NoConnectionUserManager.prototype;e.onProfileChanged=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=NoConnectionPersonList.getInstance(),n=t.getByJid(e.getJid());switch(e.getType()){case ProfileChangeNotice.TYPE_PRESENCE:null!=n&&(n.setPresence(e.getPresence()),n.setMyMemo(e.getMyMemo()));break;case ProfileChangeNotice.TYPE_PROFILE:var o=e.getProfile();if(null==o)return;if(null==n)return;PersonManager.setProfile(n,o)}}},e.getPersonData=function(e){if(null==e||"string"!=typeof e)return null;var t=NoConnectionPersonList.getInstance();return t.getByJid(e)},e.getPersonDataByLoginAccount=function(e){if(null==e||"string"!=typeof e)return null;var t=NoConnectionPersonList.getInstance();return t.getByLoginAccount(e)},e.addPersonData=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=NoConnectionPersonList.getInstance();return t.add(e)},e.disconnected=function(){var e=NoConnectionPersonList.getInstance();e.removeAll()}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=SearchManager.prototype;e.searchMessage=function(e,t,n,o){function i(e){o(e)}return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))?!1:null==o||"function"!=typeof o?!1:CubeeServerConnector.getInstance().searchMessage(e,t,n,i)},e.onNotificationReceived=function(e){},e.disconnected=function(){}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=ChatRoomManager.prototype;e.getRoomInfo=function(e,t){function n(t){if(t){for(var n=t.getRoomId(),i=o._chatroomInfoList.getCount(),a=!1,r=0;i>r;r++)if(n==o._chatroomInfoList.get(r).getRoomId()){a=!0;break}a||o._chatroomInfoList.add(t)}if(t&&o._chatroomInfoList.getByKey(t.getRoomId())){var s=o._chatroomInfoList.getByKey(t.getRoomId()),l=t.getProfileMap();if(l)for(var i=l.getCount(),r=0;i>r;r++){var u=t.getMemberList().get(r),c=l.getByKey(u);c&&s.getProfileMap().add(u,c)}}if(o._getRoomInfoRequestList[e]){var d=function(){for(var n=o._getRoomInfoRequestList[e].length,i=0;n>i;i++)o._getRoomInfoRequestList[e][i]&&o._getRoomInfoRequestList[e][i](t);delete o._getRoomInfoRequestList[e]};setTimeout(function(){d()},1)}}var o=this;if(null==e||"string"!=typeof e)return!1;if(null!=t&&"function"!=typeof t)return!1;if(o._getRoomInfoRequestList[e])return o._getRoomInfoRequestList[e].push(t),!0;o._getRoomInfoRequestList[e]=[],o._getRoomInfoRequestList[e].push(t);var i=CubeeServerConnector.getInstance().getRoomInfo(e,n);return i||delete o._getRoomInfoRequestList[e],i},e.getRoomInfoList=function(e,t,n,o,i){function a(e){for(var t=e.getCount(),n=0;t>n;n++)r._chatroomInfoList.add(e.get(n));i(e)}var r=this;return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))?!1:null==o||"object"!=("undefined"==typeof o?"undefined":_typeof(o))?!1:null==i||"function"!=typeof i?!1:CubeeServerConnector.getInstance().getRoomInfoList(e,t,n,o,a)},e.getPublicGroupRoomInfoList=function(e,t,n,o){function i(e){o(e)}return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))?!1:null==o||"function"!=typeof o?!1:CubeeServerConnector.getInstance().getPublicGroupRoomInfoList(e,t,n,i)},e.getChatRoomInfoList=function(){var e=this;return e._chatroomInfoList},e.getChatRoomInfoByRoomId=function(e){var t=this;return null==e||"string"!=typeof e?null:t._chatroomInfoList.getByRoomId(e)},e._addChatRoomInfo=function(e){var t=this;null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&t._chatroomInfoList.add(e)},e.addMember=function(e){function t(e){}var n=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var o=e.getRoomId(),i=n.getChatRoomInfoByRoomId(o);if(null==i)n.getRoomInfo(o,t);else{for(var a=e.getMemberList(),r=a.getCount(),s=0;r>s;s++){var l=a.get(s);i.getMemberList().add(l)}var u=e.getProfileMap()._map;for(var c in u){var d=e.getProfileMap().getByKey(c);i.getProfileMap().add(c,d)}}}},e._updateRoomInfo=function(e){var t=this;null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&t._addChatRoomInfo(e)},e.removeMember=function(e,t){function n(e){}var o=this;if(null!==e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!==t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var i=e.getRoomId(),a=o.getChatRoomInfoByRoomId(i);if(null===a)o.getRoomInfo(i,n);else for(var r=t.getCount(),s=0;r>s;s++){var l=t.get(s);a.removeMemberList(l)}}},e.onNotificationReceived=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getType){var n=e.getType();if(n==Notification_model.TYPE_GROUP_CHAT){var o=e.getSubType(),i=new ChatRoomInformation;switch(o){case GroupChatNotification.SUB_TYPE_CREATE_ROOM:var a=e;i=a.getRoomInfo();var r=30,s=function m(){var e=t.hasCreatingRoomIdList(i.getRoomId());null!=e||0==r?(null!=e&&e[i.getRoomId()]&&t._addChatRoomInfo(i),null!=e&&t.addCreatingRoomIdList(i.getRoomId()+"notification1",_defineProperty({},i.getRoomId(),!0))):(--r,setTimeout(m,1e3))};setTimeout(s,1e3);break;case GroupChatNotification.SUB_TYPE_ADD_MEMBER:var l=e;i=l.getRoomInfo(),t.addMember(i);break;case GroupChatNotification.SUB_TYPE_REMOVE_MEMBER:var i=e.getRoomInfo(),u=e.getRemovedMemberList();t.removeMember(i,u);break;case GroupChatNotification.SUB_TYPE_UPDATE_ROOM_INFO:for(var c=e.getUpdatedItems(),d=0;d<c.length;d++)switch(c[d]){case GroupChatInfoUpdateNotification.SUB_TYPE_CHANGE_ROOM_NAME:var g=e;i=g.getRoomInfo(),i.setPreRoomName(g.getPreviousRoomName()),t._updateRoomInfo(i);break;case GroupChatInfoUpdateNotification.SUB_TYPE_CHANGE_ROOM_PRIVACY_TYPE:var g=e;i=g.getRoomInfo(),t._updateRoomInfo(i)}}}}},e.removeChatRoomMember=function(e,t,n,o){function i(e){o(e)}return null==e||"string"!=typeof e?!1:null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t))?!1:null==n||"string"!=typeof n||"own"!=n&&"member"!=n?!1:null==o||"function"!=typeof o?!1:CubeeServerConnector.getInstance().removeChatRoomMember(e,t,n,i)},e.removePublicChatRoomMember=function(e,t){function n(e){t(e)}return null==e||"string"!=typeof e?!1:null==t||"function"!=typeof t?!1:CubeeServerConnector.getInstance().removePublicChatRoomMember(e,n)},e.addCreatingRoomIdList=function(e,t){this._creatingRoomIdList.add(e,t)},e.hasCreatingRoomIdList=function(e){return this._creatingRoomIdList.getByKey(e)},e.delCreatingRoomIdList=function(e){return this._creatingRoomIdList.removeByKey(e)},e.disconnected=function(){}}(),function(){var e=MailServerManager.prototype;e.getServerInfoListFirst=function(e){function t(t){n._mailServerInfoList.removeAll();for(var o=t.getCount(),i=0;o>i;i++)n._mailServerInfoList.add(t.get(i));e(t)}var n=this;return null!=e&&"function"!=typeof e?!1:CubeeServerConnector.getInstance().getServerList(t)},e.getServerInfoList=function(){var e=this;return e._mailServerInfoList},e.getServerInfoById=function(e){var t=this;if(null==e||"number"!=typeof e)return null;for(var n=null,o=0;o<t._mailServerInfoList.getCount();o++)if(t._mailServerInfoList.get(o).getId()==e){n=t._mailServerInfoList.get(o);break}return n},e.disconnected=function(){}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t,n,o,i,a,r){return null==e||"function"!=typeof e?!1:null==t||"function"!=typeof t?!1:null==n||"function"!=typeof n?!1:null==o||"function"!=typeof o?!1:null==i||"function"!=typeof i?!1:null==a||"function"!=typeof a?!1:null==r||"function"!=typeof r?!1:!0}var t=new CubeeController;CubeeController.getInstance=function(){return t};var n=CubeeController.prototype;n.getImageData=function(e){return e&&"string"==typeof e?this._imageDataMap[e]:null},n.setImageData=function(e,t){return e&&"string"==typeof e?t?void(this._imageDataMap[e]=t):void delete this._imageDataMap[e]:void 0},n.login=function(t,n,o,i,a,r,s,l,u,c){function d(e){function t(t){function o(){}function a(){setTimeout(function(){LoginUser.getInstance().getPresence()!=Person.PRESENCE_STATUS_OFFLINE&&(C._personManager.changePresence(null,null),setTimeout(function(){LoginUser.getInstance().getPresence()!=Person.PRESENCE_STATUS_OFFLINE&&(C._personManager.changePresence(null,null),a())},500))},s)}if(null!=t){var r=t.get(0);null!=r&&(n.setGroup(r.getGroup()),LoginPresence.getInstance().setLoginPresence(r.getPresence()),LoginMyMemo.getInstance().setLoginMyMemo(r.getMyMemo()))}C._personManager.setLoginedUserData(e),C._mailServerManager.getServerInfoListFirst(o),i();var s=Conf.getVal("SERVER_HEART_BEAT_TIME_MILLS");a()}if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=e.getLoginUserPerson&&"function"==typeof e.getLoginUserPerson){var n=e.getLoginUserPerson();if(null!=n){var o=n.getJid();if(null!=o){var a=new ArrayList;return a.add(o),Promise.all([C.getRights(n.getLoginAccount()),C.getRoleAssignmentForUser(n.getLoginAccount())]).then(function(e){AuthorityInfo.getInstance().setRoleId(e[1].content.role.id),AuthorityInfo.getInstance().setRoleName(e[1].content.role.t.ja),AuthorityInfo.getInstance().setRights(e[0].content.rights),C.getPersonDataByJidFromServer(a,t)})["catch"](function(e){if("content"in e&&"reason"in e.content){var t={message:""};switch(e.content.reason){case 404e3:t.message="unauthorized_assignment";break;default:t.message="failed_to_fetch_authority_data"}return r(t)}}),!0}}}}function g(){for(var e=ContactList.getInstance(),t=e.getCount(),n=0;t>n;n++){var o=e.get(n),i=new PresenceChangeNotice;i.setJid(o.getJid()),i.setPresence(Person.PRESENCE_STATUS_OFFLINE),i.setMyMemo(""),_(i)}a(),C._notifyDisconnected()}function m(e){r(e)}function _(e){C._personManager.onProfileChanged(e),C._communityManager.onProfileChanged(e),s(e)}function f(e){C._messageManager.onMessageReceived(e),l(e)}function p(e){e.getType()==Notification_model.TYPE_DELETE_MESSAGE?(u(e),C._notificationManager.onNotificationReceived(e)):(C._notificationManager.onNotificationReceived(e),u(e))}function h(e){c(e)}var C=this;return null==n||"string"!=typeof n?!1:null==o||"string"!=typeof o?!1:e(i,a,r,s,l,u,c)?C._loginManager.login(t,n,o,d,g,m,_,f,p,h):!1},n.skipLogin=function(t,n,o,i,a,r,s){function l(e){function t(){}_._personManager.setLoginedUserData(e),_._mailServerManager.getServerInfoListFirst(t),n()}function u(){for(var e=ContactList.getInstance(),t=e.getCount(),n=0;t>n;n++){var i=e.get(n),a=new PresenceChangeNotice;a.setJid(i.getJid()),a.setPresence(Person.PRESENCE_STATUS_OFFLINE),a.setMyMemo(""),d(a)}o(),_._notifyDisconnected()}function c(e){i(e)}function d(e){_._personManager.onProfileChanged(e),a(e)}function g(e){_._messageManager.onMessageReceived(e),r(e)}function m(e){e.getType()==Notification_model.TYPE_DELETE_MESSAGE?(s(e),_._notificationManager.onNotificationReceived(e)):(_._notificationManager.onNotificationReceived(e),s(e))}var _=this;return null==t||"string"!=typeof t?!1:e(n,o,i,a,r,s)?_._loginManager.skipLogin(t,l,u,c,d,g,m):!1},n.getChatroomManager=function(){return this._chatroomManager},n.getCommunityManager=function(){return this._communityManager},n.getTaskMessages=function(e,t,n,o,i){var a=this;return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))||$.isEmptyObject(n)?!1:null==o||"object"!=("undefined"==typeof o?"undefined":_typeof(o))?!1:null==i||"function"!=typeof i?!1:a._messageManager.getTaskMessages(e,t,n,o,i)},n.getChatMessages=function(e,t,n,o){var i=this;return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"string"!=typeof n?!1:null==o||"function"!=typeof o?!1:i._messageManager.getChatMessages(e,t,n,o)},n.getQuestionnaireMessages=function(e,t,n,o){var i=this;return i._messageManager.getQuestionnaireMessages(e,t,n,o)},n.sendVoteMessage=function(e,t,n,o){var i=this;return i._messageManager.sendVoteMessage(e,t,n,o)},n.sendPublicMessage=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},i=this;return null==e||"string"!=typeof e?!1:null==t||"string"!=typeof t?!1:null==o||"function"!=typeof o?!1:i._messageManager.sendPublicMessage(e,t,n,o)},n.getPublicMessages=function(e,t,n){var o=this;return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"function"!=typeof n?!1:o._messageManager.getPublicMessages(e,t,n)},n.getMessage=function(e){var t=this;return null==e||"string"!=typeof e?null:t._messageManager.getMessage(e)},n.getAllMessage=function(){var e=this;return e._messageManager.getAllMessage()},n.getReplyReverseItemIds=function(e){var t=this;return null==e||"string"!=typeof e?null:t._messageManager.getReplyReverseItemIds(e)},n.getChildrenTaskItemIds=function(e){var t=this;return null==e||"string"!=typeof e?null:t._messageManager.getChildrenTaskItemIds(e)},n.onAddMessageView=function(e){var t=this;return null==e||"string"!=typeof e?!1:t._messageManager.onAddMessageView(e)},n.onRemoveMessageView=function(e){var t=this;return null==e||"string"!=typeof e?!1:t._messageManager.onRemoveMessageView(e)},n.onAddParentMessageRefarence=function(e){var t=this;return t._messageManager.onAddParentMessageRefarence(e)},n.onRemoveParentMessageRefarence=function(e){var t=this;return t._messageManager.onRemoveParentMessageRefarence(e)},n.onRemoveAllMessageView=function(){var e=this;return e._messageManager.onRemoveAllMessageView()},n.changePresence=function(e,t){var n=this;return null!=e&&"string"!=typeof e?!1:null!=t&&"string"!=typeof t?!1:n._personManager.changePresence(e,t)},n.changeProfile=function(e,t){var n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:n._personManager.changeProfile(e,t)},n.uploadAvatarIE=function(e,t){var n=location.protocol+"//"+location.hostname,o=location.pathname,i=o.lastIndexOf("/"),a=o.substring(i+1,o.length);n+=0!=a.length?a.lastIndexOf(".")<0?o+"/":o.substring(0,i+1):o;var r="uploaduseravatar";r=n+r;try{$(e).upload(r,function(e){var n;n=null!=e&&null!=e.result?e:{result:"failed",path:"",filename:""},t(n)},"json")}catch(s){var l={result:"failed",path:"",filename:""};t(l)}return!0},n.uploadCommunityLogo=function(e,t,n){function o(e){e.lengthComputable}function i(e){var t=e.target.status;if(200==t){var o=e.target.responseText,i=JSON.parse(o);n(i)}else{console.log("error : upload failed");var a={result:"failed",status:""+e.target.status,statusText:e.target.statusText};n(a)}}function a(e){console.log("error : upload failed");var t={result:"failed",status:""+e.target.status,statusText:e.target.statusText};n(t)}function r(e){console.log("cancel : upload failed");var t={result:"canceled"};n(t)}if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return!1;if(null==n||"function"!=typeof n)return!1;var s=CubeeServerConnector.getInstance().getAccessToken();if(""==s)return!1;var l=LoginUser.getInstance().getLoginAccount();if(""==l)return!1;var u=location.protocol+"//"+location.hostname,c=location.pathname,d=c.lastIndexOf("/"),g=c.substring(d+1,c.length);u+=0!=g.length?g.lastIndexOf(".")<0?c+"/":c.substring(0,d+1):c;var m="uploadcommunitylogo";m=u+m;var _=new FormData;_.append("logofile",t),_.append("accesstoken",s),_.append("account",l),_.append("roomid",e);var f=new XMLHttpRequest;return f.upload.addEventListener("progress",o,!1),f.addEventListener("load",i,!1),f.addEventListener("error",a,!1),f.addEventListener("abort",r,!1),f.open("POST",m,!0),f.send(_),!0},n.changePassword=function(e,t,n){var o=this;return null==e||"string"!=typeof e?!1:null==t||"string"!=typeof t?!1:null!=n&&"function"!=typeof n?!1:o._personManager.changePassword(e,t,n)},n.searchMessage=function(e,t,n,o){var i=this;return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))?!1:null==o||"function"!=typeof o?!1:i._messageManager.searchMessage(e,t,n,o)},n.getMessageCount=function(e,t){return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"function"!=typeof t?!1:CubeeServerConnector.getInstance().getMessageCount(e,t)},n.onNotifyKeyOperation=function(e){var t=this,n=!1;if(null==e||"boolean"!=typeof e)return n;var o=t._personManager.decideSendPresence(e);if(n=t.changePresence(o,null)){var i=LoginUser.getInstance().getMyMemo();MyPresenceView.getInstance().updateChangePresence(o,i),ColumnMessageView.updateMessageAvatarToolTip(LoginUser.getInstance().getJid())}return n},n.clearPrePresence=function(){var e=this;e._personManager.clearPrePresence()},n.sendChatMessage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"function"!=typeof t?!1:n._messageManager.sendChatMessage(e,t)},n.getPersonData=function(e){var t=this;return null==e||"string"!=typeof e?null:t._personManager.getPersonData(e)},n.getPersonDataByLoginAccount=function(e){var t=this;return null==e||"string"!=typeof e?null:t._personManager.getPersonDataByLoginAccount(e)},n.getContactListData=function(e){var t=this;return null==e||"string"!=typeof e?null:t._personManager.getContactListData(e)},n.sendGoodJob=function(e,t){var n=this;return null==e||"string"!=typeof e?!1:null==t||"function"!=typeof t?!1:n._messageManager.sendGoodJob(e,t)},n.setNotificationChatMessage=function(e,t){var n=this;n._notificationManager.setChatMessageData(e,t)},n.getNotificationChatMessageByJid=function(e){var t=this;return t._notificationManager.getChatMessageListByJid(e)},n.removeNotificationChatMessageByJid=function(e){var t=this;return t._notificationManager.removeChatMessageListByJid(e)},n.addQuestionnaire=function(e,t){var n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"function"!=typeof t?!1:n._messageManager.addQuestionnaire(e,t)},n.addTask=function(e,t){var n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"function"!=typeof t?!1:n._messageManager.addTask(e,t)},n.updateTask=function(e,t){var n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"function"!=typeof t?!1:n._messageManager.updateTask(e,t)},n.sendDemandTask=function(e,t){var n=this;return null==e||"string"!=typeof e?!1:null==t||"function"!=typeof t?!1:n._messageManager.sendDemandTask(e,t)},n.sendClearDemandedTask=function(e,t){var n=this;return null==e||"string"!=typeof e?!1:null==t||"function"!=typeof t?!1:n._messageManager.sendClearDemandedTask(e,t)},n.sendGetExistingReaderList=function(e,t){var n=this;return null==e||"string"!=typeof e?!1:null==t||"function"!=typeof t?!1:n._messageManager.sendGetExistingReaderList(e,t)},n.sendSetReadOneMessage=function(e,t){var n=this;return null==e||"string"!=typeof e?!1:null==t||"function"!=typeof t?!1:n._messageManager.sendSetReadOneMessage(e,t)},n.deleteMessage=function(e,t,n){var o=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"number"!=typeof t?!1:null==n||"function"!=typeof n?!1:o._messageManager.deleteMessage(e,t,n)},n.getRoomInfo=function(e,t){var n=this;return null==e||"string"!=typeof e?!1:null!=t&&"function"!=typeof t?!1:n._chatroomManager.getRoomInfo(e,t)},n.getRoomInfoList=function(e,t,n,o,i){var a=this;return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))?!1:null==o||"object"!=("undefined"==typeof o?"undefined":_typeof(o))?!1:null!=i&&"function"!=typeof i?!1:a._chatroomManager.getRoomInfoList(e,t,n,o,i)},n.getPublicGroupRoomInfoList=function(e,t,n,o){var i=this;return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))?!1:null!=o&&"function"!=typeof o?!1:i._chatroomManager.getPublicGroupRoomInfoList(e,t,n,o)},n.createChatRoom=function(e,t){var n=e;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"function"!=typeof t?!1:CubeeServerConnector.getInstance().createChatRoom(n,t)},n.updateChatRoomInfo=function(e,t){return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"function"!=typeof t?!1:CubeeServerConnector.getInstance().updateChatRoomInfo(e,t)},n.sendGroupChatMessage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"function"!=typeof t?!1:n._messageManager.sendGroupChatMessage(e,t)},n.getChatRoomInfoByRoomId=function(e){var t=this;return null==e||"string"!=typeof e?null:t._chatroomManager.getChatRoomInfoByRoomId(e)},n.addGroupChatRoomMember=function(e,t,n){return null==e||"string"!=typeof e?!1:null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t))?!1:null==n||"function"!=typeof n?!1:CubeeServerConnector.getInstance().addGroupChatRoomMember(e,t,n)},n.removeChatRoomMember=function(e,t,n,o){var i=this;return null==e||"string"!=typeof e?!1:null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t))?!1:null==n||"string"!=typeof n||"own"!=n&&"member"!=n?!1:null==o||"function"!=typeof o?!1:i._chatroomManager.removeChatRoomMember(e,t,n,o)},n.removePublicChatRoomMember=function(e,t){var n=this;return null==e||"string"!=typeof e?!1:null==t||"function"!=typeof t?!1:n._chatroomManager.removePublicChatRoomMember(e,t)},n.getServerList=function(e){var t=this;return null!=e&&"function"!=typeof e?!1:t._mailServerManager.getServerInfoListFirst(e)},n.getServerInfoById=function(e){var t=this;return null!=e&&"number"!=typeof e?null:t._mailServerManager.getServerInfoById(e)},n.changeMailCooperationSetting=function(e,t){var n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:n._personManager.changeMailCooperationSetting(e,t)},n.getMailBody=function(e,t){var n=this;return null==e||"string"!=typeof e?!1:null!=t&&"function"!=typeof t?!1:n._messageManager.getMailBody(e,t)},n.getThreadMessage=function(e,t){var n=this;return null==e||"string"!=typeof e?!1:null!=t&&"function"!=typeof t?!1:n._messageManager.getThreadMessage(e,t)},n.createCommunity=function(e,t){var n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:n._communityManager.createCommunity(e,t)},n.getJoinedCommunityInfoList=function(e,t,n,o){var i=this;return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))?!1:null!=o&&"function"!=typeof o?!1:i._communityManager.getJoinedCommunityInfoList(e,t,n,o);
},n.getNoJoinedPublicCommunityInfoList=function(e,t,n,o){var i=this;return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))?!1:null!=o&&"function"!=typeof o?!1:i._communityManager.getNoJoinedPublicCommunityInfoList(e,t,n,o)},n.getCommunityInfo=function(e,t){var n=this;return null==e||"string"!=typeof e?!1:null!=t&&"function"!=typeof t?!1:n._communityManager.getCommunityInfo(e,t)},n.getCommunityMemberInfo=function(e,t){var n=this;return null==e||"string"!=typeof e?!1:null!=t&&"function"!=typeof t?!1:n._communityManager.getCommunityMemberInfo(e,t)},n.getCachedCommunityMember=function(e,t){var n=this;return null==e||"string"!=typeof e?null:null!=t&&"string"!=typeof t?null:n._communityManager.getCachedCommunityMember(e,t)},n.updateCommunity=function(e,t){var n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:n._communityManager.updateCommunity(e,t)},n.addCommunityMember=function(e,t,n){var o=this;return null==e||"string"!=typeof e?!1:null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t))?!1:null!=n&&"function"!=typeof n?!1:o._communityManager.addCommunityMember(e,t,n)},n.updateCommunityOwner=function(e,t,n){var o=this;return null==e||"string"!=typeof e?!1:null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t))?!1:null!=n&&"function"!=typeof n?!1:o._communityManager.updateCommunityOwner(e,t,n)},n.removeCommunityMember=function(e,t,n){var o=this;return null==e||"string"!=typeof e?!1:null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t))?!1:null!=n&&"function"!=typeof n?!1:o._communityManager.removeCommunityMember(e,t,n)},n.removePublicCommunityMember=function(e,t){var n=this;return null==e||"string"!=typeof e?!1:null!=t&&"function"!=typeof t?!1:n._communityManager.removePublicCommunityMember(e,t)},n.sendCommunityMessage=function(e,t){var n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:n._messageManager.sendCommunityMessage(e,t)},n.sendMurmurMessage=function(e,t){var n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null!=t&&"function"!=typeof t?!1:n._messageManager.sendMurmurMessage(e,t)},n.logout=function(){var e=this;e._loginManager.logout(),e._notifyDisconnected()},n._notifyDisconnected=function(){var e=this;e._loginManager.disconnected(),e._personManager.disconnected(),e._favoriteManager.disconnected(),e._messageManager.disconnected(),e._searchManager.disconnected(),e._notificationManager.disconnected(),e._communityManager.disconnected()},n.uploadFile=function(e,t,n){function o(e){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);n(t)}else console.log("unable compute"),n(-1)}function i(e){var n=e.target.status;if(200==n){var o=e.target.responseText,i=JSON.parse(o);i.path=l+i.path,t(i)}else{console.log("error : upload failed");var a={result:"failed",status:""+e.target.status,statusText:e.target.statusText};t(a)}}function a(e){console.log("error : upload failed");var n={result:"failed",status:""+e.target.status,statusText:e.target.statusText};t(n)}function r(e){console.log("cancel : upload failed");var n={result:"canceled"};t(n)}if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==t||"function"!=typeof t)return!1;if(null==n||"function"!=typeof n)return!1;var s=CubeeServerConnector.getInstance().getAccessToken();if(""==s)return!1;var l=location.protocol+"//"+location.hostname,u=location.pathname,c=u.lastIndexOf("/"),d=u.substring(c+1,u.length);l+=0!=d.length?d.lastIndexOf(".")<0?u+"/":u.substring(0,c+1):u;var g="fileupload";g=l+g;var m=new FormData;m.append("uploadfile",e),m.append("accesstoken",s);var _=new XMLHttpRequest;return _.upload.addEventListener("progress",o,!1),_.addEventListener("load",i,!1),_.addEventListener("error",a,!1),_.addEventListener("abort",r,!1),_.open("POST",g,!0),_.send(m),!1},n.uploadFileIE=function(e,t){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==t||"function"!=typeof t)return!1;var n=CubeeServerConnector.getInstance().getAccessToken();if(""==n)return!1;var o=location.protocol+"//"+location.hostname,i=location.pathname,a=i.lastIndexOf("/"),r=i.substring(a+1,i.length);o+=0!=r.length?r.lastIndexOf(".")<0?i+"/":i.substring(0,a+1):i;var s="fileupload";s=o+s;var l={accesstoken:n,uploadfile:e};try{$(e).upload(s,l,function(e){var n;null!=e&&null!=e.result?(n=e,n.path=o+n.path):n={result:"failed"},t(n)},"json")}catch(u){var c={result:"failed"};t(c)}return!1},n.downloadfile=function(e,t){if(null==e||"string"!=typeof e)return!1;if(null==t||"string"!=typeof t)return!1;var n=location.protocol+"//"+location.hostname,o=location.pathname,i=o.lastIndexOf("/"),a=o.substring(i+1,o.length);n+=0!=a.length?a.lastIndexOf(".")<0?o+"/":o.substring(0,i+1):o;var r="filedownload";r=n+r;var s=CubeeServerConnector.getInstance().getAccessToken();return""==s?!1:($("#df_accesstoken").val(s),$("#df_itemId").val(t),$("#df_downloadURL").val(e),$("#download_form").submit(),!1)},n.downloadfileOpen=function(e){var t=this,n=$(e).children("img.image-thumbnail").eq(0);if(n&&n.hasClass("image-thumbnail")){var o=n.attr("src"),i=n.attr("title");o&&i&&(t.setImageData(i,o),window.open("showImage.html",i))}return!1},n.downloadThumbnailImage=function(e,t,n){if(null!=e&&"string"==typeof e&&null!=t&&"string"==typeof t&&null!=n){var o=location.protocol+"//"+location.hostname,i=location.pathname,a=i.lastIndexOf("/"),r=i.substring(a+1,i.length);o+=0!=r.length?r.lastIndexOf(".")<0?i+"/":i.substring(0,a+1):i;var s="filedownload";s=o+s;var l=CubeeServerConnector.getInstance().getAccessToken();if(""!=l){var u="accesstoken="+l+"&itemId="+t+"&downloadURL="+encodeURIComponent(e),c=new XMLHttpRequest;c.open("POST",s,!0),c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.onreadystatechange=function(){if(4===c.readyState&&200===c.status){var e=c.response;if(e){var t=new Blob([e],{type:"image/jpeg"}),o=window.URL||window.webkitURL,i=window.navigator.userAgent.toLowerCase();-1==i.indexOf("edge")&&-1==i.indexOf("chrome")&&-1!==i.indexOf("safari")?n.attr("src",o.createObjectURL(t)):loadImage.parseMetaData(t,function(e){var o={canvas:!0};e.exif&&(o.orientation=e.exif.get("Orientation")),loadImage(t,function(e){if("function"==typeof e.toDataURL){var t=e.toDataURL("image/jpeg");n.attr("src",t)}},o)})}else n.attr("src","images/add_attach_img_file.png").attr("style","margin-left: 2px; height: 20px; width: 20px; border: 0px;")}},c.responseType="arraybuffer",c.send(u)}}},n.openShortenUrl=function(e,t){if(null==e||"string"!=typeof e)return!1;if(null==t||"string"!=typeof t)return!1;var n=CubeeServerConnector.getInstance().getAccessToken();return""==n?!1:($("#shorten_url_link").attr("action",e),$("#shorten_url_accesstoken").val(n),$("#shorten_url_itemId").val(t),$("#shorten_url_link").submit(),!1)},n.getFollowList=function(){var e=this;return e._personManager.getFollowList()},n.getAccessToken=function(){return CubeeServerConnector.getInstance().getAccessToken()},n.isContactListMember=function(e){var t=this;return null==e||"string"!=typeof e?null:t._personManager.isContactListMember(e)},n.addContactListMember=function(e,t){var n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"function"!=typeof t?!1:n._personManager.addContactListMember(e,t)},n.removeContactListMember=function(e,t){var n=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:null==t||"function"!=typeof t?!1:n._personManager.removeContactListMember(e,t)},n.searchPerson=function(e,t,n,o){var i=this;return null==e||"number"!=typeof e||0>e?!1:null==t||"number"!=typeof t||1>t?!1:null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n))?!1:null==o||"function"!=typeof o?!1:i._personManager.searchPerson(e,t,n,o)},n.getPersonDataByJidFromServer=function(e,t){var n=this;if(null==e)return!1;var o=new ArrayList;return"string"==typeof e?o.add(e):o=e,"object"!=("undefined"==typeof o?"undefined":_typeof(o))||o.getCount()<=0?!1:null==t||"function"!=typeof t?!1:n._personManager.getPersonDataByJidFromServer(o,t)},n.getPersonDataByLoginAccountFromServer=function(e,t){var n=this;if(null==e)return!1;var o=new ArrayList;return"string"==typeof e?o.add(e):o=e,"object"!=("undefined"==typeof o?"undefined":_typeof(o))||o.getCount()<=0?!1:null==t||"function"!=typeof t?!1:n._personManager.getPersonDataByLoginAccountFromServer(o,t)},n.getRights=function(e){var t=this;return new Promise(function(n,o){var i=t;i._authorityManager.getRights(e).then(function(e){n(e)})["catch"](function(e){o(e)})})},n.getRoleAssignmentForUser=function(e){var t=this;return new Promise(function(n,o){var i=t;i._authorityManager.getRoleAssignmentForUser(e).then(function(e){n(e)})["catch"](function(e){o(e)})})},n.createPolicy=function(e,t,n){var o=this;return new Promise(function(i,a){var r=o;r._authorityManager.createPolicy(e,t,n).then(function(e){i(e)})["catch"](function(e){a(e)})})},n.createRight=function(e,t,n){var o=this;return new Promise(function(i,a){var r=o;r._authorityManager.createRight(e,t,n).then(function(e){i(e)})["catch"](function(e){a(e)})})},n.assignPolicyToUser=function(e,t){var n=this;return new Promise(function(o,i){var a=n;a._authorityManager.assignPolicyToUser(e,t).then(function(e){o(e)})["catch"](function(e){i(e)})})},n.getUserPoliciesByResource=function(e){var t=this;return new Promise(function(n,o){var i=t;i._authorityManager.getUserPoliciesByResource(e).then(function(e){n(e)})["catch"](function(e){o(e)})})},n.unassignPolicyFromUser=function(e,t){var n=this;return new Promise(function(o,i){var a=n;a._authorityManager.unassignPolicyFromUser(e,t).then(function(e){o(e)})["catch"](function(e){i(e)})})},n.updateThreadTitle=function(e,t){var n=this;return new Promise(function(o,i){var a=n;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?void i(!1):null==t||"string"!=typeof t?void i(!1):void a._messageManager.updateThreadTitle(e,t).then(function(e){o(e)})["catch"](function(e){i(e)})})},n.getThreadTitleList=function(e){var t=this;return new Promise(function(n,o){var i=t;return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?void i._messageManager.getThreadTitleList(e).then(function(e){n(e)})["catch"](function(e){o(e)}):void o(!1)})},n.updateMessage=function(e,t){var n=this;return new Promise(function(o,i){var a=n;return e&&"string"==typeof e&&t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))?void a._messageManager.updateMessage(e,t).then(function(e){o(e)})["catch"](function(e){i(e)}):void i(!1)})},n.sendQuoteMessage=function(e){var t=this;return new Promise(function(n,o){var i=t;return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?void i._messageManager.sendQuoteMessage(e).then(function(e){n(e)})["catch"](function(e){o(e)}):void o(!1)})},n.sendEmotionPoint=function(e,t,n){var o=this;return null==e||"string"!=typeof e?!1:null==t||"number"!=typeof t?!1:null==n||"function"!=typeof n?!1:o._messageManager.sendEmotionPoint(e,t,n)},n.getGoodJobTotal=function(e,t){var n=this;return new Promise(function(o,i){var a=n;return e&&void 0!=t&&"string"==typeof e&&"string"==typeof t?void a._messageManager.getGoodJobTotal(e,t).then(function(e){o(e)})["catch"](function(e){i(e)}):void i(!1)})},n.getThanksPointsTotal=function(e,t){var n=this;return new Promise(function(o,i){var a=n;return e&&void 0!=t&&"string"==typeof e&&"string"==typeof t?void a._messageManager.getThanksPointsTotal(e,t).then(function(e){o(e)})["catch"](function(e){i(e)}):void i(!1)})},n.getGoodJobRanking=function(e,t,n,o){var i=this;return new Promise(function(a,r){var s=i;return e&&"string"==typeof e?"number"!=typeof t||"number"!=typeof n||"number"!=typeof o?void r(!1):void s._messageManager.getGoodJobRanking(e,t,n,o).then(function(e){a(e)})["catch"](function(e){r(e)}):void r(!1)})},n.getThanksPointsRanking=function(e,t,n,o){var i=this;return new Promise(function(a,r){var s=i;return e&&"string"==typeof e?"number"!=typeof t||"number"!=typeof n||"number"!=typeof o?void r(!1):void s._messageManager.getThanksPointsRanking(e,t,n,o).then(function(e){a(e)})["catch"](function(e){r(e)}):void r(!1)})},n.getMurmurTotal=function(e,t){var n=this;return new Promise(function(o,i){var a=n;return e&&void 0!=t&&"string"==typeof e&&"string"==typeof t?void a._messageManager.getMurmurTotal(e,t).then(function(e){o(e)})["catch"](function(e){i(e)}):void i(!1)})},n.getMurmurRanking=function(e,t,n,o){var i=this;return new Promise(function(a,r){var s=i;return e&&"string"==typeof e?"number"!=typeof t||"number"!=typeof n||"number"!=typeof o?void r(!1):void s._messageManager.getMurmurRanking(e,t,n,o).then(function(e){a(e)})["catch"](function(e){r(e)}):void r(!1)})},n.getGroupList=function(){var e=this;return new Promise(function(t,n){var o=e;o._personManager.getGroupList().then(function(e){t(e)})["catch"](function(e){n(e)})})},n.getFolloweeList=function(e){var t=this;return new Promise(function(n,o){var i=t;i._personManager.getFolloweeList(e).then(function(e){n(e)})["catch"](function(e){o(e)})})},n.getFollowerList=function(e){var t=this;return new Promise(function(n,o){var i=t;i._personManager.getFollowerList(e).then(function(e){n(e)})["catch"](function(e){o(e)})})},n.getFollowInfo=function(e){var t=this;return new Promise(function(n,o){var i=t;i._personManager.getFollowInfo(e).then(function(e){n(e)})["catch"](function(e){o(e)})})},n.addUserFollow=function(e){var t=this;return new Promise(function(n,o){var i=t;i._personManager.addUserFollow(e).then(function(e){n(e)})["catch"](function(e){o(e)})})},n.delUserFollow=function(e){var t=this;return new Promise(function(n,o){var i=t;i._personManager.delUserFollow(e).then(function(e){n(e)})["catch"](function(e){o(e)})})}}(),$(window).on("ChangeKeyOparationOn",function(e){}),$(window).on("ChangeKeyOparationOFF",function(e){}),function(){function e(e,n){for(var o=0;o<n.length;o++)if(n[o].type==ColumnInformation.TYPE_COLUMN_MENTION){n[o].type=ColumnInformation.TYPE_COLUMN_TOME,t(e,n);break}}function t(e,t){if(o()){var i=[],a=!1;if(t&&t.length>0){for(var r=0;r<t.length;r++){var s={};for(_key in t[r]){var l=t[r][_key];l&&(s[_key]=l)}Object.keys(s).length>0&&i.push(s)}if(i.length>0){var u=JSON.stringify(i);u&&(localStorage.setItem(NotificationSettingManager.PARAM_NOTIFICATIONICON_SETTING,u),a=!0)}}a||n(e)}}function n(e){localStorage.removeItem(NotificationSettingManager.PARAM_NOTIFICATIONICON_SETTING),e.setNotificationInfo([])}function o(){if(null==NotificationSettingManager.PARAM_NOTIFICATIONICON_SETTING){var e=LoginUser.getInstance().getJid();if(!e)return!1;NotificationSettingManager.PARAM_NOTIFICATIONICON_SETTING="notificationicon_setting_"+e}return!0}var i=NotificationSettingManager.prototype,a=new NotificationSettingManager;NotificationSettingManager.getInstance=function(){return a},i.getNotificationInfo=function(){var e=this;return e._notificationInfo},i.setNotificationInfo=function(e){var t=this,n=[];e&&(n=e),t._notificationInfo=n},i.appendSetting=function(e,n,o){var i=this,a=[],r=!1;if(e&&(a=i.getNotificationInfo(),!i.isSetting(e,n))){var s={};s.type=e,n&&(s.id=n),a.push(s),r=!0}r&&(t(i,a),o&&"function"==typeof o&&setTimeout(function(){o()},1))},i.removeSetting=function(e,n,o){var i=this,a=[],r=!1;if(e){a=i.getNotificationInfo();var s=i.indexOfSetting(e,n);-1!=s&&(a.splice(s,1),r=!0)}r&&(t(i,a),o&&"function"==typeof o&&setTimeout(function(){o()},1))},i.indexOfSetting=function(e,t){var n=this,o=[];if(e){o=n.getNotificationInfo();for(var i=0;i<o.length;i++)if(e!=o[i].type);else if(!t||t==o[i].id)return i}return-1},i.isSetting=function(e,t){var n=this;return-1!=n.indexOfSetting(e,t)},NotificationSettingManager.PARAM_NOTIFICATIONICON_SETTING=null,i.read=function(){var t=this;if(o()){var n=[],i=localStorage.getItem(NotificationSettingManager.PARAM_NOTIFICATIONICON_SETTING);i&&(n=JSON.parse(i),!n||n.length<1?n=[]:e(t,n)),t.setNotificationInfo(n)}}}(),function(){function e(e,t){var n=[];t&&(n=t),e._notificationInfo=n}function t(e,t){var o=[],i=!1;if(t&&t.length>0){for(var a=0;a<t.length;a++){var r={};for(_key in t[a]){var s=t[a][_key];s&&(r[_key]=s)}Object.keys(r).length>0&&o.push(r)}if(o.length>0){var l=JSON.stringify(o);l&&(localStorage.setItem(PushNotificationSettingManager.PARAM_PUSH_NOTIFICATIONICON_SETTING,l),i=!0)}}i||n(e)}function n(t){localStorage.removeItem(PushNotificationSettingManager.PARAM_PUSH_NOTIFICATIONICON_SETTING),e(t,[])}var o=PushNotificationSettingManager.prototype,i=new PushNotificationSettingManager;PushNotificationSettingManager.getInstance=function(){return i},o.getNotificationInfo=function(){var e=this;return e._notificationInfo},o.appendSetting=function(e,n){var o=this,i=[],a=!1;if(e&&(i=o.getNotificationInfo(),!o.isSetting(e))){var r={};r.id=e,i.push(r),a=!0}a&&(t(o,i),n&&"function"==typeof n&&setTimeout(function(){n()},1))},o.removeSetting=function(e,n){var o=this,i=[],a=!1;if(e){i=o.getNotificationInfo();var r=o.indexOfSetting(e);-1!=r&&(i.splice(r,1),a=!0)}a&&(t(o,i),n&&"function"==typeof n&&setTimeout(function(){n()},1))},o.indexOfSetting=function(e){var t=this,n=[];if(e){n=t.getNotificationInfo();for(var o=0;o<n.length;o++)if(e==n[o].id)return o}return-1},o.isSetting=function(e){var t=this;return-1!=t.indexOfSetting(e)},PushNotificationSettingManager.PARAM_PUSH_NOTIFICATIONICON_SETTING="push_notification_settings",o.read=function(){var t=this,n=[],o=localStorage.getItem(PushNotificationSettingManager.PARAM_PUSH_NOTIFICATIONICON_SETTING);o&&(n=JSON.parse(o),(!n||n.length<1)&&(n=[])),e(t,n)}}(),function(){var e=new CodiMdController;CodiMdController.getInstance=function(){return e};var t=CodiMdController.prototype;t.connectNewWindow=function(){var e=CubeeServerConnector.getInstance().getAccessToken(),t="/cubee/codimd/redirect",n="POST";if(e){var o={accessToken:e};$.ajax({type:n,url:t,data:JSON.stringify(o),contentType:"application/json",dataType:"json",success:function(e){return e.result?(window.open(e.location,"_blank"),!0):e.location?(window.open(e.location,"_blank"),!1):(window.open("/cubee","_blank"),!1)},error:function(){return window.open("/cubee","_blank"),!1},complete:function(){}})}},t.makeNewNote=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new Promise(function(o,i){var a=CubeeServerConnector.getInstance().getAccessToken(),r="/cubee/codimd/new",s="POST";if(!a)return void i(!1);var l={accessToken:a,title:e,threadRootId:t,roomId:n};$.ajax({type:s,url:r,data:JSON.stringify(l),contentType:"application/json",dataType:"json",success:function(e){return e.result?(o(e),void window.open(e.location,"_blank")):void i(e)},error:function(){i(!1)},complete:function(){}})})},t.getNoteList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new Promise(function(o,i){var a=CubeeServerConnector.getInstance().getAccessToken(),r="/cubee/codimd/list",s="POST";if(!a)return void i(!1);var l={accessToken:a,threadRootId:e,roomId:t,msgtype:n};$.ajax({type:s,url:r,data:JSON.stringify(l),contentType:"application/json",dataType:"json",success:function(e){return e.result?void o(e):void i(e)},error:function(){i(!1)},complete:function(){}})})},t.removeNote=function(e){return new Promise(function(t,n){var o=CubeeServerConnector.getInstance().getAccessToken();if(!e&&3==e.split("/").length)return void n(!1);var i="/cubee/codimd/delete/"+e.split("/")[2],a="DELETE";if(!o)return void n(!1);var r={accessToken:o};$.ajax({type:a,url:i,data:JSON.stringify(r),contentType:"application/json",dataType:"json",success:function(e){return e.result?void t(e):void n(e)},error:function(){n(!1)},complete:function(){}})})},t.assignNoteOnThreadRootId=function(e,t){return new Promise(function(n,o){if(!t&&!e)return void o(!1);var i=CubeeServerConnector.getInstance().getAccessToken(),a="/cubee/codimd/setcubee",r="POST";if(!i)return void o(!1);var s={accessToken:i,threadRootId:e,noteUrl:t};$.ajax({type:r,url:a,data:JSON.stringify(s),contentType:"application/json",dataType:"json",success:function(e){return e.result?void n(e):void o(e)},error:function(){o(!1)},complete:function(){}})})},t.connectPostToZeroJson=function(){var e=CubeeServerConnector.getInstance();if(e._isLogined){var t=e.getAccessToken(),n="/cubee/codimd/login",o="POST",i={accessToken:t};return $.ajax({type:o,url:n,data:JSON.stringify(i),contentType:"application/json",dataType:"json",success:function(e){return e.result?!0:!1},error:function(){return!1},complete:function(){}}),!0}return!1},t.setNoteTitle=function(e,t){return new Promise(function(n,o){if(!e&&!t)return void o(!1);var i=CubeeServerConnector.getInstance().getAccessToken(),a="/cubee/codimd/rename",r="POST";if(!i)return void o(!1);var s={accessToken:i,noteUrl:e,title:t};$.ajax({type:r,url:a,data:JSON.stringify(s),contentType:"application/json",dataType:"json",success:function(e){return e.result?void n(e):void o(e)},error:function(){o(!1)},complete:function(){}})})}}(),function(){var e=new openGraphProtocolController;openGraphProtocolController.getInstance=function(){return e};var t=openGraphProtocolController.prototype;t.getOpenGraphProtocol=function(e){return new Promise(function(t,n){var o=CubeeServerConnector.getInstance().getAccessToken(),i="/cubee/i/ogp/get",a="POST";if(!o)return void n(!1);var r={accessToken:o,url:e};$.ajax({type:a,url:i,data:JSON.stringify(r),contentType:"application/json",dataType:"json",success:function(e){return e.result?void t(e):void n(e)},error:function(){n(!1)},complete:function(){}})})}}(),function(){var e,t,n;n=global.Globalize,n.addCultureInfo("ja",{messages:(e={label_separator:":",login_header:"",login_tenantname_placeholder:"",login_username_placeholder:"",login_password_placeholder:"",login_btn:"",failed_to_fetch_authority_data:"",unauthorized_assignment:"",policy_manage:"",policy_send:"/",policy_view:"",conf_community_change_authority_tooltip:"",conf_confirm_authority_tooltip:"",dialog_label_alter_member_list:"",not_selected_authority_info:"",loginErrMsg:"    ",loginErrTenantContain:"",loginErrUserLength1:" ",loginErrUserLength2:"  ",loginErrUserContain:"",loginErrPasswordLength1:" ",loginErrPasswordLength2:"  ",loginErrPasswordContain:"",skipLoginAccessTokenErrMsg:"",skipLoginSwitchProtocolErrMsg:"",skipLoginErrMsg:"",loading:"",save:"",edit:"",presence_chat:"",presence_away:"",presence_xa:"",presence_dnd:"",my_memo_placeholder:"",header_add_column:"",header_switch_to_list:"",header_switch_to_columns:"",header_context_search:"",header_button_option:"",header_context_search_placeholder:"",MyWorkplace:"",MyFeed:"",Mention:"",ToMe:"",Chat:"",Task:"",MyTask:"",Inbox:"",Search:"",GroupChat:"",Mail:"",CommunityFeed:"",CommunityTask:"",Questionnaire:"",Murmur:"",ContextSearchCommunityTask:"",blink_title:"",NotReferableColumnTitle:"",Community:"",RecentPostedMessages:"",RecentSideBarTitle:"",MurmurSideBarTitle:"",MurmurSendButtonTitle:"",MurmurSideBarOpenCloseButton:"",RecentQuickFilterOnlyToMe:"",RecentQuickFilterUnread:"",RecentQuickFilterFile:"",RecentQuickFilterAllRead:"",ShowConversation:"",MyQuestionnaire:"",QuestionnaireOption:"",ContactList:"",GroupChatList:"",PublicGroupChatList:"",CommunityList:"",PublicCommunityList:"",CommunityMemberList:"",CommunityDetail:"",group_title_no_group:"",group_title_all:"",room_group_title_all:"",group_title_favorite:"",group_title_group_member:"",group_title_community_member:"",column_btn_submit:"","column_btn_submit-tooltip":"ctrl+enter",column_btn_filter:"",column_btn_search:"",column_btn_message_area_open_close:"",column_btn_close:"",show_past_reply_txt:"({0})",hidden_past_reply_txt:"",config_profile:"",config_password:"",config_mail_cooperation:"",config_logout:"",config_avator_zoom_in:"",config_avator_zoom_out:"",config_submit_buttom:"",config_profile_title:"",config_profile_image_label:"",config_profile_avater_label:"",config_profile_nickname_label:"",config_profile_mail_address:"",config_profile_group:"",config_profile_group_notes:"(,)",config_user_status:"",config_account_type:"",config_dashboard_background_image:"",config_profile_change_failed:"",config_profile_image_failed:"",config_profile_image_large:"",config_profile_nickname_empty:"",config_profile_group_must:"",config_profile_group_txt:"",config_profile_group_empty:"5",config_profile_group_complexity:"100",config_profile_group_list_err:"",config_password_title:"",config_password_current_label:"",config_password_new_label:"",config_password_new_confirm_label:"()",config_password_notes:"8321",config_password_complexity:"1",config_password_current_must:"",config_password_new_must:"",config_password_new_confirm_must:"",config_password_change_failed:"",config_current_password_invalid:"",config_mail_cooperation_check_cooperation_label:"",config_mail_cooperation_server_label:" : ",config_mail_cooperation_mail_address_label:" : ",config_mail_cooperation_pop3_account_label:"POP3  : ",config_mail_cooperation_pop3_password_label:"POP3  : ",config_mail_cooperation_error_mail_address_must:"",config_mail_cooperation_error_mail_server_account_must:"",config_mail_cooperation_error_mail_server_password_must:"",config_mail_cooperation_error_mail_address_invalid:"ASCII",config_mail_cooperation_error_mail_server_password_invalid:"ASCII",tab_not_referable_community:"",setting_community_dialog_title:"",community_add_member_dialog_title:"",community_force_leave_member_dialog_title:"",community_change_owner_dialog_title:"",button_create:"",button_update:"",button_force_leave:"",config_community_change_failed:"",config_community_logo_failed:"",config_community_community_large:"",config_community_title_empty:"",not_exist_in_list:"",not_force_leave_yourself:"",exist_in_list:"",not_referable_community:"",not_referable_groupchat:"",authchanged_force_reload_community:"",authchanged_force_reload_groupchat:"",create_community_dialog_title:"",community_title:"",community_description:"",community_privacy:"",community_member_entry_type:"",community_color:"",community_logo:"",community_detail_label_owner:"",community_privacy_open:"",community_privacy_close:"",community_privacy_secret:"",community_member_entry_type_add:"",community_member_entry_type_invite:"",community_member_entry_type_invite_or_accept:"",community_member_entry_type_invate_or_free:"",conf_community_setting_tooltip:"",conf_community_change_owner_tooltip:"",conf_community_add_member_tooltip:"",conf_community_leave_member_tooltip:"",conf_community_withdraw_member_tooltip:"",add_member_submit:"",force_leave_member:"",add_owner:"",owner_list:" : ",presence:"",suspend:"()",goodjob:"!",whole_text:"",abbreviation:"",omit:"",view_all:"",action_show_conversation:"",action_reply:"",action_add_inbox_task:"",action_doing_task:"",action_finish_task:"",action_edit_task:"",action_accept_new_task:"",action_reject_task:"",action_demand_task:"",action_clear_demanded_task:"",action_add_new_task_from_message:"",action_add_new_task_from_inbox:"",action_delete_message:"",action_delete_task:"",action_delete_from_inbox:"",presence_offline:"",presence_offline_cut:"",presence_offline_cutUp:"",presence_online:"",presence_staway:"",presence_exaway:"",presence_nodisturb:"",notification_items:"",group_chat_notification_join:"",group_chat_notification_add_member:"",group_chat_notification_remove_member:"",group_chat_notification_remove_member_own:"",group_chat_notification_update_room_name:"",group_chat_notification_change_authority:"",community_notification_change_info:"",community_notification_change_authority:"",get_room_list_err:" ",task_title_add:"",task_title_view:"",task_title_edit:"",task_title_registerTask:"",task_registerTask_btn:"",task_reloadTask_btn:"",task_title_editTask:"",questionnaire_registerQuestionnaire_btn:"",questionnaire_reloadQuestionnaire_btn:"",questionnaire_title_createQuestionnaire:"",task_statuc_reject:"-",task_statuc_other:"",notification:"",demand_notification:"",task_user_arrow:"&nbsp;&#9654;&nbsp;",task_user_count:"",task_user_other:"",task_show_owner:"",task_owner:":",task_owner_edit:"",task_client:"",task_priority_title:"",task_priority_low:"",task_priority_medium:"",task_priority_high:"",task_priority_top:"",task_status:"",task_to_inbox_omit:"IN",task_status_assign_omit:"",task_status_new_omit:"",task_status_do_omit:"",task_status_fin_omit:"",task_status_rej_omit:"",task_to_inbox:"INBOX",task_status_assign:"",task_status_new:"",task_status_do:"",task_status_fin:"",task_status_rej:"",task_status_req:"",task_status_accept:"",task_demand:"",task_filter_dialog_title:"",task_refilter_dialog_title:"",task_filter:"",task_type:"",task_request_type:"",task_request_type_client:"",task_request_type_owner:"",task_request_type_self:"",task_demand_status:"",task_due_date_date:"",task_due_date_to:"",task_created_term:"",task_startdate_label:"",task_enddate_label:"",task_unfinished_number:" : ",inbox_item_number:" : ",toggle:"/",questionnaire_inputtype_title:"",questionnaire_inputType_radiobox:"",questionnaire_inputType_checkbox:"",questionnaire_resultVisible_title:"",questionnaire_resultVisible_public:"",questionnaire_resultVisible_private:"",questionnaire_graphType_title:"",questionnaire_graphType_pie:"",questionnaire_graphType_bar:"",questionnaire_range_title:"",questionnaire_item_add:"",questionnaire_item_option:"",questionnaire_range_value:"",questionnaire_range_value_no_select:"",questionnaire_dialog_range_title:"",questionnaire_dialog_error_no_select_range:"",questionnaire_dialog_error_nothing_room:"",questionnaire_dialog_error_send:"",questionnaire_start_date:"",questionnaire_due_date:"",
questionnaire_option_text:"",questionnaire_dialog_range_feed:"",questionnaire_dialog_range_community:"",questionnaire_dialog_range_group:"",questionnaire_range_community_name:"",questionnaire_range_group_name:"",custom_filter_label_sender:"",custom_filter_label_having_attached_file_and_url:"URL",custom_filter_label_having_attached_file:"",custom_filter_label_having_url:"URL",custom_filter_label_attached_file:"",custom_filter_label_url:"URL",custom_filter_label_term:"",custom_filter_label_term_24_hours:"24",custom_filter_label_term_48_hours:"48",custom_filter_label_term_1_week:"1",custom_filter_label_term_1_month:"1",custom_filter_label_term_1_year:"1",custom_filter_error_text:"",custom_filter_inbox_label_sender:"",custom_filter_label_unread_message:"",suffix_for_reply_title:"",dialogerrorTaskFilterText:"",dialogerrorTaskFilterCheckbox:"",system_message_server_disconnected:"",mail_setting_error_message:"",no_server_info:"",dialog_error_invalid_input:"",task_status_solved:"",task_status_fb:"",task_start_date:"",task_due_date:"",task_name_placeholder:"()",task_name:"",task_body:"",task_body_placeholder:"",task_register_name_placeholder:"50",questionnaire_body_placeholder:"",task_update_title:"\n ",task_update_user:"\n ",task_multi_selection:"()",task_non_multi_selection:"()",task_error_taskname:"",task_error_wrong_datetime:"",task_error_statu_due_datetime:"",task_error_taskname_length:"",task_error_content_length:"",task_error_owner_select:"",task_error_not_defined:"",date_year:"",date_month:"",date_day:"",date_hour:"",date_minute:"",file_up_title:"(20MB)",calendar_picker_title:"...",reply_button:"",default_placeholder:"",not_send_to_feed_err_placeholder:"",not_view_to_feed_err_placeholder:" ",not_send_to_community_err_placeholder:"",not_send_to_groupchat_err_placeholder:"",not_view_to_murmur_err_placeholder:"",title_placeholder:"()",title_select_category:"",reply_placeholder:"",inbox_placeholder:"",inbox_submit:"",inbox_add_date:" : ",dialogerrorSearch:"",dialogerrorSearchOneChar:"1",dialogerrorSelect:"",search_option_title:"",search_option_label:"",search_option_checked_all:"ON",search_option_unchecked_all:"OFF",search_result_message_none:"",column_option_filter:"",column_option_group_chat_add_member:"",column_option_group_chat_change_authority_member:"",column_option_group_chat_leave_member:"",column_option_group_chat_unsubscribe:"",column_option_public_group_chat_unsubscribe:"",column_option_group_chat_update_room_info:"",column_option_group_chat_list_member:"",column_option_add_myworkplace:"",column_option_custom_filter:"",column_option_notification_off:"",column_option_notification_on:"",column_option_thread_title_list:"",column_unexpected_error:"",dialog_label_ok:"OK",dialog_label_ok2:"OK",dialog_label_cancel:"",dialog_label_save:"OK",dialog_label_keyword:"  : ",dialog_filter_title:"",dialog_context_search_title:"",dialog_add_column_title:"",dialog_delete_conf_message:"",dialog_delete_conf_message_for_community:"<br><br><br>",dialog_delete_conf_message_for_contactlist:"",dialog_cancel_title:"",dialog_option_title:"",dialog_close_title:"",dialog_label_account:"  : ",dialog_placeholder_account:"@",dialog_show_conversation_title:"",dialog_label_roomname:"  : ",dialog_placeholder_roomname:"",dialog_confirmation_title:"",dialog_label_close:"",dialog_label_more_view:"",dialog_label_input_member:" : ",dialog_title_group_chat_add_member:"",dialog_label_add_member_list:" : ",dialog_label_remove_member_list:" : ",dialog_confirmation_unsubscribe:"",dialog_title_group_chat_change_authority_member:"",dialog_title_group_chat_leave_member:"",dialog_button_add_to_member_list:">",add_followee_text:"",del_followee_text:"",dialog_title_followee:"",dialog_title_follower:"",dialog_label_followee_search:"",dialog_label_follower_search:"",dialog_followee_list_nothing:"",dialog_follower_list_nothing:"",dialog_followee_list_search_nothing:"",dialog_follower_list_search_nothing:"",murmur_btn_text:"",dialog_murmur_show_unfollow_mess:"",dialog_murmur_show_all_follow_mess:"",dialog_murmur_list:"",side_menu_view_fix:"",side_menu_view_unfixed:"",dialog_tab_new:"",dialog_title_chatlist:"",dialog_label_chatlist_search:"",dialog_chatlist_search_nothing:"",dialog_chatlist_nothing:"",dialog_title_create_groupchat:"",dialog_note_1_create_groupchat:"",dialog_label_groupchatlist_search:"",dialog_groupchatlist_search_nothing:"",dialog_groupchatlist_nothing:"",dialog_label_projectlist_search:"",dialog_projectlist_search_nothing:"",dialog_projectlist_nothing:"",dialog_public_groupchat_joining:"",dialog_public_community_joining:"",dialog_title_system_info:"",dialog_title_add_favorite:"",dialog_title_remove_favorite:"",dialog_label_remove:"[[1]][[2]]",dialog_label_keyword_and:"and : 1 2 ",dialog_label_keyword_or:"or : 1 +2 + ",dialog_label_remove_member:"",dialog_label_project_remove_member:"",dialog_title_remove_followee_user:"",err_not_selected_followee_user:"",dialog_label_remove_user:"",dialog_title_remove_chatlist_user:"",err_not_selected_user:"",dialog_label_thread_title_list:"",dialog_label_thread_search:"",dialog_label_thread_title_update:"",dialog_placeholder_title:"",dialog_update_title_note:"OK",dialog_update_title_validation_error:"50",dialog_update_title_error:"",dialog_thread_title_list_get_error:"",dialog_thread_title_nothing:"",dialog_thread_title_search_nothing:"",dialog_label_update_message:"",dialog_update_message_error:"",dialog_update_message_number_error:"",dialog_update_message_nothing_error:"",dialog_update_file_error:"",dialog_label_quote_message:"",dialog_select_quote_room:"",dialog_selected_quote_room:"",dialog_comment_for_quote_message:"",dialog_quote_message:"",dialog_quote_message_attention_anonymous:"",dialog_label_not_select_quote_room_error:"",dialog_label_send_quote_message_error:"",dialog_error_no_chatlist:"",dialog_error_no_groupchat:"",dialog_search_room_nothing:"",dialog_search_room_name:"",data_modal_emotion:"",dialog_label_list_emotion_point:"",dialog_goodjob_point_ranking:"!",dialog_select_ranking_period:"",dialog_ranking_week:"1",dialog_ranking_month:"1",dialog_ranking_year:"1",dialog_thanks_point_ranking:"",dialog_error_get_ranking:"",dialog_error_nothing_ranking:"",dialog_error_nothing_murmur:"",dialog_label_create_note:"",dialog_label_note_name:"",dialog_placeholder_note_name:"",dialog_error_note_name:"",dialog_create_note_validation_error:"50",dialog_error_create_note:"",dialog_label_get_note_list:"",dialog_label_search_note_list:"",dialog_error_get_note_list:"",dialog_error_note_search_nothing:"",dialog_label_remove_note:"",dialog_note_nothing:"",dialog_note_nothing_for_assign:"",dialog_error_select_remove_notes:"",dialog_error_failed_remove_notes:" ",not_assign_room_notes:"",dialog_label_assign_note:"",dialog_error_assign_note:"",dialog_error_no_select_assign_note:"",tootip_assign_note:"",dialog_label_select_assign_note:"",dialog_selected_note:"",dialog_error_assign_note_after_try:"",dialog_error_send_message:"",dialog_title_note_error:"",dialog_error_note_rename:"",dialog_label_murmur_send_message:"",default_group_chat_suffix:"",group_chat_start_title:"",group_chat_start_explain:"",group_chat_start_label_title:":",group_chat_start_label_selected_users:":",group_chat_start_label_start_button:"",group_chat_start_label_cancel_button:"",group_chat_start_selected_users_count_suffix:"",gorup_chat_member_label:"",group_chat_member_count_suffix:"",add_member_err_contactlist:"",add_member_err_not_exist_account:"",add_member_err_exist:"",add_member_err_input:"",add_member_err_not_exist:"",group_chat_add_member_err_wrong_account:"",add_member_err_submit:"",add_member_err_authority_change:"",change_member_authority_err:"",leave_member_err:"",leave_last_manager_member_err:"",add_member_err_authority:"",not_assign_account_type_err:"",authority_err:"",authority_err_on_add_member:"",groupchat_community_err:"",create_community_err:"",subview_title:":",subview_label_selected_user:":",subview_label_selected_user_suffix:"",subview_btn_title_start_chat:"",subview_btn_title_start_group_chat:"",subview_btn_title_add_contact_list:"",subview_btn_title_remove_contact_list:"",subview_btn_title_add_favorite:"",subview_btn_title_community_unsubscribe_member:"",subview_btn_title_community_add_member:"",sideview_btn_back_to_contact_list:"",sideview_label_search_result:"",sideview_tab_search_contact_list_member:"",sideview_tab_search_all_user:"",sideview_text_search_placeholder:"",sideview_btn_search_exec:"",deleted_message_body:"",deleted_message_body_by_admin:"",deleted_questionnaire_body:"",deleted_questionnaire_body_by_admin:"",show_Action_ToolTip_button:"",group_chat_error_room_name:"",authority_changed_role:"",error_file_up_over_max_sixe:"20MB",error_file_up_request:"",read_message_control_title:"",read_in_bulk_control:"",read_in_bulk_error_message:"",read_in_bulk_attention_message:"",read_in_bulk_attention_message_last_line:"",read_in_bulk_attention_nonify_message:"",Send:"Send",Favorite:"Favorite",Hashtag:"Hashtag"},_defineProperty(e,"Favorite","Favorite"),_defineProperty(e,"List","List"),_defineProperty(e,"Friend","Friend"),_defineProperty(e,"Family","Family"),_defineProperty(e,"Java","Java"),_defineProperty(e,"C","C"),_defineProperty(e,"existing_reader_count",""),_defineProperty(e,"existing_reader_other",""),_defineProperty(e,"existing_reader_label",""),_defineProperty(e,"existing_reader_link",""),_defineProperty(e,"existing_reader_dialog_title",""),_defineProperty(e,"wizard_btn_next",""),_defineProperty(e,"wizard_btn_before",""),_defineProperty(e,"wizard_btn_start",""),_defineProperty(e,"wizard_btn_avater_up",""),_defineProperty(e,"wizard_btn_avater_down",""),_defineProperty(e,"wizard_profile_title",""),_defineProperty(e,"wizard_profile_nickname_label",""),_defineProperty(e,"wizard_profile_avater_label",""),_defineProperty(e,"wizard_profile_avater_OK","OK"),_defineProperty(e,"wizard_password_title",""),_defineProperty(e,"wizard_password_new_label",""),_defineProperty(e,"wizard_password_new_confirm_label","()"),_defineProperty(e,"wizard_password_not_specified_label","8321"),_defineProperty(e,"wizard_password_skip_label",""),_defineProperty(e,"wizard_password_not_specified_label_suffix",""),_defineProperty(e,"wizard_chatlist_title",""),_defineProperty(e,"wizard_chatlist_conditions",""),_defineProperty(e,"wizard_chatlist_conditions_account",""),_defineProperty(e,"wizard_chatlist_allcheck",""),_defineProperty(e,"wizard_profile_change_failed",""),_defineProperty(e,"wizard_profile_image_failed",""),_defineProperty(e,"wizard_profile_image_large",""),_defineProperty(e,"wizard_profile_nickname_empty",""),_defineProperty(e,"wizard_password_new_must",""),_defineProperty(e,"wizard_password_new_confirm_must",""),_defineProperty(e,"wizard_password_Length1"," "),_defineProperty(e,"wizard_password_Length2","  "),_defineProperty(e,"wizard_password_Contain",""),_defineProperty(e,"wizard_chatList_add_failed",""),_defineProperty(e,"main_header_project_list_title",""),_defineProperty(e,"main_header_system_info",""),_defineProperty(e,"main_header_project_details",""),_defineProperty(e,"main_header_recent_list",""),_defineProperty(e,"main_header_project_all",""),_defineProperty(e,"main_header_create_project",""),_defineProperty(e,"main_header_public_project_list",""),_defineProperty(e,"project_list_title",""),_defineProperty(e,"public_project_list_title",""),_defineProperty(e,"project_list_zero",""),_defineProperty(e,"community_btn_avater_up",""),_defineProperty(e,"community_btn_avater_down",""),_defineProperty(e,"community_btn_avater_OK","OK"),_defineProperty(e,"community_logo_setting_failed",""),_defineProperty(e,"main_Left_sidebar_group_chatList",""),_defineProperty(e,"main_Left_sidebar_group_add",""),_defineProperty(e,"main_Left_sidebar_group_all_chatList",""),_defineProperty(e,"main_Left_sidebar_chatList",""),_defineProperty(e,"main_Left_sidebar_project_all",""),_defineProperty(e,"main_Left_sidebar_create_project",""),_defineProperty(e,"dialog_add_chat_no_user",""),_defineProperty(e,"push_notification_setting_title","Push"),_defineProperty(e,"push_notification_on",""),_defineProperty(e,"push_notification_off",""),_defineProperty(e,"push_notification_alert_blocking","\n"),_defineProperty(e,"push_notification_for_goodjob","!"),_defineProperty(e,"push_notification_for_thanks_point",""),_defineProperty(e,"push_notification_for_questionnaire",""),_defineProperty(e,"push_notification_for_adduserfollow",""),_defineProperty(e,"vote_button_name",""),_defineProperty(e,"vote_startdate_status_text",""),_defineProperty(e,"vote_enddate_status_text",""),_defineProperty(e,"vote_toggle_display",""),_defineProperty(e,"vote_toggle_hide",""),_defineProperty(e,"vote_status_label_before",""),_defineProperty(e,"vote_status_label_after",""),_defineProperty(e,"vote_status_label_authority_err",""),_defineProperty(e,"stamp_name",""),_defineProperty(e,"dialog_title_stamp_error",""),_defineProperty(e,"dialog_error_send_stamp",""),_defineProperty(e,"menthion_community_person_list_dialog_title",""),_defineProperty(e,"menthion_groupchat_person_list_dialog_title",""),_defineProperty(e,"menthion_button_force_selected",""),_defineProperty(e,"menthion_select_error",""),_defineProperty(e,"menthion_icon_title",""),_defineProperty(e,"note_name_edit_botton_tooltip",""),_defineProperty(e,"note_name_save_botton_tooltip",""),_defineProperty(e,"set_murmur_column_name",""),_defineProperty(e,"dialog_label_murmur_column_name_set",""),_defineProperty(e,"dialog_placeholder_murmur_column_name",""),_defineProperty(e,"dialog_set_murmur_column_name_note","<br />"),_defineProperty(e,"dialog_update_column_name_validation_error","20"),_defineProperty(e,"dialog_update_column_name_error",""),e)}),n.addCultureInfo("en-US",{messages:(t={label_separator:":",login_username:"User name",login_username_placeholder:"Name",login_password:"Password",login_password_placeholder:"Password",login_btn:"Login",login_faq:"FAQ",failed_to_fetch_authority_data:"Faild to fetch authority data.",unauthorized_assignment:"Faild to fetch account type of assigned to you. Beg it to administrator.",policy_manage:"Manager",policy_send:"Sender",policy_view:"Viewer",loginErrMsg:"The username or password you entered is incorrect.",loginErrUserLength1:"Length of Username must be between ",loginErrUserLength2:" and ",loginErrUserContain:"You must enter your username.",loginErrPasswordLength1:"Length of Password must be between ",loginErrPasswordLength2:" and ",loginErrPasswordContain:"You must enter your password.",skipLoginAccessTokenErrMsg:"Failed authentication. Please login again.",skipLoginSwitchProtocolErrMsg:"Failed to switch protocol. Please login again.",skipLoginErrMsg:"Failed authentication. Please login again.",loading:"loading",save:"save",edit:"edit",presence_chat:"Online",presence_away:"Away",presence_xa:"External away",presence_dnd:"Don't disturb",my_memo_placeholder:"My memo",header_add_column:"Add Column",header_switch_to_list:"Switch to list",header_switch_to_columns:"Switch to columns",header_context_search:"Context search",header_button_option:"Options",header_context_search_placeholder:"Context Search",MyWorkplace:"My Workplace",MyFeed:"Feed",Mention:"Watch Feed",ToMe:"Watch Feed",Chat:"Chat",Task:"Task",MyTask:"My Task",Inbox:"Inbox",Search:"Search",GroupChat:"Group Chat",Mail:"Mail",CommunityFeed:"Community Feed",CommunityTask:"Task",ContextSearchCommunityTask:"Community Task",NotReferableColumnTitle:"Not Referable",Community:"Community",RecentPostedMessages:"Recent",ShowConversation:"Show Conversation",Questionnaire:"Questionnaire",MyQuestionnaire:"My Questionnaire",QuestionnaireOption:"Option ",ContactList:"Contact List",GroupChatList:"Group Chat List",CommunityList:"Community List",CommunityMemberList:"Community Member List",CommunityDetail:"Community Detail",group_title_no_group:"No Group",group_title_all:"All",room_group_title_all:"All Room Members",group_title_favorite:"Favorite",group_title_group_member:"Group Member",group_title_community_member:"Community Member",column_btn_submit:"Submit",column_btn_filter:"Filter",column_btn_search:"Search",show_past_reply_txt:"Display all reply({0})",hidden_past_reply_txt:"Hide past reply",config_profile:"Profile",config_password:"Change Password",config_mail_cooperation:"Mail Setting",config_logout:"Logout",config_profile_image_label:"Change image",config_profile_avater_label:"Avatar image: ",config_profile_nickname_label:"Nickname : ",config_profile_mail_address:"Mail address : ",config_profile_change_failed:"Fail to change your profile",config_profile_image_failed:"You did not select an image data.",config_profile_image_large:"A selected image is too large. Resize to less than 700KB",config_profile_nickname_empty:"You must enter your nickname.",config_password_current_label:"Current password : ",config_password_new_label:"New password : ",config_password_new_confirm_label:"Confirm new password : ",config_password_current_must:"You must enter your current password in order to change it. ",config_password_new_must:"You must enter a new password in order to change it.",config_password_new_confirm_must:"Passwords don't match",config_password_change_failed:"Fail to change your password.",config_current_password_invalid:"Invalid youe current password.",config_mail_cooperation_check_cooperation_label:"Retrieve your e-mail",config_mail_cooperation_server_label:"Pop Server : ",config_mail_cooperation_mail_address_label:"e-mail address : ",config_mail_cooperation_pop3_account_label:"POP3 account  : ",config_mail_cooperation_pop3_password_label:"POP3 password  : ",config_mail_cooperation_error_mail_address_must:"You must enter your e-mail address",config_mail_cooperation_error_mail_server_account_must:"You must enter your pop3 server account.",config_mail_cooperation_error_mail_server_password_must:"You must enter your pop3 server password.",config_mail_cooperation_error_mail_address_invalid:"E-Mail Address may contain any combination of ASCII characters",config_mail_cooperation_error_mail_server_password_invalid:"Password may contain any combination of ASCII characters",tab_not_referable_community:"not referable",update_community_dialog_title:"Setting Community",community_add_member_dialog_title:"Add Member",community_force_leave_member_dialog_title:"Leave Member",community_change_owner_dialog_title:"Change Owner",button_create:"Create",button_update:"Update",button_force_leave:"Leave",config_community_change_failed:"Fail to change a community",config_community_logo_failed:"You did not select an image data.",config_community_community_large:"A selected image is too large. Resize to less than 700KB",config_community_title_empty:"You must enter a title.",not_exist_in_list:"You must enter accounts in a list.",not_force_leave_yourself:"You can not let yourself leave forcibly",exist_in_list:"exists in a list",not_referable_community:"This Community is not referable.",not_referable_groupchat:"You are not a member of this group chat.",community_title:"Title",community_description:"Description",community_privacy:"Privacy Type",community_member_entry_type:"Member Entry Type",community_logo:"Community Logo",community_detail_label_owner:"Owner",community_privacy_open:"Open",community_privacy_close:"Close",community_privacy_secret:"Secret",community_member_entry_type_add:"Add",community_member_entry_type_invite:"Invite",community_member_entry_type_invite_or_accept:"Invite or Accept",community_member_entry_type_invate_or_free:"Invite or Free",conf_community_setting_tooltip:"Setting",conf_community_change_owner_tooltip:"Change Owner",conf_community_add_member_tooltip:"Add Member",conf_community_leave_member_tooltip:"Remove Member",add_member_submit:"Exec Add Member",force_leave_member:"Remove Member",add_owner:"Add Owner",owner_list:"List of Owner : ",presence:"",suspend:"(Suspension of Use)",goodjob:"Good Job!",whole_text:"Whole Text",abbreviation:"abbreviation",omit:"Omit",view_all:"Show all",action_show_conversation:"Show Conversation",action_reply:"Reply",action_add_inbox_task:"To Inbox",action_doing_task:"Doing task",action_finish_task:"Finish task",action_edit_task:"Edit task",action_accept_new_task:"Accept task",action_reject_task:"Reject task",action_demand_task:"Demand task",action_clear_demanded_task:"Clear demanded task",action_add_new_task_from_message:"Add task from Message",action_add_new_task_from_inbox:"Add task from Inbox",action_delete_message:"Delete message",action_delete_task:"Delete task",action_delete_from_inbox:"Delete from Inbox",presence_offline:"Offline",presence_offline_cut:"offline",presence_offline_cutUp:"Offline",presence_online:"Online",presence_staway:"Stay away",presence_exaway:"Go out. Trip",presence_nodisturb:"Do not disturb",notification_items:"",group_chat_notification_join:"Joined",group_chat_notification_add_member:"Added Member",group_chat_notification_remove_member:"Remove Member",group_chat_notification_remove_member_own:"Remove Yourself",group_chat_notification_update_room_name:" : old title",community_notification_change_info:"Changed Community Information",community_notification_change_authority:"Changed Community Authority",task_title_add:"Add task",task_title_view:"Show task",task_title_edit:"Update task",task_title_registerTask:"Register Task",task_registerTask_btn:"Register task",task_reloadTask_btn:"Reload",task_title_editTask:"Edit Task",task_statuc_reject:"-",task_statuc_other:"",notification:"notification",demand_notification:"Request Task is Demand",task_user_arrow:"&nbsp;&#9654;&nbsp;",task_user_count:"users",task_user_other:"others:",task_show_owner:"Show Owner",task_owner:"Assigned :",task_owner_edit:"Assigned",task_client:"requester",task_priority_title:"Priority",task_priority_low:"Low",task_priority_medium:"Mid",task_priority_high:"High",task_priority_top:"Urgent",task_status:"Status",task_to_inbox_omit:"IN",task_status_assign_omit:"AS",task_status_new_omit:"NW",task_status_do_omit:"DO",task_status_fin_omit:"FN",task_status_rej_omit:"RJ",task_to_inbox:"INBOX",task_status_assign:"Assigning",task_status_new:"New",task_status_do:"Doing",task_status_fin:"Finished",task_status_rej:"Rejected",task_status_req:"Request",task_status_accept:"Accepted",task_demand:"Hurry up",task_filter_dialog_title:"Filter",task_refilter_dialog_title:"Filter",task_filter:"Filterd",task_type:"type",task_request_type:"",task_request_type_client:"",task_request_type_owner:"",task_request_type_self:"",task_demand_status:"",task_due_date_date:"",task_due_date_to:"",task_created_term:"",task_startdate_label:"Start",task_enddate_label:"End",task_unfinished_number:"Unfinished : ",inbox_item_number:"Items : ",toggle:"Toggle",questionnaire_inputtype_title:"Type",questionnaire_inputType_radiobox:"Radiobox",questionnaire_inputType_checkbox:"Checkbox",questionnaire_resultVisible_title:"Result",questionnaire_resultVisible_public:"Public",questionnaire_resultVisible_private:"Private",questionnaire_graphType_title:"Graph",questionnaire_graphType_pie:"Pie",questionnaire_graphType_bar:"Bar",questionnaire_range_title:"Range",questionnaire_item_add:"Add option",questionnaire_start_date:"Start date and time",questionnaire_due_date:"Due date and time",questionnaire_dialog_range_title:"Select range",questionnaire_dialog_range_feed:"Feed",questionnaire_dialog_range_community:"Community",questionnaire_dialog_range_group:"Group",questionnaire_range_community_name:"CommunityName",questionnaire_range_group_name:"GrouoName",custom_filter_label_sender:"Sender",custom_filter_label_having_attached_file_and_url:"Attached file / URL",custom_filter_label_having_attached_file:"Include attached files",custom_filter_label_having_url:"Include URL",custom_filter_label_term:"Term",custom_filter_label_term_24_hours:"Within 24 hours",custom_filter_label_term_48_hours:"Within 48 hours",custom_filter_label_term_1_week:"Within 1 week",custom_filter_label_term_1_month:"Within 1 month",custom_filter_label_term_1_year:"Within 1 year",custom_filter_error_text:"is invalid.",custom_filter_inbox_label_sender:"Sender / Requester",custom_filter_label_unread_message:"Unread Message",dialogerrorTaskFilterText:"is invalid.",dialogerrorTaskFilterCheckbox:"is not selected.",system_message_server_disconnected:"Server disconnected",mail_setting_error_message:"Fail: Change MailCooperationSetting",no_server_info:"No Name Server",dialog_error_invalid_input:"Account is wrong.",task_status_solved:"Closed",task_status_fb:"Feedback",task_start_date:"Start date and time",task_due_date:"Due date and time",task_name_placeholder:"Task name(This is essential field, if status is assigning, new or doing.)",task_name:"Task name",task_body_placeholder:"request details",task_update_title:"Task status is updated \n Title",task_update_user:"\n Modified by ",task_multi_selection:"(Multiple selection)",task_non_multi_selection:"(Single selection)",task_error_taskname:"Please input task name.",task_error_wrong_datetime:"Date or Time is wrong.",task_error_statu_due_datetime:"StartDate error. Input future date rather than Due Date.",task_error_taskname_length:"Task name is too long.",task_error_content_length:"Task content is too long.",task_error_owner_select:"Please select owners.",task_error_not_defined:"Register form is not defined.",date_year:"year",date_month:"month",date_day:"day",date_hour:"hour",date_minute:"minute",file_up_title:"file Upload(under 20MB)",calendar_picker_title:"...",reply_button:"Reply",default_placeholder:"Input your message.",reply_placeholder:"Input reply message.",inbox_placeholder:"Drop in your INBOX.",inbox_submit:"Drop in",inbox_add_date:"Drop date to inbox : ",dialogerrorSearch:"Keyword is empty.",dialogerrorSearchOneChar:"It is not possible to single character search of alphanumeric characters and some single-byte symbols.",dialogerrorSelect:"Search ColumnType not selected.",search_option_title:"Search Option",search_option_label:"ColumnType",search_option_checked_all:"ON All",search_option_unchecked_all:"OFF All",search_result_message_none:"No message found",column_option_filter:"Search",column_option_group_chat_add_member:"Add member",column_option_group_chat_change_authority_member:"Edit member",column_option_group_chat_leave_member:"Leave member",column_option_group_chat_unsubscribe:"Unsubscribe",column_option_group_chat_update_room_info:"Change title",column_option_group_chat_list_member:"List member",column_option_add_myworkplace:"Add this column to My Workplace",column_option_custom_filter:"Filter",column_option_notification_off:"Turn off the notification",column_option_notification_on:"Turn on the notification",dialog_label_ok:"OK",dialog_label_ok2:"OK",dialog_label_cancel:"Cancel",dialog_label_save:"OK",dialog_label_keyword:"Keyword  : ",dialog_filter_title:"Search",dialog_context_search_title:"Context Search",dialog_add_column_title:"Add Column",dialog_delete_conf_message:"Are you sure to delete",dialog_delete_conf_message_for_community:"This task being shared community members.<br>if it deleted, other member also can not see it.<br><br>Are you sure to delete",dialog_delete_conf_message_for_contactlist:"Are you sure to delete from contact list",dialog_cancel_title:"cancel",dialog_option_title:"Options",dialog_close_title:"Close",dialog_label_account:"Account name  : ",dialog_placeholder_account:"Input account name after @.",dialog_show_conversation_title:"Show conversations",dialog_label_roomname:"Title  : ",dialog_placeholder_roomname:"Input title",dialog_confirmation_title:"Confirmation",dialog_label_close:"Close",dialog_label_input_member:"Input member : ",dialog_label_add_member_list:"Add member list : ",dialog_label_remove_member_list:"Remove member list : ",
dialog_confirmation_unsubscribe:"Are you sure you want to unsubscribe from group chat ?",dialog_title_group_chat_change_authority_member:"Edit member",dialog_title_group_chat_leave_member:"Remove member",dialog_button_add_to_member_list:"Add to list>",dialog_tab_new:"New",dialog_title_create_groupchat:"Create Group chat",dialog_title_system_info:"Information",dialog_title_add_favorite:"Add Favorite Group",dialog_title_remove_favorite:"Remove Favorite Group",dialog_label_remove:"Are you sure you want to remove [[1]] from [[2]]?",default_group_chat_suffix:"Group Chat",group_chat_start_title:"Group Chat",group_chat_start_explain:"Click or tap user from contact list to add this group chat.",group_chat_start_label_title:"Title:",group_chat_start_label_selected_users:"Selected user(s):",group_chat_start_label_start_button:"Start chat",group_chat_start_label_cancel_button:"Cancel",group_chat_start_selected_users_count_suffix:"",gorup_chat_member_label:"Num. of joined",group_chat_member_count_suffix:"",add_member_err_contactlist:"Input user name in the contact list.",add_member_err_not_exist_account:"is not exist",add_member_err_exist:"is already joined",add_member_err_not_exist:"is not joined",add_member_err_input:"Input user name format.",group_chat_add_member_err_wrong_account:"is must input user name format.",add_member_err_submit:"An attempt to add member has failed. Try the same process again with some time.",add_member_err_authority_change:"An attempt to add member has failed. Please update a authority data from the authority management function.",change_member_authority_err:"Failed to update authority data. Try the same process again with some time.",leave_member_err:"Failed to unsubscribe a member. Try the same process again with some time.",add_member_err_authority:"Failed to assign user with specified authority.",not_assign_account_type_err:" is not attached account type. Please ask the tenant administrator to set up.",authority_err:"You do not have permission to execute.",authority_err_on_add_member:"An attempt to add member has failed. Please ask the community administrator to set the authority of the added user from the authority management function.",subview_title:"Action:",subview_label_selected_user:"Selected user(s):",subview_label_selected_user_suffix:"",subview_btn_title_start_chat:"Start chat",subview_btn_title_start_group_chat:"Start group chat",subview_btn_title_add_contact_list:"Add to contact list",subview_btn_title_remove_contact_list:"remove from contact list",subview_btn_title_add_favorite:"Add favorite",subview_btn_title_community_unsubscribe_member:"Unsubscribe the members",subview_btn_title_community_add_member:"Add the members",sideview_btn_back_to_contact_list:"Back to contact list",sideview_label_search_result:"Search result(s)",sideview_tab_search_contact_list_member:"Contact list",sideview_tab_search_all_user:"All users",sideview_text_search_placeholder:"Keyword",sideview_btn_search_exec:"Search",deleted_message_body:"This message was deleted.",deleted_message_body_by_admin:"This message was deleted by admin.",show_Action_ToolTip_button:"Message menu",group_chat_error_room_name:"Title is empty.",authority_changed_role:"Tenant admin changed your account type. Reload browser.",error_file_up_over_max_sixe:"Over 20MB",error_file_up_request:"Server Error",read_message_control_title:"Click to chage status to Read.",read_in_bulk_control:"Read in bulk.",read_in_bulk_error_message:"Change to already read failed.",read_in_bulk_attention_message:"Can you change to already read , view message?",read_in_bulk_attention_message_last_line:"",read_in_bulk_attention_nonify_message:"",Send:"Send",Favorite:"Favorite",Hashtag:"Hashtag"},_defineProperty(t,"Favorite","Favorite"),_defineProperty(t,"List","List"),_defineProperty(t,"Friend","Friend"),_defineProperty(t,"Family","Family"),_defineProperty(t,"Java","Java"),_defineProperty(t,"C","C"),_defineProperty(t,"existing_reader_count","users"),_defineProperty(t,"existing_reader_other","others"),_defineProperty(t,"existing_reader_label"," user(s) read"),_defineProperty(t,"existing_reader_link","Existing Reader List"),_defineProperty(t,"existing_reader_dialog_title","Existing Reader List"),_defineProperty(t,"vote_button_name","Vote"),_defineProperty(t,"vote_enddate_status_text","Over"),_defineProperty(t,"vote_toggle_display","Display the vote area and vote"),_defineProperty(t,"vote_toggle_hide","Hide the vote area"),_defineProperty(t,"vote_status_label_before","Not time"),_defineProperty(t,"vote_status_label_after","Finished"),t)})}(void 0);var Resource={setCulture:function(e){return Globalize.culture(e)},getMessage:function(e,t){return Globalize.localize(e,t)}};Resource.setCulture("ja");var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t,n,o){var i="images/user_noimage.png",a="";if(a+='<div class="block-avatar" jid="'+e+'">',a+='<span class="ico ico_user">',n==i){var r=new Person;r.setUserName(t),a+=ViewUtils.getDefaultAvatarHtml(r)}else a+="undefined"!=typeof o?'<img class="'+o+'" alt="'+Utils.convertEscapedTag(t)+'" src="'+n+'">':'<img class="avatar" alt="'+Utils.convertEscapedTag(t)+'" src="'+n+'">';return a+="</span>",a+="</div>"}function t(e,t){for(var n=0;n<e.getCount();n++){var o=e.get(n).getOriginalURL();if(o==t)return e.get(n)}return null}function n(e){if("string"==typeof url)return!1;var t=new RegExp("((https?|ftp)(://[-_.!~*'()a-zA-Z0-9;/?:@&=+$,%#]+))"),n=e.search(t);return 0>n?!1:!0}function o(e){if(0==a({imageUrl:e}))return!1;var t=new RegExp("^https?://.+(.jpg|.jpeg|.png|.gif|.bmp)$","i"),n=e.search(t);return 0>n?!1:!0}function i(e,t){if(0==a({message:e,attachmentUrl:t}))return!1;if(t.length>e.length)return!1;if(e.substr(e.length-t.length,t.length)!=t)return!1;var n=location.host,o=location.pathname,i=o.lastIndexOf("/"),r=o.substring(i+1,o.length);0!=r.length?r.lastIndexOf(".")>=0&&(o=o.substring(0,i)):o=o.substring(0,i);for(var s=["f","file"],l=0;l<s.length;l++){var u=new RegExp("https?://"+n+o+"/"+s[l]+"/.*$"),c=t.match(u),d=new RegExp("https?://"+n+"/cubee/"+s[l]+"/.*$"),g=t.match(d);if(null!=c||null!=g)return!0}return null!=t.match(/\/redir\/[0-9A-Za-z]+$/)?!1:!1}function a(e){for(var t in e)if("jid"==t||"classNames"==t||"str"==t||"message"==t||"url"==t||"attachmentUrl"==t||"imageUrl"==t){if(null==e[t]||"string"!=typeof e[t])return!1}else if("textBoxElm"==t||"outputTargetElm"==t||"baseElem"==t){if(null==e[t]||"object"!=_typeof(e[t])||0==e[t].size())return!1}else if("maxLength"==t||"count"==t){if(null==e[t]||"number"!=typeof e[t]||e[t]<0)return!1}else if("status"==t||"priority"==t||"presenceNum"==t){if(null==e[t]||"number"!=typeof e[t])return!1}else if("elm"==t){if(null==e[t]||"object"!=_typeof(e[t]))return!1}else if("privacyType"==t){if(null==e[t]||"number"!=typeof e[t])return!1}else if("memberEntryType"==t&&(null==e[t]||"number"!=typeof e[t]))return!1;return!0}function r(e,t){var n="",o=t.slice(2),i=FavoriteStore.getInstance().getGroupIdByName(o);if(i>=0){for(var a=FavoriteStore.getInstance().getGroupMember(i),r=0;r<a.length;r++){var s=a[r],l=CubeeController.getInstance().getPersonData(s),u=l.getLoginAccount(l);n+="@"+u+" "}var c=e.val();c.lastIndexOf(t);return c=c.substr(0,c.length-t.length),$(e).val(c+n),!0}return!1}ViewUtils.LOADING_ICON_CLASS_NAME="loading-readmore",ViewUtils.DEFAULT_USER_AVATAR_SRC="images/user_noimage.png",ViewUtils.CHAR_COUNTER_BEFORE=0,ViewUtils.CHAR_COUNTER_AFTER=1,ViewUtils.CHAR_COUNTER_CLASSNAME="char-counter",ViewUtils.CHAR_COUNTER_UNDER_CLASSNAME="char-counter-under",ViewUtils.CHAR_COUNTER_OVER_CLASSNAME="char-counter-over",ViewUtils.ACCOUNT_PREFIX="@",ViewUtils.STATUS_PRESENCEICON_CONTACTLIST=0,ViewUtils.STATUS_PRESENCEICON_GROUPCHAT_MEMBERLIST=1,ViewUtils.SINGLE_CLICK_DECISION_TIME=500,ViewUtils.TYPE_CONTACT_LIST=0,ViewUtils.TYPE_GROUP_CHAT=1,ViewUtils.TYPE_COMMUNITY=2;var s="div."+ViewUtils.LOADING_ICON_CLASS_NAME;ViewUtils.getUserName=function(e){var t="";if(0==a({jid:e}))return t;var n=CubeeController.getInstance().getPersonData(e);if(n){var o=n.getUserName();null!=o&&""!=o&&(t=o)}else{var i=$('.message-border div[jid="'+e+'"] img').eq(0);1==i.length&&(t=i.attr("alt"))}return(null==t||""==t)&&(t=ViewUtils.getCubeeAccountName(e)),t},ViewUtils.getUserNameByPerson=function(e){var t="";if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.getUserName();return t=null!=n&&""!=n?n:e.getLoginAccount()},ViewUtils.getCubeeAccountName=function(e){var t="";if(0==a({jid:e}))return t;var n=CubeeController.getInstance().getPersonData(e);if(n){var o=n.getLoginAccount();null!=o&&""!=o&&(t=o)}return t},ViewUtils.getCubeeAccountNameByPerson=function(e){var t="";if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.getLoginAccount();return t=null!=n&&""!=n?n:ViewUtils.getCubeeAccountName(e.getJid())},ViewUtils.setCharCounter=function(e,t,n,o,i){function r(a){var r,s=e;r=1==o?s.val().length:i?ViewUtils.getCalculattionTitle(s.val()):ViewUtils.getCalculattionBody(s.val());var l=n-r;l>=0?(t.removeClass(ViewUtils.CHAR_COUNTER_OVER_CLASSNAME),t.addClass(ViewUtils.CHAR_COUNTER_UNDER_CLASSNAME)):(t.removeClass(ViewUtils.CHAR_COUNTER_UNDER_CLASSNAME),t.addClass(ViewUtils.CHAR_COUNTER_OVER_CLASSNAME)),t.html(l)}return 0==a({textBoxElm:e,outputTargetElm:t,maxLength:n})?!1:(r(),e.on("keyup",function(){r()}),e.on("change",function(){r()}),e.on("focus",function(){r()}),!0)},ViewUtils.getCharCounterHtml=function(e){return 0==a({classNames:e})&&(e=""),'<span class="'+ViewUtils.CHAR_COUNTER_CLASSNAME+" "+e+'"></span>'},ViewUtils.taskStatusNumToStr=function(e){var t="";if(0==a({status:e}))return t;switch(e){case TaskMessage.STATUS_INBOX:t=Resource.getMessage("task_to_inbox");break;case TaskMessage.STATUS_ASSIGNING:t=Resource.getMessage("task_status_assign");break;case TaskMessage.STATUS_NEW:t=Resource.getMessage("task_status_new");break;case TaskMessage.STATUS_DOING:t=Resource.getMessage("task_status_do");break;case TaskMessage.STATUS_SOLVED:t=Resource.getMessage("task_status_solved");break;case TaskMessage.STATUS_FEEDBACK:t=Resource.getMessage("task_status_fb");break;case TaskMessage.STATUS_FINISHED:t=Resource.getMessage("task_status_fin");break;case TaskMessage.STATUS_REJECTED:t=Resource.getMessage("task_status_rej")}return t},ViewUtils.requestTaskStatusNumToStr=function(e,t){var n="";if(0==a({status:e}))return n;switch(e){case TaskMessage.STATUS_ASSIGNING:n=Resource.getMessage("task_status_assign"),t||(n=Resource.getMessage("task_status_req"));break;case TaskMessage.STATUS_NEW:n=Resource.getMessage("task_status_new"),t&&(n=Resource.getMessage("task_status_accept"));break;default:n=ViewUtils.taskStatusNumToStr(e)}return n},ViewUtils.taskPriorityNumToStr=function(e){var t="";if(0==a({priority:e}))return t;switch(e){case TaskMessage.PRIORITY_LOW:t=Resource.getMessage("task_priority_low");break;case TaskMessage.PRIORITY_MEDIUM:t=Resource.getMessage("task_priority_medium");break;case TaskMessage.PRIORITY_HIGH:t=Resource.getMessage("task_priority_high");break;case TaskMessage.PRIORITY_TOP:t=Resource.getMessage("task_priority_top")}return t},ViewUtils.showLoadingTopInChild=function(e){return 0==a({elm:e})?!1:0==e.siblings(s).size()?(e.prepend('<div class="'+ViewUtils.LOADING_ICON_CLASS_NAME+'"></div>'),$(window).trigger("resize"),!0):!1},ViewUtils.showLoadingIcon=function(e){return 0==a({elm:e})?!1:0==e.siblings(s).size()?(e.after('<div class="'+ViewUtils.LOADING_ICON_CLASS_NAME+'"></div>'),$(window).trigger("resize"),!0):!1},ViewUtils.hideLoadingIconInChild=function(e){if(0==a({elm:e}))return!1;var t=e.find(s);return $(t).size()>0?($(t).remove(),$(window).trigger("resize"),!0):!1},ViewUtils.hideLoadingIcon=function(e){if(0==a({elm:e}))return!1;var t=e.siblings("."+ViewUtils.LOADING_ICON_CLASS_NAME);return $(t).size()>0?($(t).remove(),$(window).trigger("resize"),!0):!1},ViewUtils.showLoginLoadingIcon=function(e){return 0==a({elm:e})?!1:0==e.siblings(s).size()?(e.before('<div class="'+ViewUtils.LOADING_ICON_CLASS_NAME+'"></div>'),!0):!1},ViewUtils.hideLoginLoadingIcon=function(e){if(0==a({elm:e}))return!1;var t=e.siblings("."+ViewUtils.LOADING_ICON_CLASS_NAME);return $(t).size()>0?($(t).remove(),!0):!1},ViewUtils.getAvatarDataHtml=function(t,n){if(0==a({jid:t}))return"";var o=CubeeController.getInstance().getPersonData(t),i=ViewUtils.getUserName(t),r=ViewUtils.getAvatarUrl(o);if(!o){var s=$('.message-border div[jid="'+t+'"] img').eq(0);1==s.length&&(r=s.attr("src"))}var l=e(t,i,r,n);return l},ViewUtils.getAvatarDataHtmlFromPerson=function(t,n){if(t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var o=t.getJid(),i=t.getUserName();i&&""!=i||(i=t.getLoginAccount(),i&&""!=i||(i=ViewUtils.getCubeeAccountName(t.getJid())));var a=ViewUtils.getAvatarUrl(t),r=e(o,i,a,n);return r}},ViewUtils.createAvatarToolTipHtml=function(e,t){function n(e,t){var n="";if(e!=LoginUser.getInstance().getJid()){for(var o=0;o<t.getCount();o++)if(e==t._array[o].getJid())return n+='<td width="110px">',n+='  <button type="button" class="unfollow-btn">',n+=Resource.getMessage("del_followee_text"),n+="  </button>",n+="</td>";return n+='<td width="110px">',n+='  <button type="button" class="follow-btn">',n+=Resource.getMessage("add_followee_text"),n+="  </button>",n+="</td>"}return n+='<td width="110px">',n+='  <button disabled class="follow-btn">',n+=Resource.getMessage("add_followee_text"),n+="  </button>",n+="</td>"}function o(e){var t="";return e?(t+='<div id="tooltipProfileMyMemo" class="tooltip-block-item">',t+=Utils.convertEscapedHtml(e,!0),t+="</div>"):""}if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var i=e.getJid(),a=e.getPresence(),r=e.getUserName(),s=e.getStatus(),l=e.getMyMemo(),u=e.getGroup();u||(u=[]);var c=function(){return CubeeController.getInstance().getPersonData(i)?ViewUtils.getAvatarDataHtml(i,"tooltip-block-image"):ViewUtils.getAvatarDataHtmlFromPerson(e,"tooltip-block-image")},d=ViewUtils.getPresenceColorCss(a),g=(r.length<12?ViewUtils.getRepeatString("&nbsp;",12-r.length):"","");return g+='<div class="tooltip-block-border cf">',g+='  <div class="tooltip-block-left">',g+="    <div>",g+='      <span class="ico ico_user">',g+=c(),g+="      </span>",g+="    </div>",g+="  </div>",g+='  <div class="tooltip-block-right">',g+='    <div id="tooltipProfileName" class="tooltip-block-item">',g+=Utils.convertEscapedHtml(r),g+=ViewUtils.getUserStatusString(s),g+="    </div>",g+='    <div class="tooltip-block-item tooltipGroupName" style="font-size:12px;">',g+=Utils.convertEscapedHtml(u.join(",")),g+="    </div>",g+='    <div class="tooltip-block-item">',g+='      <span id="tooltipProfilePresenceString" class="'+d+'">',g+=ViewUtils.convertPresenceNumToDisplayStr(a),g+="      </span>",g+="    </div>",g+='    <div id="sidebar-gj-tp-'+t+'">',g+='        <goodjob-thanks-counter v-bind:total="total"></goodjob-thanks-counter>',g+="    </div>",g+=o(l),g+='    <table class="sidebar-followee-follower-list">',g+='      <div class="list_ttl_ico"></div>',g+='      <tr style="text-align:center">',g+='        <div class="sidebar_list_inner">',g+='        <div class="tooltip-border-line"></div>',g+='          <div class="list_ttl">',g+='            <td width="96px">',g+='              <a class="followeelist txt_btn" data-toggle="tooltip" data-html="true" data-placement="bottom" data-modal="followeelist-modal" title="">',g+='                <span class="followee-count">0</span></a>',g+="            </td>",g+="            <td>",g+='              <a class="followerlist txt_btn" data-toggle="tooltip" data-html="true" data-placement="bottom" data-modal="followerlist-modal" title="">',g+='                <span class="follower-count">0</span></a>',g+="            </td>",g+="          </div>",g+="        </div>",g+="      </tr>",g+="    </table>",g+="    <table>",g+="      <tr>",g+=n(i,LoginUser.getInstance().getFolloweeList()),g+="        <td>",g+='    <button type="button" class="murmur-btn">',g+=Resource.getMessage("murmur_btn_text"),g+="    </button>",g+="        </td>",g+="      </tr>",g+="    </table>",g+="  </div>",g+="</div>"}},ViewUtils.centeringElement=function(e){return 0==a({elm:e})?!1:(e.removeClass("visibility-hidden"),!0)},ViewUtils.urlAutoLink=function(e,n,o,i,a,r){var s=/((https?|ftp)(:\/\/\S+))|\\\\(.+\\)+\S*/gi,l=n.match(s),u=Utils.convertPreEscapedHtml(n,o);if(null!=l&&l.length>0){for(var c=[],d=l.length,g=0;d>g;g++){for(var m=l[g],_=!1,f=c.length,p=0;f>p;p++)if(c[p]==m){_=!0;break}1!=_&&(c[f]=m)}var h=c.length,d=h;a&&(d-=1);for(var g=0;d>g;g++){var C=c[g],v=Utils.convertEscapedHtml(C,o);if(0==C.indexOf("ftp://"))u=Utils.replaceAll(u,v,'<a class="url-link" href="'+C+'" target="_blank">'+v+"</a>");else if(0==C.indexOf("\\"))ViewUtils.isIE()&&(u=Utils.replaceAll(u,v,'<a class="url-link" href="'+C+'" target="_blank">'+v+"</a>"));else{var y=t(e,C);if(null!=y){C=y.getShortenPath();var v=Utils.convertEscapedHtml(y.getDisplayedURL()),T=Utils.convertEscapedHtml(y.getOriginalURL()),b=Utils.convertEscapedTag(y.getOriginalURL()),I=r;null==I&&(r=""),u=Utils.replaceAll(u,T,'<a class="url-link" href='+T+' target="_blank" title="'+b+'">'+v+"</a>")}else u=Utils.replaceAll(u,v,'<a class="url-link" href="'+C+'" target="_blank">'+v+"</a>")}}if("undefined"!=typeof i&&null!=i&&a)if(u=u.replace(c[h-1]+"</pre>",""),0==i.indexOf("ftp://"))u+='<a class="url-link" href="'+i+'" target="_blank">'+c[h-1]+"</a></pre>";else{var y=t(e,i);if(null!=y){var M=Utils.convertEscapedHtml(y.getDisplayedURL()),E=Utils.convertEscapedTag(y.getOriginalURL());u+='<a class="url-link" href='+E+' target="_blank" title="'+E+'">'+M+"</a></pre>"}else u+='<a class="url-link" href="'+i+'" target="_blank">'+c[h-1]+"</a></pre>"}}return u},ViewUtils.checkLength=function(e,t,n){var o=e.val().length;return o>n||t>o?!1:!0},ViewUtils.checkRegexp=function(e,t){return t.test(e.val())?!0:!1},ViewUtils.convertPresenceNumToDisplayStr=function(e){var t=Resource.getMessage("presence_offline");if(0==a({presenceNum:e}))return t;switch(e){case Person.PRESENCE_STATUS_ONLINE:t=Resource.getMessage("presence_online");break;case Person.PRESENCE_STATUS_AWAY:t=Resource.getMessage("presence_staway");break;case Person.PRESENCE_STATUS_EXT_AWAY:t=Resource.getMessage("presence_exaway");break;case Person.PRESENCE_STATUS_DO_NOT_DISTURB:t=Resource.getMessage("presence_nodisturb")}return t},ViewUtils.showPresenceIcon=function(e,t,n){if(0==a({baseElem:e}))return!1;var o=e.children("button"),i=ViewUtils.getPresenceColorCss(t);0!=o.length&&o.remove();var r;switch(n){case ViewUtils.STATUS_PRESENCEICON_CONTACTLIST:r="button_presence contact-list-presence "+i;break;case ViewUtils.STATUS_PRESENCEICON_GROUPCHAT_MEMBERLIST:r="button_presence groupchat-memberlist-presence "+i}return e.find("span").removeClass("status online offline leave busy out").addClass("status "+r),!0},ViewUtils.getPresenceColorCss=function(e){var t="button_presence_offline";if(0==a({presenceNum:e}))return t;switch(e){case Person.PRESENCE_STATUS_OFFLINE:t="offline";break;case Person.PRESENCE_STATUS_ONLINE:t="online";break;case Person.PRESENCE_STATUS_AWAY:t="leave";break;case Person.PRESENCE_STATUS_EXT_AWAY:t="out";break;case Person.PRESENCE_STATUS_DO_NOT_DISTURB:t="busy"}return t},ViewUtils.getRepeatString=function(e,t){var n="";return 0==a({str:e,count:t})?n:Array(t+1).join(e)},ViewUtils.showPrivateMark=function(e){if(0==a({elm:e}))return!1;var t=e.position();return t.top+=16,t.left+=24,$(e).parent().append('<img src="images/lock.png" style="position: absolute;top:'+t.top+"px;left:"+t.left+'px;width:24px!important; height:24px!important;" />'),!0},ViewUtils.showUnreadTopicMark=function(e){if(0==a({elm:e}))return!1;var t=e.position();return t.top+=16,t.left+=16,$(e).parent().append('<button style="position:absolute;top:'+t.top+"px;left:"+t.left+'px;width:20px!important; height:18px!important; font-size:11px;" class="button_notification">13</button>').children("button").css("background-color","#0000ff").css("color","#ffffff"),!0},ViewUtils.removeElems=function(e){for(var t=e.getCount(),n=0;t>n;n++)e.get(n).remove()},ViewUtils.extractUrls=function(e){var t=new ArrayList;if(0==a({message:e}))return t;var n=/((https?|ftp)(:\/\/\S+))/gi,o=e.match(n);if(null!=o)for(var i=o.length,r=0;i>r;r++)t.add(o[r]);return t},ViewUtils.extractAttachedFileUrls=function(e){var t=new ArrayList;if(0==a({message:e}))return t;var n=/((https?|ftp)(:\/\/\S+))/gi,o=e.match(n);if(null!=o)for(var r=o.length,s=0;r>s;s++)i(e,o[s])&&t.add(o[s]);return t},ViewUtils.getThumbnailImageHtml=function(e,t,n){if(0==a({url:e}))return"";var r,s="";try{s=decodeURI(e)}catch(l){if("URI malformed"!=l.message)return"";s=e}var u=Utils.convertEscapedTag(s.split("/").pop());if(o(e))r=i(t,e)?ViewUtils.isOldUploadFilePath(e)?'<a href="'+e+'" target="_blank"><img src="'+e+'" class="image-thumbnail clickable" title="'+e+'"/></a>':ViewUtils.isIE89()?'<a href="javascript: void(0)"onClick="return CubeeController.getInstance().downloadfile(\''+e+"','"+n+'\');"><img class="image-thumbnail clickable" title="'+e+'"/></a>':'<a href="javascript: void(0)" onClick="return CubeeController.getInstance().downloadfileOpen(this);"><img class="image-thumbnail clickable" title="'+u+'" data-url="'+e+'"/></a>':'<a href="'+e+'" target="_blank"><img src="'+e+'" class="image-thumbnail clickable" title="'+e+'"/></a>';else{if(!i(t,e))return"";var c="images/add_attach_file.png",d='style="margin-left: 2px; height: 20px; width: 20px; border: 0px;"';r=ViewUtils.isOldUploadFilePath(e)?'<a href="'+e+'" target="_blank"><img src="'+c+'" class="image-thumbnail clickable" title="'+e+'" '+d+"/></a>":'<a href="javascript: void(0)" onClick="return CubeeController.getInstance().downloadfile(\''+e.replace(/\'/g,"\\'")+"','"+n+'\');" title="'+u+'"'+d+'><i class="fa fa-paperclip"></i>'+u+"</a>"}return r},ViewUtils.removeAttachmentUrl=function(e){var t=e;if(0==a({message:e}))return"";var n=/((https?|ftp)(:\/\/\S+))/gi,o=e.match(n);if(null!=o){var r=o.length;i(e,o[r-1])&&(t=e.replace(o[r-1],""))}return t},ViewUtils.getAttachmentFileName=function(e){var t="";if(0==a({attachmentUrl:e}))return!1;var n=new RegExp(location.protocol+"//"+location.hostname+"(/[^/].*/|/)(f|file)/.*$"),o=e.match(n);if(null==o)return t;var i=e.split("/"),r=i.length;return t=i[r-1],Utils.urldecode(t)},ViewUtils.getKeywordListFromKeywordInputString=function(e){var t=Utils.replaceAll(e,""," ");t=t.replace(/ +/g," ");var n=Utils.convertStringToArrayList(t," "),o=n.getCount();if(1>o)return null;for(var i=0;o>i;i++){var a=n.get(i);(0==a.indexOf("+")||0==a.indexOf(""))&&a.length>1&&(a=a.substring(1),n.set(i,a))}return n},ViewUtils.getKeywordFilterFromKeywordInputString=function(e,t){var n=2==arguments.length?t:!0,o=Utils.replaceAll(e,""," ");o=o.replace(/ +/g," ");var i=Utils.convertStringToArrayList(o," "),a=i.getCount(),r=null;if(1>a)return null;var s=i.get(0);(0==s.indexOf("+")||0==s.indexOf(""))&&s.length>1&&(s=s.substring(1));var l=new KeywordCondition;l.setData(s),n&&l.setAddIncludeMessageFrom();for(var u=1;a>u;u++){var c=!1,s=i.get(u);(0==s.indexOf("+")||0==s.indexOf(""))&&s.length>1&&(s=s.substring(1),c=!0);var d=new KeywordCondition;d.setData(s),n&&d.setAddIncludeMessageFrom();var g=null;g=c?new OrCondition:new AndCondition,g.addChildCondition(l),g.addChildCondition(d),l=g}return r=l},ViewUtils.getAvatarUrl=function(e){var t=ViewUtils.DEFAULT_USER_AVATAR_SRC;if(null!=e){var n=e.getAvatarType(),o=e.getAvatarData();if(null!=n&&""!=n&&null!=o&&""!=o&&(t="data:"+n+";base64,"+o,"imagepath"==n)){var i=location.protocol+"//"+location.hostname,a=location.pathname,r=a.lastIndexOf("/"),s=a.substring(r+1);i+=0!=s.length?s.lastIndexOf(".")<0?a:a.substring(0,r+1):a,t=i,"/"!=i.charAt(i.length-1)&&(t+="/"),t+=o}}return t},ViewUtils.isAttachmentUrl=function(e,t){return i(e,t)},ViewUtils.getColumnTypeListFromMessage=function(e){var t=new ArrayList,n=e.getType();switch(n){case Message.TYPE_PUBLIC:t.add(ColumnInformation.TYPE_COLUMN_TIMELINE);var o=ViewUtils.isMentionMessage(e);o&&t.add(ColumnInformation.TYPE_COLUMN_MENTION);break;case Message.TYPE_CHAT:t.add(ColumnInformation.TYPE_COLUMN_CHAT);break;case Message.TYPE_GROUP_CHAT:t.add(ColumnInformation.TYPE_COLUMN_UNKNOWN);break;case Message.TYPE_TASK:var i=ViewUtils.isInboxColumnMessage(e);i?t.add(ColumnInformation.TYPE_COLUMN_INBOX):t.add(ColumnInformation.TYPE_COLUMN_TASK);break;case Message.TYPE_COMMUNITY:t.add(ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED);break;case Message.TYPE_SYSTEM:t.add(ColumnInformation.TYPE_COLUMN_TIMELINE);break;case Message.TYPE_MAIL:t.add(ColumnInformation.TYPE_COLUMN_MAIL);break;case Message.TYPE_QUESTIONNAIRE:t.add(ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE);break;default:t.add(ColumnInformation.TYPE_COLUMN_UNKNOWN)}return t},ViewUtils.isMentionMessage=function(e){var t=!1;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.getType();if(!n||n!=Message.TYPE_PUBLIC)return t;var o=ColumnFilterManager.getColumnFilter(ColumnInformation.TYPE_COLUMN_MENTION);return o.isMatch(e)&&(t=!0),t},ViewUtils.isToMeMessage=function(e){var t=!1;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=ColumnFilterManager.getColumnFilter(ColumnInformation.TYPE_COLUMN_TOME);return n.isMatch(e)&&(t=!0),t},ViewUtils.isInboxColumnMessage=function(e){var t=!1;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.getType();if(!n||n!=Message.TYPE_TASK)return t;var o=e.getStatus(),i=e.getParentItemId(),a=!1;return o==TaskMessage.STATUS_ASSIGNING&&""!=i&&(a=!0),(o==TaskMessage.STATUS_INBOX||a)&&(t=!0),t},ViewUtils.setAutoCompleteEventToTextArea=function(){function e(e){function n(e,t,n){var o=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\"].join("|\\")+")","g"),i="("+t.replace(o,"\\$1")+")",a="";if(0==e.value.indexOf("#"))null!=n&&n[e.value]&&(a="("+n[e.value]+")");else if(0==e.value.indexOf("@")){var r=e.value.substring(1,e.value.length-1);if("all"==r)a="("+Resource.getMessage("group_title_all")+")";else{var s=CubeeController.getInstance().getPersonDataByLoginAccount(r);if(null!=s){var l=s.getUserName();null!=l&&""!=l&&(a="("+l+")")}}}return e.value.replace(new RegExp(i,"gi"),"<strong>$1</strong>")+Utils.convertEscapedHtml(a)}function o(t){var n=t.value;n.startsWith("@@")&&r(e,n),ViewUtils.setCursorEndOfLineForText(e),e.focus()}function i(e,t){var n=LoginUser.getInstance(),o=ContactList.getInstance(),i=[],a=n.getLoginAccount();i[0]="@all ",i[1]="@"+a+" ";for(var r=o.getCount(),s=0;r>s;s++){var l=o.get(s),u=l.getLoginAccount();i[s+2]="@"+u+" "}CubeeServerConnector.getInstance().getHashtagRanking().then(function(n){for(var o={},a=0;a<n.content.items.length;a++){var r=decodeURIComponent(n.content.items[a].tagname);i.push(r+" "),o[r+" "]=n.content.items[a].count}t(i,o),e.data("iBinded",!1)})["catch"](function(n){t(i,{}),e.data("iBinded",!1)})}function a(i,a){return e.data("autocomplete")?e.data("autocomplete").setOptions({lookup:i,formatResult:function(e,t){return n(e,t,a)}}):e.autocomplete({lookup:i,minChars:1,delimiter:t,onSelect:o,formatResult:function(e,t){return n(e,t,a)},lookupFilter:function(t,n,o){return 1==o.length&&"@all "!=t.value?!1:1==o.length&&"@"!=o?!1:"@all "==t.value&&($(e).parent().hasClass("register-task-client")||$(e).parent().hasClass("register-task-owner")||$(e).parent().hasClass("column-inbox-frm-message")||$(e).parent().hasClass("column-chat-frm-message")||$(e).closest(".column-chat").length||$(e).hasClass("register-questionnaire-item"))?!1:t.value.indexOf("#")>=0&&($(e).hasClass("questionnaire-register-item")&&$(e).hasClass("register-option-input")||$(e).hasClass("register-questionnaire-item"))?!1:-1!==t.value.toLowerCase().indexOf(o)}})}i(e,a)}var t=new RegExp(" |\n");$(document).off("focusin",'input.autocomplete[type="text"]'),$(document).on("focusin",'input.autocomplete[type="text"]',function(){1!=$(this).data("iBinded")&&($(this).data("iBinded",!0),e($(this)))}),$(document).off("focusin","textarea.autocomplete"),$(document).on("focusin","textarea.autocomplete",function(){1!=$(this).data("iBinded")&&($(this).data("iBinded",!0),e($(this)))})},ViewUtils.setAutoCompleteEventForCommunityMember=function(){function e(e){function t(e,t,n){var o=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\"].join("|\\")+")","g"),a="("+t.replace(o,"\\$1")+")",r="";if(0==e.value.indexOf("#"))null!=n&&n[e.value]&&(r="("+n[e.value]+")");else if(0==e.value.indexOf("@")){var s=e.value.substring(1,e.value.length-1);if("all"==s)r="("+Resource.getMessage("room_group_title_all")+")";else{var l=i.getByLoginAccount(s);if(null!=l){var u=l.getUserName();null!=u&&""!=u&&(r="("+u+")")}}}return e.value.replace(new RegExp(a,"gi"),"<strong>$1</strong>")+Utils.convertEscapedHtml(r)}function n(t){var n=t.value;if(n.startsWith("@@")&&0==r(e,n)){var o=function(t){if(null!=t){for(var o="",i=t.getOwnerList(),a=i.getCount(),r=t.getGeneralMemberList(),s=r.getCount(),l=0;a>l;l++){var u=i.get(l),c=u.getLoginAccount(u);o+="@"+c+" "}for(var d=0;s>d;d++){var u=r.get(d),c=u.getLoginAccount(u);o+="@"+c+" "}var g=e.val();g.lastIndexOf(n);g=g.substr(0,g.length-n.length),$(e).val(g+o),ViewUtils.setCursorEndOfLineForText(e),e.focus()}};CubeeController.getInstance().getCommunityMemberInfo(a,o)}ViewUtils.setCursorEndOfLineForText(e),e.focus()}function o(o){if(null!=o){for(var a=o.getOwnerList(),r=a.getCount(),s=o.getGeneralMemberList(),l=s.getCount(),u=[],c=0;r>c;c++){var d=a.get(c),g=d.getLoginAccount(),m="@"+g+" ";u.push(m),i.add(d)}for(var _=0;l>_;_++){var d=s.get(_),g=d.getLoginAccount(),m="@"+g+" ";u.push(m),i.add(d)}u.push("@all "),u.push("@@"+Resource.getMessage("group_title_community_member"));var f=new RegExp(" |\n");CubeeServerConnector.getInstance().getHashtagRanking().then(function(t){for(var n={},o=0;o<t.content.items.length;o++){var i=decodeURIComponent(t.content.items[o].tagname);u.push(i+" "),n[i+" "]=t.content.items[o].count}p(n),$(e).data("iBinded",!1)})["catch"](function(t){p({}),$(e).data("iBinded",!1)});var p=function(o){return e.data("autocomplete")?e.data("autocomplete").setOptions({lookup:u,formatResult:function(e,n){return t(e,n,o)}}):void e.autocomplete({lookup:u,minChars:1,delimiter:f,onSelect:n,formatResult:function(e,n){return t(e,n,o)},lookupFilter:function(t,n,o){return 1==o.length&&"@all "!=t.value?!1:1==o.length&&"@"!=o?!1:"@all "==t.value&&($(e).parent().hasClass("register-task-client")||$(e).parent().hasClass("register-task-owner"))?!1:-1!==t.value.toLowerCase().indexOf(o)}})}}}var i=new PersonList,a=e.attr("groupId");a||(a=e.attr("communityId")),CubeeController.getInstance().getCommunityMemberInfo(a,o)}$(document).off("focusin",'input.autocomplete-for-community[type="text"]'),$(document).on("focusin",'input.autocomplete-for-community[type="text"]',function(){if(1!=$(this).data("iBinded")){$(this).data("iBinded",!0);var t=this;setTimeout(function(){e($(t))},100)}}),$(document).off("focusin","textarea.autocomplete-for-community"),$(document).on("focusin","textarea.autocomplete-for-community",function(){if(1!=$(this).data("iBinded")){$(this).data("iBinded",!0);var t=this;setTimeout(function(){e($(t))},100)}})},ViewUtils.setAutoCompleteEventToTextAreaForGroup=function(e){function t(e){function t(e,t,n){var o=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\"].join("|\\")+")","g"),i="("+t.replace(o,"\\$1")+")",r="";if(0==e.value.indexOf("#"))null!=n&&n[e.value]&&(r="("+n[e.value]+")");else if(0==e.value.indexOf("@")){var s=e.value.substring(1,e.value.length-1);if("all"==s)r="("+Resource.getMessage("room_group_title_all")+")";else{var l="";if(null!=a){var u=a.getProfileMap();if(null!=u)for(var c=u.getCount(),d=0;c>d;d++){var g=u.get(d);if(null!=g&&s==g.getLoginAccount()){l=g.getNickName();break}}}null!=l&&""!=l&&(r="("+l+")")}}return e.value.replace(new RegExp(i,"gi"),"<strong>$1</strong>")+Utils.convertEscapedHtml(r);
}function n(t){var n=t.value;if(n.startsWith("@@")&&0==r(e,n)){for(var o="",i=a.getMemberList(),s=i.getCount(),l=0;s>l;l++){var u=i.get(l),c=a.getProfileMap().getByKey(u),d=c.getLoginAccount();o+="@"+d+" "}var g=e.val();g.lastIndexOf(n);g=g.substr(0,g.length-n.length),$(e).val(g+o)}ViewUtils.setCursorEndOfLineForText(e),e.focus()}function o(){return new RegExp(" |\n")}function i(i,r,s){return a=r,e.data("autocomplete")?e.data("autocomplete").setOptions({lookup:i,formatResult:function(e,n){return t(e,n,s)}}):e.autocomplete({lookup:i,minChars:1,delimiter:o(),onSelect:n,formatResult:function(e,n){return t(e,n,s)},lookupFilter:function(e,t,n){return 1==n.length&&"@all "!=e.value?!1:1==n.length&&"@"!=n?!1:-1!==e.value.toLowerCase().indexOf(n)}})}var a=null;s(e,i)}var n=1,o=e?e:n,i=[],a=[],s=function(e,t){};switch(o){case n:a=[{event:"focusin",element:'input.autocomplete-for-chatroom[type="text"]'},{event:"focusin",element:"textarea.autocomplete-for-chatroom"}],s=function(e,t){function n(n){i=[];new PersonList;if(null===n)return void t(i,n);for(var o=n.getMemberList(),a=o.getCount(),r=0;a>r;r++){var s=o.get(r),l=n.getProfileMap().getByKey(s),u=l.getLoginAccount();i.push("@"+u+" ")}i.push("@all "),i.push("@@"+Resource.getMessage("group_title_group_member")),CubeeServerConnector.getInstance().getHashtagRanking().then(function(o){for(var a={},r=0;r<o.content.items.length;r++){var s=decodeURIComponent(o.content.items[r].tagname);i.push(s+" "),a[s+" "]=o.content.items[r].count}t(i,n,a),e.data("iBinded",!1)})["catch"](function(o){t(i,n,{}),e.data("iBinded",!1)})}var o=e.attr("groupId"),a=ColumnManager.getInstance()._getChatroomInformationFromColumnObjByRoomId(o);if(null===a){var r=CubeeController.getInstance().getRoomInfo(o,n);r||(console.log("GetRoomInfo Request is fail"),n(null))}else n(a)}}!function(){for(var e=0;e<a.length;e++){var n=a[e].event,o=a[e].element;$(document).off(n,o),$(document).on(n,o,function(){1!=$(this).data("iBinded")&&($(this).data("iBinded",!0),t($(this)))})}}()},ViewUtils.clearAutoCompleteEventToTextArea=function(e,t){function n(){i>=a||($(document).find(o[i]).each(function(){$(this).data("iBinded",!1)}),i++,setTimeout(function(){n()},1))}if(null!=e&&"number"==typeof e){var o=[];switch(e){case ViewUtils.TYPE_CONTACT_LIST:o.push('input.autocomplete[type="text"]'),o.push("textarea.autocomplete");break;case ViewUtils.TYPE_GROUP_CHAT:o.push('input.autocomplete-for-chatroom[type="text"][groupid="'+t+'"]'),o.push('textarea.autocomplete-for-chatroom[groupid="'+t+'"]');break;case ViewUtils.TYPE_COMMUNITY:o.push('input.autocomplete-for-community[type="text"][groupid="'+t+'"]'),o.push('textarea.autocomplete-for-community[communityid="'+t+'"]'),o.push('input.autocomplete-for-community[type="text"][communityid="'+t+'"]'),o.push('textarea.autocomplete-for-community[groupid="'+t+'"]');break;default:return}var i=0,a=o.length;setTimeout(function(){n()},1)}},ViewUtils.getGroupChatColumnInfo=function(e){var t=new GroupChatColumnInformation;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return null;var n={};n.roomId=e.getRoomId();var o=ColumnFilterManager.getColumnFilter(ColumnInformation.TYPE_COLUMN_GROUP_CHAT,n),i=new ColumnSortCondition,a=new ColumnSearchCondition(o,i),t=new GroupChatColumnInformation;return t.setChatRoomInfomation(e),t.setSearchCondition(a),t},ViewUtils.getCommunityFeedColumnInfo=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return null;var t={};t.roomId=e.getRoomId();var n=ColumnFilterManager.getColumnFilter(ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED,t),o=new ColumnSortCondition,i=new ColumnSearchCondition(n,o),a=new CommunityFeedColumnInformation;return a.setCommunityInfomation(e),a.setSearchCondition(i),a},ViewUtils.getCommunityTaskColumnInfo=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return null;var t={};t.roomId=e.getRoomId();var n=CommunityTaskColumnFilter.getFilterWithoutCompletedTask(t),o=ViewUtils.getTaskDefaultSortCondition(),i=new ColumnSearchCondition(n,o),a=new CommunityTaskColumnInformation;return a.setCommunityInfomation(e),a.setSearchCondition(i),a},ViewUtils.convertAccountStrToJidStr=function(e){var t=null;if(null==e||"string"!=typeof e||""==Utils.trimStringMulutiByteSpace(e))return t;var n=e.indexOf(ViewUtils.ACCOUNT_PREFIX);if(0!=n)return t;var o=e.substring(1,e.length),i=CubeeController.getInstance().getPersonDataByLoginAccount(o);return null==i?t:t=i.getJid()},ViewUtils.convertAccountStrToJidStrFromServer=function(e,t){function n(e){var n=null;null!=e&&e.getCount()>0&&(n=e.get(0).getJid()),t&&"function"==typeof t&&setTimeout(function(){t(n)},1)}if(null==e||"string"!=typeof e||""==Utils.trimStringMulutiByteSpace(e))return void n(null);var o=e.indexOf(ViewUtils.ACCOUNT_PREFIX);if(0!=o)return void n(null);var i=e.substring(1,e.length),a=new ArrayList;a.add(i),CubeeController.getInstance().getPersonDataByLoginAccountFromServer(a,n)},ViewUtils.convertJidStrToAccountStr=function(e){var t="";return null==e||"string"!=typeof e||""==Utils.trimStringMulutiByteSpace(e)?t:t=ViewUtils.ACCOUNT_PREFIX+ViewUtils.getCubeeAccountName(e)},ViewUtils.convertJidStrToAccountStrFromServer=function(e,t){function n(e){var n="";null!=e&&e.getCount()>0&&(n=ViewUtils.ACCOUNT_PREFIX+e.get(0).getLoginAccount()),t&&"function"==typeof t&&setTimeout(function(){t(n)},1)}if(null==e||"string"!=typeof e||""==Utils.trimStringMulutiByteSpace(e))return void n(null);var o=new ArrayList;o.add(e),CubeeController.getInstance().getPersonDataByJidFromServer(o,n)},ViewUtils.getTaskFilterAndSortCondition=function(e){var t=new TaskFilterAndSortCondition;if(null==e||"string"!=typeof e)return null;t.setFilterOwner(e);var n="";n+=TaskMessage.STATUS_ASSIGNING,n+=","+TaskMessage.STATUS_NEW,n+=","+TaskMessage.STATUS_DOING,t.setFilterStatus(n);var o=ViewUtils.getTaskDefaultSortCondition(),i=o.getJSONObject();return t.setSortItem(i.item),t.setSortOrder(i.order),t},ViewUtils.getTaskDefaultSortCondition=function(){var e=new ColumnSortCondition;e.add(TaskFilterAndSortCondition.DB_COLUMN_DEMAND_STATUS,TaskFilterAndSortCondition.SORT_ORDER_DES),e.add(TaskFilterAndSortCondition.DB_COLUMN_DEMAND_DATE,TaskFilterAndSortCondition.SORT_ORDER_ASC),e.add(TaskFilterAndSortCondition.DB_COLOMN_COMPLETE_DATE+" "+TaskFilterAndSortCondition.SORT_COLUMN_IS_NULL,TaskFilterAndSortCondition.SORT_ORDER_DES),e.add(TaskFilterAndSortCondition.DB_COLOMN_COMPLETE_DATE,TaskFilterAndSortCondition.SORT_ORDER_DES),e.add(TaskFilterAndSortCondition.DB_COLOMN_DUE_DATE+" "+TaskFilterAndSortCondition.SORT_COLUMN_IS_NULL,TaskFilterAndSortCondition.SORT_ORDER_ASC),e.add(TaskFilterAndSortCondition.DB_COLOMN_DUE_DATE,TaskFilterAndSortCondition.SORT_ORDER_ASC),e.add(TaskFilterAndSortCondition.DB_COLUMN_PRIORITY,TaskFilterAndSortCondition.SORT_ORDER_DES),e.add(TaskFilterAndSortCondition.DB_COLOMN_STATUS,TaskFilterAndSortCondition.SORT_ORDER_ASC);var t=e;return t},ViewUtils.getMailColumnInfomation=function(){var e=new ColumnInformation;e.setColumnType(ColumnInformation.TYPE_COLUMN_MAIL),e.setFilterCondition("");var t=ColumnFilterManager.getColumnFilter(e.getColumnType(),null);if(null==t)return!1;var n=new ColumnSortCondition,o=new ColumnSearchCondition(t,n);return e.setSearchCondition(o),e},ViewUtils.getCooperationServerName=function(){var e=LoginUser.getInstance().getSettings().getMailCooperationList().get(0).getServerName();if(""==e){var t=CubeeController.getInstance().getServerInfoById(1);e=null!=t?t.getDisplayName():Resource.getMessage("no_server_info")}return e},ViewUtils.getRequestString=function(){for(var e=new Array,t=window.location.search.substring(1),n=t.split("&"),o=0;o<n.length;o++){var i=n[o].indexOf("=");if(i>0){var a=n[o].substring(0,i),r=n[o].substring(i+1);e[a]=r}}return e},ViewUtils.createMessageObject=function(e,t){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return null;if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return null;var n=null,o=t.getType();switch(o){case Message.TYPE_PUBLIC:n=new ColumnPublicMessageView(e,t);break;case Message.TYPE_SYSTEM:n=new ColumnSystemMessageView(e,t);break;case Message.TYPE_CHAT:n=new ColumnChatMessageView(e,t);break;case Message.TYPE_GROUP_CHAT:n=new ColumnGroupChatMessageView(e,t);break;case Message.TYPE_TASK:var i=ViewUtils.isInboxColumnMessage(t),a=t.getCommunityName();n=i?new ColumnInboxMessageView(e,t):null!=a&&""!=a?new ColumnCommunityTaskMessageView(e,t):new ColumnTaskMessageView(e,t);break;case Message.TYPE_GROUP_CHAT:n=new ColumnGroupChatMessageView(e,t);break;case Message.TYPE_MAIL:n=new ColumnMailMessageView(e,t);break;case Message.TYPE_COMMUNITY:n=new ColumnCommunityMessageView(e,t);break;case Message.TYPE_QUESTIONNAIRE:n=new ColumnQuestionnaireMessageView(e,t);break;case Message.TYPE_MURMUR:n=new ColumnMurmurMessageView(e,t);break;default:console.log("ViewUtils::createMessageObjectOnly _ invalid type:"+o)}return n},ViewUtils.createDisplayName=function(e){var t=e.getColumnType();return ViewUtils.createDisplayNameByColumnType(t)},ViewUtils.createDisplayNameByColumnType=function(e){switch(e){case ColumnInformation.TYPE_COLUMN_TIMELINE:return ColumnView.DISPLAY_NAME_TIMELINE;case ColumnInformation.TYPE_COLUMN_MENTION:return ColumnView.DISPLAY_NAME_MENTION;case ColumnInformation.TYPE_COLUMN_CHAT:return ColumnView.DISPLAY_NAME_CHAT;case ColumnInformation.TYPE_COLUMN_TASK:return ColumnView.DISPLAY_NAME_MY_TASK;case ColumnInformation.TYPE_COLUMN_INBOX:return ColumnView.DISPLAY_NAME_INBOX;case ColumnInformation.TYPE_COLUMN_TASK:return ColumnView.DISPLAY_NAME_TASK;case ColumnInformation.TYPE_COLUMN_SEARCH:return ColumnView.DISPLAY_NAME_SEARCH;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:return ColumnView.DISPLAY_NAME_GROUP_CHAT;case ColumnInformation.TYPE_COLUMN_MAIL:return ColumnView.DISPLAY_NAME_MAIL;case ColumnInformation.TYPE_COLUMN_RECENT:return ColumnView.DISPLAY_NAME_RECENT;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:return ColumnView.DISPLAY_NAME_COMMUNITY_FEED;case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:return ColumnView.DISPLAY_NAME_COMMUNITY_TASK;case ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE:return ColumnView.DISPLAY_NAME_QUESTIONNAIRE;default:return""}},ViewUtils.createDisplayNameWithSubData=function(e,t,n,o){var i=!1,a="";switch(e){case ColumnInformation.TYPE_COLUMN_TIMELINE:case ColumnInformation.TYPE_COLUMN_MENTION:case ColumnInformation.TYPE_COLUMN_TASK:case ColumnInformation.TYPE_COLUMN_INBOX:case ColumnInformation.TYPE_COLUMN_MAIL:case ColumnInformation.TYPE_COLUMN_RECENT:a=ViewUtils.createDisplayNameByColumnType(e);break;case ColumnInformation.TYPE_COLUMN_CHAT:if(null==t||"string"!=typeof t)return void o(a);var r=CubeeController.getInstance().getPersonData(t);if(null!=r){var s=r.getUserName();null!=s&&""!=s&&(a=s)}else a=n;break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:var l=function(e){if(null!=e){var t=e.getRoomName();null!=t&&""!=t&&(a=t)}o(a)};null!=t&&"string"==typeof t&&""!=t&&(i=!0,CubeeController.getInstance().getRoomInfo(t,l));break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:var u=function(e){if(null!=e){var t=e.getRoomName();null!=t&&""!=t&&(a=t)}o(a)};null!=t&&"string"==typeof t&&""!=t&&(i=!0,CubeeController.getInstance().getCommunityInfo(t,u));break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:var c=function(t){if(null!=t){var n=t.getRoomName();null!=n&&""!=n&&(a=ViewUtils.createDisplayNameByColumnType(e)+"("+n+")")}o(a)};null!=t&&"string"==typeof t&&""!=t&&(i=!0,CubeeController.getInstance().getCommunityInfo(t,c))}i||o(a)},ViewUtils.getSubDataInColumnInfo=function(e,t){var n={};return null==t?n:n=e==ColumnInformation.TYPE_COLUMN_CHAT?t.partner:e==ColumnInformation.TYPE_COLUMN_GROUP_CHAT?t.roomId:e==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED?t.roomId:e==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK?t.roomId:t},ViewUtils.createQuestionnaireColumnInfo=function(){var e=new ColumnInformation;e.setColumnType(ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE);var t=new TaskFilterAndSortCondition,n=(LoginUser.getInstance().getJid(),TaskFilterAndSortCondition.DB_COLUMN_CREATED_AT);t.setSortItem(n);var o=TaskFilterAndSortCondition.SORT_ORDER_DES;t.setSortOrder(o),e.setFilterCondition(t.getFilterConditionJSONString());var i=new FilterCondition("{}"),a=new ColumnSortCondition;a.add(TaskFilterAndSortCondition.DB_COLUMN_CREATED_AT,ColumnSortCondition.SORT_ORDER_DESC);var r=new ColumnSearchCondition(i,a);return e.setSearchCondition(r),e},ViewUtils.createIndexColumnInfo=function(){var e=new ColumnInformation;e.setColumnType(ColumnInformation.TYPE_COLUMN_INBOX);var t=new TaskFilterAndSortCondition,n=LoginUser.getInstance().getJid();t.setFilterStatus(TaskMessage.STATUS_INBOX+","+TaskMessage.STATUS_ASSIGNING),t.setFilterOwner(n);var o=TaskFilterAndSortCondition.DB_COLUMN_DEMAND_STATUS;o+=","+TaskFilterAndSortCondition.DB_COLUMN_DEMAND_DATE,o+=","+TaskFilterAndSortCondition.DB_COLUMN_UPDATE_AT,t.setSortItem(o);var i=TaskFilterAndSortCondition.SORT_ORDER_DES;i+=","+TaskFilterAndSortCondition.SORT_ORDER_ASC,i+=","+TaskFilterAndSortCondition.SORT_ORDER_DES,t.setSortOrder(i),e.setFilterCondition(t.getFilterConditionJSONString());var a=new InboxFilterCondition,r=new ColumnSortCondition;r.add(TaskFilterAndSortCondition.DB_COLUMN_DEMAND_STATUS,ColumnSortCondition.SORT_ORDER_DESC),r.add(TaskFilterAndSortCondition.DB_COLUMN_DEMAND_DATE,ColumnSortCondition.SORT_ORDER_ASC),r.add(TaskFilterAndSortCondition.DB_COLUMN_UPDATE_AT,ColumnSortCondition.SORT_ORDER_DESC);var s=new ColumnSearchCondition(a,r);return e.setSearchCondition(s),e},ViewUtils.isFinishedTask=function(e){var t=!1;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.getType();if(!n||n!=Message.TYPE_TASK)return t;var o=e.getStatus(),i=!0;return o!=TaskMessage.STATUS_UNKNOWN&&o!=TaskMessage.STATUS_FINISHED&&o!=TaskMessage.STATUS_REJECTED&&(i=!1),i},ViewUtils.validBlinkTaskStatusElement=function(e,t,n,o,i,a){function r(){l=ViewUtils.getStatusElement(e,i,a),0==u?($(l).replaceWith(n),u=!0):($(l).replaceWith(o),u=!1)}var s,l=ViewUtils.getStatusElement(e,i,a),u=!1;return $(function(){s=setInterval(r,t)}),s},ViewUtils.invalidBlinkTaskStatusElement=function(e,t,n,o,i){var a=ViewUtils.getStatusElement(t,o,i);clearInterval(e),$(a).replaceWith(n)},ViewUtils.getDemandTaskListByMessage=function(e){if(null==e)return null;var t=CubeeController.getInstance().getChildrenTaskItemIds(e.getItemId()),n=new ArrayList,o=0;if(null!=t){o=t.getCount();for(var i=0;o>i;i++){var a=CubeeController.getInstance().getMessage(t.get(i));null!=a&&a.getDemandStatus()!=TaskMessage.DEMAND_OFF&&n.add(a)}}else e.getDemandStatus()==TaskMessage.DEMAND_ON&&n.add(e);return n},ViewUtils.getStatusElement=function(e,t,n){var o=null;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return o;if(t){var i=e.find("div.message-footer").find("div.children-task-assign-area"),a=i.children().find('[ownerjid = "'+n+'"]');o=a.find(".child-task-status-view")}else{var r=e.find("div.message-footer");o=r.children().find("div.task-status-view")}return o},ViewUtils.setDoubleClickEventToAvatar=function(){ViewUtils.isIE8()&&$(document).on("dblclick","div#columnContainer .block-avatar",function(){var e=$(this).attr("jid");""!=e&&ColumnManager.getInstance().addChatColumn(e,!0)}),$(document).on("click","div#columnContainer .block-avatar",function(){var e=$(this).attr("jid");""!=e&&ViewUtils.isCheckDoubleClick($(this))&&ColumnManager.getInstance().addChatColumn(e,!0)}),$(document).on("click","div#columnContainer .child-task-avatar",function(){var e=$(this).parents(".child-task-owner-jid").attr("ownerjid");""!=e&&ViewUtils.isCheckDoubleClick($(this))&&ColumnManager.getInstance().addChatColumn(e,!0)})},ViewUtils.isCheckDoubleClick=function(e){var t=!1;if(null==e.data("clickTimerId")){var n=setTimeout(function(){e.data("clickTimerId",null)},ViewUtils.SINGLE_CLICK_DECISION_TIME);e.data("clickTimerId",n),t=!1}else clearTimeout(e.data("clickTimerId")),e.data("clickTimerId",null),t=!0;return t},ViewUtils.getClientHeight=function(e){var t=e.attr("clientHeight")?e.attr("clientHeight"):e.get()[0].clientHeight;return t&&(t=parseInt(t)),t},ViewUtils.setCursorEndOfLineForText=function(e){var t=e.val();e.val(""),e.focus().val(t)},ViewUtils.isValidInputTextLength=function(e){var t=!0,n=ViewUtils.getCalculattionBody(e);return(""==e||n>ColumnView.TEXTAREA_MAX_LENGTH)&&(t=!1),t},ViewUtils.getUserStatusString=function(e){var t="";return e==Person.PROFILE_STATUS_SUSPEND&&(t=Resource.getMessage("suspend")),t};var l=null;ViewUtils.isIE8=function(){if(l)return l;if(l=!1,$.browser.msie){var e=parseInt($.browser.version);8==e&&(l=!0)}return l};var u=null;ViewUtils.isIE9=function(){if(u)return u;if(u=!1,$.browser.msie){var e=parseInt($.browser.version);9==e&&(u=!0)}return u};var c=null;ViewUtils.isIE89=function(){if(c)return c;if(c=!1,$.browser.msie){var e=parseInt($.browser.version);(8==e||9==e)&&(c=!0)}return c};var d=null;ViewUtils.isIE=function(){if(null!==d)return d;d=!1;var e=window.navigator.userAgent;return(e.match(/MSIE/)||e.match(/Trident/))&&(d=!0),d},ViewUtils.isOldUploadFilePath=function(e){var t=location.host,n=location.pathname,o=n.lastIndexOf("/"),i=n.substring(o+1,n.length);0!=i.length?i.lastIndexOf(".")>=0&&(n=n.substring(0,o)):n=n.substring(0,o);var a=new RegExp("https?://"+t+n+"/f/.*$"),r=e.match(a),s=new RegExp("https?://"+t+"/cubee/f/.*$"),l=e.match(s);return null!=r||null!=l?!0:!1},ViewUtils.showErrorMessageIE=function(e,t){return 0==a({elm:e})?!1:(e.siblings("div.ui-state-error-text").size()>0&&ViewUtils.hideErrorMessageIE(e),e.after('<div class="ui-state-error-text error-message-ie">'+t+"</div>"),!0)},ViewUtils.hideErrorMessageIE=function(e){return 0==a({elm:e})?!1:e.siblings("div.ui-state-error-text").size()>0?(e.siblings("div.ui-state-error-text").remove(),!0):!1},ViewUtils.communityPrivacyTypeNumToStr=function(e){var t="";if(0==a({privacyType:e}))return t;switch(e){case CommunityInfo.PRIVACY_TYPE_ITEM_OPEN:t=Resource.getMessage("community_privacy_open");break;case CommunityInfo.PRIVACY_TYPE_ITEM_CLOSED:t=Resource.getMessage("community_privacy_close");break;case CommunityInfo.PRIVACY_TYPE_ITEM_SECRET:t=Resource.getMessage("community_privacy_secret")}return t},ViewUtils.communityMemberEntryTypeNumToStr=function(e){var t=Resource.getMessage("community_member_entry_type_add");return t},ViewUtils.searchUserExecute=function(e,t,n){function o(e){e._array.sort(function(e,t){var n=e.getLoginAccount(),o=t.getLoginAccount();return n==o?0:o>n?-1:1}),n&&"function"==typeof n&&n(e)}function i(e,t){function n(){if(s>=r)return i.setAllItemCount(i.getCount()),void setTimeout(function(){o(i)},1);var l=e.get(s);a(l,t)&&i.add(l),s++,setTimeout(function(){n()},1)}var i=new SearchResultPersonList,r=e.getCount(),s=0;setTimeout(function(){n()},1)}function a(e,t){if("or"==t.getType()){for(var n=t._columnFilterConditionList,o=0;o<n.getCount();o++)if(a(e,n.get(o)))return!0;return!1}if("and"==t.getType()){for(var n=t._columnFilterConditionList,o=0;o<n.getCount();o++)if(!a(e,n.get(o)))return!1;return!0}return"keyword"==t.getType()?r(e,t.getValue()):void 0}function r(e,t){if(-1!=e.getUserName().indexOf(t))return!0;var n=t;if(0===t.indexOf("@")&&(n=t.substr(1)),n.length>0){var o=e.getLoginAccount();if(-1!=o.indexOf(n))return!0}for(var i=e.getGroup(),a=0;a<i.length;a++)if(-1!=i[a].indexOf(t))return!0;return!1}i(e,t)},ViewUtils.getSourceColumnTypeAndRoomIdFromColumnInfo=function(e,t){var n=t?t:e.getColumnType(),o=null,i=n;switch(n){case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:e.getChatRoomInfomation()&&(o=e.getChatRoomInfomation().getRoomId());break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:e.getCommunityInfomation()&&(o=e.getCommunityInfomation().getRoomId());break;case ColumnInformation.TYPE_COLUMN_SEARCH:e.getSubData()&&(o=e.getSubData().roomId,i=e.getSourceColumnTypeList().get(0));break;case ColumnInformation.TYPE_COLUMN_FILTER:e.getSubData()&&(o=e.getSubData().roomId,i=e.getSourceColumnType());break;case ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER:e.getSubData()&&(o=e.getSubData().roomId,i=e.getBeginningColumnType()==ColumnInformation.TYPE_COLUMN_UNKNOWN?e.getSourceColumnType():e.getBeginningColumnType())}return{roomId:o,sourceColumnType:i}},ViewUtils.getAutoCompleteAttributesFromColumnInfo=function(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=ViewUtils.getSourceColumnTypeAndRoomIdFromColumnInfo(e),n="autocomplete",o="";switch(t.sourceColumnType){case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:n="autocomplete-for-chatroom",o='groupId="'+t.roomId+'"';break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:n="autocomplete-for-community",o='groupId="'+t.roomId+'"'}return{autoCompleteType:n,roomIdAttribute:o}}},ViewUtils.createPersonByProfile=function(e,t){var n=null;return null==e||"string"!=typeof e?n:null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t))?n:(n=new Person,n.setJid(e),n._profile=t,n)},ViewUtils.getGroupName=function(e){if(e&&e.getGroup){var t=e.getGroup().join(",");return t?t:Resource.getMessage("group_title_no_group")}},ViewUtils.getDefaultAvatarHtml=function(e){var t=Utils.avatarCreate({type:"user",name:e.getUserName()}),n="";return n+='<div class="no_img" style="background-color:'+t.color+';">',n+='  <div class="no_img_inner">'+t.name+"</div>",n+="</div>"},ViewUtils.replaceTenantBaseTitleCategory=function(e,t,n,o){var i=LoginUser.getInstance().getTenantInfo().threadTitleCategory,a=o&&"string"==typeof o["class"]&&o["class"]?o["class"]:"",r=!1,s=[],l=void 0;if(i&&0!=Object.keys(i).length){for(var u={},c=0;c<Object.keys(i).length;c++){var d=decodeURIComponent(Object.keys(i)[c]);u[d]=i[Object.keys(i)[c]]}l=e.replace(new RegExp("\\[([^\\]]+)\\]","g"),function(e,o,i,l){if(r)return e;if(!u[o]||l.indexOf(e)>0&&"]"!=l.substring(l.indexOf(e)-1,l.indexOf(e))||o.match(/\s+/)||o.length>2||s.length+n.length>4)return o.length>2?r=!0:o.match(/\s+/)||s.push(o),"["+o+"]";var c=(Utils.avatarCreate({type:"hashtag",name:o}),u[o].bgColor),d=u[o].color;return n.push({index:t.indexOf("["+o+"]"),data:'<span class="thread-title-category-tip '+a+'" style="color:'+d+";background-color:"+c+';">'+o+"</span>"}),""})}return l},ViewUtils.replaceOrignalTitleCategory=function(e,t,n,o){for(var i=o&&"string"==typeof o["class"]&&o["class"]?o["class"]:"",a=LoginUser.getInstance().getTenantInfo().threadTitleCategory,r=!1,s={},l=0;l<Object.keys(a).length;l++){var u=decodeURIComponent(Object.keys(a)[l]);s[u]=a[Object.keys(a)[l]]}var c=e.replace(new RegExp("\\[([^\\]]+)\\]","g"),function(e,o,a,l){if(r)return e;if(s[o])return r=!0,e;if(l.indexOf(e)>0&&"]"!=l.substring(l.indexOf(e)-1,l.indexOf(e))||o.match(/\s+/)||o.length>2||n.length>4)return r=!0,"["+o+"]";var u=Utils.avatarCreate({type:"hashtag",name:o}),c="#fff",d=u.color;return n.push({index:t.indexOf(o),data:'<span class="thread-title-category-tip '+i+'" style="color:'+c+";background-color:"+d+';">'+o+"</span>"}),""});return c},ViewUtils.setNewNoticeMark=function(e){e&&(e.parent().addClass("notice"),e.append('<span class="new_message_notice">!</span>'))},ViewUtils.unsetNewNoticeMark=function(e){e&&(e.removeClass("notice"),e.find(".new_message_notice").remove())},ViewUtils.modal_on=function(e,t){t?$("#wizard_modal").show():($("#"+e).show(),$("#dialog_area").prepend('<div class="overlay modal_exit"></div>')),$(".ui-dialog").addClass("on").css("display","block").animate({"margin-top":0,opacity:1},200),$(".overlay").animate({opacity:.3},200)},ViewUtils.wizard_overlayClose=function(){ViewUtils.modal_exit(),$(".wizard_overlay").addClass("visibility-hidden")},ViewUtils.modal_exit=function(){$(".ui-dialog.on").animate({"margin-top":"-70px",opacity:0},200,function(){$(this).css("display","none"),$(".modal_card").css("display","none")}),$("#modal_area").hide(),$(".overlay").animate({opacity:0},200,function(){$(this).remove()})},ViewUtils.modal_allexit=function(){dlg_scr.forEach(function(e){e.destroy()}),dlg_scr=[],ViewUtils.modal_exit(),$("#modal_area").find("*").off(),$("#modal_area").off(),$("#modal_area").children().remove()},ViewUtils.rayout_resize=function(e){e.resize()},ViewUtils.switchAttachmentArea=function(e,t){if(e&&0!=e.find(".file-selected").length){var n=e.find(".file-selected").children().not(".submit-message-progress");n&&(t?n.show():n.hide())}},ViewUtils.animateCss=function(e,t,n){e.addClass("animated "+t),e.on("animationend",function(){$(this).removeClass("animated "+t),$(this).off("animationend"),"function"==typeof n&&n()})},ViewUtils.convertMessageTypeToColumnType=function(e){switch(e){case Message.TYPE_PUBLIC:return ColumnInformation.TYPE_COLUMN_TIMELINE;case Message.TYPE_CHAT:return ColumnInformation.TYPE_COLUMN_CHAT;case Message.TYPE_GROUP_CHAT:return ColumnInformation.TYPE_COLUMN_GROUP_CHAT;case Message.TYPE_COMMUNITY:return ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED;default:return ColumnInformation.TYPE_COLUMN_UNKNOWN}},ViewUtils.convertColumnTypeToMessageType=function(e){switch(e){case ColumnInformation.TYPE_COLUMN_TIMELINE:return Message.TYPE_PUBLIC;case ColumnInformation.TYPE_COLUMN_CHAT:return Message.TYPE_CHAT;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:return Message.TYPE_GROUP_CHAT;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:return Message.TYPE_COMMUNITY;case ColumnInformation.TYPE_COLUMN_MURMUR:return Message.TYPE_MURMUR;default:return 0}},ViewUtils.sendPushNotificationForGoodJobOrThanksPoint=function(e){if(e.getMsgOwnJid()&&e.getMsgOwnJid()==LoginUser.getInstance().getJid()&&PushNotificationSettingManager.getInstance().isSetting(LoginUser.getInstance().getJid())&&e.getFromJid()!=LoginUser.getInstance().getJid()){var t="",n="";if(!NotificationSettingManager.getInstance().isSetting(ViewUtils.convertMessageTypeToColumnType(e.getMsgType()),e.getMsgTo())){switch(n+=ViewUtils.getAttachmentFileName(e.getMessage())?ViewUtils.removeAttachmentUrl(e.getMessage()).slice(0,-1):e.getMessage(),e.getType()){case Notification_model.TYPE_GOOD_JOB:t=e.getNickName()+Resource.getMessage("push_notification_for_goodjob");break;case Notification_model.TYPE_EMOTION_POINT:if(0==e.getEmotionPoint())return;t=e.getNickName()+Resource.getMessage("push_notification_for_thanks_point");break;default:return}Push.create(t,{icon:"images/cubee.png",body:n,timeout:5e3,onClick:function(){window.focus(),this.close()}})}}},ViewUtils.sendPushNotification=function(e){if(PushNotificationSettingManager.getInstance().isSetting(LoginUser.getInstance().getJid())){var t="",n="",o="images/cubee.png";if(e.getFrom()!=LoginUser.getInstance().getJid()){switch(n+=e.getProfileByJid(e.getFrom()).getNickName()+"\n",e.getThreadTitle()&&(n+="# "+e.getThreadTitle()+"\n"),n+=ViewUtils.getAttachmentFileName(e.getMessage())?ViewUtils.removeAttachmentUrl(e.getMessage()).slice(0,-1):e.getMessage(),e.getProfileByJid(e.getFrom()).getAvatarData()&&(o=location.origin+location.pathname+e.getProfileByJid(e.getFrom()).getAvatarData()),e.getType()){case Message.TYPE_PUBLIC:if(!e.getMessage().match("@"+LoginUser.getInstance().getLoginAccount())&&!e.getMessage().match("@all"))return;t+=Resource.getMessage("MyFeed");break;case Message.TYPE_CHAT:if(NotificationSettingManager.getInstance().isSetting(ColumnInformation.TYPE_COLUMN_CHAT,e.getFrom()))return;t+=Resource.getMessage("Chat")+" - "+e.getProfileByJid(e.getFrom()).getNickName();break;case Message.TYPE_COMMUNITY:if(NotificationSettingManager.getInstance().isSetting(ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED,e.getTo()))return;t+=Resource.getMessage("Community")+" - "+e.getRoomName();break;case Message.TYPE_GROUP_CHAT:if(NotificationSettingManager.getInstance().isSetting(ColumnInformation.TYPE_COLUMN_GROUP_CHAT,e.getTo()))return;t+=Resource.getMessage("GroupChat")+" - "+e.getRoomName();break;case Message.TYPE_QUESTIONNAIRE:switch(parseInt(e.getRoomType())){case QuestionnaireRegister.ROOM_TYPE_FEED:t+=Resource.getMessage("MyFeed");break;case QuestionnaireRegister.ROOM_TYPE_COMMUNITY:if(NotificationSettingManager.getInstance().isSetting(ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED,e.getRoomId()))return;t+=Resource.getMessage("Community")+" - "+e.getRoomName();break;case QuestionnaireRegister.ROOM_TYPE_GROUPCHAT:if(NotificationSettingManager.getInstance().isSetting(ColumnInformation.TYPE_COLUMN_GROUP_CHAT,e.getRoomId()))return;t+=Resource.getMessage("GroupChat")+" - "+e.getRoomName()}n=e.getProfileByJid(e.getFrom()).getNickName()+Resource.getMessage("push_notification_for_questionnaire");break;default:return}Push.create(t,{icon:o,body:n,timeout:5e3,onClick:function(){window.focus(),this.close()}})}}},ViewUtils.showOpenGraphProtocolImage=function(e){var t=e.find("div.ogp-area");t.each(function(e,t){var o=$(t);o.hide(),o.attr("value")&&openGraphProtocolController.getInstance().getOpenGraphProtocol(o.attr("value")).then(function(e){if(e.result&&e.data.ogDescription&&e.data.ogTitle){var t="";if(e.data.ogImage.url){var i=Utils.convertEscapedHtml(Utils.urldecode(e.data.ogImage.url));n(i)&&(t+='<a class="ogp-image-link" href="'+o.attr("value")+'" target="_brank">                                        <img class="ogp-image" src='+i+"></a>")}var a=Utils.urldecode(e.data.ogTitle),r=a,s=Conf.getVal("OGP_TITLE_MAX_LENGTH");a.length>s&&(r=r.substring(0,s),r+="");var l=Utils.urldecode(e.data.ogDescription),u=Conf.getVal("OGP_DESCRIPTION_MAX_LENGTH");if(l.length>u&&(l=l.substring(0,u),l+=""),t+='                                <div class="ogp-string">                                    <p class="ogp-title" title="'+Utils.convertEscapedHtml(a)+'">'+Utils.convertEscapedHtml(r)+'</p>                                    <p class="ogp-description">'+Utils.convertEscapedHtml(l)+"</p>",e.data.ogUrl){var c=Utils.convertEscapedHtml(Utils.urldecode(e.data.ogUrl));n(c)&&(t+='<a href="'+c+'" class="ogp-url url-link" target="_brank"                                        title="'+c+'">'+c+"</p>")}else t+='<a href="'+o.attr("value")+'" class="ogp-url url-link" target="_brank"                                    title="'+o.attr("value")+'">'+o.attr("value")+"</p>";t+="</div>",o.append(t),o.fadeToggle(200)}})["catch"](function(e){})})},ViewUtils.replaceHashtagElement=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1,o=/(#[^ -\/:-@\[-`{-~\s]+?)(\s|\&nbsp\;|<|$)/g,i=/(^|\s|>|\&nbsp\;)$/;return t||(o=/(#[^ -\/:-@\[-`{-~\s]+?)(\s|$)/g,i=/(^|\s)$/),e.replace(o,function(e,t,o,a,r){if(r.indexOf(t)>=0&&t.length<=31){var s=r.substr(0,r.indexOf(t));if(s.match(i))return n?"":'<a class="hashtag" title="'+t+'">'+t+"</a>"+o}return e})},ViewUtils.replaceMentionElement=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1,o=/(@[\w\-''_\.\*!#$%&+\/=?^`{\|}]+?)(\s|\&nbsp\;|<|$)/g,i=/(^|\s|>|\&nbsp\;)$/;return t||(o=/(@[\w\-''_\.\*!#$%&+\/=?^`{\|}]+?)(\s|$)/g,i=/(^|\s)$/),e.replace(o,function(e,t,o,a,r){if(r.indexOf(t)>=0&&t.length<=31){var s=r.substr(0,r.indexOf(t));if(s.match(i))return n?"":t+o}return e})},ViewUtils.getShowBodyMessage=function(e){var t=/((https?)(:\/\/\S+))/gi,n=/\\\\(.+\\)+\S*/gi,o=e.replace(t,"").replace(n,"");o=ViewUtils.replaceMentionElement(o,!1,!0);var i=ViewUtils.replaceHashtagElement(o,!1,!0);return i},ViewUtils.getCalculattionTitle=function(e){return e.length},ViewUtils.getCalculattionBody=function(e){return ViewUtils.getShowBodyMessage(e).length},ViewUtils.getSubstringBody=function(e,t){if(ViewUtils.getCalculattionBody(e)>t){for(var n=e;ViewUtils.getCalculattionBody(n)>t;)n=n.substring(0,n.length-1);return n}return e},ViewUtils.showStampMessage=function(e,t){var n=$("pre:not(.message-title)",$(e).get(0)).html().replace(/^(([^\&\;]+)&lt;(.*|.*<br>)&gt;([^;]*)|(.+))$/m,function(e,t,n,o,i,a,r,s){if(null!=n&&n.length){var l=Array.from(n),u="";if(null!=o){o=o.replace(/(^&nbsp;|&nbsp;$)/g,"");var c=o.replace(/(\<br\>|&nbsp;|&#x0009;|&gt;|&lt;|&#039;|&quot;|&amp;)/g," ");if(c.length){var d=0;c.length<=15?d=2.3:c.length<=30?d=2.1:c.length<=40?d=1.8:c.length<=50?d=1.6:c.length<=60&&(d=1.5);
var g=ViewUtils.replaceHashtagElement(o,!0,!1),m="";d>0&&(m=' style="font-size:'+d+"rem;line-height:"+Math.ceil(d/3*4*10)/10+'rem;"'),u='<div class="stamp-speech-bubble" '+m+">"+g+"</div>"}}return l[0]+u}return a==Resource.getMessage("deleted_message_body")||a==Resource.getMessage("deleted_message_body_by_admin")?e:null!=a&&a.length?Array.from(a)[0]:e});n&&n.indexOf("stamp-speech-bubble")&&($("pre:not(.message-title)",$(e).get(0)).html(n),$(".hashtag",$(e).get(0)).on("click",function(){ContextSearchView.getInstance().search($(this).text(),t,!0)})),twemoji.parse($(e).get(0))},ViewUtils.getMurmurColumnInfo=function(e){if(null==e||"string"!=typeof e)return null;var t=new MurmurColumnInformation,n={};n.jid=e;var o=ColumnFilterManager.getColumnFilter(ColumnInformation.TYPE_COLUMN_MURMUR,n),i=new ColumnSortCondition,a=new ColumnSearchCondition(o,i);return t.setSearchCondition(a),t}}(),function(){var e=ViewCore.prototype;e.getHtmlElement=function(){return this._htmlElement}}(),function(){var e=new View;View.getInstance=function(){return e};var t,n,o,i=View.prototype,a=Resource.getMessage("blink_title");i.getTitle=function(){return o},i.getBlinkTitle=function(){return a},i.onLogin=function(){console.log("Connected!"),LoginView.getInstance().showMainScreen()},i.onLoginWizard=function(e){function t(){LoginUser.getInstance().getTenantInfo()?(console.log("Wizard OPEN"),clearInterval(n),LoginView.getInstance().showWizardStandby(e)):console.log("wait Wizard OPEN")}var n=null;n=setInterval(t,100)},i.onError=function(e){return void 0!=e&&null!=e&&void 0!=e.message?console.log("onError : "+e.message):console.log("onError"),LoginView.getInstance().onLoginError(e)},i.onSkipLoginError=function(e){return void 0!=e&&null!=e&&void 0!=e.message?console.log("onSkipLoginError : "+e.message):console.log("onSkipLoginError"),LoginView.getInstance().onSkipLoginError(e)},i.onDisconnected=function(){console.log("Disconnected!"),View.getInstance()._notifyDisconnected();var e=LoginView.getInstance();if(e.getLoginCompleted()){var t=Resource.getMessage("dialog_title_system_info"),n=Resource.getMessage("system_message_server_disconnected"),o=new DialogCloseView(t,n);o.showDialog()}else e.relogin("Disconnected")},i.logout=function(){var e=this;CubeeController.getInstance().logout(),e._notifyDisconnected()},i._notifyDisconnected=function(){ColumnManager.getInstance().disconnected(),MyPresenceView.getInstance().notifyDisconnect()},i.onProfileChanged=function(e){console.log("Presence was received!");var t=e.getJid(),n=e.getType();switch(n){case ProfileChangeNotice.TYPE_PRESENCE:var o=e.getPresence(),i=e.getMyMemo();ColumnMessageView.updateMessageAvatarToolTip(t);var a=LoginUser.getInstance().getJid();t==a&&MyPresenceView.getInstance().updateChangePresence(o,i),MemberAreaView.updateMessageAvatarToolTip(t),MemberAreaView.updateMessageAvatarPresenceIcon(e);break;case ProfileChangeNotice.TYPE_PROFILE:var a=LoginUser.getInstance().getJid();t==a&&GeneralConfigButton.getInstance().updateConfig(),MemberAreaView.updateMessageAvatarProfile(e)}SideListView.getInstance().onProfileChanged(e)},i.onMessage=function(e){var t=View.getInstance();LoginView.getInstance().getLoginedViewInitFinish()?(ColumnManager.getInstance().showMessage(e),e.getType()!=Message.TYPE_CHAT?(NotificationIconManager.getInstance().notifyMessage(e),console.log("message Type:"+e.getType()+" From:"+e.getFrom()),ViewUtils.sendPushNotification(e)):(SideListView.getInstance().notifyChatMessage(e),ViewUtils.sendPushNotification(e))):t._arrayLoginedNotifyMessage.add(e)},i.onNotification=function(e){var t=View.getInstance(),n=e.getType(),i=LoginUser.getInstance().getJid();switch(n){case Notification_model.TYPE_MESSAGE_OPTION:var r=e.getContentType();switch(r){case MessageOptionNotification.CONTENT_TYPE_SIBLING_TASK:break;case MessageOptionNotification.CONTENT_TYPE_DEMAND_TASK:DemandTaskCautionIconView.getDemandTaskCount();break;case MessageOptionNotification.CONTENT_TYPE_SET_READ_MESSAGE:}ColumnManager.getInstance().onNotification(e);break;case Notification_model.TYPE_GOOD_JOB:ColumnManager.getInstance().onNotification(e),e.getFromJid()!=LoginUser.getInstance().getJid()&&(GeneralConfigButton.getInstance().updateGoodJobCount(),GeneralConfigButton.getInstance().updateGoodJobAllCount()),ViewUtils.sendPushNotificationForGoodJobOrThanksPoint(e);break;case Notification_model.TYPE_EMOTION_POINT:ColumnManager.getInstance().onNotification(e),e.getFromJid()!=LoginUser.getInstance().getJid()&&(GeneralConfigButton.getInstance().updateThanksPointsCount(),GeneralConfigButton.getInstance().updateThanksPointsAllCount()),ViewUtils.sendPushNotificationForGoodJobOrThanksPoint(e);break;case Notification_model.TYPE_QUESTIONNAIRE:var s=e.getQuestionnaireMessage(),l=parseInt(s.getRoomType());if(LoginView.getInstance().getLoginedViewInitFinish()&&NotificationIconManager.getInstance().notifyMessage(s),(l==Message.TYPE_COMMUNITY||l==Message.TYPE_GROUP_CHAT)&&!s.getRoomName())break;LoginView.getInstance().getLoginedViewInitFinish()?(ColumnManager.getInstance().onNotification(e),l==Message.TYPE_COMMUNITY&&(TabManager.getInstance().isActiveMyWorkplace()?SelectAndAddProjectView.getInstance().getProjectList():SelectAndAddProjectView.getInstance().getProjectList(TabManager.getInstance().getCommunityInfo())),e.getActionType()==QuestionnaireNotification.ACTION_TYPE_ADD&&ViewUtils.sendPushNotification(s)):t._arrayLoginedNotification.add(e);break;case Notification_model.TYPE_TASK:var u=e.getTaskMessage();LoginView.getInstance().getLoginedViewInitFinish()&&NotificationIconManager.getInstance().notifyMessage(u),LoginView.getInstance().getLoginedViewInitFinish()?(ColumnManager.getInstance().onNotification(e),DemandTaskCautionIconView.getDemandTaskCount()):t._arrayLoginedNotification.add(e);break;case Notification_model.TYPE_CHAT:var c=e.getChatMessage();LoginView.getInstance().getLoginedViewInitFinish()?(View.getInstance().validBlinkTitleBar(800,o,a),NotificationIconManager.getInstance().notifyMessage(c)):t._arrayLoginedNotification.add(e);break;case Notification_model.TYPE_SYSTEM:ColumnManager.getInstance().onNotification(e);break;case Notification_model.TYPE_DELETE_MESSAGE:ColumnManager.getInstance().onNotification(e),DemandTaskCautionIconView.getDemandTaskCount();break;case Notification_model.TYPE_GROUP_CHAT:var d=e.getRoomInfo(),g=d.getRoomId(),m=View._canShowGroupChatNotification(g),_=e.getSubType();d.getRoomName(),d.getProfileMap();if(_==GroupChatNotification.SUB_TYPE_UPDATE_ROOM_INFO){NotificationIconManager.getInstance().updateRoomInfo(e);for(var f=e.getUpdatedItems(),p=0;p<f.length;p++)if("ChangeRoomName"==f[p]){i!=d.getUpdatedBy()&&(LoginView.getInstance().getLoginedViewInitFinish()?m&&(View.getInstance().validBlinkTitleBar(800,o,a),NotificationIconManager.getInstance().notifyGroupChat(e)):t._arrayLoginedNotification.add(e));var h=ViewUtils.getGroupChatColumnInfo(d);ColumnManager.getInstance().onChangeRoomName(h,d)}else if(f[p]==GroupChatInfoUpdateNotification.SUB_TYPE_CHANGE_ROOM_PRIVACY_TYPE){var h=ViewUtils.getGroupChatColumnInfo(d);ColumnManager.getInstance().onChangeGroupChatPrivacyType(h,d)}}else if(_==GroupChatNotification.SUB_TYPE_CREATE_ROOM)if(d.getCreatedBy()==i){var C=function U(){var e=CubeeController.getInstance().getChatroomManager().hasCreatingRoomIdList(d.getRoomId());if(null!=e||0==v){if(null!=e&&e[d.getRoomId()]){var t=ViewUtils.getGroupChatColumnInfo(d);ColumnManager.getInstance().addColumn(t,!0,!0)}null!=e&&CubeeController.getInstance().getChatroomManager().addCreatingRoomIdList(d.getRoomId()+"notification2",_defineProperty({},d.getRoomId(),!0))}else--v,setTimeout(U,200)},v=19;setTimeout(C,400)}else LoginView.getInstance().getLoginedViewInitFinish()?m&&(View.getInstance().validBlinkTitleBar(800,o,a),NotificationIconManager.getInstance().notifyGroupChat(e)):t._arrayLoginedNotification.add(e);else if(_==GroupChatNotification.SUB_TYPE_ADD_MEMBER){var y=e.getAddedBy(),T=e.getAddedMemberList();i!=y&&(LoginView.getInstance().getLoginedViewInitFinish()?m&&(View.getInstance().validBlinkTitleBar(800,o,a),NotificationIconManager.getInstance().notifyGroupChat(e)):t._arrayLoginedNotification.add(e));var h=ViewUtils.getGroupChatColumnInfo(d),T=e.getAddedMemberList();ColumnManager.getInstance().onAddMember(h,T),ViewUtils.clearAutoCompleteEventToTextArea(ViewUtils.TYPE_GROUP_CHAT,g)}else if(_==GroupChatNotification.SUB_TYPE_REMOVE_MEMBER){var b=e.getRemovedBy(),I=e.getRemovedMemberList(),M=(I.get(0),LoginUser.getInstance().getJid()),E=!1,S=I.getCount();for(_j=0;_j<S;_j++)if(M==I.get(_j)){E=!0;break}E&&ColumnManager.getInstance().onLoginUserRemoveGroupChatMemberNotification(e),i!=b&&(LoginView.getInstance().getLoginedViewInitFinish()?m&&(View.getInstance().validBlinkTitleBar(800,o,a),NotificationIconManager.getInstance().notifyGroupChat(e)):t._arrayLoginedNotification.add(e));var h=ViewUtils.getGroupChatColumnInfo(d);ColumnManager.getInstance().onRemoveMember(h,I),ViewUtils.clearAutoCompleteEventToTextArea(ViewUtils.TYPE_GROUP_CHAT,g)}else if(_==GroupChatNotification.SUB_TYPE_MESSAGE){var w=e.getGroupChatMessage(),N=w.getFrom(),M=LoginUser.getInstance().getJid();LoginView.getInstance().getLoginedViewInitFinish()?(m&&M!=N&&(View.getInstance().validBlinkTitleBar(800,o,a),NotificationIconManager.getInstance().notifyGroupChat(e)),ColumnManager.getInstance().onNotification(e),ViewUtils.sendPushNotification(w)):t._arrayLoginedNotification.add(e)}break;case Notification_model.TYPE_MAIL:var A=e.getMailMessage();LoginView.getInstance().getLoginedViewInitFinish()&&NotificationIconManager.getInstance().notifyMessage(A),LoginView.getInstance().getLoginedViewInitFinish()?(View.getInstance().validBlinkTitleBar(800,o,a),ColumnManager.getInstance().onNotification(e)):t._arrayLoginedNotification.add(e);break;case Notification_model.TYPE_COMMUNITY:t._onCommunityNodtification(e);break;case Notification_model.TYPE_MURMUR:t._onMurmurNodtification(e);break;case Notification_model.TYPE_AUTHORITY_CHANGED:LoginView.getInstance().getLoginedViewInitFinish()?t._onAuthorityChangedNotification(e):t._arrayLoginedNotification.add(e);break;case Notification_model.TYPE_THREAD_TITLE:ColumnManager.getInstance().onNotification(e);break;case Notification_model.TYPE_MESSAGE_UPDATE:ColumnManager.getInstance().onNotification(e);break;case Notification_model.TYPE_ASSIGN_NOTE:case Notification_model.TYPE_DELETE_NOTE:ColumnManager.getInstance().onNotification(e),SidebarNoteView.getInstance().reloadNoteListOnSidebar();break;case Notification_model.TYPE_USER_FOLLOW:GeneralConfigButton.getInstance().updateConfig()}TabManager.getInstance().onNotification(e),SideListView.getInstance().onNotification(e)},i._onCommunityNodtification=function(e){var t=this,n=e.getType();if(n==Notification_model.TYPE_COMMUNITY){var o=LoginUser.getInstance().getJid(),i=e.getSubType();switch(i){case CommunityNotification.SUB_TYPE_UPDATE_ROOM_INFO:case CommunityNotification.SUB_TYPE_ADD_MEMBER:if(LoginView.getInstance().getLoginedViewInitFinish()){var a="",r="";switch(i){case CommunityNotification.SUB_TYPE_UPDATE_ROOM_INFO:var s=e.getUpdatedCommunityInfo();a=s.getUpdatedBy(),r=s.getRoomId();break;case CommunityNotification.SUB_TYPE_ADD_MEMBER:a=e.getAddedBy(),r=e.getRoomId()}o!=a&&(t.validBlinkTitleBar(800,t.getTitle(),t.getBlinkTitle()),NotificationIconManager.getInstance().onCommunityNotificationRecieved(e)),i==CommunityNotification.SUB_TYPE_ADD_MEMBER&&ViewUtils.clearAutoCompleteEventToTextArea(ViewUtils.TYPE_COMMUNITY,r)}else t._arrayLoginedNotification.add(e);i==CommunityNotification.SUB_TYPE_UPDATE_ROOM_INFO&&ColumnManager.getInstance().onCommunityInfoUpdateNotication(e);break;case CommunityNotification.SUB_TYPE_UPDATE_OWNER:break;case CommunityNotification.SUB_TYPE_REMOVE_MEMBER:var a=e.getRemovedBy(),r=e.getRoomId();if(LoginView.getInstance().getLoginedViewInitFinish()){if(o!=a){var l=!1,u=e.getRemovedMemberList(),c=u.getCount();for(_i=0;_i<c;_i++){var d=u.get(_i);if(o==d){l=!0;break}}l?ColumnManager.getInstance().onLoginUserRemoveCommunityMemberNotification(e):(t.validBlinkTitleBar(800,t.getTitle(),t.getBlinkTitle()),NotificationIconManager.getInstance().onCommunityNotificationRecieved(e))}ViewUtils.clearAutoCompleteEventToTextArea(ViewUtils.TYPE_COMMUNITY,r)}else t._arrayLoginedNotification.add(e);break;case CommunityNotification.SUB_TYPE_MESSAGE:var g=e.getCommunityMessage(),a=g.getFrom();LoginView.getInstance().getLoginedViewInitFinish()?(o!=a&&View.getInstance().validBlinkTitleBar(800,t.getTitle(),t.getBlinkTitle()),NotificationIconManager.getInstance().onCommunityNotificationRecieved(e),ColumnManager.getInstance().onNotification(e),ViewUtils.sendPushNotification(g)):t._arrayLoginedNotification.add(e)}}},i._onMurmurNodtification=function(e){var t=this,n=e.getType();if(n==Notification_model.TYPE_MURMUR){var o,i,a=LoginUser.getInstance().getJid(),r=e.getSubType();!function(){switch(r){case MurmurNotification.SUB_TYPE_MESSAGE:o=e.getMurmurMessage(),i=o.getFrom(),LoginView.getInstance().getLoginedViewInitFinish()?(a!=i&&View.getInstance().validBlinkTitleBar(800,t.getTitle(),t.getBlinkTitle()),NotificationIconManager.getInstance().onMurmurNotificationRecieved(e),ColumnManager.getInstance().onNotification(e),ViewUtils.sendPushNotification(o)):t._arrayLoginedNotification.add(e);break;case MurmurNotification.SUB_TYPE_SET_COLUMN_NAME:var n=e.getColumnName();0==n.length&&(n=Resource.getMessage("Murmur"));var s=e.getJid();$('div[msgtype="11"][msgto="'+s+'"] div.message-border-header-murmur').text(n),$('div.murmur-message div.side-murmur-thread-root-message[msgto="'+s+'"]').text(n),$('#left_sidebar div.note_list li > a[msgtype="11"][roomid="'+s+'"]').each(function(e,t){var o=$("span.name",t).text();$("span.group",t).text(n),$(t).attr("title",o+" "+n)});for(var l=ColumnManager.getInstance().getColumnList(),u=function(t){var o=l.get(t),i=MurmurColumnInformation.getOwnJidFromSearchCondition(o);if(o.getColumnType()==ColumnInformation.TYPE_COLUMN_MURMUR&&i==s){l.get(t)._columnName=e.getColumnName(),l.get(t)._displayName=e.getColumnName();var a=CubeeController.getInstance().getPersonData(i);if(null!=a){var r=a.getUserName();$('#columnInnerContainer > div.column-murmur-wrapper > div.column-murmur[jid="'+i+'"]').length&&$('#columnInnerContainer > div.column-murmur-wrapper > div.column-murmur[jid="'+i+'"]').find("div.column-header-title").attr("title",n+" ("+r+")").text(n+" ("+r+")"),$('#menuIcons > li[jid="'+i+'"] span.name').length&&$('#menuIcons > li[jid="'+i+'"] span.name').text(n+" ("+r+")"),console.error("aa"),$('#menuIcons > li[jid="'+i+'"] img').length&&$('#menuIcons > li[jid="'+i+'"] img').attr("title",n+" ("+r+")")}else CubeeController.getInstance().getPersonDataByJidFromServer(i,function(e){for(var t=0;t<e.getCount();t++){var o=e.get(t);if(null!=o){var a=o.getUserName();$('#columnInnerContainer > div.column-murmur-wrapper > div.column-murmur[jid="'+i+'"]').length&&$('#columnInnerContainer > div.column-murmur-wrapper > div.column-murmur[jid="'+i+'"]').find("div.column-header-title").attr("title",n+" ("+a+")").text(n+" ("+a+")"),$('#menuIcons > li[jid="'+i+'"] span.name').length&&$('#menuIcons > li[jid="'+i+'"] span.name').text(n+" ("+a+")"),$('#menuIcons > li[jid="'+i+'"] div.menu-column.no_img').length&&$('#menuIcons > li[jid="'+i+'"] div.menu-column.no_img').attr("title",n+" ("+a+")"),$('#menuIcons > li[jid="'+i+'"] img').length&&$('#menuIcons > li[jid="'+i+'"] img').attr("title",n+" ("+a+")")}else console.error("_person is null")}})}},c=0;c<l.getCount();c++)u(c)}}()}},i._onAuthorityChangedNotification=function(e){var t=e.getType();if(t==Notification_model.TYPE_AUTHORITY_CHANGED){var n=e.getSubType();switch(n){case AuthorityInfoUpdateNotification.SUB_TYPE_ASSIGN_ROLE:var o=Resource.getMessage("dialog_title_system_info"),i=Resource.getMessage("authority_changed_role"),a=new DialogCloseView(o,i);a.showDialog();break;case AuthorityInfoUpdateNotification.SUB_TYPE_POLICY_ASSIGN:var r=e.getUpdatedItem(),s=(r.getTranslations()[Translations.LANG_JA],r.getAction(),r.getResourceId()),l=r.getRoomType();switch(l){case Utils.ROOMTYPE_GROUPCHAT:var u=s.substring(s.indexOf("_")+1,s.lastIndexOf("_")),c=LoginUser.getInstance().getJid(),d=c.substring(0,c.indexOf("@"));if(d==u&&"create"==e.getTriger())break;var g=new GroupChatAuthorityChangedNotification;g.setRoomId(s),g.setPolicy(r);var m=function(e){null!=e&&(g.setRoomInfo(e),NotificationIconManager.getInstance().notifyGroupChat(g),ColumnManager.getInstance().onGroupChatAuthorityChangedNotication(g))};CubeeController.getInstance().getRoomInfo(s,m);break;case Utils.ROOMTYPE_COMMUNITY:if(CubeeController.getInstance().getCommunityManager().hasCreatingRoomIdList(s))break;var g=new CommunityAuthorityChangedNotification;g.setRoomId(s),g.setPolicy(r);var _=function(e){null!=e&&(g.setRoomName(e.getRoomName()),NotificationIconManager.getInstance().onCommunityNotificationRecieved(g),ColumnManager.getInstance().onCommunityAuthorityChangedNotication(g))};CubeeController.getInstance().getCommunityInfo(s,_)}break;case AuthorityInfoUpdateNotification.SUB_TYPE_POLICY_UNASSIGN:}}},i.onLoginedViewInitFinished=function(){for(var e=this,t=e._arrayLoginedNotifyMessage.getCount(),n=0;t>n;n++){var o=e._arrayLoginedNotifyMessage.get(n);e.onMessage(o)}e._arrayLoginedNotifyMessage.removeAll();for(var i=e._arrayLoginedNotification.getCount(),n=0;i>n;n++){var a=e._arrayLoginedNotification.get(n);e.onNotification(a)}e._arrayLoginedNotification.removeAll()},i.invalidBlinkTitleBar=function(){n&&(clearInterval(n),n=null,document.title=o)},i.validBlinkTitleBar=function(e,t,n){},i.resizeContent=function(){SideListView.getInstance().resizeContents(),View.resizeButton(),View.resizeHeaderContent()},View.resizeButton=function(){RightSlideContainerView.getInstance().resizeButton()},View.resizeHeaderContent=function(){TabManager.getInstance().resizeContent()},window.onfocus=function(){t=!0},window.onblur=function(){t=!1},$(window).on("beforeunload",function(){CubeeController.getInstance().logout()}),$(function(){$("#btnSearchOption").on("click",function(){return!1});var e=500,t=0;$(document).on("touchstart",function(n){function o(){clearTimeout(t)}t=setTimeout(function(){$(n.target).trigger("longtap")},e),$(document).on("touchend touchmove touchcancel",o)})}),$(function(){document.title=Conf.getVal("PRODUCT_NAME")+" - "+_cubee_version,o=document.title}),View._canShowGroupChatNotification=function(e){return!0}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){TabItemView.TYPE_UNKNOWN=0,TabItemView.TYPE_MY_WORK_PLACE=1,TabItemView.TYPE_COMMUNITY=2,TabItemView._loadingIconUrl="images/loading2.gif";var e=TabItemView.prototype;e.init=function(){var e=this;return e},e.cleanup=function(){var e=this;e._tabInfo=null,e._defaultColumnInfoList=null,e._sideListViewImpl=null,e._onClickCloseCallBack=null,e._dom=null,e._logoUrl="images/blank.png",e._isLoading=!1},e.getTabInfo=function(){return this._tabInfo},e.setTabInfo=function(e){this._tabInfo=e},e.getTabType=function(){return this._tabInfo.type},e.getDom=function(){var e=this,t='<span class="tab"><span class="text-abbreviation"></span></span>',n=$(t),o='<img src="'+e._iconUrl+'" class="tab-icon">';return n.prepend(o),e._createEventHandler(n),e._dom=n,$(n)},e.getDefaultColumnInfoList=function(){return this._defaultColumnInfoList},e.isContainMinimumColumn=function(e){return!0},e.getSideListViewImpl=function(){return this._sideListViewImpl},e.getCloseCallBack=function(){return this._onClickCloseCallBack},e.setCloseCallBack=function(e){this._onClickCloseCallBack=e},e.isMatch=function(e){if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=this,n=e.getTabInfo();return null==n?!1:t._tabInfo.type==n.type},e.onNotification=function(e){!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))},e._createEventHandler=function(e){!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))},e._onUpdateLogoUrl=function(e){var t=this;null!=e&&"string"==typeof e&&(t._iconUrl=e,t._isLoading||t._changeLogoArea(t._iconUrl))},e.startLoading=function(){var e=this;e._isLoading||(e._isLoading=!0,e._changeLogoArea(TabItemView._loadingIconUrl))},e.endLoading=function(){var e=this;e._isLoading&&(e._changeLogoArea(e._iconUrl),e._isLoading=!1)},e._changeLogoArea=function(e){var t=this;if(null!=e&&"string"==typeof e){var n='<img src="'+t._iconUrl+'" class="tab-icon">',o=$(n);t._createEventHandler(o),t._dom=o;var i=t._dom;i.find("img.tab-icon").attr("src",e)}}}(),function(){TabMyWorkPlaceItemView.prototype=$.extend({},TabItemView.prototype);var e=TabItemView.prototype,t=TabMyWorkPlaceItemView.prototype;t.init=function(){var e=this;e._tabInfo.type=TabItemView.TYPE_MY_WORK_PLACE;var t=LoginUser.getInstance().getJid(),n=location.hostname,o="columnList_"+n+"_"+t;e._tabInfo.columnListId=o;var i=new RecentColumnInfomation,a=ColumnFilterManager.getColumnFilter(ColumnInformation.TYPE_COLUMN_RECENT,null);if(null==a)return!1;var r=new ColumnSearchCondition(a,new ColumnSortCondition);i.setSearchCondition(r),e._defaultColumnInfoList.add(i);var s=new MyWorkPlaceSideListViewImpl;return e._sideListViewImpl=s,e},t.isContainMinimumColumn=function(e){var t=!1;if(null==e)return t;for(var n=e.getCount(),o=0;n>o;o++){var i=e.get(o);if(null!=i&&i.getColumnType()==ColumnInformation.TYPE_COLUMN_RECENT){t=!0;break}}return t},t.setTabInfo=function(e){},t.getDom=function(){var t=this,n=Resource.getMessage("MyWorkplace"),o=e.getDom.call(t);return o.find("span").text(n),o.find("span").attr("title",n),o.addClass("non-close"),$(o)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t){var n=t.getSubType(),o=Utils.getSafeValue(a,n,function(){});o(e,t)}function t(e,t){function n(t){if(null!=t){var n=t.getLogoUrl();""!=n&&e._onUpdateLogoUrl(n)}}if(t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var o=t.getSubType();if(o==CommunityNotification.SUB_TYPE_UPDATE_ROOM_INFO){var i=t.getUpdatedCommunityInfo(),a=i.getRoomId(),r=e._tabInfo.extras.communityId;if(a==r){var r=(e._dom,e._tabInfo.extras.communityId);return CubeeController.getInstance().getCommunityInfo(r,n)}}}}TabCommunityItemView.prototype=$.extend({},TabItemView.prototype);var n=TabItemView.prototype,o=TabCommunityItemView.prototype;o.init=function(e){var t=this;t._tabInfo.type=TabItemView.TYPE_COMMUNITY;var n=new CommunitySideListViewImpl;if(t._sideListViewImpl=n,null!=e&&"string"==typeof e){this._tabInfo.extras.communityId=e;var o=LoginUser.getInstance().getJid(),i=location.hostname,a=e+"_columnList_"+i+"_"+o;t._tabInfo.columnListId=a}var r=t._tabInfo.extras.communityId,s=new CommunityInfo;s.setRoomId(r);var l=ViewUtils.getCommunityFeedColumnInfo(s),u=ViewUtils.getCommunityTaskColumnInfo(s);return this._defaultColumnInfoList.add(l),this._defaultColumnInfoList.add(u),t},o.isContainMinimumColumn=function(e){var t=this,n=!1;if(null==e)return n;for(var o=!1,i=!1,a=e.getCount(),r=0;a>r;r++){var s=e.get(r);null!=s&&(s.getColumnType()==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED&&s.getCommunityInfomation().getRoomId()==t._tabInfo.extras.communityId?o=!0:s.getColumnType()==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK&&s.getCommunityInfomation().getRoomId()==t._tabInfo.extras.communityId&&(i=!0))}return n=o&&i},o.getDom=function(){function e(e){var n=Resource.getMessage("tab_not_referable_community");null!=e&&(n=e.getRoomName(),t._iconUrl=e.getLogoUrl()||t._iconUrl),t._onUpdateLogoUrl(t._iconUrl),o.children("span").text(n),o.children("span").attr("title",n)}var t=this,o=n.getDom.call(t),i=t._tabInfo.extras.communityId;CubeeController.getInstance().getCommunityInfo(i,e);var a='<img src="images/add_attach_cancel.png" class="close-tab">';return o.append(a),$(o)},o.isMatch=function(e){var t=this,o=n.isMatch.call(t,e);if(!o)return!1;var i=e.getTabInfo();if(null==i)return!1;var a=i.extras;return null==a?!1:t._tabInfo.extras.communityId==a.communityId},o.isMutchCommunityId=function(e){var t=this;return t._tabInfo.extras.communityId==e},o._createEventHandler=function(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this;e.find("img.close-tab").on("click",function(){var e=$(this).parent();return t._onClickCloseCallBack(e),!1})}};var i={};i[Notification_model.TYPE_COMMUNITY]=e,o.onNotification=function(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this,n=e.getType(),o=Utils.getSafeValue(i,n,function(){});o(t,e)}};var a={};a[CommunityNotification.SUB_TYPE_UPDATE_ROOM_INFO]=t}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,n){function o(){function s(e){null!=e&&i.add(e),r++,o()}if(r>=a)return void n(i);var l=e[r];t(l,s)}var i=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return void n(i);var a=e.length;i=new ArrayList;var r=0;o(),SideMenuMurmurView.getInstance().showMurmurHistory()}function t(e,t){var l=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return void t(l);var _=!1,h=e.type;switch(h){case ColumnInformation.TYPE_COLUMN_TIMELINE:l=n(e);break;case ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE:l=o(e);break;case ColumnInformation.TYPE_COLUMN_CHAT:l=i(e);break;case ColumnInformation.TYPE_COLUMN_TASK:l=a(e);break;case ColumnInformation.TYPE_COLUMN_INBOX:l=r(e);break;case ColumnInformation.TYPE_COLUMN_SEARCH:l=s(e);break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:var y=function(e){t(e)};u(e,y),_=!0,l=null;break;case ColumnInformation.TYPE_COLUMN_MAIL:l=c(e);break;case ColumnInformation.TYPE_COLUMN_RECENT:l=d(e);break;case ColumnInformation.TYPE_COLUMN_MENTION:case ColumnInformation.TYPE_COLUMN_TOME:l=g(e);break;case ColumnInformation.TYPE_COLUMN_FILTER:var T=function(e){t(e)};m(e,T),_=!0,l=null;break;case ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER:var b=function(e){t(e)};f(e,b),_=!0,l=null;break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:l=C(e);break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:l=v(e);break;case ColumnInformation.TYPE_COLUMN_MURMUR:return void(_||p(e,t))}_||t(l)}function n(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.type;if(n!=ColumnInformation.TYPE_COLUMN_TIMELINE)return t;var o=new ColumnInformation;return o.setColumnType(ColumnInformation.TYPE_COLUMN_TIMELINE),t=o}function o(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.type;if(n!=ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE)return t;var o=ViewUtils.createQuestionnaireColumnInfo();return t=o}function i(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.type;if(n!=ColumnInformation.TYPE_COLUMN_CHAT)return t;var o=new ColumnInformation,i=e.jid;return o.setFilterCondition(i),o.setColumnType(n),t=o}function a(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.type;if(n!=ColumnInformation.TYPE_COLUMN_TASK)return t;var o=new ColumnInformation;o.setColumnType(n);var i=LoginUser.getInstance().getJid(),a=ViewUtils.getTaskFilterAndSortCondition(i);return o.setFilterCondition(a.getFilterConditionJSONString()),t=o}function r(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.type;return n!=ColumnInformation.TYPE_COLUMN_INBOX?t:t=ViewUtils.createIndexColumnInfo()}function s(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.type;if(n!=ColumnInformation.TYPE_COLUMN_SEARCH)return t;var o=new SearchColumnInfomation,i=e.keyword;o.setKeyword(i);var a=e.sourceColumnTypeList;l(a,o.getSourceColumnTypeList());var r=ViewUtils.getKeywordFilterFromKeywordInputString(i),s=ColumnFilterManager.getColumnFilterList(o.getSourceColumnTypeList());if(null!=r&&null!=s){var u=new AndCondition;u.addChildCondition(r),u.addChildCondition(s);var c=new ColumnSortCondition,d=new ColumnSearchCondition(u,c);o.setSearchCondition(d)}var g=h(ColumnInformation.TYPE_COLUMN_SEARCH,e.subData);return o.setSubData(g),t=o}function l(e,t){if(null!=e&&null!=t){var n=Utils.convertStringToArrayList(e,TabColumnStateStore.SOURCE_COLUMN_TYPE_LIST_DELIMITOR);if(null!=n)for(var o=0;o<n.getCount();o++){var i=parseInt(n.get(o));NaN!=i&&t.add(i)}}}function u(e,t){function n(e){null!=e&&(s=e);var n=ViewUtils.getGroupChatColumnInfo(s);t(n)}var o=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return void t(o);var i=e.type;if(i!=ColumnInformation.TYPE_COLUMN_GROUP_CHAT)return void t(o);var a=e.roomId,r=e.roomName,s=new ChatRoomInformation;s.setRoomId(a),s.setRoomName(r);var l=ViewUtils.getGroupChatColumnInfo(s);null!=a&&""!=a?setTimeout(function(){t(l)},1):setTimeout(function(){n(null)},1)}function c(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.type;if(n!=ColumnInformation.TYPE_COLUMN_MAIL)return t;var o=ViewUtils.getMailColumnInfomation();return t=o}function d(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.type;if(n!=ColumnInformation.TYPE_COLUMN_RECENT)return t;var o=new RecentColumnInfomation;o.setColumnType(n),o.setFilterCondition("");var i=ColumnFilterManager.getColumnFilter(n,null);if(null==i)return!1;var a=new ColumnSearchCondition(i,new ColumnSortCondition);return o.setSearchCondition(a,!1),t=o}function g(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.type;if(n!=ColumnInformation.TYPE_COLUMN_TOME)return t;var o=new ToMeColumnInfomation;o.setColumnType(n),o.setFilterCondition("");var i=ColumnFilterManager.getColumnFilter(n,null);if(null==i)return!1;var a=new ColumnSearchCondition(i,new ColumnSortCondition);return o.setSearchCondition(a,!1),t=o}function m(e,t){function n(e){null!=e&&""!=e&&a.setSourceColumnDisplayName(e),o=a,t(o)}var o=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return void t(o);var i=e.type;if(i!=ColumnInformation.TYPE_COLUMN_FILTER)return void t(o);var a=new FilterColumnInfomation,r=e.sourceColumnType,s=e.sourceColumnDisplayName,l=e.keyword,u=(e.subData,h(r,e.subData));a.setSubData(u),a.setSourceColumnType(r),a.setSourceColumnDisplayName(s),a.setKeyword(l);var c=ColumnFilterManager.getColumnFilter(r,u);if(null==c)return void t(o);var d=new AndCondition;d.addChildCondition(c);var g=ViewUtils.getKeywordFilterFromKeywordInputString(l);d.addChildCondition(g);var m=new ColumnSortCondition,f=new ColumnSearchCondition(d,m);a.setSearchCondition(f),_(e,n)}function _(e,t){var n="",n=(e.subData,e.sourceColumnType,e.sourceColumnDisplayName);null==n&&(n=""),t(n)}function f(e,t){function n(e){null!=e&&""!=e&&a.setSourceColumnDisplayName(e),o=a,t(o)}var o=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return void t(o);var i=e.type;if(i!=ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER)return void t(o);var a=new CustomFilterColumnInfomation,r=e.sourceColumnType,s=e.sourceColumnDisplayName;r==ColumnInformation.TYPE_COLUMN_FILTER&&a.setBeginningColumnType(e.beginningColumnType);var u={};u=r==ColumnInformation.TYPE_COLUMN_FILTER?h(e.beginningColumnType,e.subData):h(r,e.subData),a.setSubData(u),a.setSourceColumnType(r),a.setSourceColumnDisplayName(s);var c=e.searchCondition.filter,d=e.searchCondition.sort,g=new AndCondition;g.getConditionObject(c);var m=new ColumnSortCondition;m.getConditionObject(d);var f=new ColumnSearchCondition(g,m);if(a.setSearchCondition(f),a.setSetting(e.setting),r==ColumnInformation.TYPE_COLUMN_SEARCH){var p=e.sourceColumnTypeList;l(p,a.getSourceColumnTypeList())}(r==ColumnInformation.TYPE_COLUMN_SEARCH||r==ColumnInformation.TYPE_COLUMN_FILTER)&&a.setKeyword(e.keyword),
_(e,n)}function p(e,t){var n=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return n;var o=e.type;if(o!=ColumnInformation.TYPE_COLUMN_MURMUR)return void t(n);var i=e.jid;return null==i?void t(n):(n=ViewUtils.getMurmurColumnInfo(i),void CubeeServerConnector.getInstance().getMurmurColumnName(i).then(function(e){if("object"==_typeof(e.content)&&"boolean"==typeof e.content.result&&e.content.result&&"string"==typeof e.content.columnName){var o=decodeURIComponent(e.content.columnName);n._columnName=o,t(n)}else n._columnName="",t(n)})["catch"](function(e){t(n)}))}function h(e,t){var n={};switch(e){case ColumnInformation.TYPE_COLUMN_TIMELINE:case ColumnInformation.TYPE_COLUMN_MENTION:case ColumnInformation.TYPE_COLUMN_TASK:case ColumnInformation.TYPE_COLUMN_INBOX:case ColumnInformation.TYPE_COLUMN_MAIL:case ColumnInformation.TYPE_COLUMN_RECENT:case ColumnInformation.TYPE_COLUMN_TOME:case ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE:break;case ColumnInformation.TYPE_COLUMN_CHAT:n.partner=t;break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:n.roomId=t;break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:n.roomId=t;break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:n.roomId=t;break;case ColumnInformation.TYPE_COLUMN_SEARCH:n=t}return n}function C(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.type;if(n!=ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED)return t;var o=e.communityId;if(null==o||""==o)return t;var i=e.communityName,a=new CommunityInfo;a.setRoomId(o),a.setRoomName(i);var r=ViewUtils.getCommunityFeedColumnInfo(a);return t=r}function v(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.type;if(n!=ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK)return t;var o=e.communityId;if(null==o||""==o)return t;var i=e.communityName,a=new CommunityInfo;a.setRoomId(o),a.setRoomName(i);var r=ViewUtils.getCommunityTaskColumnInfo(a);return t=r}function y(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;for(var n=[],o=e.getCount(),i=0,a=0;o>a;a++){var r=e.get(a),s=T(r);null!=s&&(n[i]=s,i++)}return t=n}function T(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=e.getColumnType();switch(n){case ColumnInformation.TYPE_COLUMN_TIMELINE:case ColumnInformation.TYPE_COLUMN_TASK:case ColumnInformation.TYPE_COLUMN_MENTION:case ColumnInformation.TYPE_COLUMN_INBOX:case ColumnInformation.TYPE_COLUMN_MAIL:case ColumnInformation.TYPE_COLUMN_RECENT:case ColumnInformation.TYPE_COLUMN_TOME:case ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE:t=b(e);break;case ColumnInformation.TYPE_COLUMN_CHAT:t=I(e);break;case ColumnInformation.TYPE_COLUMN_SEARCH:t=N(e);break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:t=M(e);break;case ColumnInformation.TYPE_COLUMN_FILTER:t=E(e);break;case ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER:t=w(e);break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:t=A(e);break;case ColumnInformation.TYPE_COLUMN_MURMUR:t=U(e)}return t}function b(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n={};return n.type=e.getColumnType(),t=n}function I(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=b(e);return n.jid=e.getFilterCondition(),t=n}function M(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=b(e),o=e.getChatRoomInfomation(),i=o.getRoomId(),a=o.getRoomName();return n.roomId=i,n.roomName=a,t=n}function E(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=b(e),o=e.getSourceColumnType(),i=e.getSourceColumnDisplayName();n.sourceColumnType=o,n.sourceColumnDisplayName=i,n.keyword=e.getKeyword();var a=e.getSubData();return n.subData=S(o,a),t=n}function S(e,t){var n={};return null==t?n:n=e==ColumnInformation.TYPE_COLUMN_CHAT?t.partner:e==ColumnInformation.TYPE_COLUMN_GROUP_CHAT?t.roomId:e==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED?t.roomId:e==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK?t.roomId:t}function w(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return null;var t=b(e),n=e.getSourceColumnType(),o=e.getSourceColumnDisplayName();t.sourceColumnType=n,t.sourceColumnDisplayName=o;var i={},a=e.getSearchCondition().getFilterCondition();i.filter=a.getJSONObject();var r=e.getSearchCondition().getSortCondition();i.sort=r.getJSONObject(),t.searchCondition=i,t.setting=e.getSetting();var s=e.getSubData();if(n==ColumnInformation.TYPE_COLUMN_FILTER?t.subData=S(e.getBeginningColumnType(),s):t.subData=S(n,s),n==ColumnInformation.TYPE_COLUMN_FILTER&&(t.beginningColumnType=e.getBeginningColumnType()),n==ColumnInformation.TYPE_COLUMN_SEARCH){var l=e.getSourceColumnTypeList();t.sourceColumnTypeList=Utils.convertArrayListToString(l,TabColumnStateStore.SOURCE_COLUMN_TYPE_LIST_DELIMITOR)}return(n==ColumnInformation.TYPE_COLUMN_FILTER||n==ColumnInformation.TYPE_COLUMN_SEARCH)&&(t.keyword=e.getKeyword()),t}function N(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=b(e),o=e.getSourceColumnTypeList();n.sourceColumnTypeList=Utils.convertArrayListToString(o,TabColumnStateStore.SOURCE_COLUMN_TYPE_LIST_DELIMITOR),n.keyword=e.getKeyword();var i=e.getSubData();return n.subData=S(ColumnInformation.TYPE_COLUMN_SEARCH,i),t=n}function A(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=b(e),o=e.getCommunityInfomation(),i=o.getRoomId(),a=o.getRoomName();return n.communityId=i,n.communityName=a,t=n}function U(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=b(e),o=MurmurColumnInformation.getOwnJidFromSearchCondition(e);return null==o?null:(n.jid=o,t=n)}TabColumnStateStore.COLUMN_LIST_KEY="columnList",TabColumnStateStore.SOURCE_COLUMN_TYPE_LIST_DELIMITOR=",",TabColumnStateStore.TAB_LIST_KEY="tabList";var L=TabColumnStateStore.prototype,R=null;TabColumnStateStore.getInstance=function(){return null==R&&(R=new TabColumnStateStore),R},L.getColumnList=function(t,n){function o(){setTimeout(function(){null!=n&&"function"==typeof n&&n(r)},1)}function i(e){r=e,o()}var a=this,r=null,s=LoginUser.getInstance().getJid();if(null==s||"string"!=typeof s||""==s)return void o();var l="";if(null!=t&&"string"==typeof t)l=t;else{var u=location.hostname;l=TabColumnStateStore.COLUMN_LIST_KEY+"_"+u+"_"+s}var c=a._getItem(l);try{var d=JSON.parse(c);e(d,i)}catch(g){o()}},L.setColumnList=function(e,t,n){function o(){setTimeout(function(){null!=n&&"function"==typeof n&&n()},1)}var i=this;if(null==e||"string"!=typeof e||""==e)return void o();if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return void o();var a=LoginUser.getInstance().getJid();if(null==a||"string"!=typeof a||""==a)return void o();var r=y(t);if(null==r)return void o();var s=JSON.stringify(r);i._validationSetLocalStorageString(s)&&i._setItem(e,s),o()},L._validationSetLocalStorageString=function(e){var t="";try{t=JSON.parse(e)}catch(n){return console.log("set localstorage failed! parse str: "+e),!1}for(var o=0;o<t.length;o++)if(!t[o]||!t[o].type)return console.log("set localstorage failed! parse str: "+e),!1;return!0},L._getItem=function(e){var t=null;if(null==e||"string"!=typeof e)return t;var n=this;return n._localStorage&&(t=n._localStorage.getItem(e)),t},L._setItem=function(e,t){if(null!=e&&"string"==typeof e){var n=this;n._localStorage&&n._localStorage.setItem(e,t)}},L.getTabArray=function(e){function t(){setTimeout(function(){null!=e&&"function"==typeof e&&e(o)},1)}var n=this,o=null;TabColumnStateStore.TAB_LIST_KEY="tabList";var i=LoginUser.getInstance().getJid();if(null==i||"string"!=typeof i||""==i)return void t();var a=location.hostname,r=TabColumnStateStore.TAB_LIST_KEY+"_"+a+"_"+i,s=n._getItem(r);try{o=JSON.parse(s)}catch(l){}t()},L.setTabArray=function(e,t){function n(){setTimeout(function(){null!=t&&"function"==typeof t&&t()},1)}var o=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return void n();var i=LoginUser.getInstance().getJid();if(null==i||"string"!=typeof i||""==i)return void n();var a=location.hostname,r=TabColumnStateStore.TAB_LIST_KEY+"_"+a+"_"+i,s=JSON.stringify(e);o._setItem(r,s),n()}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e={};e[TabItemView.TYPE_MY_WORK_PLACE]=TabMyWorkPlaceItemView,e[TabItemView.TYPE_COMMUNITY]=TabCommunityItemView;var t=new TabManager;TabManager.getInstance=function(){return t};var n=TabManager.prototype;n.onLogin=function(e){function t(t,n){null!=e&&"function"==typeof e&&e(t,n)}var n=this;n._refreshTab(t),ContextSearchView.getInstance().setAutoComplete({type:TabItemView.TYPE_MY_WORK_PLACE})},n.selectOrAddTabByCommunityId=function(t,n){var o=this,i=new TabCommunityItemView;$(".control-sidebar").hasClass("control-sidebar-open")&&$(".control-sidebar").toggleClass("control-sidebar-open"),o._communityInfo=new CommunityInfo,"myworkplace"==t?(i=new(Utils.getSafeValue(e,TabItemView.TYPE_MY_WORK_PLACE,TabItemView)),i.init()):i.init(t),o.selectOrAddTab(i,n)},n.selectOrAddTabByCommunityInfo=function(t,n,o){var i=this,a=new TabCommunityItemView;$(".control-sidebar").hasClass("control-sidebar-open")&&$(".control-sidebar").toggleClass("control-sidebar-open"),"myworkplace"==t?(i._communityInfo=new CommunityInfo,a=new(Utils.getSafeValue(e,TabItemView.TYPE_MY_WORK_PLACE,TabItemView)),a.init()):(i._communityInfo=n,a.init(t)),i.selectOrAddTab(a,o)},n.selectOrAddTab=function(e,t){function n(){o._selectAndRefresh(a,t)}if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){for(var o=this,i=o._tabItemViewList.getCount(),a=-1,r=0;i>r;r++){var s=o._tabItemViewList.get(r);if(s.isMatch(e)){a=r;break}}-1==a?(o._appendTab(e),o._tabItemViewList.add(e),a=o._tabItemViewList.getCount()-1,o._saveTab(n)):n()}},n.onNotification=function(e){function t(){if(!(a>=i)){var n=o.get(a);n.onNotification(e),a++,setTimeout(t,r)}}var n=this,o=n._tabItemViewList,i=o.getCount(),a=0,r=10;setTimeout(t,r)},n._refreshTab=function(t){function n(n){function i(e){o._onClickCloseCallBack(e)}var a=!1;if(null!=n&&n.length>0){for(var r=!1,s=0;s<n.length;s++){var l=n[s];null!=l&&l.type==TabItemView.TYPE_MY_WORK_PLACE&&(r=!r)}a=r}if(a)for(var s=0;s<n.length;s++){var l=n[s];if(null!=l){var u=new(Utils.getSafeValue(e,l.type,TabItemView));u.setTabInfo(l),u.setCloseCallBack(i),u.init(),o._tabItemViewList.add(u)}}else{var c=new(Utils.getSafeValue(e,TabItemView.TYPE_MY_WORK_PLACE,TabItemView));c.setTabInfo(l),c.setCloseCallBack(i),c.init(),o._tabItemViewList.add(c)}if(null!=t&&"function"==typeof t){var d=o._tabItemViewList.get(0),g=d.getTabInfo();o.selectedInfo=d;var m=d.getDefaultColumnInfoList(),_=d.getSideListViewImpl();SideListView.getInstance().refreshContents(_,g),t(g,m),o.isCreateGroupchat("myworkplace")}}var o=this;TabColumnStateStore.getInstance().getTabArray(n)},n.isActiveMyWorkplace=function(){return 1==this.getCurrentTabInfo().type},n.activeMyWorkplaceTab=function(e){var t=this,n=t._tabItemViewList.getCount(),o=-1;$(".control-sidebar").hasClass("control-sidebar-open")&&$(".control-sidebar").toggleClass("control-sidebar-open"),$("#groupChatList > div.all_gc_list_btn").removeClass("nomalpadd"),$("#groupChatList > div.all_public_list_btn").show();for(var i=0;n;i++)if(t._tabItemViewList.get(i)instanceof TabMyWorkPlaceItemView){o=i;break}return o>-1?(t._communityInfo=new CommunityInfo,void t._refreshContents(o,e)):void setTimeout(function(){null!=e&&"function"==typeof e&&e(!1)},1)},n.isActiveCommunityTab=function(e){var t=this,n=t.getCurrentTabItemView();return n.getTabType()!=TabItemView.TYPE_COMMUNITY?!1:n.isMutchCommunityId(e)},n._saveTab=function(e){for(var t=this,n=new Array,o=t._tabItemViewList.getCount(),i=0;o>i;i++){var a=t._tabItemViewList.get(i);null!=a&&n.push(a.getTabInfo())}TabColumnStateStore.getInstance().setTabArray(n,function(){setTimeout(function(){null!=e&&"function"==typeof e&&e()},1)})},n._appendTab=function(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this,n=e.getDom();t._tabInnerContainerElement.append(n)}},n.getCurrentTabItemView=function(){var e=this,t=e._tabInnerContainerElement.children("span.tab.select"),n=t.index(),o=e._tabItemViewList.get(n);return o},n.getCurrentTabInfo=function(){return"object"==_typeof(this.selectedInfo)&&0==Object.keys(this.selectedInfo)?new TabItemView:this.selectedInfo.getTabInfo()},n.getCommunityInfo=function(){return this._communityInfo},n._selectAndRefresh=function(e,t){if(null!=e&&"number"==typeof e){var n=this,o=n._tabInnerContainerElement.children().eq(e),i=n._selectTab(o);return i?(0==e?($("#groupChatList > div.all_gc_list_btn").removeClass("nomalpadd"),$("#groupChatList > div.all_public_list_btn").show()):($("#groupChatList > div.all_gc_list_btn").addClass("nomalpadd"),$("#groupChatList > div.all_public_list_btn").hide()),void n._refreshContents(e,t)):void setTimeout(function(){null!=t&&"function"==typeof t&&t(!1)},1)}},n._onClickCloseCallBack=function(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this,n=e.index();if(null!=n&&-1!=n){var o=t._deleteTab(e);o&&t._saveTab(function(){if(t.resizeContent(),e.hasClass("select")){var o=0>n-1?0:n-1;t._selectAndRefresh(o)}})}}},n._deleteTab=function(e){if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=this;if(t._tabSelectRefreshing)return!1;var n=e.index(),o=t._tabItemViewList.get(n);return null==o?!1:(o.cleanup(),t._tabItemViewList.remove(n),e.remove(),e=null,!0)},n._deleteProject=function(e){for(var t=this,n=t._tabItemViewList.getCount(),o=-1,i=0;n>i;i++){var a=t._tabItemViewList.get(i);if(a.isMatch(e)){o=i;break}}if(-1!=o){var r=t._tabItemViewList.get(o);if(null==r)return;r.cleanup(),t._tabItemViewList.remove(o)}},n._selectTab=function(e){if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=this;if(t._tabSelectRefreshing)return!1;var n=$(e).hasClass("select");if(n)return!1;var o=t._tabInnerContainerElement,i=o.children();i.removeClass("select"),$(e).addClass("select"),$(e).removeClass("left-select");for(var a=1;a<i.length;a++)$(i[a]).hasClass("select")?$(i[a-1]).addClass("left-select"):$(i[a-1]).removeClass("left-select");return!0},n._bringTabIntoView=function(e){if(null!=e&&"number"==typeof e){var t=this,n=t._tabInnerContainerElement,o=n.children().eq(e);if(0!=o.length){var i=(n.offset().left,o.offset().left),a=t._tabContainerElement,r=a.scrollLeft();i=r+i,a.animate({scrollLeft:i},"slow")}}},n.resizeContent=function(){var e=this;e._resizeTabAreaWidth(),e._controllTabScrollButton(),e._resizeTabAreaWidth()},n._resizeTabAreaWidth=function(){var e=this,t=0;e._tabInnerContainerElement.children().each(function(){var e=$(this).outerWidth(!0);t+=e}),t+=2,e._tabInnerContainerElement.css("width",t),e._tabInnerContainerElement.css("min-width",t),e._tabInnerContainerElement.css("max-width",t);var n=$("#headerContainer"),o=e._prevTabElement.parent(),i=e._nextTabElement.parent(),a=n.children("#notification-area"),r=n.children(".options"),s=n.outerWidth(!0),l=o.outerWidth(!0),u=i.outerWidth(!0);e._tabContainerElement.addClass("display-none");var c=a.outerWidth(!0),d=r.outerWidth(!0);e._tabContainerElement.removeClass("display-none");var g=s-(l+u+c+d);g=g>Conf.getVal("MIN_TAB_WIDTH")?g:Conf.getVal("MIN_TAB_WIDTH"),g-=1,e._tabContainerElement.css("min-width",g),e._tabContainerElement.css("max-width",g),e._tabContainerElement.width(g)},n._controllTabScrollButton=function(){var e=this,t=e._tabContainerElement,n=e._tabInnerContainerElement,o=e._prevTabElement,i=e._nextTabElement,a=t.outerWidth(!0),r=n.outerWidth(!0);r>a?(i.removeClass("display-none"),o.removeClass("display-none")):(i.addClass("display-none"),o.addClass("display-none"))},n.isCreateGroupchat=function(e){var t=AuthorityInfo.getInstance();1==t.checkRights("createGroupchat")?$("#groupChatList .list_ttl > a").show():$("#groupChatList .list_ttl > a").hide()},n._refreshContents=function(e,t){function n(e){e?(s.endLoading(),r._tabSelectRefreshing=!1,null!=t&&"function"==typeof t&&(t(e),head_scr.update(),wtc_scr.update())):t(!1)}function o(e){s.isContainMinimumColumn(e)&&(c=e),i(function(){}),setTimeout(a,1),col_scr.forEach(function(e){e.destroy()}),col_scr=[]}function i(e){function t(){for(var o=100,a=0;o>a&&!(0>i);a++)n.eq(i).remove(),i--;return 0>i?void(null!=e&&"function"==typeof e&&e()):void setTimeout(function(){t()},1)}var n=$("body").children("div.mTip"),o=n.length,i=o-1;setTimeout(function(){t()},1)}function a(){ContextSearchView.getInstance().setAutoComplete(l),ColumnManager.getInstance().refresh(u,c,n),setTimeout(function(){var t=s.getSideListViewImpl();r.isCreateGroupchat(l.extras.communityId);var n="#groupChatList > ul > div.list-groupchat";$(n).find("*").off(),$(n).off().remove(),0==e?(n=".contact_list ul.sidebar_list > div.contact-list-top",$(n).children().off(),$(n).off().remove(),n=".colum_list .list_ttl > a",$(n).show(),$("#prj_ico").hide(),$("#side-bar-recent-ico").hide(),$("#side-bar-murmur-ico").show(),SideMenuRecentView.getInstance().clearColumn(),SelectAndAddProjectView.getInstance().setHeaderIconAndColor(null)):(n=".colum_list .list_ttl > a",$(n).hide(),$("#prj_ico").show(),$("#side-bar-recent-ico").show(),$("#side-bar-murmur-ico").hide(),SelectAndAddProjectView.getInstance().setHeaderIconAndColor(r.getCommunityInfo())),SideListView.getInstance().refreshContents(t,l)},1)}if(null!=e&&"number"==typeof e){var r=this;if(r._tabSelectRefreshing)return void setTimeout(function(){null!=t&&"function"==typeof t&&t(!1)},1);var s=r._tabItemViewList.get(e);if(!s)return void setTimeout(function(){null!=t&&"function"==typeof t&&t(!1)},1);r._tabSelectRefreshing=!0,s.startLoading();var l=s.getTabInfo();r.selectedInfo=s;var u=l.columnListId,c=s.getDefaultColumnInfoList();TabColumnStateStore.getInstance().getColumnList(u,o)}},n._getMyWorkPlaceTabObj=function(){for(var e=this,t=e._tabItemViewList.getCount(),n=0;t>n;n++){var o=e._tabItemViewList.get(n),i=o.getTabInfo();if(i.type==TabItemView.TYPE_MY_WORK_PLACE)break}if(n==t)return $();var a=e._tabInnerContainerElement,r=a.children().eq(n);return $(r)},n.startRefreshingFromLoginView=function(){var e=this;e._tabSelectRefreshing=!0;var t=e.getCurrentTabItemView();t.startLoading()},n.endRefreshingFromLoginView=function(){var e=this,t=e.getCurrentTabItemView();t.endLoading(),e._tabSelectRefreshing=!1}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){LoginView.MIN_LENGTH_USER_NAME=2,LoginView.MAX_LENGTH_USER_NAME=32,LoginView.MIN_LENGTH_PASSWORD=8,LoginView.MAX_LENGTH_PASSWORD=32,LoginView.HIDE_SPEED=500,LoginView.URI_PARAM_ACCESS_TOKEN="access_token",LoginView.URI_PARAM_LOGIN_TICKET="login_ticket",LoginView.URI_PARAM_COLUMN_TYPE="column_type",LoginView.URI_PARAM_TO_JID="to_jid",LoginView.URI_PARAM_ROOM_ID="room_id",LoginView.LOGIN_COMPLETE_DELAY=50,LoginView.START_ADD_FIRST_COLUMN_DELAY=LoginView.LOGIN_COMPLETE_DELAY+LoginView.HIDE_SPEED;var e=new LoginView;LoginView.getInstance=function(){return e};var t=LoginView.prototype;t.setQueryStringParamArray=function(e){"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(this._qsParamArray=e)},t.getQueryStringParamArray=function(){return this._qsParamArray},t._execLogin=function(){if($("#loginErrMsg").text(""),!LoginView.getInstance()._checkTenantname()||!LoginView.getInstance()._checkUsername()||!LoginView.getInstance()._checkPassword())return $("#btnLogin").prop("disabled",!1),!1;ViewUtils.showLoginLoadingIcon($("#loginErrMsg"));var e=View.getInstance();CubeeController.getInstance().login($("#txtLogintenant").val(),$("#txtLoginid").val(),$("#txtLoginpassword").val(),e.onLogin,e.onDisconnected,e.onError,e.onProfileChanged,e.onMessage,e.onNotification,e.onLoginWizard)},t._execTicketLogin=function(e){$("#loginErrMsg").text("");var t=LoginTicket.loginTicket2Account(e);if(!t)return!1;ViewUtils.showLoginLoadingIcon($("#loginErrMsg"));var n=View.getInstance();CubeeController.getInstance().login(t.tenant,t.id,t.pw,n.onLogin,n.onDisconnected,n.onError,n.onProfileChanged,n.onMessage,n.onNotification,n.onLoginWizard)},t._execSkipLogin=function(e){$("#loginErrMsg").text(""),ViewUtils.showLoginLoadingIcon($("#loginErrMsg"));var t=View.getInstance();return CubeeController.getInstance().skipLogin(e,t.onLogin,t.onDisconnected,t.onSkipLoginError,t.onProfileChanged,t.onMessage,t.onNotification),!0},t._execSkipLoginFromUri=function(){var e=ViewUtils.getRequestString();LoginView.getInstance().setQueryStringParamArray(e);var t=e[LoginView.URI_PARAM_ACCESS_TOKEN];return null!=t&&LoginView.getInstance()._execSkipLogin(t),!0},t.onLoginError=function(e){var t=this,n=e.message;return ViewUtils.hideLoginLoadingIcon($("#loginErrMsg")),"Not Authorized"==n?void(LoginTicket.readAccount()?(LoginTicket.remove(),window.location.reload()):($("#loginErrMsg").text(Resource.getMessage("loginErrMsg")),$("#btnLogin").prop("disabled",!1))):"unauthorized_assignment"==n||"failed_to_fetch_authority_data"==n?(LoginTicket.readAccount()&&(LoginTicket.remove(),window.location.reload()),$("#loginErrMsg").text(Resource.getMessage(n)),$("#btnLogin").prop("disabled",!1),!1):t._isLoginCompleted?!0:(t.relogin(n),!1)},t.relogin=function(e){var t=this;0==t._needRelogin&&(t._needRelogin=!0,console.log("login communicateion error : "+e),setTimeout(function(){t._needRelogin=!1,t._execLogin()},5e3),CubeeController.getInstance().logout())},t.onSkipLoginError=function(e){var t=e.message;return ViewUtils.hideLoginLoadingIcon($("#loginErrMsg")),"Not Authorized"==t?($("#loginErrMsg").text(Resource.getMessage("skipLoginAccessTokenErrMsg")),!1):"Failed Switch Protocol"==t?($("#loginErrMsg").text(Resource.getMessage("skipLoginSwitchProtocolErrMsg")),!1):($("#loginErrMsg").text(Resource.getMessage("skipLoginErrMsg")),!1)},t._checkTenantname=function(){var e=$("#txtLogintenant"),t="#loginErrMsg";return ViewUtils.checkRegexp(e,/^\s*$/)?($(t).text(Resource.getMessage("loginErrTenantContain")),!1):($(t).text(""),!0)},t._checkUsername=function(){var e=$("#txtLoginid"),t="#loginErrMsg";return ViewUtils.checkRegexp(e,/^\s*$/)?($(t).text(Resource.getMessage("loginErrUserContain")),!1):($(t).text(""),!0)},t._checkPassword=function(){var e=$("#txtLoginpassword"),t="#loginErrMsg";return ViewUtils.checkRegexp(e,/^$/)?($(t).text(Resource.getMessage("loginErrPasswordContain")),!1):($(t).text(""),!0)},t._addRequestColumn=function(){var e=this,t=e.getQueryStringParamArray(),n=(new ColumnInformation,t[LoginView.URI_PARAM_COLUMN_TYPE]),o=t[LoginView.URI_PARAM_TO_JID],i=t[LoginView.URI_PARAM_ROOM_ID];n*=1;var a=ColumnManager.getInstance();switch(n){case ColumnInformation.TYPE_COLUMN_MENTION:return a.addColumnInfo(n);case ColumnInformation.TYPE_COLUMN_INBOX:return a.addInboxColumn();case ColumnInformation.TYPE_COLUMN_TASK:return a.addTaskColumn("");case ColumnInformation.TYPE_COLUMN_CHAT:return a.addChatColumn(o);case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:return a.addGroupChatColumn(i);case ColumnInformation.TYPE_COLUMN_MAIL:return a.addMailColumn();case ColumnInformation.TYPE_COLUMN_RECENT:return a.addRecentColumn();default:return!1}return!0},t.showWizardStandby=function(e){var t=LoginTicket.read();t||LoginTicket.writeAccount($("#txtLogintenant").val(),$("#txtLoginid").val(),$("#txtLoginpassword").val()),WizardView.getInstance().showWizard(e),$("#login").animate({opacity:0},600,function(){$(this).remove(),setTimeout(function(){ViewUtils.modal_on("wizard_modal",!0)},400)})},t.showMainScreen=function(){function e(e,n){function r(e){function r(e){t._mailCooperationSettingServerList=e,null!=t._mailCooperationSettingServerList&&t._mailCooperationSettingServerList.getCount()>0&&GeneralConfigButton.getInstance().setConfigMenu(t._mailCooperationSettingServerList)}var l=e,u=200;if(null==l||l.getCount()<1||0==a){var c=function(){function e(e){return LoginUser.getInstance().isFirstLogin()&&ColumnManager.getInstance().addRecentColumn(!0),e?void(null!=o?setTimeout(function(){t._addRequestColumn(),t._onLoginedViewInitFinished()},u):t._onLoginedViewInitFinished()):(t._onLoginedViewInitFinished(),void TabManager.getInstance().endRefreshingFromLoginView())}ColumnManager.getInstance().refresh(s,n,e)};setTimeout(c,LoginView.START_ADD_FIRST_COLUMN_DELAY)}else{for(var d=function(){function e(e){return e?(null!=o&&t._addRequestColumn(),void t._onLoginedViewInitFinished()):void t._onLoginedViewInitFinished()}ColumnManager.getInstance().refresh(s,l,e)},g=l.getCount(),m=!1,_=0;g>_;_++)if(l.get(_).getColumnType()==ColumnInformation.TYPE_COLUMN_RECENT){m=!0;break}if(!m){var f=new RecentColumnInfomation,p=ColumnFilterManager.getColumnFilter(ColumnInformation.TYPE_COLUMN_RECENT,null);if(null==p)return!1;var h=new ColumnSearchCondition(p,new ColumnSortCondition);f.setSearchCondition(h),l.add(f)}setTimeout(d,LoginView.START_ADD_FIRST_COLUMN_DELAY)}GeneralConfigButton.getInstance().showLoginUserName(),GeneralConfigButton.getInstance().showLoginUserGroup(),GeneralConfigButton.getInstance().showLoginUserAvatar(),SidebarNoteView.getInstance().showNoteList(),GeneralConfigButton.getInstance().setConfigMenu(t._mailCooperationSettingServerList),GeneralConfigButton.getInstance().updateGoodJobCount(),GeneralConfigButton.getInstance().updateGoodJobAllCount(),GeneralConfigButton.getInstance().updateThanksPointsCount(),GeneralConfigButton.getInstance().updateThanksPointsAllCount(),GeneralConfigButton.getInstance().updateFolloweeFollower(),LoginUser.getInstance().isUpdatablePersonData()||$('ul.user_menu li[value="password"]').remove(),null==t._mailCooperationSettingServerList&&CubeeController.getInstance().getServerList(r),ViewUtils.setAutoCompleteEventToTextArea(),ViewUtils.setAutoCompleteEventForCommunityMember(),ViewUtils.setAutoCompleteEventToTextAreaForGroup();var C,v;LoginPresence.getInstance().isLogin()?(C=$("#presence_type").val(),v=$("#myMemo > input").val()):(C=LoginPresence.getInstance().getLoginPresenceToStr(),v=LoginMyMemo.getInstance().getLoginMyMemo(),1==CubeeController.getInstance().changePresence(C,v+" ")&&ColumnMessageView.updateMessageAvatarToolTip(i)),1==CubeeController.getInstance().changePresence(C,v)&&ColumnMessageView.updateMessageAvatarToolTip(i),setTimeout(function(){t.onLoginCompleted(),setTimeout(function(){View.resizeButton()},LoginView.HIDE_SPEED)},LoginView.LOGIN_COMPLETE_DELAY)}var s=e.columnListId;TabColumnStateStore.getInstance().getColumnList(s,r)}var t=this;SelectAndAddProjectView.getInstance().getProjectList();var n=t.getQueryStringParamArray(),o=n[LoginView.URI_PARAM_COLUMN_TYPE],i=LoginUser.getInstance().getJid(),a=(ContactList.getInstance(),!0),r=NotificationSettingManager.getInstance();r.read();var s=PushNotificationSettingManager.getInstance();s.read(),TabManager.getInstance().onLogin(e)},t._onLoginedViewInitFinished=function(){var e=this;setTimeout(function(){e._loginedViewInitFinish=!0,View.getInstance().onLoginedViewInitFinished(),DemandTaskCautionIconView.getDemandTaskCount()},1),ViewUtils.setDoubleClickEventToAvatar()},t.getLoginedViewInitFinish=function(){var e=this;return e._loginedViewInitFinish},t.onLoginCompleted=function(){var e=this;ViewUtils.hideLoginLoadingIcon($("#loginErrMsg"));var t="slide",n={direction:"up"},o=LoginView.HIDE_SPEED;$("#login").hide(t,n,o,function(){$("#mainOuterContainer").removeClass("visibility-hidden"),View.getInstance().resizeContent()}),e._isLoginCompleted=!0,LayoutManager.resetScreenLayout();var i=LoginTicket.read();i||LoginTicket.writeAccount($("#txtLogintenant").val(),$("#txtLoginid").val(),$("#txtLoginpassword").val())},t.getLoginCompleted=function(){var e=this;return e._isLoginCompleted},t.controlFocus=function(){0==$("#txtLogintenant").val().length?$(document).ready(function(){$("#txtLogintenant").focus()}):0==$("#txtLoginid").val().length?$(document).ready(function(){$("#txtLoginid").focus()}):$(document).ready(function(){$("#txtLoginpassword").focus()})},$(function(){LoginView.getInstance()._execSkipLoginFromUri(),$("body").css("display","");var e=LoginTicket.read();if(e)LoginView.getInstance()._execTicketLogin(e),LoginView.getInstance()._setResourceStaticElements();else{$("#btnLogin").on("click",function(){return $("#btnLogin").prop("disabled",!0),LoginView.getInstance()._execLogin(),!1}),ViewUtils.isIE89()&&($("#txtLoginid").on("keydown",function(e){t(e)}),$("#txtLoginpassword").on("keydown",function(e){t(e)})),$("#forgotPassword > a").on("click",function(){});var t=function(e){var t=13,n=e.keyCode?e.keyCode:e.which;return n&&n==t&&!LoginView.getInstance()._execLogin()?!1:void 0};LoginView.getInstance()._setResourceStaticElements(),LoginView.getInstance().controlFocus()}}),t._setResourceStaticElements=function(){$(".login_inner h2").text(Resource.getMessage("login_header")),$("#txtLogintenant").attr("placeholder",Resource.getMessage("login_tenantname_placeholder")),$("#txtLoginid").attr("placeholder",Resource.getMessage("login_username_placeholder")),$("#txtLoginpassword").attr("placeholder",Resource.getMessage("login_password_placeholder")),$("#btnLoginText").text(Resource.getMessage("login_btn"));for(var e=["chat","away","xa","dnd"],t=0;t<e.length;t++){var n=e[t],o=Resource.getMessage("presence_"+n);$('#presence_type > option[value="'+n+'"]').text(o)}$("#myMemo input:first").attr({placeholder:Resource.getMessage("my_memo_placeholder")});var i={".action-reply":"action_reply",".action-show-conversation":"action_show_conversation",".action-add-inbox-task":"action_add_inbox_task",".action-doing-task":"action_doing_task",".action-doing-inner-task":"action_doing_task",".action-finish-task":"action_finish_task",".action-finish-inner-task":"action_finish_task",".action-edit-task":"action_edit_task",".action-accept-new-task":"action_accept_new_task",".action-accept-new-inner-task":"action_accept_new_task",".action-Reject-task":"action_reject_task",".action-reject-inner-task":"action_reject_task",".action-demand-task":"action_demand_task",".action-clear-demanded-task":"action_clear_demanded_task",".action-add-new-task":"action_add_new_task_from_message","#tooltipInboxMessageAction > .action-add-new-task":"action_add_new_task_from_inbox","#tooltipInboxMessageAction > .action-delete-message":"action_delete_from_inbox","#tooltipReplyMessageActionCanDelete > .action-delete-message":"action_delete_message","#tooltipReplyMessageActionCanDeleteBar > .action-delete-message":"action_delete_message","#tooltipTaskMessageAction > .action-delete-message":"action_delete_task","#tooltipChatMessageActionCanDelete > .action-delete-message":"action_delete_from_inbox","#tooltipChatMessageActionCanDeleteBar > .action-delete-message":"action_delete_from_inbox","#tooltipParentTaskMessageAction > .action-delete-message":"action_delete_task","#tooltipParentTaskMessageCancelAction > .action-delete-message":"action_delete_task","#addColumnIcon":"header_add_column","#switchToList":"header_switch_to_list","#switchToColumn":"header_switch_to_columns","#searchIcon_for_mobile":"header_context_search","#addColumnIcon_for_mobile":"header_add_column"};for(var a in i){var o=Resource.getMessage(i[a]);$(a).attr({alt:o,title:o})}$("#txtSearchContext").attr({placeholder:Resource.getMessage("header_context_search_placeholder")}),$(".header_right .input_group a").attr({"data-original-title":Resource.getMessage("search_option_title")}),$(".header_right .input_group #search_btn").attr({"data-original-title":Resource.getMessage("Search")}),$(".header_btn .popup_menu a").attr({"data-original-title":Resource.getMessage("main_header_system_info")}),$(".header_btn #prj_ico").attr({"data-original-title":Resource.getMessage("main_header_project_details")
}),$(".header_btn #side-bar-recent-ico").attr({"data-original-title":Resource.getMessage("main_header_recent_list")})},t.getMailCooperationSettingServerList=function(){var e=this;return e._mailCooperationSettingServerList}}(),function(){$(function(){$("img.avatar").on("click",function(){})})}(),function(){DialogOkCancelView.prototype=$.extend({},DialogView.prototype);var e=(DialogView.prototype,DialogOkCancelView.prototype);e._init=function(){},e.cleanup=function(){var e=this;e._dialogInnerElement.find(".scroll_content").find("*").off().remove()},e.showDialog=function(){var e=this;$("#modal_area").css("display","block"),$("#modal_area").prepend('<div class="overlay modal_exit"></div>'),this._dialogInnerElement.addClass("on").css("display","block").animate({"margin-top":0,opacity:1},200,function(){""!=e.ps&&e.ps.update()}),$(".overlay").animate({opacity:.3},200),document.activeElement.blur()}}(),function(){this.prototype=$.extend({},DialogView.prototype);var e=DialogCloseView.prototype;e._init=function(e,t){var n="";n+='<div id="msg_modal" class="card modal_card">',n+='  <div class="card_title">',n+="    <p>"+e+"</p>",n+="  </div>",n+='  <div class="modal_content_wrapper">',n+='    <p class="txt">'+t+"</p>",n+="  </div>",n+='  <div class="btn_wrapper">',n+='    <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',n+='    <button type="button" id="msg_ok_btn" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+"</span></button>",n+="  </div>",n+='  <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',n+="</div>",this._dialogAreaElement.html(n),this._dialogInnerElement=this._dialogAreaElement.children(),this._dialogInnerElement.find("#msg_ok_btn").on("click",function(){ViewUtils.modal_allexit(),this._dialogInnerElement=null})},e.showDialog=function(){$("#modal_area").css("display","block"),$("#modal_area").prepend('<div class="overlay modal_exit"></div>'),this._dialogInnerElement.addClass("on").css("display","block").animate({"margin-top":0,opacity:1},200),$(".overlay").animate({opacity:.3},200),document.activeElement.blur()}}.call(DialogCloseView),function(){DialogSettingView.prototype=$.extend({},DialogOkCancelView.prototype);var e=(DialogOkCancelView.prototype,DialogSettingView.prototype);e._init=function(){var e=this;e._dialogAreaElement.html(e.getInnerHtml()),e._dialogInnerElement=e._dialogAreaElement.children()},e.submit=function(e){$(e).dialog("close")},e.getInnerHtml=function(){var e="";return e="<div>",e+="</div>"}}(),function(){DialogPersonListView.prototype=$.extend({},DialogOkCancelView.prototype);var e=(DialogOkCancelView.prototype,DialogPersonListView.prototype);e._init=function(){var e=this;e._personList.getCount();e._dialogAreaElement.html(e.getInnerHtml()),e._dialogInnerElement=e._dialogAreaElement.children(),e.ps=new PerfectScrollbar(e._dialogInnerElement.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(e.ps),e._dialogInnerElement.find(".modal_btn").on("click",function(){e.cleanup(),ViewUtils.modal_allexit()})},e.cleanup=function(){var e=this;e.ps&&e.ps.destroy(),e._title=null,e._dialogAreaElement=null,e._dialogInnerElement=null,e._personList=null},e._onCloseDialog=function(){ColumnManager.getInstance().closePersonListDialog()},e.submit=function(e){$(e).dialog("close")},e.getInnerHtml=function(){var e=this,t="",n=e._personList;if(null==n)return t;var o=n.getCount();t+='<div id="read_modal" class="card modal_card">',t+='  <div class="card_title">',t+="    <p>"+e._title+""+o+"</p>",t+="  </div>",t+='  <div class="list_wrapper scroll_content">',t+='   <ul class="modal_list">';for(var i=0;o>i;i++){var a=n.get(i);t+=e._createPersonHtml(a)}return t+="   </ul>",t+="  </div>",t+='  <div class="btn_wrapper">',t+='    <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',t+='    <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+"</span></button>",t+="  </div>",t+='  <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',t+="</div>"},e._createPersonHtml=function(e){var t="",n=e.getJid(),o=ViewUtils.getAvatarUrl(e),i=e.getLoginAccount(),a=e.getUserName(),r="images/user_noimage.png";(null==a||""==a)&&(a=ViewUtils.getUserName(n));e.getStatus();if(t+='<li class="cf">',t+='  <span class="ico ico_user">',o==r){var s=new Person;s.setUserName(a),t+=ViewUtils.getDefaultAvatarHtml(s)}else t+='    <img src="'+o+'" alt="'+Utils.convertEscapedTag(a)+'">';return t+="  </span>",t+='  <span class="name">'+Utils.convertEscapedHtml(a)+"</span>",t+='  <span class="group">@'+Utils.convertEscapedHtml(i)+"</span>",t+="</li>"},e.onNotification=function(e){},e.rewritDialogTitle=function(){var e=this,t=e._dialogInnerElement.find(".modal_list li"),n=t.length,o=e._dialogInnerElement.parent().find(".card_title p");o.text(e._title+" ("+n+")")}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogExistingPersonListView.prototype=$.extend({},DialogPersonListView.prototype);var e=(DialogPersonListView.prototype,DialogExistingPersonListView.prototype);e.onNotification=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getType();if(n==Notification_model.TYPE_MESSAGE_OPTION){var o=e.getContentType();if(o==MessageOptionNotification.CONTENT_TYPE_SET_READ_MESSAGE){var i=e.getItemId();if(i==t._messageItemId){var a=e.getExistingReaderItem(),r=a.getPerson(),s=t._createPersonHtml(r);t._dialogInnerElement&&t._dialogInnerElement.find(".modal_list").prepend(s),t.rewritDialogTitle()}}}}}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogFollowerListView.prototype=$.extend({},DialogOkCancelView.prototype);var e=DialogOkCancelView.prototype,t=DialogFollowerListView.prototype;t._init=function(){var t=this;t._dialogAreaElement.html(t.getInnerHtml()),t._dialogInnerElement=t._dialogAreaElement.children();var n=LoginUser.getInstance().getJid(),o=t._jid;if(n==o){for(var i=LoginUser.getInstance().getFollowerList(),a=i.getCount(),r=[],s=0;a>s;s++)r.push(i.get(s));t._followerList=i,t._createColumnNameElement(r,a),t.ps=new PerfectScrollbar(t._dialogInnerElement.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t._createEventHandler(),t._dialogInnerElement.find(".scroll_content").on("ps-y-reach-end",function(){for(var e=[],n=t._dialogInnerElement.find("ul.modal_list.select_list li").length,o=0;e.length<Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST")&&o+n<i.getCount()&&n%(Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST")-1)==0;o++){var r=o+n;t._searchword.length>0?(i.get(r).getUserName().indexOf(t._searchword)>=0||i.get(r).getGroup().indexOf(t._searchword)>=0||i.get(r).getLoginAccount().indexOf(t._searchword)>=0)&&e.push(i.get(r)):e.push(i.get(r))}t._createColumnNameElement(e,a,!0)}),t._dialogInnerElement.on("click",".modal_exit",function(){e.cleanup.call(t)})}else CubeeController.getInstance().getFollowerList(o).then(function(n){for(var o=n,i=o.getCount(),a=[],r=0;i>r;r++)a.push(o.get(r));t._followerList=o,t._createColumnNameElement(a,i),t.ps=new PerfectScrollbar(t._dialogInnerElement.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t._createEventHandler(),t._dialogInnerElement.find(".scroll_content").on("ps-y-reach-end",function(){for(var e=[],n=t._dialogInnerElement.find("ul.modal_list.select_list li").length,a=0;e.length<Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST")&&a+n<o.getCount()&&n%(Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST")-1)==0;a++){var r=a+n;t._searchword.length>0?(o.get(r).getUserName().indexOf(t._searchword)>=0||o.get(r).getGroup().indexOf(t._searchword)>=0||o.get(r).getLoginAccount().indexOf(t._searchword)>=0)&&e.push(o.get(r)):e.push(o.get(r))}t._createColumnNameElement(e,i,!0)}),t._dialogInnerElement.on("click",".modal_exit",function(){e.cleanup.call(t)})})},t.getInnerHtml=function(){var e='<div class="followerlist-modal card modal_card">          <div class="card_title">            <p> '+Resource.getMessage("dialog_title_follower")+' </p>          </div>          <div class="select_menu">            <form action="." method="get" class="search_form title_search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("dialog_label_follower_search")+'">              <button type="button" name="search" class="title_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},t._createEventHandler=function(){var e=this;e._dialogInnerElement.find(".title_search_btn").off("click"),e._dialogInnerElement.find(".title_search_btn").on("click",function(){e.filterColumnName()}),e._dialogInnerElement.find("input.field").keypress(function(t){return(t.which&&13===t.which||t.keyCode&&13===t.keyCode)&&e.filterColumnName(),13!==t.which})},t._createColumnNameElement=function(e,t,n){var o=this,i=o._dialogAreaElement.find("#dialog-error");if(i.text(""),0==t)return void i.text(Resource.getMessage("dialog_follower_list_nothing"));if(0==e.length&&!n)return void o._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_follower_list_search_nothing"));for(var a=0;a<e.length;a++)if("object"==_typeof(e[a])&&null!=e[a].getUserName()&&e[a].getUserName().length>0){var r=ViewUtils.getAvatarDataHtmlFromPerson(e[a]),s=" status "+ViewUtils.getPresenceColorCss(e[a].getPresence()),l=e[a].getGroup().length>0?e[a].getGroup().join(" "):Resource.getMessage("group_title_no_group"),u='                <li jid="'+e[a].getJid()+'">                    <a title="'+e[a].getUserName()+" "+Utils.convertEscapedHtml(l)+'">                        <span class="ico ico_user '+s+'">'+r+'</span>                        <span class="name">'+Utils.convertEscapedHtml(e[a].getUserName())+'</span>                        <span class="group">'+Utils.convertEscapedHtml(l)+"</span>                    </a>                </li>",c=$(u);this._dialogInnerElement.find(".select_list").append(c),c.on("click",function(e){var t=$(e.currentTarget).attr("jid"),n=new ColumnInformation;n.setColumnType(ColumnInformation.TYPE_COLUMN_CHAT),n.setFilterCondition(t),ColumnManager.getInstance().addMurmurColumn(t,!0,!1,!1),ViewUtils.unsetNewNoticeMark($(e.currentTarget)),NotificationIconManager.getInstance().onColumnClicked(n),ViewUtils.modal_allexit()})}},t.filterColumnName=function(){var e=this,t=e._followerList;e._dialogInnerElement.find(".select_list").empty();for(var n=e._dialogInnerElement.find("input.field").val(),o=t.getCount(),i=[],a=0;o>a;a++){var r=t.get(a);(r.getUserName().indexOf(n)>=0||r.getGroup().indexOf(n)>=0||r.getLoginAccount().indexOf(n)>=0)&&i.push(r)}e._searchword=n,e._createColumnNameElement(i,o),e._dialogInnerElement.find(".scroll_content").scrollTop(0)},$(function(){var e=$("#left_sidebar").find(".follower_list .all_list_btn a");e.on("click",function(){var e=new DialogfollowerListView;e.showDialog()})})}(),function(){DialogFolloweeListView.prototype=$.extend({},DialogOkCancelView.prototype);var e=DialogOkCancelView.prototype,t=DialogFolloweeListView.prototype;t._init=function(){var t=this;t._dialogAreaElement.html(t.getInnerHtml()),t._dialogInnerElement=t._dialogAreaElement.children();var n=LoginUser.getInstance().getJid(),o=t._jid;if(n==o){for(var i=LoginUser.getInstance().getFolloweeList(),a=i.getCount(),r=[],s=0;a>s;s++)r.push(i.get(s));t._followeeList=i,t._createColumnNameElement(r,a),t.ps=new PerfectScrollbar(t._dialogInnerElement.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t._createEventHandler(),t._dialogInnerElement.find(".scroll_content").on("ps-y-reach-end",function(){for(var e=[],n=t._dialogInnerElement.find("ul.modal_list.select_list li").length,o=0;e.length<Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST")&&o+n<i.getCount()&&n%(Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST")-1)==0;o++){var r=o+n;t._searchword.length>0?(i.get(r).getUserName().indexOf(t._searchword)>=0||i.get(r).getGroup().indexOf(t._searchword)>=0||i.get(r).getLoginAccount().indexOf(t._searchword)>=0)&&e.push(i.get(r)):e.push(i.get(r))}t._createColumnNameElement(e,a,!0)}),t._dialogInnerElement.on("click",".modal_exit",function(){e.cleanup.call(t)})}else CubeeController.getInstance().getFolloweeList(o).then(function(n){for(var o=n,i=o.getCount(),a=[],r=0;i>r;r++)a.push(o.get(r));t._followeeList=o,t._createColumnNameElement(a,i),t.ps=new PerfectScrollbar(t._dialogInnerElement.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t._createEventHandler(),t._dialogInnerElement.find(".scroll_content").on("ps-y-reach-end",function(){for(var e=[],n=t._dialogInnerElement.find("ul.modal_list.select_list li").length,a=0;e.length<Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST")&&a+n<o.getCount()&&n%(Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST")-1)==0;a++){var r=a+n;t._searchword.length>0?(o.get(r).getUserName().indexOf(t._searchword)>=0||o.get(r).getGroup().indexOf(t._searchword)>=0||o.get(r).getLoginAccount().indexOf(t._searchword)>=0)&&e.push(o.get(r)):e.push(o.get(r))}t._createColumnNameElement(e,i,!0)}),t._dialogInnerElement.on("click",".modal_exit",function(){e.cleanup.call(t)})})},t.getInnerHtml=function(){var e='<div class="followeelist-modal card modal_card">          <div class="card_title">            <p> '+Resource.getMessage("dialog_title_followee")+' </p>          </div>          <div class="select_menu">            <form action="." method="get" class="search_form title_search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("dialog_label_followee_search")+'">              <button type="button" name="search" class="title_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},t._createEventHandler=function(){var e=this;e._dialogInnerElement.find(".title_search_btn").off("click"),e._dialogInnerElement.find(".title_search_btn").on("click",function(){e.filterColumnName()}),e._dialogInnerElement.find("input.field").keypress(function(t){return(t.which&&13===t.which||t.keyCode&&13===t.keyCode)&&e.filterColumnName(),13!==t.which})},t._createColumnNameElement=function(e,t,n){var o=this,i=this,a=i._dialogAreaElement.find("#dialog-error");if(a.text(""),0==t)return void a.text(Resource.getMessage("dialog_followee_list_nothing"));if(0==e.length&&!n)return void i._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_followee_list_search_nothing"));for(var r=0;r<e.length;r++)if(null!=e[r].getUserName()||e[r].getUserName().length>0){var s,l,u,c,d,g,m,_,f,p;!function(){var t=function n(e,t,o){var i=o;"follow"==t&&e.on("click",function(){CubeeController.getInstance().addUserFollow(i).then(function(){e.off("click"),e.addClass("unfollow-dialog-btn change"),e.removeClass("follow-dialog-btn"),e.text(Resource.getMessage("del_followee_text")),n(e,"unfollow",i)})["catch"](function(e){})}),"unfollow"==t&&e.on("click",function(){CubeeController.getInstance().delUserFollow(i).then(function(){e.off("click"),e.addClass("follow-dialog-btn change"),e.removeClass("unfollow-dialog-btn"),e.text(Resource.getMessage("add_followee_text")),n(e,"follow",i)})["catch"](function(e){})})};s=ViewUtils.getAvatarDataHtmlFromPerson(e[r]),l=" status "+ViewUtils.getPresenceColorCss(e[r].getPresence()),u=e[r].getGroup().length>0?e[r].getGroup().join(" "):Resource.getMessage("group_title_no_group"),c=LoginUser.getInstance().getJid(),d=i._jid,g="",c==d&&(g=e[r]._jid==c?'<span><button type="button" class="follow-dialog-btn">'+Resource.getMessage("add_followee_text")+"</button></span>":'<span><button type="button" class="unfollow-dialog-btn">'+Resource.getMessage("del_followee_text")+"</button></span>"),m='                <li>                    <a jid="'+e[r].getJid()+'" class="follow-dialog-user" title="'+e[r].getUserName()+" "+Utils.convertEscapedHtml(u)+'">                        <span class="ico ico_user '+l+'">'+s+'</span>                        <span class="name">'+Utils.convertEscapedHtml(e[r].getUserName())+'</span>                        <span class="group">'+Utils.convertEscapedHtml(u)+"</span>                    </a>                    "+g+"                 </li>",_=$(m),o._dialogInnerElement.find(".select_list").append(_),$("#modal_area div.followeelist-modal ul > li > a").click(function(e){var t=$(e.target).closest("a.follow-dialog-user").attr("jid"),n=new ColumnInformation;n.setColumnType(ColumnInformation.TYPE_COLUMN_CHAT),n.setFilterCondition(t),ColumnManager.getInstance().addMurmurColumn(t,!0,!1,!1),ViewUtils.unsetNewNoticeMark($(e.currentTarget)),NotificationIconManager.getInstance().onColumnClicked(n),ViewUtils.modal_allexit()}),f=e[r].getJid(),p="follow",p=_.find("button").hasClass("follow-dialog-btn")?"follow":"unfollow",t(_.find("button"),p,f)}()}},t.filterColumnName=function(){var e=this,t=e._followeeList;e._dialogInnerElement.find(".select_list").empty();for(var n=e._dialogInnerElement.find("input.field").val(),o=t.getCount(),i=[],a=0;o>a;a++){var r=t.get(a);(r.getUserName().indexOf(n)>=0||r.getGroup().indexOf(n)>=0||r.getLoginAccount().indexOf(n)>=0)&&i.push(r)}e._searchword=n,e._createColumnNameElement(i,o),e._dialogInnerElement.find(".scroll_content").scrollTop(0)},$(function(){var e=$("#left_sidebar").find(".followee_list .all_list_btn a");e.on("click",function(){var e=new DialogFolloweeListView;e.showDialog()})})}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogGoodJobPersonListView.prototype=$.extend({},DialogPersonListView.prototype);var e=(DialogPersonListView.prototype,DialogGoodJobPersonListView.prototype);e.onNotification=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getType();if(n==Notification_model.TYPE_GOOD_JOB){var o=e.getItemId();if(o==t._messageItemId){var i=e.getFromJid(),a=new Person;a.setJid(i),a.setLoginAccount(e.getLoginAccount()),a.setUserName(e.getNickName()),a.setAvatarType(e.getAvatarType()),a.setAvatarData(e.getAvatarData()),a.setStatus(e.getStatus());var r=t._createPersonHtml(a);t._dialogInnerElement.find(".modal_list").prepend(r),t.rewritDialogTitle()}}}}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogAddColumnView.NEW_TAB_DETAIL_HTML_ID="column-add-detail-new",DialogAddColumnView.prototype=$.extend({},DialogOkCancelView.prototype);var e=DialogOkCancelView.prototype,t=DialogAddColumnView.prototype;t._init=function(){var t=this;e._init.call(t),t._tabDetailHtmlIdList.add(DialogAddColumnView.NEW_TAB_DETAIL_HTML_ID),delete t._buttons[DialogOkCancelView.LABEL_CANCEL],t._dialogAreaElement=$("#modal_area"),t._dialogAreaElement.html(t.getColumnAddMenuHtml()),t._dialogInnerElement=t._dialogAreaElement.children();for(var n=t._tabDetailList.getCount(),o=0;n>o;o++){var i=t._tabDetailList.get(o),a=$("#"+t._tabDetailHtmlIdList.get(o));i.createEventHandler(a)}},t.getColumnAddMenuHtml=function(){var e="",t=this;t._tabDetailList.add(new NewTabDetail(t._mailCooperationSettingServerList));var n=t._tabDetailList.getCount();e+='<div id="addcolum_modal" class="card modal_card">';for(var o=0;n>o;o++)e+='<div id="'+t._tabDetailHtmlIdList.get(o)+'">'+t._tabDetailList.get(o).getDetailHtml()+"</div>";return e+="</div>",$(e)}}(),function(){NewTabDetail.LIST_TITLE_MYFEED=Resource.getMessage("MyFeed"),NewTabDetail.LIST_TITLE_RECENT=Resource.getMessage("RecentPostedMessages"),NewTabDetail.LIST_TITLE_MENTION=Resource.getMessage("Mention"),NewTabDetail.LIST_TITLE_TOME=Resource.getMessage("ToMe"),NewTabDetail.LIST_TITLE_SEND=Resource.getMessage("Send"),NewTabDetail.LIST_TITLE_FAVORITE=Resource.getMessage("Favorite"),NewTabDetail.LIST_TITLE_HASHTAG=Resource.getMessage("Hashtag"),NewTabDetail.LIST_TITLE_TASK=Resource.getMessage("Task"),NewTabDetail.LIST_TITLE_GROUP=Resource.getMessage("Group"),NewTabDetail.LIST_TITLE_LIST=Resource.getMessage("List"),NewTabDetail.LIST_TITLE_CHAT=Resource.getMessage("Chat"),NewTabDetail.LIST_TITLE_INBOX=Resource.getMessage("Inbox"),NewTabDetail.LIST_TITLE_SEARCH=Resource.getMessage("Search"),NewTabDetail.LIST_TITLE_MAIL=Resource.getMessage("Mail"),NewTabDetail.LIST_TITLE_MURMUR=Resource.getMessage("Murmur"),NewTabDetail.LIST_TITLE_QUESTIONNAIRE=Resource.getMessage("Questionnaire"),NewTabDetail.ERROR_SEARCH_CONDITION_KEYWORD=Resource.getMessage("dialogerrorSearch"),NewTabDetail.ERROR_SEARCH_CONDITION_COLUMN=Resource.getMessage("dialogerrorSelect");var e=NewTabDetail.prototype;e._init=function(){},e.getTabName=function(){return this._tabName},e.createEventHandler=function(e){var t=this;if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.find('select[name="task"]');n.on("focus",function(){n.parent().trigger("click")});var o=e.find("input.chat-partner");o.on("focus",function(){o.parent().trigger("click")});var i=e.find("button.success_btn");i.on("click",t.onOK.bind(this,e,function(){ViewUtils.modal_allexit()}))}},e.getDetailHtml=function(){var e='<div id="addcolum_modal_inner">';return e+='<div class="card_title">',e+="  <p>"+Resource.getMessage("dialog_add_column_title")+"</p>",e+="</div>",e+='<div class="list_wrapper">',e+='  <ul class="modal_list select_list">',e+='   <li><label for="radio1">                        <span class="name">'+NewTabDetail.LIST_TITLE_MYFEED+'</span>                        <label class="radio"><input type="radio" name="column-info"                          value="'+ColumnInformation.TYPE_COLUMN_TIMELINE+'" id="radio1"><span></span>                        </label>                    </label></li>',e+='    <li><label for="radio2">',e+='        <span class="name">'+NewTabDetail.LIST_TITLE_MURMUR+"</span>",e+='        <label class="radio"><input type="radio" name="column-info" ',e+='          value="'+ColumnInformation.TYPE_COLUMN_MURMUR+'" id="radio2"><span></span>',e+="        </label>",e+="    </label></li>",e+='    <li><label for="radio3">',e+='      <span class="name">'+NewTabDetail.LIST_TITLE_INBOX+"</span>",e+='      <label class="radio"><input type="radio" name="column-info" ',e+='        value="'+ColumnInformation.TYPE_COLUMN_INBOX+'" id="radio3"><span></span>',e+="      </label>",e+="    </label></li>",e+='    <li><label for="radio4">',e+='      <span class="name">'+NewTabDetail.LIST_TITLE_TASK+"</span>",e+='      <select class="field" name="task" class="ui-corner-all">',e+='        <option value="">'+Resource.getMessage("MyTask")+"</option></select> ",e+='      <label class="radio"><input type="radio" id="radio4" name="column-info"',e+='        value="'+ColumnInformation.TYPE_COLUMN_TASK+'"><span></span>',e+="      </label>",e+="    </label></li>",e+='    <li><label for="radio5">',e+='      <span class="name">'+NewTabDetail.LIST_TITLE_QUESTIONNAIRE+"</span>",e+='      <label class="radio"><input type="radio" id="radio5" name="column-info"',e+='        value="'+ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE+'"><span></span>',e+="      </label>",e+="    </label></li>",e+="  </ul>",e+="</div>",e+='<div class="btn_wrapper">',e+='  <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text"></span></button>',e+="</div>",e+='<a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',e+="</div>"},e._getContactListJid=function(){},e._getChatJid=function(e,t){function n(e){(null==e||""==e)&&i.addClass("input-error"),null!=t&&"function"==typeof t&&t(e)}var o=!1,i=e.find("input.chat-partner");if($(i).length>0){i.removeClass("input-error");var a=Utils.trimStringMulutiByteSpace(i.val());ViewUtils.convertAccountStrToJidStrFromServer(a,n)}return o},e.onOK=function(e,t){function n(e){t&&"function"==typeof t&&setTimeout(function(){t(e)},1)}var o=this,i=$(e).find('input[name="column-info"]').filter(":checked").val();if("undefined"==typeof i)return void n(!1);i*=1;var a=ColumnManager.getInstance();switch(i){case ColumnInformation.TYPE_COLUMN_TIMELINE:case ColumnInformation.TYPE_COLUMN_MENTION:case ColumnInformation.TYPE_COLUMN_TOME:n(a.addColumnInfo(i,!0));break;case ColumnInformation.TYPE_COLUMN_INBOX:n(a.addInboxColumn(!0));break;case ColumnInformation.TYPE_COLUMN_TASK:var r=$(e).find("#column-info-task").siblings("ul.column-add-new").find('select[name="task"]').val();n(a.addTaskColumn(r,!0));break;case ColumnInformation.TYPE_COLUMN_CHAT:var s=function(e){var t=!1;null!=e&&""!=e&&(a.addChatColumn(e,!0),t=!0),n(t)};o._getChatJid(e,s);break;case ColumnInformation.TYPE_COLUMN_MAIL:n(a.addMailColumn(!0));break;case ColumnInformation.TYPE_COLUMN_RECENT:n(a.addRecentColumn(!0));break;case ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE:n(a.addQuestionnaireColumn(!0));break;case ColumnInformation.TYPE_COLUMN_MURMUR:n(a.addMurmurColumn(LoginUser.getInstance().getJid(),!0));break;default:n(!1)}var l=new ColumnInformation;l.setColumnType(i),NotificationIconManager.getInstance().onColumnClicked(l)}}(),function(){DialogAddColumnForCommunityView.prototype=$.extend({},DialogAddColumnView.prototype);var e=(DialogAddColumnView.prototype,DialogAddColumnForCommunityView.prototype);e.getColumnAddMenuHtml=function(){var e="",t=this;t._tabDetailList.add(new NewTabDetailForCommunity(t._mailCooperationSettingServerList)),e+='<div id="tab-column-add">',e+="<ul>";for(var n=t._tabDetailList.getCount(),o=0;n>o;o++)e+='<li><a href="#'+t._tabDetailHtmlIdList.get(o)+'">'+t._tabDetailList.get(o).getTabName()+"</a></li>";e+="</ul>";for(var o=0;n>o;o++)e+='<div id="'+t._tabDetailHtmlIdList.get(o)+'">'+t._tabDetailList.get(o).getDetailHtml()+"</div>";return e+="</div>"},e.showDialog=function(){this._dialogInnerElement.dialog("open")}}(),function(){NewTabDetailForCommunity.prototype=$.extend({},NewTabDetail.prototype);var e=(NewTabDetail.prototype,NewTabDetailForCommunity.prototype);e._init=function(){},e.getDetailHtml=function(){var e=this,t='<ul class="column-add-new">';return t+='<li style="display :none;>',t+='<input type="radio" name="column-info" value="'+ColumnInformation.TYPE_COLUMN_RECENT+'" id="column-info-recent">',t+='<label for="column-info-recent">'+NewTabDetail.LIST_TITLE_RECENT+"</label>",t+="</li>",t+='<li style="display :none;>',t+='<input type="radio" name="column-info" value="'+ColumnInformation.TYPE_COLUMN_MENTION+'" id="column-info-mention">',t+='<label for="column-info-mention">'+NewTabDetail.LIST_TITLE_MENTION+"</label>",t+="</li>",t+='<li style="display :none;>',t+='<input type="radio" name="column-info" value="'+ColumnInformation.TYPE_COLUMN_INBOX+'" id="column-info-inbox">',t+='<label for="column-info-inbox">'+NewTabDetail.LIST_TITLE_INBOX+"</label>",t+="</li>",t+='<li  style="display :none;">',t+='<input type="radio" name="column-info" value="" id="column-info-send" disabled>',t+='<label for="column-info-send">'+NewTabDetail.LIST_TITLE_SEND+"</label>",t+="</li>",t+='<li  style="display :none;">',t+='<input type="radio" name="column-info" value="" id="column-info-favorite" disabled>',t+='<label for="column-info-favorite">'+NewTabDetail.LIST_TITLE_FAVORITE+"</label>",t+="</li>",t+='<li  style="display :none;">',t+='<input type="radio" name="column-info" value="" id="column-info-hashtag" disabled>',t+='<label for="column-info-hashtag">'+NewTabDetail.LIST_TITLE_HASHTAG+"</label>",t+='<ul class="column-add-new">',t+="<li>",t+="#",t+='<input type="text" name="column-info" value="" class="hashtag-input" disabled>',t+="</li>",t+="</ul>",t+="</li>",t+='<li style="display :none;>',t+='<input type="radio" name="column-info" value="'+ColumnInformation.TYPE_COLUMN_TASK+'" id="column-info-task">',t+='<label for="column-info-task">'+NewTabDetail.LIST_TITLE_TASK+"</label>",t+='<ul class="column-add-new">',t+="<li>",t+='<select name="task" class="ui-corner-all">',t+='<option value="">'+Resource.getMessage("MyTask")+"</option>",t+="</select>",t+="</li>",t+="</ul>",t+="</li>",t+='<li style="display :none;">',t+='<input type="radio" name="column-info" value="" id="column-info-group" disabled>',t+='<label for="column-info-group">'+NewTabDetail.LIST_TITLE_GROUP+"</label>",t+='<ul class="column-add-new">',t+="<li>",t+='<select name="group" disabled>',t+='<option value="">'+Resource.getMessage("Friend")+"</option>",t+='<option value="">'+Resource.getMessage("Family")+"</option>",t+="</select>",t+="</li>",t+="</ul>",t+="</li>",t+='<li style="display :none;">',t+='<input type="radio" name="column-info" value="" id="column-info-list" disabled>',t+='<label for="column-info-list">'+NewTabDetail.LIST_TITLE_LIST+"</label>",t+='<ul class="column-add-new">',t+="<li>",t+='<select name="list" disabled>',t+='<option value="">'+Resource.getMessage("Java")+"</option>",t+='<option value="">'+Resource.getMessage("C")+"</option>",t+="</select>",t+="</li>",t+="</ul>",t+="</li>",t+="<li>",t+='<input type="radio" name="column-info" value="'+ColumnInformation.TYPE_COLUMN_CHAT+'" id="column-info-chat">',t+='<label for="column-info-chat">'+NewTabDetail.LIST_TITLE_CHAT+"</label>",t+="<br />",t+='<ul class="column-add-new">',t+="<li>",t+='<input type="text" class="chat-partner ui-corner-all autocomplete" name="column-info" value="" placeholder="'+Resource.getMessage("dialog_placeholder_account")+'">',t+="</li>",t+="</ul>",t+="</li> <!-- chat -->",null!=e._mailCooperationSettingServerList&&e._mailCooperationSettingServerList.getCount()>0&&(t+='<li style="display :none;>',t+='<input type="radio" name="column-info" value="'+ColumnInformation.TYPE_COLUMN_MAIL+'" id="column-info-mail">',t+='<label for="column-info-mail">'+NewTabDetail.LIST_TITLE_MAIL+"</label>",t+="</li> <!-- mail -->"),t+="</ul>"}}(),function(){DialogRemoveChatListView.prototype=$.extend({},DialogOkCancelView.prototype);var e=(DialogOkCancelView.prototype,DialogRemoveChatListView.prototype);e._init=function(){var e=this;e.frame=e.getInnerHtml(),e.memberList=new ArrayList,e.allMembers=new Array,e.allPersons=new Array;for(var t=0;t<ContactList.getInstance().getCount();t++)e.allMembers.push(ContactList.getInstance().get(t)),e.allPersons.push(ContactList.getInstance().get(t));e._dialogAreaElement.html(e.frame),e._dialogInnerElement=e._dialogAreaElement.children(),e._createMemberElement(e.allMembers),e.ps=new PerfectScrollbar(e.frame.find(".scroll_content")[0],{
suppressScrollX:!0}),dlg_scr.push(e.ps),e._createEventHandler()},e.cleanup=function(){var e=this;e.ps&&e.ps.destroy(),e.selectUserListView.cleanUp(),e.selectUserListView=null,e._dialogAreaElement=null,e._dialogInnerElement=null,e.frame=null},e.getInnerHtml=function(){var e='<div id="removeprojectmember_modal" class="card modal_card">          <div class="card_title">            <p> '+Resource.getMessage("dialog_title_remove_chatlist_user")+' </p>          </div>          <div class="select_menu">            <span class="select_number"><i class="fa fa-user"></i><span class="checkedCnt">0</span></span>            <form action="#" method="get" class="search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("wizard_chatlist_conditions_account")+'">              <button type="button" name="search" class="user_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>            <label class="modal_btn all_check">'+Resource.getMessage("wizard_chatlist_allcheck")+'<label class="checkbox"><input name="allcheck" type="checkbox"><span></span></label></label>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>            <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_remove_user")+'</span></button>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},e._createMemberElement=function(e){var t=this,n=LoginUser.getInstance(),o=n.getJid();$.each(e,function(e,n){if(o!==n.getJid()){var i=n._profile,a=Utils.getSafeStringData(i._nickName);a=Utils.convertEscapedHtml(a);var r="@"+i._loginAccount,s=ViewUtils.getAvatarDataHtmlFromPerson(n),l='<li title="'+a+" "+r+'"><label>                   <span class="ico ico_user"></span>                    <span class="name">'+a+'</span>                    <span class="group"></span>                    <label class="checkbox">                   <input type="checkbox" name="removeuser"><span></span></label>                    </label></li>',u=$(l);t._dialogInnerElement.find(".select_list").append(u);u.find(".ico_user").append(s),u.find(".group").text(r).html(),u.find("input:checkbox").val(n._jid),0<=t.memberList._array.indexOf(n.getJid())&&u.find("input:checkbox").prop("checked",!0),u.find("input[name=removeuser]").off("change"),u.find("input[name=removeuser]").on("change",function(){var e=this.value;this.checked?t.memberList.add(this.value):t.memberList._array.forEach(function(n,o){n===e&&t.memberList.remove(o)});var n=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(n)})}})},e._createEventHandler=function(){var e=this;e.frame.find(".success_btn").on("click",function(){e.frame.find("#dialog-error").text(""),e.removeChatListMember()}),e._dialogInnerElement.find(".user_search_btn").off("click"),e._dialogInnerElement.find(".user_search_btn").on("click",function(){e.filterMembers()}),e._dialogInnerElement.find("input.field").keypress(function(t){return(t.which&&13===t.which||t.keyCode&&13===t.keyCode)&&e.filterMembers(),13!==t.which}),e._dialogInnerElement.find("input[name=allcheck]").off("change"),e._dialogInnerElement.find("input[name=allcheck]").on("change",function(){e._dialogInnerElement.find("input[name=removeuser]").prop("checked",this.checked);var t=e._dialogInnerElement.find("input[name=removeuser]");if(this.checked)for(var n=0;n<t.length;n++)0===e.memberList._array.filter(function(e){return e===t[n].value}).length&&e.memberList.add(t[n].value);else for(var n=0;n<t.length;n++)e.memberList.remove(e.memberList._array.indexOf(t[n].value));var o=e.memberList.getCount();e._dialogInnerElement.find(".checkedCnt").text(o)})},e.filterMembers=function(){var e=this;e.personCount=0,e._dialogInnerElement.find(".select_list").empty(),e._dialogInnerElement.find("input[name=allcheck]").prop("checked",!1);var t=e.frame.find(".field").val(),n=e.allMembers.filter(function(e){var n=Utils.getSafeStringData(e.getUserName()),o=e._profile.getLoginAccount();return 0<=n.indexOf(t)||0<=o.indexOf(t)});e.allPersons=n,e._createMemberElement(e.allPersons),e.frame.find(".scroll_content").scrollTop(0)},e.removeChatListMember=function(){var e=this;e.frame.find("#dialog-error").text("");for(var t=new ArrayList,n=0;n<e.memberList.getCount();n++)t.add({jid:e.memberList.get(n)});if(t.getCount()>0){var o=function(t,n){if(t.removeSuccessMemberList.getCount()>0)for(var o=TabManager.getInstance().selectedInfo,i=o.getSideListViewImpl().sidebarParts,a=0;a<i.length;a++)"function"==typeof i[a].onNotifyRemoveChatMember&&i[a].onNotifyRemoveChatMember(t.removeSuccessMemberList);if(t.removeFailureMemberList.getCount()>0){var r=Resource.getMessage("wizard_chatList_add_failed"),s=n?n:"";e.frame.find("#dialog-error").text(r+s)}else ViewUtils.modal_allexit()};CubeeController.getInstance().removeContactListMember(t,o)}else e.frame.find("#dialog-error").text(Resource.getMessage("err_not_selected_user"))},$(function(){var e=$("#left_sidebar").find(".contact_list .list_ttl a.list_remove");e.on("click",function(){var e=new DialogRemoveChatListView;e.showDialog()})})}(),function(){DialogDeleteCheckView.prototype=$.extend({},DialogOkCancelView.prototype);var e=DialogOkCancelView.prototype,t=DialogDeleteCheckView.prototype;t._init=function(){function t(e){console.log("message was deleted : "+e)}var n=this;e._init.call(n),this._dialogAreaElement.html(n.getDeleteMessageCheckHtml()),this._dialogInnerElement=this._dialogAreaElement.children(),n._dialogInnerElement.find("#delete_ok_btn").on("click",function(){var e=1,o=n._deleteMessage.getType();switch(o){case Message.TYPE_PUBLIC:case Message.TYPE_CHAT:case Message.TYPE_GROUP_CHAT:case Message.TYPE_COMMUNITY:case Message.TYPE_QUESTIONNAIRE:case Message.TYPE_MURMUR:e=2}0==CubeeController.getInstance().deleteMessage(n._deleteMessage,e,t)&&console.log("message was not deleted"),ViewUtils.modal_allexit()}),n._dialogInnerElement.find("#delete_cancel_btn").on("click",function(){ViewUtils.modal_allexit()})},t.getDeleteMessageCheckHtml=function(){var e=this,t=Resource.getMessage("dialog_delete_conf_message");if("function"==typeof e._deleteMessage.getCommunityId&&"function"==typeof e._deleteMessage.getStatus&&e._deleteMessage.getStatus()!=TaskMessage.STATUS_INBOX){var n=e._deleteMessage.getCommunityId();null!=n&&""!=n&&(t=Resource.getMessage("dialog_delete_conf_message_for_community"),e._width=420,e._height=170)}var o="";return o+='<div id="msgdelete_modal" class="card modal_card">',o+='  <div class="card_title">',o+="    <p>"+Resource.getMessage("dialog_confirmation_title")+"</p>",o+="  </div>",o+='  <div class="modal_content_wrapper">',o+='    <p class="txt">'+t+"</p>",o+="  </div>",o+='  <div class="btn_wrapper">',o+='    <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',o+='    <button type="button" id="delete_cancel_btn" class="modal_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_cancel")+"</span></button>",o+='    <button type="button" id="delete_ok_btn" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+"</span></button>",o+="  </div>",o+='  <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',o+="</div>"}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogPasswordView.prototype=$.extend({},DialogSettingView.prototype);var e=DialogSettingView.prototype,t=DialogPasswordView.prototype;t._init=function(){var t=this;e._init.call(t)},t.getInnerHtml=function(){var e="";return e+='<div id="password_modal" class="card modal_card">',e+='  <form class="form-horizontal horizonal-form ui-dialog-content ui-widget-content" id="user_profile" scrolltop="0" scrollleft="0">',e+='    <div class="card_title">',e+="      <p>"+Resource.getMessage("config_password_title")+"</p>",e+="    </div>",e+='    <div class="modal_content_wrapper">',e+='      <div class="modal_content">',e+='        <p class="modal_title">'+Resource.getMessage("config_password_current_label")+"</p>",e+='        <input type="password" id="current_password" class="field ui-corner-all">',e+="      </div>",e+='      <div class="modal_content">',e+='        <p class="modal_title">'+Resource.getMessage("config_password_new_label")+"</p>",e+='        <input type="password" id="new_password" class="field ui-corner-all">',e+="      </div>",e+='      <div class="modal_content">',e+='        <p class="modal_title">'+Resource.getMessage("config_password_new_confirm_label")+"</p>",e+='        <input type="password" id="new_password_confirm" class="field ui-corner-all">',e+="      </div>",e+='      <p class="notes">'+Resource.getMessage("config_password_notes")+"</p>",e+="    </div>",e+='    <div class="btn_wrapper">',e+='      <br><p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',e+='      <button id="password_button" type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("config_submit_buttom")+"</span></button>",e+="    </div>",e+='    <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',e+="  </form>",e+="</div>"},t._createEventHandler=function(){var e=this,t=e._dialogInnerElement;t.on("click","#password_button",function(){e.submit(e._dialogAreaElement)})},t.submit=function(e){function t(e,t){if(e)LoginTicket.password(s),ViewUtils.modal_allexit();else{var n=Resource.getMessage("config_password_change_failed");if(8==t){n=Resource.getMessage("config_current_password_invalid");var i=o.find("#current_password");i.addClass("input-error")}else 32==t&&(n=Resource.getMessage("config_password_complexity"));o.find("#dialog-error").text(n)}}var n=this,o=n._dialogInnerElement;if(n._checkPassword(o)){var i=o.find("#current_password"),a=o.find("#new_password"),r=i.val(),s=a.val();CubeeController.getInstance().changePassword(r,s,t)}},t._checkPassword=function(e){if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=!1,n=e.find("#current_password"),o=e.find("#new_password"),i=e.find("#new_password_confirm"),a=n.val(),r=o.val(),s=i.val();return e.find("#dialog-error").text(""),n.removeClass("input-error"),o.removeClass("input-error"),i.removeClass("input-error"),null==a||""==a?(n.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("config_password_current_must"))):null==r||""==r?(o.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("config_password_new_must"))):ViewUtils.checkLength(o,LoginView.MIN_LENGTH_PASSWORD,LoginView.MAX_LENGTH_PASSWORD)?ViewUtils.checkRegexp(o,/([!-~])+$/)?r!=s?(o.addClass("input-error"),i.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("config_password_new_confirm_must"))):t=!0:(o.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("loginErrPasswordContain"))):(o.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("loginErrPasswordLength1")+LoginView.MIN_LENGTH_PASSWORD+Resource.getMessage("loginErrPasswordLength2")+LoginView.MAX_LENGTH_PASSWORD+".")),t}}(),function(){DialogProfileView.prototype=$.extend({},DialogSettingView.prototype);var e=DialogSettingView.prototype,t=DialogProfileView.prototype;t._init=function(){var t=this;if(e._init.call(t),!ViewUtils.isIE89()){var n=t._dialogInnerElement.find("#avater_edit_area div.block-avatar"),o='<button id="changeAvaterPhoto" class="profile_change_avater_btn">'+Resource.getMessage("config_profile_image_label")+"</button>";n.append(o),t._dialogInnerElement.find("button").button()}t.getGroupList()},t.getGroupList=function(){var e=this,t=e._dialogInnerElement,n=t.find("#group");CubeeController.getInstance().getGroupList().then(function(e){for(var t=e.content.groups,o=0;o<t.length;o++)t[o]=Utils.urldecode(Utils.getSafeStringData(t[o]));var i=new RegExp(",");n.autocomplete({lookup:t,minChars:1,delimiter:i,lookupFilter:function(e,t,n){return t.length>=1&&t.match(/^\s*$/)&&e.value.match(/^\s*$/)||t.length>=1&&!t.match(/^[^\x01-\x7E\xA1-\xDF]+$/)&&!e.value.match(/^[^\x01-\x7E\xA1-\xDF]+$/)||t.length>=101&&e.length>=101?void 0:-1!==e.value.toUpperCase().indexOf(t)}})})["catch"](function(e){t.find("#dialog-error").text(Resource.getMessage("config_profile_group_list_err")),n.addClass("input-error")})},t.getInnerHtml=function(){var e=LoginUser.getInstance().getUserName();e=Utils.convertEscapedTag(e);var t=LoginUser.getInstance().isUpdatablePersonData(),n="";n+='<div id="profile_modal" class="card modal_card">',n+='  <div class="card_title">',n+="    <p>"+Resource.getMessage("config_profile_title")+"</p>",n+="  </div>",n+='  <div class="modal_content_wrapper">',n+='    <div class="modal_content">',n+='      <p class="modal_title">'+Resource.getMessage("config_profile_nickname_label")+"</p>",n+=t?'      <input type="text" maxlength="20" class="field ui-corner-all" id="nick_name" value="'+e+'">':'      <input type="text" maxlength="20" class="field ui-corner-all" id="nick_name" disabled value="'+e+'">',n+="    </div>";var o=LoginUser.getInstance().getMailAddress();o=Utils.convertEscapedTag(o),n+='    <div class="modal_content">',n+='      <p class="modal_title">'+Resource.getMessage("config_profile_mail_address")+"</p>",n+=t?'      <input type="text" maxlength="256" class="field ui-corner-all" id="mail_address" value="'+o+'">':'      <input type="text" maxlength="256" class="field ui-corner-all" id="mail_address" disabled value="'+o+'">',n+="    </div>";var i=LoginUser.getInstance().getGroup(),a=i.join(",");a=Utils.convertEscapedTag(a),n+='    <div class="modal_content">',n+='      <p class="modal_title">'+Resource.getMessage("config_profile_group")+"</p>",n+=t?'      <input type="text" maxlength="504" class="field ui-corner-all" id="group" value="'+a+'">':'      <input type="text" maxlength="504" class="field ui-corner-all" id="group" disabled value="'+a+'">',n+='      <p class="notes" style="margin-left: 10px" >'+Resource.getMessage("config_profile_group_notes")+"</p>",n+="    </div>";var r=AuthorityInfo.getInstance();n+='    <div class="modal_content w50">',n+='      <p class="modal_title">'+Resource.getMessage("config_account_type")+"</p>",n+='      <p class="fwb mb0">'+Utils.convertEscapedHtml(r.getRoleName())+"</p>",n+="    </div>";var s=LoginUser.getInstance().getPresence();n+='    <div class="modal_content w50">',n+='      <p class="modal_title">'+Resource.getMessage("config_user_status")+"</p>",n+='      <select class="field" id="profile_status">',n+='        <option value="1">'+Resource.getMessage("presence_online")+"</option>",n+='        <option value="2">'+Resource.getMessage("presence_staway")+"</option>",n+='        <option value="3">'+Resource.getMessage("presence_exaway")+"</option>",n+='        <option value="4">'+Resource.getMessage("presence_nodisturb")+"</option>",n+="      </select>",n+="    </div>";var l=LoginUser.getInstance().getMyMemo();return l=Utils.convertEscapedTag(l),n+='    <div class="modal_content">',n+='      <p class="modal_title">'+Resource.getMessage("my_memo_placeholder")+"</p>",n+='      <input type="text" class="field" id="profile_memo" value="'+l+'">',n+="    </div>",n+='    <div class="modal_content">',n+='      <p class="modal_title">'+Resource.getMessage("config_profile_avater_label")+"</p>",n+='      <div class="cropped_wrapper">',n+='        <div id="profile-logo-field">',n+='          <input type="file" name="logofile" class="avatar_file_prof" size="30" accept="image/jpeg, image/gif, image/png">',n+="        </div>",n+='        <div class="img_edit_area">',n+='          <div class="imageBox imageBox_prof">',n+='            <div class="thumbBox"></div>',n+='            <div class="spinner" style="display: none">Loading...</div>',n+="          </div>",n+='          <div class="action">',n+='            <button class="modal_btn zoom_btn" id="btnZoomIn"><i class="fa fa-plus"></i> '+Resource.getMessage("config_avator_zoom_in")+"</button>",n+='            <button class="modal_btn zoom_btn" id="btnZoomOut"><i class="fa fa-minus"></i> '+Resource.getMessage("config_avator_zoom_out")+"</button>",n+='            <button class="modal_btn success_btn" id="btnCrop">'+Resource.getMessage("dialog_label_ok")+"</button>",n+="          </div>",n+="        </div>",n+='        <div class="cropped"></div>',n+="      </div>",n+="    </div>",window.Notification&&(n+='    <div class="modal_content">',n+='      <p class="modal_title">'+Resource.getMessage("push_notification_setting_title")+"</p>",n+='<div class="select-quote-target">                      <label for="notification_on" class="radio">                      <input type="radio" name="push_notification_setting" id="notification_on" value='+Message.TYPE_COMMUNITY+">                      <span></span>"+Resource.getMessage("push_notification_on")+'</label>                      <label for="notification_off" class="radio">                      <input type="radio" name="push_notification_setting" id="notification_off" value='+Message.TYPE_GROUP_CHAT+" checked>                      <span></span>"+Resource.getMessage("push_notification_off")+"</label>                    </div>",n+="    </div>"),TabManager.getInstance().isActiveMyWorkplace()&&(n+='    <div class="modal_content">',n+='      <p class="modal_title">'+Resource.getMessage("config_dashboard_background_image")+"</p>",n+='<div id="background_image" class="select-quote-target">                      <label for="bg_1" class="radio">                      <input type="radio" name="background_setting" id="bg_1" value="dashboard_wrapper" checked>                      <span></span>1</label>                      <label for="bg_2" class="radio">                      <input type="radio" name="background_setting" id="bg_2" value="dashboard_wrapper2">                      <span></span>2</label>                      <label for="bg_3" class="radio">                      <input type="radio" name="background_setting" id="bg_3" value="dashboard_wrapper3">                      <span></span>3</label>                      <label for="bg_4" class="radio">                      <input type="radio" name="background_setting" id="bg_4" value="dashboard_wrapper4">                      <span></span>4</label>                      <label for="bg_5" class="radio">                      <input type="radio" name="background_setting" id="bg_5" value="dashboard_wrapper5">                      <span></span>5</label>                      <label for="bg_6" class="radio">                      <input type="radio" name="background_setting" id="bg_6" value="dashboard_wrapper6">                      <span></span>6</label>                      <label for="bg_7" class="radio">                      <input type="radio" name="background_setting" id="bg_7" value="dashboard_wrapper7">                      <span></span>7</label>                      <label for="bg_8" class="radio">                      <input type="radio" name="background_setting" id="bg_8" value="dashboard_wrapper8">                      <span></span>8</label>                    </div>',n+="    </div>"),n+="  </div>",n+='  <div class="btn_wrapper">',n+='    <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',n+='    <button class="modal_btn success_btn" id="profile_button">'+Resource.getMessage("config_submit_buttom")+"</button>",n+="  </div>",n+='  <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',n+="</div>",n=$(n),n.find("select#profile_status").val(s).prop("selected",!0),n.find('div#background_image input[value="'+LoginUser.getInstance().getExtras().backgroundImage+'"]').prop("checked",!0),n},t.submit=function(e){function t(e){if(e){var t=Number(a.find("#profile_status").children("option:selected").val()),n=Utils.convertPresenceNumToStr(t),i=a.find("#profile_memo").val(),r=CubeeController.getInstance().changePresence(n,i);if(r)if(CubeeController.getInstance().clearPrePresence(),ColumnMessageView.updateMessageAvatarToolTip(LoginUser.getInstance().getJid()),o._backgroundPath){var s=(LoginUser.getInstance().getExtras(),{});s.backgroundImage=o._backgroundPath,CubeeServerConnector.getInstance().setLoginUserExtras(s).then(function(e){var t=e.content.extras;if(t)try{t=JSON.parse(t),LoginUser.getInstance().setExtras(t),ViewUtils.modal_allexit()}catch(n){t={}}})}else ViewUtils.modal_allexit();else a.find("#dialog-error").text(Resource.getMessage("config_profile_change_failed"))}else a.find("#dialog-error").text(Resource.getMessage("config_profile_change_failed"))}function n(e){return a.find("#avatarupload_accesstoken").val(""),a.find("#avatarupload_account").val(""),"success"!=e.result?void a.find("#dialog-error").text(Resource.getMessage("config_profile_change_failed")):(i.setAvatarType("imagepath"),i.setAvatarData(e.path),void CubeeController.getInstance().changeProfile(i,t))}var o=this,i=new Profile,a=o._dialogInnerElement,r=a.find("#nick_name"),s=Utils.excludeControleCharacters(r.val());i.setNickName(s),r.removeClass("input-error");var l=a.find("#mail_address"),u=l.val();if(i.setMailAddress(u),l.removeClass("input-error"),0==Utils.trimStringMulutiByteSpace(s).length)return r.addClass("input-error"),void a.find("#dialog-error").text(Resource.getMessage("config_profile_nickname_empty"));var c=a.find("#group"),d=c.val();if(d){var g=d;if(d=g.split(","),d.length>5)return a.find("#dialog-error").text(Resource.getMessage("config_profile_group_empty")),void c.addClass("input-error");for(var m=0;m<d.length;m++){if(d[m].match(/^\s*$/))return a.find("#dialog-error").text(Resource.getMessage("config_profile_group_must")),void c.addClass("input-error");if(!d[m].match(/^[^\x01-\x7E\xA1-\xDF]+$/))return a.find("#dialog-error").text(Resource.getMessage("config_profile_group_txt")),void c.addClass("input-error");if(d[m].length>100)return a.find("#dialog-error").text(Resource.getMessage("config_profile_group_complexity")),void c.addClass("input-error");d[m]=encodeURIComponent(d[m])}}else d=[];if(i.setGroup(d),ViewUtils.isIE89())if(""!=a.find("#inputAvaterIE").val()){var _=CubeeServerConnector.getInstance();a.find("#avatarupload_accesstoken").val(_._accessToken),a.find("#avatarupload_account").val(_._user),CubeeController.getInstance().uploadAvatarIE(a.find("#avaterfields"),n)}else i.setAvatarType(o._avaterType),i.setAvatarData(o._avaterData),CubeeController.getInstance().changeProfile(i,t);else i.setAvatarType(o._avaterType),i.setAvatarData(o._avaterData),CubeeController.getInstance().changeProfile(i,t)},t._avatorImage=function(e){var t,n=this,o={imageBox:".imageBox_prof",thumbBox:".thumbBox",spinner:".spinner",imgSrc:""};$(".img_edit_area, .cropped").hide(),$(".avatar_file_prof").click(function(){e.find("#dialog-error").text(""),cropper="",$(this).val(""),$(this).parents(".cropped_wrapper").find(".cropped").hide(),$(this).parents(".cropped_wrapper").find(".img_edit_area").hide(),n._avaterData="",n._avaterType=""}),$(".avatar_file_prof").change(function(){if(this.files.length>0){var n=this.files[0];switch(n.type){case"image/jpeg":case"image/gif":case"image/png":case"image/bmp":break;default:return void e.find("#dialog-error").text(Resource.getMessage("config_profile_image_failed"))}reader_prof=new FileReader,reader_prof.onload=function(e){o.imgSrc=e.target.result,t=new cropbox(o)},reader_prof.readAsDataURL(this.files[0]),$(this).parents(".cropped_wrapper").find(".cropped").hide(),$(this).parents(".cropped_wrapper").find(".img_edit_area").fadeIn()}}),$(".modal_content #btnCrop").on("click",function(){e.find("#dialog-error").text(Resource.getMessage(""));var o=t.getDataURL();$(this).parents(".img_edit_area").nextAll(".cropped").replaceWith('<div class="cropped"><img src="'+o+'" class="mCS_img_loaded"></div>'),$(this).parents(".img_edit_area").hide(),$(this).parents(".img_edit_area").nextAll(".cropped").fadeIn();var i=o.split(";")[0];i=i.split(":")[1];var a=o.split(",")[1];n._avaterData=a,n._avaterType=i}),$(".modal_content #btnZoomIn").on("click",function(){t.zoomIn()}),$(".modal_content #btnZoomOut").on("click",function(){t.zoomOut()})},t._createEventHandler=function(){var e=this,t=e._dialogInnerElement;e._avatorImage(t),window.Notification&&(PushNotificationSettingManager.getInstance().isSetting(LoginUser.getInstance().getJid())&&t.find('input[id="notification_on"]').prop("checked",!0),t.on("change",'input[name="push_notification_setting"]:radio',function(){$(this);switch($(this).attr("id")){case"notification_on":Notification.requestPermission(function(e){return"denied"===e?void alert(Resource.getMessage("push_notification_alert_blocking")):void("default"!==e&&"granted"===e&&PushNotificationSettingManager.getInstance().appendSetting(LoginUser.getInstance().getJid()))});break;case"notification_off":PushNotificationSettingManager.getInstance().removeSetting(LoginUser.getInstance().getJid())}})),t.on("change",'input[name="background_setting"]:radio',function(){$(this);switch($('div[name="mainWrapper"]').removeClass(function(e,t){return(t.match(/\bdashboard_w\S+/g)||[]).join(" ")}),$(this).attr("id")){case"bg_1":e._backgroundPath="dashboard_wrapper";break;case"bg_2":e._backgroundPath="dashboard_wrapper2";break;case"bg_3":e._backgroundPath="dashboard_wrapper3";break;case"bg_4":e._backgroundPath="dashboard_wrapper4";break;case"bg_5":e._backgroundPath="dashboard_wrapper5";break;case"bg_6":e._backgroundPath="dashboard_wrapper6";break;case"bg_7":e._backgroundPath="dashboard_wrapper7";break;case"bg_8":e._backgroundPath="dashboard_wrapper8"}return TabManager.getInstance().isActiveMyWorkplace()?void $('div[name="mainWrapper"]').addClass(e._backgroundPath):void 0}),t.on("click","#profile_button",function(){e.submit(e._dialogAreaElement)})}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogSettingFilterView.prototype=$.extend({},DialogSettingView.prototype);var e=DialogSettingView.prototype,t=DialogSettingFilterView.prototype;t._init=function(){var t=this;e._init.call(t);var n=t._dialogInnerElement,o=n.find("input#"+t._dialogID);o.on("keypress",function(e){(e.which&&13==e.which||e.keyCode&&13==e.keyCode)&&t._searchExecute()}),t._dialogInnerElement.find(".modal_btn").on("click",function(){t._searchExecute()})},t.getInnerHtml=function(){var e=ViewUtils.getAutoCompleteAttributesFromColumnInfo(this._columnInfo),t="";return t='<div id="colsearch_modal" class="card modal_card">',t+='  <div class="card_title">',t+="    <p>"+this._title+"</p>",t+="  </div>",t+='  <div class="modal_content_wrapper">',t+='    <div class="modal_content">',t+='      <p class="modal_title">'+Resource.getMessage("dialog_label_keyword")+"</p>",t+='      <input type="text" id="keyword-input" class="field ui-corner-all '+e.autoCompleteType+'" '+e.roomIdAttribute+">",t+="    </div>",t+='    <div class="modal_content mb0">',t+='      <p class="mb0">'+Resource.getMessage("dialog_label_keyword_and")+"<br>",t+="        "+Resource.getMessage("dialog_label_keyword_or")+"</p>",t+="    </div>",t+="  </div>",t+='  <div class="btn_wrapper">',t+='    <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',t+='    <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+"</span></button>",t+="  </div>",t+='  <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',t+="</div>"},t._searchExecute=function(){var e=this,t=e._dialogInnerElement;if(!e._checkKeyword(t))return!1;var n=t.find("input#"+e._dialogID),o=Utils.trimStringMulutiByteSpace(n.val()),i=new FilterColumnInfomation;i.setSourceColumnType(e._columnInfo.getColumnType()),i.setSourceColumnDisplayName(e._getDisplayName()),i.setKeyword(o);var a=new AndCondition,r=e._columnInfo.getColumnType(),s={};if(r==ColumnInformation.TYPE_COLUMN_CHAT)s.partner=e._columnInfo.getFilterCondition();else if(r==ColumnInformation.TYPE_COLUMN_GROUP_CHAT){var l=e._columnInfo.getChatRoomInfomation(),u=l.getRoomId();s.roomId=u}else if(r==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED){var l=e._columnInfo.getCommunityInfomation(),u=l.getRoomId();s.roomId=u}else if(r==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK){var l=e._columnInfo.getCommunityInfomation(),u=l.getRoomId();s.roomId=u}i.setSubData(s);var c=ColumnFilterManager.getColumnFilter(r,s);if(null==c)return!1;a.addChildCondition(c);var d=ViewUtils.getKeywordFilterFromKeywordInputString(o);a.addChildCondition(d);var g=new ColumnSortCondition,m=new ColumnSearchCondition(a,g);return i.setSearchCondition(m),ColumnManager.getInstance().insertAfterColumn(i,e._ownerObj,!0,!0),ViewUtils.modal_allexit(),!0},t._getDisplayName=function(){var e=this,t=e._columnInfo.getDisplayName();return(e._columnInfo.getColumnType()==ColumnInformation.TYPE_COLUMN_TASK||e._columnInfo.getColumnType()==ColumnInformation.TYPE_COLUMN_INBOX)&&(t=ViewUtils.createDisplayName(e._columnInfo)),t},t._checkKeyword=function(e){if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=e.find("input#keyword-input"),n=t.val();if(e.find("#dialog-error").text(""),t.removeClass("input-error"),null==n||""==n||""==Utils.trimStringMulutiByteSpace(n))return t.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("dialogerrorSearch")),!1;n=Utils.trimStringMulutiByteSpace(n);var o=ViewUtils.getKeywordListFromKeywordInputString(n);if(null==o)return t.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("dialogerrorSearch")),!1;var i=o.getCount();if(1>i)return t.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("dialogerrorSearch")),!1;for(var a=0;i>a;a++){var r=o.get(a),s=encodeURIComponent(r);if(s.length<=1)return t.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("dialogerrorSearchOneChar")),!1}return!0}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogSettingFilterTaskView.prototype=$.extend({},DialogSettingView.prototype);var e=DialogSettingView.prototype,t=DialogSettingFilterTaskView.prototype;t._init=function(){var t=this;e._init.call(t);var n=t._dialogInnerElement,o=n.find("input.date-picker");o.datepicker({showOn:"focus",dateFormat:Utils.DISPLAY_DATEPICKER_DATE_FORMAT,showButtonPanel:!0});var i=null,a=null,r=null,s=null,l=null,u=null,c=null,d=!1,g=!1,m=DialogSettingCustomFilterView.TERM_DATA_NONE_VALUE,_=null;null!=t._columnInfo.getSetting&&"function"==typeof t._columnInfo.getSetting&&(_=t._columnInfo.getSetting()),_&&(i=_.client,a=_.owner,r=_.status,s=_.priority,l=_.request_type,u=_.demand_status,c=_.due_date,
d=null!=_.attached_file?_.attached_file:d,g=null!=_.having_url?_.having_url:g,m=null!=_.term?_.term:m),t._setClientJid(i),t._setOwnerJid(a),t._setStatusArray(r),t._setPriorityArray(s),t._setRequestTypeArray(l),t._setDemandStatusArray(u),t._setDueDateStr(c),t._setHavingAttachedFileCheckStatus(d),t._setHavingUrlCheckStatus(g),t._setTermData(m),t._createEventHandler()},t._displayFieldClient=function(){var e=ViewUtils.getAutoCompleteAttributesFromColumnInfo(this._columnInfo),t="";return t+="<li>",t+='  <label for="client">',t+='    <label class="checkbox checkbox_title">',t+='      <input type="checkbox" class="target" id="client" name="sender-checkbox">',t+="      <span></span>"+Resource.getMessage("task_client"),t+="    </label>",t+='    <input type="text" class="field client-input ui-corner-all '+e.autoCompleteType+'" placeholder="'+Resource.getMessage("dialog_placeholder_account")+'" '+e.roomIdAttribute+">",t+="  </label>",t+="</li>"},t._displayFieldOwner=function(){var e=ViewUtils.getAutoCompleteAttributesFromColumnInfo(this._columnInfo),t="";return t+="<li>",t+='  <label for="owner">',t+='    <label class="checkbox checkbox_title">',t+='      <input type="checkbox" class="target" id="owner" name="sender-checkbox">',t+="      <span></span>"+Resource.getMessage("task_owner"),t+="    </label>",t+='    <input type="text" class="field owner-input ui-corner-all '+e.autoCompleteType+'" placeholder="'+Resource.getMessage("dialog_placeholder_account")+'" '+e.roomIdAttribute+">",t+="  </label>",t+="</li>"},t._displayFieldStatus=function(){var e="";return e+="<li>",e+='<label for="status">',e+='  <label class="checkbox checkbox_title"><input type="checkbox" class="target" id="status"><span></span>'+Resource.getMessage("task_status")+"</label>",e+='  <label class="checkbox checkbox_btn"><input type="checkbox" name="status" value="'+TaskMessage.STATUS_ASSIGNING+'"><span></span>'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_ASSIGNING)+"</label>",e+='  <label class="checkbox checkbox_btn"><input type="checkbox" name="status" value="'+TaskMessage.STATUS_NEW+'"><span></span>'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_NEW)+"</label>",e+='  <label class="checkbox checkbox_btn"><input type="checkbox" name="status" value="'+TaskMessage.STATUS_DOING+'"><span></span>'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_DOING)+"</label>",e+='  <label class="checkbox checkbox_btn"><input type="checkbox" name="status" value="'+TaskMessage.STATUS_FINISHED+'"><span></span>'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_FINISHED)+"</label>",e+='  <label class="checkbox checkbox_btn"><input type="checkbox" name="status" value="'+TaskMessage.STATUS_REJECTED+'"><span></span>'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_REJECTED)+"</label>",e+="</label>",e+="</li>"},t._displayFieldPriority=function(){var e="";return e+="<li>",e+='<label for="priority">',e+='  <label class="checkbox checkbox_title"><input type="checkbox" class="target" id="priority"><span></span>'+Resource.getMessage("task_priority_title")+"</label>",e+='  <label class="checkbox checkbox_btn"><input type="checkbox" name="priority" value="'+TaskMessage.PRIORITY_TOP+'"><span></span>'+ViewUtils.taskPriorityNumToStr(TaskMessage.PRIORITY_TOP)+"</label>",e+='  <label class="checkbox checkbox_btn"><input type="checkbox" name="priority" value="'+TaskMessage.PRIORITY_HIGH+'"><span></span>'+ViewUtils.taskPriorityNumToStr(TaskMessage.PRIORITY_HIGH)+"</label>",e+='  <label class="checkbox checkbox_btn"><input type="checkbox" name="priority" value="'+TaskMessage.PRIORITY_MEDIUM+'"><span></span>'+ViewUtils.taskPriorityNumToStr(TaskMessage.PRIORITY_MEDIUM)+"</label>",e+='  <label class="checkbox checkbox_btn"><input type="checkbox" name="priority" value="'+TaskMessage.PRIORITY_LOW+'"><span></span>'+ViewUtils.taskPriorityNumToStr(TaskMessage.PRIORITY_LOW)+"</label>",e+="</label>",e+="</li>"},t._displayFieldRequestType=function(){var e="";return e+="<li>",e+='<label for="request_type">',e+='  <label class="checkbox checkbox_title"><input type="checkbox" class="target" id="request_type"><span></span>'+Resource.getMessage("task_request_type")+"</label>",e+='  <label class="checkbox checkbox_btn"><input type="checkbox" name="request_type" value="client"><span></span>'+Resource.getMessage("task_request_type_client")+"</label>",e+='  <label class="checkbox checkbox_btn"><input type="checkbox" name="request_type" value="owner"><span></span>'+Resource.getMessage("task_request_type_owner")+"</label>",e+='  <label class="checkbox checkbox_btn"><input type="checkbox" name="request_type" value="self"><span></span>'+Resource.getMessage("task_request_type_self")+"</label>",e+="</label>",e+="</li>"},t._displayFieldDemandStatus=function(){var e="";return e+="<li>",e+='<label for="demand_status">',e+='  <label class="checkbox checkbox">',e+='    <input type="checkbox" id="demand_status" name="demand_status" value="1">',e+="    <span></span>"+Resource.getMessage("task_demand_status"),e+="  </label>",e+="</label>",e+="</li>"},t._displayFieldDueDate=function(){var e="";return e+="<li>",e+='<label for="due_date">',e+='    <label class="checkbox checkbox_title"><input type="checkbox" class="target" id="due_date"><span></span>'+Resource.getMessage("task_due_date_date")+"</label>",e+='    <input type="text" class="field task-due-date task-register-item ui-corner-all date-picker">'+Resource.getMessage("task_due_date_to"),e+="</label>",e+="</li>"},t._displayFieldUrl=function(){var e="";return e+="<li>",e+="<div>",e+='  <span class="name">'+Resource.getMessage("custom_filter_label_having_attached_file_and_url")+"</span>",e+='    <label class="checkbox checkbox_btn"><input type="checkbox" id="having-attached-file-checkbox" name="having-attached-file" value="'+DialogSettingCustomFilterView.SETTING_VALUE_HAVING_ATTACHED_FILE+'"><span></span>'+Resource.getMessage("custom_filter_label_having_attached_file")+"</label>",e+='    <label class="checkbox checkbox_btn"><input type="checkbox" id="having-url-checkbox" name="having-url" value="'+DialogSettingCustomFilterView.SETTING_VALUE_HAVING_ATTACHED_FILE+'"><span></span>'+Resource.getMessage("custom_filter_label_having_url")+"</label>",e+="  </div>",e+="</li>"},t._displayFieldTerm=function(){var e="";e+="<li>",e+='<label for="termCheckbox">',e+='  <label class="checkbox checkbox_title">',e+='    <input type="checkbox" class="target" id="termCheckbox" name="term-checkbox" value="1">',e+="    <span></span>"+Resource.getMessage("task_created_term"),e+="  </label>",e+='  <select class="field term-select ui-corner-all">';for(var t=DialogSettingCustomFilterView.TERM_DATA_ARRAY,n=0;n<t.length;n++){var o=t[n],i=0==n?"selected":"";e+='<option value="'+o.value+'" '+i+' style="margin-top:0;">'+o.label+"</option>"}return e+="  </select>",e+="</label>",e+="</li>"},t.displaySubmitButton=function(){var e="";return e+='<div class="btn_wrapper">',e+='  <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',e+='  <button type="button" id="task_filter_btn" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">OK</span></button>',e+="</div>",e+='<a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>'},t._createEventHandler=function(){var e=this,t=e._dialogInnerElement;t.on("click","#task_filter_btn",function(){e.submit(e._dialogAreaElement)})},t.submit=function(e){var t=this;t._searchExecute()},t._searchExecute=function(){function e(e){if(0!=e){var n=t._getStatusArray(),o=t._getPriorityArray(),i=t._getRequestTypeArray(),a=t._getDemandStatusArray(),r=t._getDueDate(),s=t._getHavingAttachedFileCheckState(),l=t._getHavingUrlCheckState(),u=t._getTermSettingData(),c=new CustomFilterColumnInfomation;c.setSourceColumnDisplayName(t._getDisplayName());var d,g={},m=null,_=null,f=!1;t._columnInfo.getColumnType()==ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER?(m=t._columnInfo.getSourceColumnType(),m==ColumnInformation.TYPE_COLUMN_FILTER&&(_=t._columnInfo.getBeginningColumnType()),f=!0):(m=t._columnInfo.getColumnType(),m==ColumnInformation.TYPE_COLUMN_FILTER&&(_=t._columnInfo.getSourceColumnType())),c.setSourceColumnType(m),null!=_&&c.setBeginningColumnType(_);var p={};if(f)p=t._columnInfo.getSubData();else if(m==ColumnInformation.TYPE_COLUMN_CHAT)p.partner=t._columnInfo.getFilterCondition();else if(m==ColumnInformation.TYPE_COLUMN_GROUP_CHAT){var h=t._columnInfo.getChatRoomInfomation(),C=h.getRoomId();p.roomId=C}else if(m==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED){var h=t._columnInfo.getCommunityInfomation(),C=h.getRoomId();p.roomId=C}else if(m==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK){var v=t._columnInfo.getCommunityInfomation(),C=v.getRoomId();p.roomId=C}else m==ColumnInformation.TYPE_COLUMN_FILTER&&(p=CustomFilterColumnInfomation.copySubData(t._columnInfo.getSubData()));if(c.setSubData(p),m==ColumnInformation.TYPE_COLUMN_FILTER){var y=t._columnInfo.getKeyword(),T=ColumnFilterManager.getColumnFilter(_,p),b=ViewUtils.getKeywordFilterFromKeywordInputString(y);d=new AndCondition,d.addChildCondition(T),d.addChildCondition(b),c.setKeyword(y)}else d=ColumnFilterManager.getColumnFilter(m,p);if(null!=d){var I;if(t._isTargetClient()||t._isTargetOwner()||t._isTargetStatus()||t._isTargetPriority()||t._isTargetRequestType()||a.length>0||t._isTargetDueDate()||s||l||u!=DialogSettingCustomFilterView.TERM_DATA_NONE_VALUE){if(I=new AndCondition,t._isTargetClient()){var M=t._clientJid,E=new ItemCondition;E.setData("client",M),I.addChildCondition(E),g.client=M}if(t._isTargetOwner()){var S=t._ownerJid,w=ParticularCondition.createTaskOwnerCondition(S);I.addChildCondition(w),g.owner=S}if(t._isTargetStatus()){var N;if(1==n.length){var E=new ItemCondition;E.setData("status",n[0]),N=E}else{N=new OrCondition;for(var A=0;A<n.length;A++){var E=new ItemCondition;E.setData("status",n[A]),N.addChildCondition(E)}}I.addChildCondition(N),g.status=n}if(t._isTargetPriority()){var U;if(1==o.length){var E=new ItemCondition;E.setData("priority",o[0]),U=E}else{U=new OrCondition;for(var A=0;A<o.length;A++){var E=new ItemCondition;E.setData("priority",o[A]),U.addChildCondition(E)}}I.addChildCondition(U),g.priority=o}if(t._isTargetRequestType()){var L=LoginUser.getInstance().getJid();if(1==i.length){var w=null;switch(i[0]){case"client":w=ParticularCondition.createTaskRequestingCondition(L);break;case"owner":w=ParticularCondition.createTaskRequestedCondition(L);break;case"self":w=ParticularCondition.createTaskSelfCondition(L)}null!=w&&I.addChildCondition(w)}else{for(var R=new OrCondition,A=0;A<i.length;A++){var w=null;switch(i[A]){case"client":w=ParticularCondition.createTaskRequestingCondition(L);break;case"owner":w=ParticularCondition.createTaskRequestedCondition(L);break;case"self":w=ParticularCondition.createTaskSelfCondition(L)}null!=w&&R.addChildCondition(w)}I.addChildCondition(R)}g.request_type=i}if(a.length>0){var O;if(1==a.length)if(m==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK){var L=LoginUser.getInstance().getJid(),w=ParticularCondition.createCommunityTaskDemandedCondition(L);null!=w&&(O=w)}else{var E=new ItemCondition;E.setData("demand_status",a[0]),O=E}else{O=new OrCondition;for(var A=0;A<a.length;A++){var E=new ItemCondition;E.setData("demand_status",a[A]),O.addChildCondition(E)}}I.addChildCondition(O),g.demand_status=a}if(t._isTargetDueDate()){var P=Date.create(r).addDays(1).format("{yyyy}/{MM}/{dd} 00:00:00"),k=new LessThanCondition;k.setData("due_date",P),I.addChildCondition(k),g.due_date=r}if(1==s||1==l){var D=CustomFilterSetting.createAttachedFileAndHavingUrlSettingFilterCondition(s,l);null!=D&&I.addChildCondition(D)}if(g.attached_file=s,g.having_url=l,u!=DialogSettingCustomFilterView.TERM_DATA_NONE_VALUE){var V=CustomFilterSetting.createTermSettingFilterCondition(u);null!=V&&I.addChildCondition(V)}g.term=u,I.addChildCondition(d)}else I=d;var x=new ViewUtils.getTaskDefaultSortCondition,Y=new ColumnSearchCondition(I,x);c.setSearchCondition(Y),c.setSetting(g),null==t._parentColumn?ColumnManager.getInstance().insertAfterColumn(c,t._ownerObj,!0,!0):t._parentColumn.searchAgain(c),ViewUtils.modal_allexit()}}}var t=this,n=t._dialogInnerElement;t._checkKeyword(n,e)},t._getDisplayName=function(){var e=this,t=e._columnInfo.getDisplayName(),n=e._columnInfo.getColumnType();return(n==ColumnInformation.TYPE_COLUMN_TASK||n==ColumnInformation.TYPE_COLUMN_INBOX)&&(t=ViewUtils.createDisplayName(e._columnInfo)),t},t._checkKeyword=function(e,t){function n(t){a._isTargetClient()&&(null==t||""==t||""==Utils.trimStringMulutiByteSpace(t)?(e.find("input.client-input").addClass("input-error"),d.push(Resource.getMessage("task_client")),r=!1):a._clientJid=t),o()}function o(){function t(t){a._isTargetOwner()&&(null==t||""==t||""==Utils.trimStringMulutiByteSpace(t)?(e.find("input.owner-input").addClass("input-error"),d.push(Resource.getMessage("task_owner_edit")),r=!1):a._ownerJid=t),i()}a._getOwnerJid(t)}function i(){if(0==r){var n="";if(d.length>0){for(var o="",i=0;i<d.length;i++)i>0&&(o+=", "),o+=d[i];n+=o+Resource.getMessage("dialogerrorTaskFilterText")}if(g.length>0){for(var a="",i=0;i<g.length;i++)i>0&&(a+=", "),a+=g[i];n+=a+Resource.getMessage("dialogerrorTaskFilterCheckbox")}e.find("#dialog-error").text(n)}t&&"function"==typeof t&&setTimeout(function(){t(r)},1)}var a=this;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var r=!0,s=this._getStatusArray(),l=this._getPriorityArray(),u=this._getRequestTypeArray(),c=(this._getDemandStatusArray(),this._getDueDate());e.find("#dialog-error").text("");var d=new Array,g=new Array;this._isTargetStatus()&&0==s.length&&(g.push(Resource.getMessage("task_status")),r=!1),this._isTargetPriority()&&0==l.length&&(g.push(Resource.getMessage("task_priority_title")),r=!1),this._isTargetRequestType()&&0==u.length&&(g.push(Resource.getMessage("task_request_type")),r=!1),this._isTargetDueDate()&&null==c&&(e.find("input.task-due-date").addClass("input-error"),d.push(Resource.getMessage("task_due_date_date")),r=!1),a._getClientJid(n)},t._getClientJid=function(e){function t(t){e&&"function"==typeof e&&setTimeout(function(){e(t)},1)}var n=this,o=n._dialogInnerElement,i=o.find(".client-input"),a=Utils.trimStringMulutiByteSpace(i.val());ViewUtils.convertAccountStrToJidStrFromServer(a,t)},t._setClientJid=function(e){var t=this,n=t._dialogInnerElement,o=n.find('label[for="client"]');if(e)o.find("input#client").prop("checked",!0),ViewUtils.convertJidStrToAccountStrFromServer(e,function(e){o.find(".client-input").val(e)});else{var i=o.children("div").find("*");i.attr("disabled","disabled")}},t._getOwnerJid=function(e){function t(t){e&&"function"==typeof e&&setTimeout(function(){e(t)},1)}var n=this,o=n._dialogInnerElement,i=o.find(".owner-input"),a=Utils.trimStringMulutiByteSpace(i.val());ViewUtils.convertAccountStrToJidStrFromServer(a,t)},t._setOwnerJid=function(e){var t=this,n=t._dialogInnerElement,o=n.find('label[for="owner"]');if(e)o.find("input#owner").prop("checked",!0),ViewUtils.convertJidStrToAccountStrFromServer(e,function(e){o.find(".owner-input").val(e)});else{var i=o.children("div").find("*");i.attr("disabled","disabled")}},t._getStatusArray=function(){var e=this,t=e._dialogInnerElement,n=t.find("input[name=status]:checked");return n.map(function(){return parseInt($(this).val())}).get()},t._setStatusArray=function(e){var t=this,n=t._dialogInnerElement,o=n.find('label[for="status"]');if(e){o.find("input#status").prop("checked",!0);for(var i=0;i<e.length;i++)o.find("input[name=status][value="+e[i]+"]").prop("checked",!0)}else{o.find("input[name=status]").prop("checked",!0);var a=o.children("div").find("*");a.attr("disabled","disabled")}},t._getPriorityArray=function(){var e=this,t=e._dialogInnerElement,n=t.find("input[name=priority]:checked");return n.map(function(){return parseInt($(this).val())}).get()},t._setPriorityArray=function(e){var t=this,n=t._dialogInnerElement,o=n.find('label[for="priority"]');if(e){o.find("input#priority").prop("checked",!0);for(var i=0;i<e.length;i++)o.find("input[name=priority][value="+e[i]+"]").prop("checked",!0)}else{o.find("input[name=priority]").prop("checked",!0);var a=o.children("div").find("*");a.attr("disabled","disabled")}},t._getRequestTypeArray=function(){var e=this,t=e._dialogInnerElement,n=t.find("input[name=request_type]:checked");return n.map(function(){return $(this).val()}).get()},t._setRequestTypeArray=function(e){var t=this,n=t._dialogInnerElement,o=n.find('label[for="request_type"]');if(e){o.find("input#request_type").prop("checked",!0);for(var i=0;i<e.length;i++)o.find("input[name=request_type][value="+e[i]+"]").prop("checked",!0)}else{o.find("input[name=request_type]").prop("checked",!0);var a=o.children("div").find("*");a.attr("disabled","disabled")}},t._getDemandStatusArray=function(){var e=this,t=e._dialogInnerElement,n=t.find("input[name=demand_status]:checked");return n.map(function(){return parseInt($(this).val())}).get()},t._setDemandStatusArray=function(e){var t=this,n=t._dialogInnerElement,o=n.find('label[for="demand_status"]');e&&o.find("input[name=demand_status]").prop("checked",!0)},t._getDueDate=function(){var e=this,t=e._dialogInnerElement,n=t.find(".task-due-date"),o=Utils.trimStringMulutiByteSpace(n.val()),i=o.match(/^(\d{4})\/(\d{2})\/(\d{2})$/);return null==i?null:Date.create(o)},t._setDueDateStr=function(e){var t=this,n=t._dialogInnerElement,o=n.find('label[for="due_date"]');if(e){o.find("input#due_date").prop("checked",!0);var i=Date.create(e).format("{yyyy}/{MM}/{dd}");o.find(".task-due-date").val(i)}else{var i=Date.create("today").format("{yyyy}/{MM}/{dd}");o.find(".task-due-date").val(i);var a=o.children("div").find("*");a.attr("disabled","disabled")}},t._getHavingAttachedFileCheckState=function(){var e=this,t=e._dialogInnerElement,n=t.find("input#having-attached-file-checkbox:checked");return n.length>0?!0:!1},t._setHavingAttachedFileCheckStatus=function(e){var t=this,n=t._dialogInnerElement;e&&n.find("input#having-attached-file-checkbox").prop("checked",!0)},t._getHavingUrlCheckState=function(){var e=this,t=e._dialogInnerElement,n=t.find("input#having-url-checkbox:checked");return n.length>0?!0:!1},t._setHavingUrlCheckStatus=function(e){var t=this,n=t._dialogInnerElement;e&&n.find("input#having-url-checkbox").prop("checked",!0)},t._getTermSettingData=function(){var e=this,t=DialogSettingCustomFilterView.TERM_DATA_NONE_VALUE;return e._isTargetTerm()&&(t=e._getTermData()),t},t._getTermData=function(){var e=this,t=e._dialogInnerElement,n=t.find("select.term-select").val();return parseInt(n)},t._setTermData=function(e){var t=this,n=t._dialogInnerElement,o=n.find('label[for="termCheckbox"]');if(e==DialogSettingCustomFilterView.TERM_DATA_NONE_VALUE){var i=o.children("div").find("*");i.attr("disabled","disabled")}else o.find("input#termCheckbox").prop("checked",!0),o.find("select.term-select").val(e)},t._isTargetClient=function(){var e=this,t=e._dialogInnerElement,n=t.find('label[for="client"]');return n.find("input#client").is(":checked")},t._isTargetOwner=function(){var e=this,t=e._dialogInnerElement,n=t.find('label[for="owner"]');return n.find("input#owner").is(":checked")},t._isTargetStatus=function(){var e=this,t=e._dialogInnerElement,n=t.find('label[for="status"]');return n.find("input#status").is(":checked")},t._isTargetPriority=function(){var e=this,t=e._dialogInnerElement,n=t.find('label[for="priority"]');return n.find("input#priority").is(":checked")},t._isTargetRequestType=function(){var e=this,t=e._dialogInnerElement,n=t.find('label[for="request_type');return n.find("input#request_type").is(":checked")},t._isTargetDueDate=function(){var e=this,t=e._dialogInnerElement,n=t.find('label[for="due_date');return n.find("input#due_date").is(":checked")},t._isTargetTerm=function(){var e=this,t=e._dialogInnerElement,n=t.find('label[for="termCheckbox');return n.find("input#termCheckbox").is(":checked")}}(),function(){DialogSettingFilterMyTaskView.prototype=$.extend({},DialogSettingFilterTaskView.prototype);var e=(DialogSettingFilterTaskView.prototype,DialogSettingFilterMyTaskView.prototype);e.getInnerHtml=function(){var e=this,t="";return t+='<div id="taskfilter_modal" class="card modal_card">',t+='<div class="card_title"><p>'+Resource.getMessage("task_filter")+"</p></div>",t+='<div class="list_wrapper">',t+='<ul class="modal_list select_list cf">',t+=e._displayFieldClient(),t+=e._displayFieldOwner(),t+=e._displayFieldStatus(),t+=e._displayFieldPriority(),t+=e._displayFieldDemandStatus(),t+=e._displayFieldRequestType(),t+=e._displayFieldDueDate(),t+=e._displayFieldUrl(),t+=e._displayFieldTerm(),t+="</ul>",t+="</div>",t+=e.displaySubmitButton(),t+="</div>"}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){CustomFilterSetting.createSettingFilterCondition=function(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=new ArrayList;if(null!=e.sender){var o=CustomFilterSetting.createSenderSettingFilterCondition(e.sender);null!=o&&n.add(o)}if(1==e.attached_file||1==e.having_url){var i=CustomFilterSetting.createAttachedFileAndHavingUrlSettingFilterCondition(e.attached_file,e.having_url);null!=i&&n.add(i)}if(null!=e.term&&0!=e.term){var a=CustomFilterSetting.createTermSettingFilterCondition(e.term);null!=a&&n.add(a)}if(null!=e.unread&&1==e.unread){var r=CustomFilterSetting.createUnreadSettingFilterCondition();null!=r&&n.add(r)}return t=CustomFilterSetting.createSettingFilterConditionFromConditionArray(n)},CustomFilterSetting.createSettingFilterConditionFromConditionArray=function(e){var t=null;if(null==e)return t;var n=e.getCount();if(n>0)if(1==n)t=e.get(0);else{t=new AndCondition;for(var o=0;n>o;o++)t.addChildCondition(e.get(o))}return t},CustomFilterSetting.createSenderSettingFilterCondition=function(e){var t=null;if(null==e)return t;var n=Utils.trimStringMulutiByteSpace(e);return""==n?t:(t=new ItemCondition,t.setData("msgfrom",n),t)},CustomFilterSetting.createAttachedFileAndHavingUrlSettingFilterCondition=function(e,t){var n=null,o=Utils.getDocumentRootUrlWithoutProtocol()+"f/",i=Utils.getDocumentRootUrlWithoutProtocol()+"file/";if(1==e&&1==t){n=new OrCondition;var a=new KeywordCondition;a.setData("http://"),n.addChildCondition(a);var r=new KeywordCondition;r.setData("https://"),n.addChildCondition(r)}else if(1==e){n=new OrCondition;var s=new KeywordCondition;s.setData("http://"+o),n.addChildCondition(s);var l=new KeywordCondition;l.setData("https://"+o),n.addChildCondition(l);var u=new KeywordCondition;u.setData("http://"+i),n.addChildCondition(u);var c=new KeywordCondition;c.setData("https://"+i),n.addChildCondition(c)}else if(1==t){n=new AndCondition;var d=ParticularCondition.createMessageHavingUrlExceptAttachedFileCondition(o);n.addChildCondition(d);var g=ParticularCondition.createMessageHavingUrlExceptAttachedFileCondition(i);n.addChildCondition(g)}return n},CustomFilterSetting.createTermSettingFilterCondition=function(e){var t=null;if(null==e||"number"!=typeof e)return t;var n=null;switch(e){case DialogSettingCustomFilterView.TERM_DATA_NONE_VALUE:break;case DialogSettingCustomFilterView.TERM_DATA_24_HOUR_VALUE:n=Date.create("1 day ago");break;case DialogSettingCustomFilterView.TERM_DATA_48_HOUR_VALUE:n=Date.create("2 days ago");break;case DialogSettingCustomFilterView.TERM_DATA_1_WEEK_VALUE:n=Date.create("last week");break;case DialogSettingCustomFilterView.TERM_DATA_1_MONTH_VALUE:n=Date.create("last month");break;case DialogSettingCustomFilterView.TERM_DATA_1_YEAR_VALUE:n=Date.create("last year")}if(null==n)return t;var o=Utils.getDate(n,Utils.DISPLAY_STANDARD_DATE_FORMAT);return t=new GreaterThanCondition,t.setData("created_at",o),t},CustomFilterSetting.createUnreadSettingFilterCondition=function(){var e=LoginUser.getInstance(),t=e.getJid(),n=new AndCondition;n.addChildCondition(ParticularCondition.createUnreadMessageFileCondition(t));var o=new NotCondition,i=new ItemCondition;return i.setData("msgtype",Message.TYPE_QUESTIONNAIRE),o.setChildCondition(i),n.addChildCondition(o),n}}(),function(){DialogSettingCustomFilterView.SETTING_VALUE_HAVING_ATTACHED_FILE=1,DialogSettingCustomFilterView.SETTING_VALUE_HAVING_URL=2,DialogSettingCustomFilterView.TERM_DATA_NONE_VALUE=0,DialogSettingCustomFilterView.TERM_DATA_24_HOUR_VALUE=1,DialogSettingCustomFilterView.TERM_DATA_48_HOUR_VALUE=2,DialogSettingCustomFilterView.TERM_DATA_1_WEEK_VALUE=3,DialogSettingCustomFilterView.TERM_DATA_1_MONTH_VALUE=4,DialogSettingCustomFilterView.TERM_DATA_1_YEAR_VALUE=5,DialogSettingCustomFilterView.TERM_DATA_ARRAY=[{value:DialogSettingCustomFilterView.TERM_DATA_24_HOUR_VALUE,label:Resource.getMessage("custom_filter_label_term_24_hours")},{value:DialogSettingCustomFilterView.TERM_DATA_48_HOUR_VALUE,label:Resource.getMessage("custom_filter_label_term_48_hours")},{value:DialogSettingCustomFilterView.TERM_DATA_1_WEEK_VALUE,label:Resource.getMessage("custom_filter_label_term_1_week")},{value:DialogSettingCustomFilterView.TERM_DATA_1_MONTH_VALUE,label:Resource.getMessage("custom_filter_label_term_1_month")},{value:DialogSettingCustomFilterView.TERM_DATA_1_YEAR_VALUE,label:Resource.getMessage("custom_filter_label_term_1_year")}],DialogSettingCustomFilterView.prototype=$.extend({},DialogSettingView.prototype);var e=DialogSettingView.prototype,t=DialogSettingCustomFilterView.prototype;t._init=function(){var t=this;e._init.call(t);var n=t._dialogInnerElement,o=n.find("input.target");o.on("change",function(e){t._changeTarget(e.target)});var i="",a=!1,r=!1,s=DialogSettingCustomFilterView.TERM_DATA_NONE_VALUE,l=!1,u=null;null!=t._columnInfo.getSetting&&"function"==typeof t._columnInfo.getSetting&&(u=t._columnInfo.getSetting()),u&&(i=null!=u.sender?u.sender:i,a=null!=u.attached_file?u.attached_file:a,r=null!=u.having_url?u.having_url:r,s=null!=u.term?u.term:s,l=null!=u.unread?u.unread:l),t._setSenderJid(i),t._setHavingAttachedFileCheckStatus(a),t._setHavingUrlCheckStatus(r),t._setTermData(s),t._setUnreadCheckStatus(l),t._dialogInnerElement.find(".modal_btn").on("click",function(){t._searchExecute()})},t.getInnerHtml=function(){var e=this,t="";return t+='<div id="colfilter_modal" class="card modal_card">',t+='<div class="card_title">',t+="  <p>"+Resource.getMessage("column_btn_filter")+"</p>",t+="</div>",t+='<div class="list_wrapper">',t+='<ul class="modal_list select_list">',t+=e._displayFieldSender(),t+=e._displayFieldUrl(),t+=e._displayFieldTerm(),t+=e._displayFieldUnread(),t+="</ul>",t+="</div>",t+='<div class="btn_wrapper">',t+='  <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',t+='  <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+"</span></button>",t+="</div>",t+='<a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',t+="</div>"},t._displayFieldSender=function(){var e=this,t=ViewUtils.getAutoCompleteAttributesFromColumnInfo(e._columnInfo),n="";return n+="<li>",n+='  <label for="sender_checkbox">',n+='    <label class="checkbox checkbox_title">',n+='      <input type="checkbox" class="target" id="sender_checkbox" name="sender-checkbox" value="1">',n+="        <span></span>"+Resource.getMessage("custom_filter_label_sender"),n+="    </label>",n+='    <input type="text" class="field sender-input ui-corner-all '+t.autoCompleteType+'" placeholder="'+Resource.getMessage("dialog_placeholder_account")+'" '+t.roomIdAttribute+">",n+="  </label>",n+="</li>"},t._displayFieldUrl=function(){var e="";return e+="<li>",e+='  <label for="">',e+='    <label style="margin-right:20px">',e+="    <span></span>"+Resource.getMessage("custom_filter_label_having_attached_file_and_url")+"</label>",e+='  <label class="checkbox checkbox_btn"><input type="checkbox" id="having_attached_file_checkbox" name="having-attached-file" value="'+DialogSettingCustomFilterView.SETTING_VALUE_HAVING_ATTACHED_FILE+'"><span></span>'+Resource.getMessage("custom_filter_label_having_attached_file")+"</label>",e+='  <label class="checkbox checkbox_btn"><input type="checkbox" id="having_url_checkbox" name="having-url" value="'+DialogSettingCustomFilterView.SETTING_VALUE_HAVING_ATTACHED_FILE+'"><span></span>'+Resource.getMessage("custom_filter_label_having_url")+"</label>",e+="</li>"},t._displayFieldTerm=function(){var e="";e+="<li>",e+='  <label for="term_checkbox">',e+='    <label class="checkbox checkbox_title">',e+='      <input type="checkbox" class="target" id="term_checkbox" name="term-checkbox" value="1">',e+="      <span></span>"+Resource.getMessage("custom_filter_label_term"),e+="    </label>",e+='    <select class="field term-select ui-corner-all">';for(var t=DialogSettingCustomFilterView.TERM_DATA_ARRAY,n=0;n<t.length;n++){var o=t[n],i=0==n?"selected":"";e+='<option value="'+o.value+'" '+i+'">'+o.label+"</option>"}return e+="    </select>",e+="  </label>",e+="</li>"},t._displayFieldUnread=function(){var e="";return e+="<li>",e+='  <label for="unread_checkbox">',e+='    <label class="checkbox">',e+='      <input type="checkbox" class="target" id="unread_checkbox" name="unread-checkbox" value="1">',e+="      <span></span>"+Resource.getMessage("custom_filter_label_unread_message"),e+="    </label>",e+="  </label>",e+="</li>"},t._changeTarget=function(e){var t=this,n=(t._dialogInnerElement,$(e).closest("fieldset")),o=n.children("div").find("*");if(e.checked)o.removeAttr("disabled");else{o.attr("disabled","disabled");var i=n.find("input[type=text]");i&&i.removeClass("input-error")}return!0},t._searchExecute=function(){function e(e){if(0!=e){a.setSourceColumnDisplayName(o._getDisplayName());var i=o._columnInfo.getColumnType(),r=null,s=!1;i==ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER?(i=o._columnInfo.getSourceColumnType(),i==ColumnInformation.TYPE_COLUMN_FILTER&&(r=o._columnInfo.getBeginningColumnType()),s=!0):i==ColumnInformation.TYPE_COLUMN_FILTER&&(r=o._columnInfo.getSourceColumnType()),a.setSourceColumnType(i),null!=r&&a.setBeginningColumnType(r);var l={};if(s)l=o._columnInfo.getSubData();else if(i==ColumnInformation.TYPE_COLUMN_CHAT)l.partner=o._columnInfo.getFilterCondition();else if(i==ColumnInformation.TYPE_COLUMN_GROUP_CHAT){var u=o._columnInfo.getChatRoomInfomation(),c=u.getRoomId();l.roomId=c}else if(i==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED){var u=o._columnInfo.getCommunityInfomation(),c=u.getRoomId();l.roomId=c}else if(i==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK){var d=o._columnInfo.getCommunityInfomation(),c=d.getRoomId();l.roomId=c}else(i==ColumnInformation.TYPE_COLUMN_SEARCH||i==ColumnInformation.TYPE_COLUMN_FILTER)&&(l=CustomFilterColumnInfomation.copySubData(o._columnInfo.getSubData()));if(a.setSubData(l),i==ColumnInformation.TYPE_COLUMN_SEARCH||i==ColumnInformation.TYPE_COLUMN_FILTER){var g=o._columnInfo.getKeyword(),m=null;if(i==ColumnInformation.TYPE_COLUMN_SEARCH){for(var _=o._columnInfo.getSourceColumnTypeList(),f=a.getSourceColumnTypeList(),p=_.getCount(),h=0;p>h;h++)f.add(_.get(h));m=null!=l&&null!=l.roomId&&""!=l.roomId?ColumnFilterManager.getColumnFilterForCommunity(f,l):ColumnFilterManager.getColumnFilterList(f)}else m=ColumnFilterManager.getColumnFilter(r,l);var C=ViewUtils.getKeywordFilterFromKeywordInputString(g);n=new AndCondition,n.addChildCondition(m),n.addChildCondition(C),a.setKeyword(g)}else n=ColumnFilterManager.getColumnFilter(i,l);null!=n&&o._getSettingFromView(t)}}function t(e){var t,i=o._createSettingFilterCondition(e);null!=i?(t=new AndCondition,t.addChildCondition(n),t.addChildCondition(i)):t=n;var r=new ColumnSortCondition,s=new ColumnSearchCondition(t,r);a.setSearchCondition(s),a.setSetting(e),null==o._parentColumn?ColumnManager.getInstance().insertAfterColumn(a,o._ownerObj,!0,!0):o._parentColumn.searchAgain(a),
ViewUtils.modal_allexit()}var n,o=this,i=o._dialogInnerElement,a=new CustomFilterColumnInfomation;o._checkSetting(i,e)},t._getSettingFromView=function(e){function t(t){o.sender=t,e&&"function"==typeof e&&setTimeout(function(){e(o)},1)}var n=this,o={};n._getSenderSettingData(t),o.attached_file=n._getAttachedFileSetteingData(),o.having_url=n._getHavingUrlSetteingData(),o.term=n._getTermSettingData(),o.unread=n._getUnreadSetteingData()},t._getSenderSettingData=function(e){function t(t){null!=t&&(o=t),e&&"function"==typeof e&&setTimeout(function(){e(o)},1)}var n=this,o="";n._isTargetSender()?n._getSenderJid(t):t(null)},t._getAttachedFileSetteingData=function(){var e=this;return e._getHavingAttachedFileCheckState()},t._getHavingUrlSetteingData=function(){var e=this;return e._getHavingUrlCheckState()},t._getTermSettingData=function(){var e=this,t=DialogSettingCustomFilterView.TERM_DATA_NONE_VALUE;return e._isTargetTerm()&&(t=e._getTermData()),t},t._getUnreadSetteingData=function(){var e=this;return e._getUnreadCheckState()},t._createSettingFilterCondition=function(e){return CustomFilterSetting.createSettingFilterCondition(e)},t._getDisplayName=function(){var e=this,t=e._columnInfo.getDisplayName(),n=e._columnInfo.getColumnType();return(n==ColumnInformation.TYPE_COLUMN_TASK||n==ColumnInformation.TYPE_COLUMN_INBOX)&&(t=ViewUtils.createDisplayName(e._columnInfo)),t},t._checkSetting=function(e,t){function n(n){if(0==n){var o="";if(i.length>0){for(var a="",r=0;r<i.length;r++)r>0&&(a+=", "),a+=i[r];o+=a+Resource.getMessage("custom_filter_error_text")}e.find("#dialog-error").text(o)}t&&"function"==typeof t&&setTimeout(function(){t(n)},1)}var o=this;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;e.find("#dialog-error").text("");var i=new Array;o._checkSenderSetting(e,i,n)},t._checkSenderSetting=function(e,t,n){function o(n){if(null==n||""==Utils.trimStringMulutiByteSpace(n)){e.find("input.sender-input").addClass("input-error");var o=a._getInvalidSenderSettingText();t.push(o),r=!1}i()}function i(){n&&"function"==typeof n&&setTimeout(function(){n(r)},1)}var a=this,r=!0;a._isTargetSender()?a._getSenderJid(o):i()},t._getInvalidSenderSettingText=function(){return Resource.getMessage("custom_filter_label_sender")},t._getSenderJid=function(e){function t(t){e&&"function"==typeof e&&setTimeout(function(){e(t)},1)}var n=this,o=n._dialogInnerElement,i=o.find(".sender-input"),a=Utils.trimStringMulutiByteSpace(i.val());ViewUtils.convertAccountStrToJidStrFromServer(a,t)},t._setSenderJid=function(e){var t=this,n=t._dialogInnerElement,o=n.find('label[for="sender_checkbox"]');if(e)o.find("input#sender_checkbox").prop("checked",!0),ViewUtils.convertJidStrToAccountStrFromServer(e,function(e){o.find(".sender-input").val(e)});else{var i=o.children("div").find("*");i.attr("disabled","disabled")}},t._getHavingAttachedFileCheckState=function(){var e=this,t=e._dialogInnerElement,n=t.find("input#having_attached_file_checkbox:checked");return n.length>0?!0:!1},t._setHavingAttachedFileCheckStatus=function(e){var t=this,n=t._dialogInnerElement;e&&n.find("input#having_attached_file_checkbox").prop("checked",!0)},t._getHavingUrlCheckState=function(){var e=this,t=e._dialogInnerElement,n=t.find("input#having_url_checkbox:checked");return n.length>0?!0:!1},t._setHavingUrlCheckStatus=function(e){var t=this,n=t._dialogInnerElement;e&&n.find("input#having_url_checkbox").prop("checked",!0)},t._getTermData=function(){var e=this,t=e._dialogInnerElement,n=t.find("select.term-select").val();return parseInt(n)},t._setTermData=function(e){var t=this,n=t._dialogInnerElement,o=n.find('label[for="term_checkbox"]');if(e==DialogSettingCustomFilterView.TERM_DATA_NONE_VALUE){var i=o.children("div").find("*");i.attr("disabled","disabled")}else o.find("input#term_checkbox").prop("checked",!0),o.find("select.term-select").val(e)},t._getUnreadCheckState=function(){var e=this,t=e._dialogInnerElement,n=t.find("input#unread_checkbox:checked");return n.length>0?!0:!1},t._setUnreadCheckStatus=function(e){var t=this,n=t._dialogInnerElement;e&&n.find("input#unread_checkbox").prop("checked",!0)},t._isTargetSender=function(){var e=this,t=e._dialogInnerElement,n=t.find("input#sender_checkbox:checked");return n.length>0?!0:!1},t._isTargetTerm=function(){var e=this,t=e._dialogInnerElement,n=t.find("input#term_checkbox:checked");return n.length>0?!0:!1}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){CustomFilterInboxSetting.createSettingFilterCondition=function(e){var t=null;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=new ArrayList;if(null!=e.sender){var o=CustomFilterInboxSetting.createSenderSettingFilterCondition(e.sender);null!=o&&n.add(o)}if(1==e.attached_file||1==e.having_url){var i=CustomFilterSetting.createAttachedFileAndHavingUrlSettingFilterCondition(e.attached_file,e.having_url);null!=i&&n.add(i)}if(null!=e.term&&0!=e.term){var a=CustomFilterSetting.createTermSettingFilterCondition(e.term);null!=a&&n.add(a)}return t=CustomFilterSetting.createSettingFilterConditionFromConditionArray(n)},CustomFilterInboxSetting.createSenderSettingFilterCondition=function(e){var t=null;if(null==e)return t;var n=Utils.trimStringMulutiByteSpace(e);return""==n?t:(t=new ItemCondition,t.setData("client",n),t)}}(),function(){DialogSettingCustomFilterInboxView.prototype=$.extend({},DialogSettingCustomFilterView.prototype);var e=DialogSettingCustomFilterView.prototype,t=DialogSettingCustomFilterInboxView.prototype;t._init=function(){var t=this;e._init.call(t)},t._displayFieldSender=function(){var e=this,t=ViewUtils.getAutoCompleteAttributesFromColumnInfo(e._columnInfo),n="";return n+="<li>",n+='  <label for="sender_checkbox">',n+='    <label class="checkbox checkbox_title">',n+='      <input type="checkbox" class="target" id="sender_checkbox" name="sender-checkbox" value="1">',n+="        <span></span>",n+=Resource.getMessage("custom_filter_inbox_label_sender"),n+="    </label>",n+='    <input type="text" class="field sender-input ui-corner-all '+t.autoCompleteType+'" placeholder="'+Resource.getMessage("dialog_placeholder_account")+'" '+t.roomIdAttribute+">",n+="  </label>",n+="</li>"},t._getInvalidSenderSettingText=function(){return Resource.getMessage("custom_filter_inbox_label_sender")},t._createSettingFilterCondition=function(e){return CustomFilterInboxSetting.createSettingFilterCondition(e)},t._displayFieldUnread=function(){var e="";return e},t._getUnreadCheckState=function(){return!1},t._setUnreadCheckStatus=function(e){}}(),function(){DialogSettingSearchView.prototype=$.extend({},DialogSettingFilterView.prototype);var e=(DialogSettingFilterView.prototype,DialogSettingSearchView.prototype);e._searchExecute=function(){var e=this,t=e._dialogInnerElement,n=t.find("input#"+e._dialogID),o=Utils.trimStringMulutiByteSpace(n.val());ContextSearchView.getInstance().search(o)&&t.dialog("close")}}(),function(){DialogTaskView.MODE_ADD=1,DialogTaskView.MODE_READ=2,DialogTaskView.MODE_UPDATE=3,DialogTaskView.MAX_LENGTH_TASK_NAME=Conf.getVal("TASK_TITLE_MAX_LENGTH"),DialogTaskView.MAX_LENGTH_TASK_BODY=Conf.getVal("MESSAGE_BODY_MAX_LENGTH"),DialogTaskView.prototype=$.extend({},DialogOkCancelView.prototype);var e=(DialogOkCancelView.prototype,DialogTaskView.prototype);e._initView=function(){function e(){var e=parseInt($("#dialog-task-status").val());if(e==TaskMessage.STATUS_INBOX||e>=TaskMessage.STATUS_FINISHED&&n._taskMessage.getStatus()==TaskMessage.STATUS_INBOX);else if(n.isEmptyValue($("#dialog-task-name").attr("value")))return $("#dialog-task-dialog-error").text(Resource.getMessage("task_error_taskname")),!1;var t=$("#dialog-task-start-date").val(),o=null;if(""!=t){if(!Utils.isValidDate(t))return $("#dialog-task-dialog-error").text(Resource.getMessage("task_error_datetime")),!1;o=new Date(t)}var i=$("#dialog-task-due-date").val(),a=null;if(""!=i){if(!Utils.isValidDate(i))return $("#dialog-task-dialog-error").text(Resource.getMessage("task_error_datetime")),!1;a=new Date(i)}if(o&&a&&o.getTime()>a.getTime())return $("#dialog-task-dialog-error").text(Resource.getMessage("task_error_statu_due_datetime")),!1;if($("#dialog-task-name").val().length>DialogTaskView.MAX_LENGTH_TASK_NAME)return $("#dialog-task-dialog-error").text(Resource.getMessage("task_error_taskname_length")),!1;var r=/((https?)(:\/\/\S+))/gi,s=$("#dialog-task-body").val(),l=s.replace(r,"");if(l.length>DialogTaskView.MAX_LENGTH_TASK_BODY)return $("#dialog-task-dialog-error").text(Resource.getMessage("task_error_content_length")),!1;var u=$("#dialog-task-owner").val();return 0==u.length?($("#dialog-task-dialog-error").text(Resource.getMessage("task_error_owner_select")),!1):!0}function t(){var e=$("#dialog-task-owner").val(),t=e.join(),o=n._taskMessage;o.setTitle($("#dialog-task-name").val()),o.setMessage($("#dialog-task-body").val()),o.setDueDate(new Date($("#dialog-task-due-date").val())),o.setOwnerJid(t),o.setStatus(parseInt($("#dialog-task-status").val())),o.setStartDate(new Date($("#dialog-task-start-date").val())),o.setPriority(parseInt($("#dialog-task-priority").val())),o.setClient($("#dialog-task-client option:selected").val())}var n=this,o="";switch(n._mode){case DialogTaskView.MODE_ADD:o=Resource.getMessage("task_title_add");var i=function(e){console.log("add task : "+e)};n._buttons={OK:function(){e()&&(t(),1==CubeeController.getInstance().addTask(n._taskMessage,i)?($(this).dialog("close"),n._dialogInnerElement.remove()):console.log("faild to add task"))},"":function(){$(this).dialog("close")}};break;case DialogTaskView.MODE_READ:o=Resource.getMessage("task_title_view"),n._buttons={"":function(){$(this).dialog("close")}};break;case DialogTaskView.MODE_UPDATE:o=Resource.getMessage("task_title_update"),n._buttons={OK:function(){function o(e){console.log("update task : "+e)}if(e()){for(var i=ColumnManager.getInstance()._getTargetColumnsIndex(n._taskMessage),a=n._taskMessage.getItemId(),r=new ArrayList,s=new ArrayList,l=0;l<i.getCount();l++){var u=i.get(l),c=ColumnManager.getInstance().getColumnObjList().get(u),d=c.getMsgObjIndexPositionByItemId(a);s.add(c),r.add(d)}t();var g=n._taskMessage.getOwnerJid(),m=n._taskMessage.getClient(),_=LoginUser.getInstance().getJid();if(g!=_&&m!=_)for(var l=0;l<i.getCount();l++){var f=s.get(l),p=r.get(l),h=(f.getHtmlElement().children("div.column-content"),f.getParentMsgObjByPosition(p)),C=h.getHtmlElement();C.remove(),f.removeMsgObjIndexByItemId(a)}1==CubeeController.getInstance().updateTask(n._taskMessage,o)?$(this).dialog("close"):console.log("faild to add task")}},"":function(){$(this).dialog("close")}}}$("#dialog_area").html(n._getTaskDialogBasicHtml());var a=$("#dialog-task-name"),r=$("#dialog-task-body");ViewUtils.setCharCounter(a,a.next("."+ViewUtils.CHAR_COUNTER_CLASSNAME),DialogTaskView.MAX_LENGTH_TASK_NAME,!0),ViewUtils.setCharCounter(r,r.next("."+ViewUtils.CHAR_COUNTER_CLASSNAME),DialogTaskView.MAX_LENGTH_TASK_BODY),n._dialogInnerElement=$("#dialog-task-dialog"),""!=n._taskMessage.getOwnerJid()?$("#dialog-task-owner").val(n._taskMessage.getOwnerJid()):$("#dialog-task-owner").val(LoginUser.getInstance().getJid()),$("#dialog-task-status").val(n._taskMessage.getStatus()),$("#dialog-task-priority").val(n._taskMessage.getPriority());var s=n._taskMessage.getStartDate();if(s){var l=s.toString();if("Invalid Date"!=l){var u=Utils.getDate(l,Utils.DISPLAY_STANDARD_DATE_FORMAT);$("#dialog-task-start-date").val(u)}}var c=n._taskMessage.getDueDate();if(c){var d=c.toString();if("Invalid Date"!=d){var g=Utils.getDate(d,Utils.DISPLAY_STANDARD_DATE_FORMAT);$("#dialog-task-due-date").val(g)}}n._dialogInnerElement.find("input.date-time-picker").datetimepicker({showOn:"button",buttonImage:"images/calendar.png",buttonImageOnly:!0,dateFormat:Utils.DISPLAY_DATEPICKER_DATE_FORMAT}),n._dialogInnerElement.find("input.date-time-picker").next("img").css("width","24"),n._dialogInnerElement.dialog({buttons:n._buttons,modal:!0,autoOpen:!1,width:500,title:o,close:function(){$(this).dialog("destroy"),$(this).remove()}})},e._getTaskDialogBasicHtml=function(){var e="",t=this,n=t._taskMessage.getTitle(),o=t._taskMessage.getMessage(),i=LoginUser.getInstance().getJid(),a=LoginUser.getInstance().getUserName(),r=t._taskMessage.getDueDate(),s="",l=t._taskMessage.getFrom(),u="selected";0==l.length&&(l=i,u=""),r&&(s=Utils.getDate(r.toString,Utils.DISPLAY_DATEPICKER_DATE_FORMAT));var c=t._taskMessage.getStartDate(),d="";c&&(d=Utils.getDate(c.toString,Utils.DISPLAY_DATEPICKER_DATE_FORMAT)),e+='<div id="dialog-task-dialog">',e+='<p id="dialog-task-dialog-error" class="ui-state-error-text"></p>',e+='<form class="task-dialog-form">',e+='<label for="task-name" class="task-dialog-label">'+Resource.getMessage("task_name")+"</label>",e+='<input id="dialog-task-name" name="task-name" class="task-dialog-item ui-corner-all" value="'+Utils.convertEscapedTag(n)+'">',e+=ViewUtils.getCharCounterHtml("char-counter-task-add-dialog"),e+="<br />",e+='<label for="task-body" class="task-dialog-label">'+Resource.getMessage("task_body_placeholder")+"</label>",e+='<textarea id="dialog-task-body" name="task-body" class="task-dialog-item ui-corner-all">'+o+"</textarea>",e+=ViewUtils.getCharCounterHtml("char-counter-task-add-dialog"),e+="<br />",e+='<label for="task-client" class="task-dialog-label">'+Resource.getMessage("task_client")+"</label>",e+='<select id="dialog-task-client" class="task-dialog-item ui-corner-all">',e+='<option value="'+l+'"></option>',e+='<option value="'+i+'" '+u+">"+Utils.convertEscapedHtml(a)+"</option>";for(var g=ContactList.getInstance().getCount(),m=0;g>m;m++){var _=ContactList.getInstance().get(m),f=_.getUserName(),p=_.getJid();e+=p==l?'<option value="'+p+'" '+u+">"+Utils.convertEscapedHtml(f)+"</option>":'<option value="'+p+'">'+Utils.convertEscapedHtml(f)+"</option>"}e+="</select>",e+="<br />",e+='<label for="task-owner" class="task-dialog-label"><div class="task-dialog-item">'+Resource.getMessage("task_owner_edit")+'</div><div class="task-dialog-item">'+Resource.getMessage("task_multi_selection")+'</div><div class="task-dialog-item"></div></label>',e+='<select id="dialog-task-owner" class="task-dialog-item ui-corner-all" size="5" multiple="multiple">',e+='<option value="'+i+'" selected>'+Utils.convertEscapedHtml(a)+"</option>";for(var m=0;g>m;m++){var _=ContactList.getInstance().get(m),f=_.getUserName(),p=_.getJid();e+='<option value="'+p+'">'+Utils.convertEscapedHtml(f)+"</option>"}return e+="</select>",e+="<br />",e+='<label for="task-start-date" class="task-dialog-label">'+Resource.getMessage("task_start_date")+"</label>",e+='<input id="dialog-task-start-date" name="task-start-date" class="task-dialog-item date-time-picker ui-corner-all" value="'+d+'">',e+="<br />",e+='<label for="task-due-date" class="task-dialog-label">'+Resource.getMessage("task_due_date")+"</label>",e+='<input id="dialog-task-due-date" name="task-due-date" class="task-dialog-item date-time-picker ui-corner-all" value="'+s+'">',e+="<br />",e+='<label for="task-status" class="task-dialog-label">'+Resource.getMessage("task_status")+"</label>",e+='<select id="dialog-task-status" class="task-dialog-item ui-corner-all">',e+='<option value="'+TaskMessage.STATUS_INBOX+'">'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_INBOX)+"</option>",e+='<option value="'+TaskMessage.STATUS_ASSIGNING+'">'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_ASSIGNING)+"</option>",e+='<option value="'+TaskMessage.STATUS_NEW+'">'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_NEW)+"</option>",e+='<option value="'+TaskMessage.STATUS_DOING+'">'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_DOING)+"</option>",e+='<option value="'+TaskMessage.STATUS_FINISHED+'">'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_FINISHED)+"</option>",e+='<option value="'+TaskMessage.STATUS_REJECTED+'">'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_REJECTED)+"</option>",e+="</select>",e+="<br />",e+='<label for="task-priority" class="task-dialog-label">'+Resource.getMessage("task_priority_title")+"</label>",e+='<select id="dialog-task-priority" class="task-dialog-item ui-corner-all">',e+='<option value="'+TaskMessage.PRIORITY_LOW+'">'+Resource.getMessage("task_priority_low")+"/option>",e+='<option value="'+TaskMessage.PRIORITY_MEDIUM+'">'+Resource.getMessage("task_priority_medium")+"</option>",e+='<option value="'+TaskMessage.PRIORITY_HIGH+'">'+Resource.getMessage("task_priority_high")+"</option>",e+='<option value="'+TaskMessage.PRIORITY_TOP+'">'+Resource.getMessage("task_priority_top")+"</option>",e+="</select>",e+="<br />",e+="</form>",e+="</div>"},e._getTaskDialogDetailHtml=function(){var e=this,t=e._getTaskDialogBasicHtml();return t},e.showDialog=function(){this._dialogInnerElement.dialog("open")},e.isEmptyValue=function(e){var t=!1;return(null==e||"string"==typeof e&&""==e)&&(t=!0),t}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogMailCooperationView.prototype=$.extend({},DialogSettingView.prototype);var e=DialogSettingView.prototype,t=DialogMailCooperationView.prototype;t._init=function(){var t=this;e._init.call(t),t._dialogInnerElement.dialog("option","width",450),t._width=450,t._dialogInnerElement.dialog({open:function(e,n){t._onOpenDialog()}})},t._createEventHandler=function(){var e=this,t=e._dialogInnerElement,n=t.find("#mail-cooperation-check");n.click(function(){e._onChangeCheckCooperation()})},t._onOpenDialog=function(){function e(e){t._mailServerList=e,t._setOptionServerList(),t._onChangeCheckCooperation()}var t=this,n=CubeeController.getInstance().getServerList(e);if(!n){console.log("GetServerList Request is fail");var o=t._dialogInnerElement;return o.dialog("close"),!1}},t._setOptionServerList=function(){var e=this,t=e._dialogInnerElement,n=t.find("#pop_server_list");t.find("#pop_server_list > option").remove();for(var o=LoginUser.getInstance().getSettings().getMailCooperationList(),i=o.getCount(),a=null,r=0;i>r;r++)a=o.get(r);var s=e._mailServerList,l=s.getCount();1>l&&t.find("#mail-cooperation-check").removeAttr("checked");for(var r=0;l>r;r++){var u="",c=s.get(r);c.getId()==a.getServerId()&&(u="selected");var d='<option class="margintop-clear" value="'+c.getId()+'" '+u+">"+c.getDisplayName()+"</option>";n.append(d)}},t._onChangeCheckCooperation=function(){var e=this,t=e._dialogInnerElement,n=null;n=e._mailServerList&&0!=e._mailServerList.getCount()?t.find(":input").not("#mail-cooperation-check"):t.find(":input");var o=t.find("#mail-cooperation-check").attr("checked");"checked"==o?n.removeAttr("disabled"):n.attr("disabled","disabled")},t.getInnerHtml=function(){var e="",t="",n="",o="",i=LoginUser.getInstance().getSettings().getMailCooperationList(),a=i.get(0);if(null!=a){t=a.getMailAddress();var r=a.getSettingInfo();a.getCooperationType()==MailCooperationInformation.SERVER_TYPE_POP&&(e='checked="checked"'),null!=r&&(n=r.getAccount(),o=r.getPassword())}var s="";return s='<form class="form-horizontal horizonal-form" id="mail_cooperation">',s+='<div class="control-group form_group">',s+="<span>",s+='<input id="mail-cooperation-check" type="checkbox" class="margintop-clear" name="cooperation-checkbox" '+e+">",s+='<label for="mail-cooperation-check">'+Resource.getMessage("config_mail_cooperation_check_cooperation_label")+"</label>",s+="</span>",s+="</div>",s+='<div class="control-group form_group">',s+='<label class="control-label form_label label_mailinfo">'+Resource.getMessage("config_mail_cooperation_server_label")+"</label>",s+='<div class="controls form_controls">',s+='<select id="pop_server_list" class="ui-corner-all">',s+="</select>",s+="</div>",s+="</div>",s+='<div class="control-group form_group">',s+='<label class="control-label form_label label_mailinfo">'+Resource.getMessage("config_mail_cooperation_mail_address_label")+"</label>",s+='<div class="controls form_controls">',s+='<input type="text" class="ui-corner-all" id="mail_address" value="'+Utils.convertEscapedTag(t)+'">',s+="</div>",s+="</div>",s+='<div class="control-group form_group">',s+='<label class="control-label form_label label_mailinfo">'+Resource.getMessage("config_mail_cooperation_pop3_account_label")+"</label>",s+='<div class="controls form_controls">',s+='<input type="text" class="ui-corner-all" id="mail_account" value="'+Utils.convertEscapedTag(n)+'">',s+="</div>",s+="</div>",s+='<div class="control-group form_group">',s+='<label class="control-label form_label label_mailinfo">'+Resource.getMessage("config_mail_cooperation_pop3_password_label")+"</label>",s+='<div class="controls form_controls">',s+='<input type="password" id="mail_password" class="ui-corner-all" value="'+Utils.convertEscapedTag(o)+'">',s+="</div>",s+="</div>",s+='<p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',s+="</form>"},t.submit=function(e){function t(t,n){if(t)LoginUser.getInstance().getSettings().setMailCooperationList(i),$(e).dialog("close");else{var a=Resource.getMessage("mail_setting_error_message");o.find("#dialog-error").text(a)}}for(var n=this,o=n._dialogInnerElement,i=new MailCooperationInfoList,a=LoginUser.getInstance().getSettings().getMailCooperationList(),r=a.getCount(),s=null,l=0;r>l;l++)s=a.get(l);if(!n._isChangeData(s))return void $(e).dialog("close");var u=o.find("#mail-cooperation-check").attr("checked");if("checked"==u){if(!n._isValidationOk(o))return;s.setCooperationType(MailCooperationInformation.SERVER_TYPE_POP)}else s.setCooperationType(MailCooperationInformation.SERVER_TYPE_NON);var c=o.find("#pop_server_list");s.setServerId(c.val()),s.setServerName(c.text()),s.setMailAddress(o.find("#mail_address").val());var d=new PopSettingInfomation;d.setAccount(o.find("#mail_account").val()),d.setPassword(o.find("#mail_password").val()),s.setSettingInfo(d),i.add(s),CubeeController.getInstance().changeMailCooperationSetting(i,t)},t._isChangeData=function(e){var t=this,n=t._dialogInnerElement,o=!1,i=n.find("#mail-cooperation-check").attr("checked"),a=n.find("#pop_server_list").val(),r=n.find("#mail_address").val(),s=n.find("#mail_account").val(),l=n.find("#mail_password").val(),u=e.getSettingInfo();if("checked"==i)e.getCooperationType()==MailCooperationInformation.SERVER_TYPE_NON&&(o=!0);else if(e.getCooperationType()==MailCooperationInformation.SERVER_TYPE_POP&&(o=!0),o)return o;return e.getId()!=parseInt(a)&&(o=!0),e.getMailAddress()!=r&&(o=!0),null!=u?(u.getAccount()!=s&&(o=!0),u.getPassword()!=l&&(o=!0)):(null!=s&&""!=s&&(o=!0),null!=l&&""!=l&&(o=!0)),o},t._isValidationOk=function(e){if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=!1,n=e.find("#mail_address"),o=e.find("#mail_account"),i=e.find("#mail_password"),a=(e.find("#pop_server_list").val(),Utils.trimStringMulutiByteSpace(n.val())),r=Utils.trimStringMulutiByteSpace(o.val()),s=Utils.trimStringMulutiByteSpace(i.val());e.find("#dialog-error").text(""),n.removeClass("input-error"),o.removeClass("input-error"),i.removeClass("input-error");var l=e.find("#mail-cooperation-check").attr("checked");return"checked"==l&&(null==a||""==a?(n.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("config_mail_cooperation_error_mail_address_must"))):null==r||""==r?(o.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("config_mail_cooperation_error_mail_server_account_must"))):null==s||""==s?(i.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("config_mail_cooperation_error_mail_server_password_must"))):ViewUtils.checkRegexp(n,/([!-~])+$/)?ViewUtils.checkRegexp(i,/([!-~])+$/)?t=!0:(i.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("config_mail_cooperation_error_mail_server_password_invalid"))):(n.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("config_mail_cooperation_error_mail_address_invalid")))),t}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogChatRoomUpdateRoomInfoView.prototype=$.extend({},DialogSettingView.prototype);var e=DialogSettingView.prototype,t=DialogChatRoomUpdateRoomInfoView.prototype;t._init=function(){var t=this;e._init.call(t),t._dialogAreaElement.html(t.getInnerHtml()),t._dialogInnerElement=t._dialogAreaElement.children();var n=t._dialogInnerElement,o=n.find("input#room_name");o.on("keypress",function(e){(e.which&&13==e.which||e.keyCode&&13==e.keyCode)&&t._updateRoomInfoExecute()}),t._dialogInnerElement.find(".modal_btn").on("click",function(){t._updateRoomInfoExecute()})},t.showDialog=function(){var e=this;e._onOpenDialog()},t._onOpenDialog=function(){function e(e){t._roomInfo=e,t._initInputData(),$("#modal_area").css("display","block"),$("#modal_area").prepend('<div class="overlay modal_exit"></div>'),t._dialogInnerElement.addClass("on").css("display","block").animate({"margin-top":0,opacity:1},200),$(".overlay").animate({opacity:.3},200)}var t=this,n=CubeeController.getInstance().getRoomInfo(t._roomId,e);return n?void 0:(console.log("GetRoomInfo Request is fail"),ViewUtils.modal_allexit(),!1)},t._initInputData=function(){var e=this,t=e._dialogInnerElement,n=t.find("input#room_name");if(e._roomInfo){var o=e._roomInfo.getRoomName();n.val(o);var i=e._roomInfo.getPrivacyType();e._dialogInnerElement.find("#gc_privacy_type").val(i),n.blur(),n.focus()}},t.getInnerHtml=function(){var e=this,t="";return t='<div id="grouptitle_modal" class="card modal_card">',t+='    <div class="card_title">',t+="      <p>"+e._title+"</p>",t+="    </div>",t+='    <div class="modal_content_wrapper">',t+='      <div class="modal_content">',t+='        <p class="modal_title">'+Resource.getMessage("dialog_label_roomname")+"</p>",t+='        <input type="text" id="room_name" placeholder="'+Resource.getMessage("dialog_placeholder_roomname")+'" class="field ui-corner-all" maxlength="50">',t+="      </div>",t+='    <div class="modal_content w50">',t+='      <p class="modal_title">'+Resource.getMessage("community_privacy")+"</p>",t+='      <select id="gc_privacy_type" class="field term-select ui-corner-all">            <option value="0" >'+Resource.getMessage("community_privacy_open")+'</option>            <option value="2" selected>'+Resource.getMessage("community_privacy_secret")+"</option>        </select>",t+="    </div>",t+="    </div>",t+='      <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',t+='    <div class="btn_wrapper">',t+='      <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+"</span></button>",t+="    </div>",t+='    <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',t+="</div>"},t._updateRoomInfoExecute=function(){function e(){}var t=this,n=t._dialogInnerElement;if(!t._isChangeData(n))return ViewUtils.modal_allexit(),!0;if(!t._isValidationOk(n))return!1;var o=n.find("input#room_name"),i=Utils.excludeControleCharacters(o.val());t._roomInfo.setRoomName(i);var a=parseInt($("#gc_privacy_type").val());t._roomInfo.setPrivacyType(a);var r=CubeeController.getInstance().updateChatRoomInfo(t._roomInfo,e);return r||console.log("UpdateRoomInfo Request is fail"),ViewUtils.modal_allexit(),!0},t._isChangeData=function(e){var t=this,n=!0;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var o=e.find("input#room_name"),i=o.val();return t._roomInfo&&i!=t._roomInfo.getRoomName()||t._roomInfo.getPrivacyType()==parseInt($("#gc_privacy_type").val())&&(n=!1),n},t._isValidationOk=function(e){var t=!0;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var n=e.find("input#room_name"),o=n.val();e.find("#dialog-error").text(""),n.removeClass("input-error"),(""==o||""==Utils.trimStringMulutiByteSpace(o))&&(n.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("group_chat_error_room_name")),t=!1);var i=parseInt(e.find("#gc_privacy_type").val());return 0!=i&&2!=i&&(e.find("#dialog-error").text(Resource.getMessage("dialog_error_invalid_input")),t=!1),t}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogChatRoomCreateRoomInfoView.prototype=$.extend({},DialogSettingView.prototype);var e=DialogSettingView.prototype,t=DialogChatRoomCreateRoomInfoView.prototype;t._init=function(){var t=this;e._init.call(t),t.frame=t.getInnerHtml(),t.selectUserListView=new SelectUserListView,t.selectUserListView.init({hasAuthority:!0,loginUserInfo:LoginUser.getInstance(),excludedList:[]}),TabManager.getInstance().isActiveMyWorkplace()?t.frame.find(".modal_list").append(t.selectUserListView.getInitialView()):t.frame.find(".modal_list").append(t.selectUserListView.getInitialGroupView($(".project_btn").attr("data_value"))),t._dialogAreaElement.html(t.frame),t._dialogInnerElement=t._dialogAreaElement.children(),t.ps=new PerfectScrollbar(t.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),TabManager.getInstance().isActiveMyWorkplace()||t.frame.find(".scroll_content").on("scroll",function(){if($(this).get(0).scrollHeight===$(this).scrollTop()+$(this).get(0).clientHeight){if(t.frame.find(".select_list").children("li").size()>=t.selectUserListView.allPersons.length)return void t.frame.find(".scroll_content").off();t.selectUserListView.addPersons()}}),t._createEventHandler();var n=Utils.getDate(Utils.DISPLAY_STANDARD_DATE_FORMAT);n+=" "+Resource.getMessage("default_group_chat_suffix");var o=t.frame.find("input#room_name");o.val(n),t._callback=function(){t.cleanup(),ViewUtils.modal_allexit()}},t.cleanup=function(){var e=this;e.ps&&e.ps.destroy(),e.selectUserListView.cleanUp(),e.selectUserListView=null,e._dialogAreaElement=null,e._dialogInnerElement=null,e.frame=null},t.getInnerHtml=function(){var e="";return e+='<div id="addgroup_modal" class="card modal_card">',e+='<div class="card_title">',e+="<p>"+Resource.getMessage("dialog_title_create_groupchat")+"</p>",e+="</div>",e+='<div class="modal_content_wrapper pt10 pb5">',e+='<div class="modal_content mb10">',e+='<p class="modal_title">'+Resource.getMessage("group_chat_start_label_title")+"</p>",e+='<input type="text" maxlength="50" class="field ui-corner-all" id="room_name" value="">',e+="</div>",e+='<div class="modal_content mb0">',e+='<p class="notes">'+Resource.getMessage("dialog_note_1_create_groupchat")+"</p>",e+="</div>",e+="</div>",e+='<div class="list_wrapper">',e+='<ul class="modal_list select_content">',e+="</ul>",e+="</div>",e+='<div class="" style="height: 60px"></div>',e+='<div class="btn_wrapper">',e+='<p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',e+=' <button id="more_button" type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("button_create")+"</span></button>",e+="</div>",e+='<a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',e+="</div>",$(e)},t._createEventHandler=function(){var e=this;e.frame.find("#more_button").on("click",function(){e._createRoomInfoExecute()})},t._createRoomInfoExecute=function(){function e(e){function n(){var e=CubeeController.getInstance().getChatroomManager().hasCreatingRoomIdList(r+"notification1"),t=CubeeController.getInstance().getChatroomManager().hasCreatingRoomIdList(r+"notification2");
null!=e&&null!=t||0==a?(CubeeController.getInstance().getChatroomManager().delCreatingRoomIdList(r),CubeeController.getInstance().getChatroomManager().delCreatingRoomIdList(r+"notification1"),CubeeController.getInstance().getChatroomManager().delCreatingRoomIdList(r+"notification2")):(--a,setTimeout(n,1e3))}var a=10;if(0==e.errorCode&&null!=e.content&&1==e.content.result){var r=e.content.items[0].roomId;CubeeController.getInstance().getChatroomManager().addCreatingRoomIdList(r,_defineProperty({},r,!0)),i.dialog("close"),o._callback(),setTimeout(n,1e3)}else if(t(403e3==e.content.reason?Resource.getMessage("authority_err"):404e3==e.content.reason?e.content.error_users+Resource.getMessage("not_assign_account_type_err"):Resource.getMessage("groupchat_community_err")),e.content.hasOwnProperty("deleted")){var r=e.content.roomId;CubeeController.getInstance().getChatroomManager().addCreatingRoomIdList(r,_defineProperty({},r,!1)),setTimeout(n,1e3)}}function t(e){var t=i.find("#dialog-error");t.text(e),i.parent().find("button").eq(0).attr("disabled",!1),i.parent().find("button").eq(1).attr("disabled",!1),$(".ui-dialog-titlebar-close").show()}function n(){i.parent().find("button").eq(0).attr("disabled",!0),i.parent().find("button").eq(1).attr("disabled",!0),$(".ui-dialog-titlebar-close").hide(),ViewUtils.hideLoadingIconInChild($("#dialog-error")),ViewUtils.showLoadingTopInChild($("#dialog-error"))}var o=this,i=o.frame;if(!o._isValidationOk())return!1;n();var a=o._setCreateChatRoomInfo();CubeeController.getInstance().createChatRoom(a,e)},t._setCreateChatRoomInfo=function(){var e=this,t=new ChatRoomInformation,n=e._dialogInnerElement,o=LoginUser.getInstance().getJid(),i=LoginUser.getInstance().getLoginAccount(),a=$(".project_btn").attr("data_value");TabManager.getInstance().isActiveMyWorkplace()&&(a=""),t.setParentRoomId(a);var r=n.find("input#room_name");t.setRoomName(Utils.excludeControleCharacters(r.val()));for(var s=e.selectUserListView.getSelectedUserList(),l=s.length,u=0;l>u;u++){var c=s[u],d=c.jid,g=c.accountName,m=c.authority;t.addMemberList(d,m,g)}return t.addMemberList(o,AuthorityDef.AUTHORITY_ACTIONS.GC_MANAGE,i),t.setCreatedBy(o),t},t._isValidationOk=function(){var e=this,t=e._dialogInnerElement,n=!0;if(!t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return n=!1;var o=t.find("input#room_name"),i=o.val();return t.find("#dialog-error").text(""),o.removeClass("input-error"),(""==i||""==Utils.trimStringMulutiByteSpace(i))&&(o.addClass("input-error"),t.find("#dialog-error").text(Resource.getMessage("group_chat_error_room_name")),n=!1),n},$(function(){var e=$("#left_sidebar").find(".groupchat_list .list_ttl a");e.on("click",function(){var e=new DialogChatRoomCreateRoomInfoView;e.showDialog()})})}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(){return'<input type="file" name="logofile" accept="image/jpeg, image/gif, image/png">'}DialogCommunityCreateSettingBaseView.prototype=$.extend({},DialogSettingView.prototype);var t=DialogSettingView.prototype,n=DialogCommunityCreateSettingBaseView.prototype;n._init=function(){var e=this;t._init.call(e)},n.clearInputCommunityLogo=function(){var t=this,n=t._dialogInnerElement;n.find(".modal_content").find('input[type="file"]').replaceWith(e()),n.find(".modal_content").find("img.form-img-community-logo").attr("src",n.find(".modal_content").find("img.form-img-community-logo").attr("data-ex-src"))},n.getInnerHtml=function(){var e="";e+='<div id="addproject_modal" class="card modal_card">',e+='  <div class="card_title">',e+="    <p>"+this.title+"</p>",e+="  </div>",e+='  <div class="modal_content_wrapper">',e+='    <div class="modal_content">',e+='      <p class="modal_title">'+Resource.getMessage("community_title")+"</p>",e+='      <input maxlength="50" type="text" class="field ui-corner-all" name="community-title">',e+="    </div>",e+='    <div class="modal_content">',e+='      <p class="modal_title">'+Resource.getMessage("community_description")+"</p>",e+='      <textarea maxlength="7000" class="field ui-corner-all" name="community-description" rows="3"></textarea>',e+="    </div>",e+='    <div class="modal_content w50">',e+='      <p class="modal_title">'+Resource.getMessage("community_privacy")+"</p>",e+='      <select id="project_privacy_type" class="field term-select ui-corner-all">            <option value="0" >'+Resource.getMessage("community_privacy_open")+'</option>            <option value="2" selected>'+Resource.getMessage("community_privacy_secret")+"</option>        </select>",e+="    </div>",e+='    <div class="modal_content w50">',e+='      <p class="modal_title">'+Resource.getMessage("community_member_entry_type")+"</p>",e+='      <p class="fwb mb0">'+Resource.getMessage("community_member_entry_type_add")+"</p>",e+="    </div>",e+='    <div class="modal_content mb0">',e+='      <p class="modal_title">'+Resource.getMessage("community_color")+"</p>",e+='      <div class="project_color">',e+='        <label class="color_box">',e+='          <input type="radio" name="community-color" value="#E04F5F"><span></span>',e+="        </label>",e+='        <label class="color_box">',e+='          <input type="radio" name="community-color" value="#E7953B"><span></span>',e+="        </label>",e+='        <label class="color_box">',e+='          <input type="radio" name="community-color" value="#FAD43D"><span></span>',e+="        </label>",e+='        <label class="color_box">',e+='          <input type="radio" name="community-color" value="#98D44E"><span></span>',e+="        </label>",e+='        <label class="color_box">',e+='          <input type="radio" name="community-color" value="#32BEA6"><span></span>',e+="        </label>",e+='        <label class="color_box">',e+='          <input type="radio" name="community-color" value="#51B8FD"><span></span>',e+="        </label>",e+='        <label class="color_box">',e+='          <input type="radio" name="community-color" value="#187BCE"><span></span>',e+="        </label>",e+='        <label class="color_box">',e+='          <input type="radio" name="community-color" value="#AF69C4"><span></span>',e+="        </label>",e+='        <label class="color_box">',e+='          <input type="radio" name="community-color" value="#F195AD"><span></span>',e+="        </label>",e+='        <label class="color_box">',e+='          <input type="radio" name="community-color" value="#A17255"><span></span>',e+="        </label>",e+='        <label class="color_box">',e+='          <input type="radio" name="community-color" value="#8CA8BC"><span></span>',e+="        </label>",e+='        <label class="color_box">',e+='          <input type="radio" name="community-color" value="#555555"><span></span>',e+="        </label>",e+="      </div>",e+="    </div>",e+='    <div class="modal_content mb0">',e+='        <p class="modal_title">'+Resource.getMessage("community_logo")+"</p>",e+='                <img class="form-img-community-logo" src="images/no_image.png" data-ex-src="images/no_image.png">',e+='                <div id="community-logo-field">',e+='                    <input type="file" name="logofile" accept="image/jpeg, image/gif, image/png">';var t=CubeeController.getInstance().getAccessToken(),n=LoginUser.getInstance().getLoginAccount();return e+='                    <input type="hidden" name="accesstoken" value="'+t+'">',e+='                    <input type="hidden" name="account" value="'+n+'">',e+='                    <input type="hidden" name="roomid" value="">',e+="                </div>",e+="    </div>",e+="  </div>",e+='  <div class="btn_wrapper">',e+='    <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',e+='    <button type="button" id="onCreatePrj" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">'+this._submitButtonTitle+"</span></button>",e+="  </div>",e+='    <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',e+="</div>"},n.submit=function(e){var t=this,n=t._dialogInnerElement,o=t._isValidateOk(n);o&&t._request(e)},n._isValidateOk=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=!0,n=e.find('input[name="community-title"]'),o=e.find('textarea[name="community-description"]'),i=n.val();o.val();return n.removeClass("dialog-error"),o.removeClass("dialog-error"),""==Utils.trimStringMulutiByteSpace(i)&&(t=!1,e.find("#dialog-error").text(Resource.getMessage("config_community_title_empty")),n.addClass("input-error")),t},n._request=function(e){},n._createEventHandler=function(){var e=this,t=e._dialogInnerElement;t.on("change",'input[type="file"]',function(){t.find("#dialog-error").text("");var n=this.files[0];if(!n)return void e.clearInputCommunityLogo();switch(n.type){case"image/jpeg":case"image/gif":case"image/png":case"image/bmp":break;default:return e.clearInputCommunityLogo(),void t.find("#dialog-error").text(Resource.getMessage("config_community_logo_failed"))}if(n.size<=0||n.size>Conf.getVal("COMMUNITY_LOGO_SIZE_LIMIT"))return e.clearInputCommunityLogo(),void t.find("#dialog-error").text(Resource.getMessage("config_community_community_large"));if(!window.FileReader)return void t.find("img").css("filter","alpha(opacity=30)");var o=new FileReader;o.onload=function(){t.find("img").attr("src",o.result)},o.readAsDataURL(n)}),t.find("textarea").on("ready",function(){$(this).autosize()}),$("#onCreatePrj").click(function(){var t=this;e.submit(t)}),$("#modal_area .modal_card .project_color .color_box").click(function(){var e=$("input[name=community-color]:checked").val();$("input[name=community-color]").click(function(){$(this).val()==e?($(this).prop("checked",!1),e=!1):e=$(this).val()})}),$("#modal_area .modal_card .project_color .color_box").each(function(){var e=$(this).children('input[type="radio"]').val();$(this).children("span").css("background-color",e)})}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogSelectMemberView.prototype=$.extend({},DialogSettingView.prototype);var e=DialogSettingView.prototype,t=DialogSelectMemberView.prototype;t._init=function(){var t=this;e._init.call(t),t._dialogInnerElement.find("#dialog-error").css("text-align","center"),t._dialogInnerElement.find("#dialog-error").css("padding-top","30px")},t.getInnerHtml=function(){var e=this,t="";return t+="<div>",t+='  <form name="member-input-area">',t+='    <div class="member-setting-table member-setting-table-left">',t+='      <div class="label">'+e._memberInputAreaLabel+"</div>",t+='      <div class="input-form"><textarea placeholder="'+Resource.getMessage("dialog_placeholder_account")+'" name="input-member" class="ui-corner-all width-100 '+e._autoCompleteCssCls+'" groupId="'+e._groupId+'"/></div>',t+='      <div class="submit-button-area"><button type="submit">'+e._memberAddButtonLabel+"</button></div>",t+="    </div>",t+="  </form>",t+='  <div class="member-setting-table">',t+='    <div class="label aligin-top">'+e._memberListAreaLabel+"</div>",t+='    <div class="input-form">',t+='      <ul name="member-list" class="ui-widget-content ui-corner-all width-100">',t+="      </ul>",t+="    </div>",t+="  </div>",t+='  <p id="dialog-error" class="ui-state-error-text dialog_error_footer member-setting-error"></p>',t+="</div>"},t.submit=function(e){var t=this,n=t._createMemberListFromMemberListElement(),o=t._dialogInnerElement,i=o.find('ul[name="member-list"]'),a=o.find("#dialog-error");return 0==n.getCount()?(i.addClass("input-error"),void a.text(Resource.getMessage("not_exist_in_list"))):void t._request(n,e)},t._request=function(e,t){},t._createEventHandler=function(){var e=this,t=e._dialogInnerElement,n=t.find('form[name="member-input-area"]');n.find("button").button(),n.on("submit",function(){return e._onAddMemberToList(),!1});var o=t.find('textarea[name="input-member"]');t.on("ready",function(){var e="@";o.val(e),o.focus()}),o.on("keydown",function(t){t.which&&13==t.which||t.keyCode&&13==t.keyCode?e._ctrlFlg&&e._onAddMemberToList():t.which&&17==t.which||t.keyCode&&17==t.keyCode?e._ctrlFlg=!0:e._ctrlFlg=!1}),o.on("keyup",function(t){(t.which&&17==t.which||t.keyCode&&17==t.keyCode)&&(e._ctrlFlg=!1)})},t._onAddMemberToList=function(){function e(e,o){n._isValidateOk(e,o,t)}function t(e){if(e){for(var t=e.memberList.getCount(),o=0;t>o;o++){var a=e.memberList.get(o),r=n._createMemberElement(a);if(null!=r){n._addMemberListArea(r);var s=new RegExp("@"+a.getLoginAccount()+"[\\s,]+","g");i.attr("value",i.attr("value").replace(s,""))}}n._setErrorText(e.errList),n._removeDelimiterForCalcInputMemberList(i)}}var n=this,o=n._dialogInnerElement,i=o.find('textarea[name="input-member"]'),a=o.find('ul[name="member-list"]');o.find("#dialog-error").text(""),i.removeClass("input-error"),a.removeClass("input-error"),n._addDelimiterForCalcInputMemberList(i),n._getMemberListFromInputArea(e)},t._addDelimiterForCalcInputMemberList=function(e){var t=e.attr("value");""!==t&&e.attr("value",t+" ")},t._removeDelimiterForCalcInputMemberList=function(e){var t=e.attr("value");""!=t&&" "==t.substr(t.length-1)&&e.attr("value",t.substr(0,t.length-1))},t._addMemberListArea=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this,n=t._dialogInnerElement,o=n.find('ul[name="member-list"]');0!=o.length&&o.append(e)}},t._createMemberElement=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return null;var t=e.getJid(),n=e.getUserName(),o=e.getLoginAccount(),i="";i="<li>",i+='  <span class="item text-abbreviation"></span>',i+='  <span class="cancel"><img src="images/add_close.png"></span>',i+="</li>",i=$(i);var a=n+"@"+o;return i.children("span.item").attr("jid",t),i.children("span.item").text(a),i.children("span.cancel").children().on("click",function(){i.remove()}),i},t._isValidateOk=function(e,t,n){var o=_self._validateInputMemberList(e,t);_self._isValidateJoinedMember(o,n)},t._isExistMemberArea=function(e){var t=this,n=t._dialogInnerElement,o=n.find('ul[name="member-list"]'),i=o.find("li").children('span.item[jid="'+e+'"]');n.find('textarea[name="input-member"]'),n.find("#dialog-error");return 0==i.length?!1:!0},t._createMemberListFromMemberListElement=function(){var e=this,t=e._dialogInnerElement,n=t.find('ul[name="member-list"]');if(0!=n.length){var o=new ArrayList;return n.children("li").each(function(){var e=$(this).children("span.item").attr("jid");o.add(e)}),o}},t._setErrorText=function(e){var t=this,n=t._dialogInnerElement,o=n.find('textarea[name="input-member"]');if(n.find("#dialog-error").text(""),o.removeClass("input-error"),e.getCount()>0){o.addClass("input-error");for(var i="",a=0;a<e.getCount();a++)""!=i&&(i+="<br />"),i+=e.get(a);n.find("#dialog-error").html(i)}},t._getMemberListFromInputArea=function(e){function t(t){e&&"function"==typeof e&&setTimeout(function(){e(r,t)},1)}var n=this,o=n._dialogInnerElement,i=o.find('textarea[name="input-member"]'),a=i.val();a=Utils.replaceAll(a,""," "),a=Utils.replaceAll(a,","," "),a=Utils.replaceAll(a,""," "),a=Utils.replaceAll(a,"\r\n"," "),a=Utils.replaceAll(a,"\r"," "),a=Utils.replaceAll(a,"\n"," "),a=Utils.trimStringMulutiByteSpace(a);var r=[];if(""==a)return void t(new StringMapedArrayList);r=a.split(" ");for(var s=new ArrayList,l=0;l<r.length;l++)if(!(null==r[l]||r[l].length<1)){for(var u=!1,c=s.getCount(),d=0;c>d;d++)if(r[l]==ViewUtils.ACCOUNT_PREFIX+s.get(d)){u=!0;break}if(!u){var g=r[l].indexOf(ViewUtils.ACCOUNT_PREFIX);if(0==g){var m=r[l].substring(1,r[l].length);s.add(m)}}}return 0==s.getCount()?void t(new StringMapedArrayList):void CubeeController.getInstance().getPersonDataByLoginAccountFromServer(s,t)},t._validateInputMemberList=function(e,t){var n=new PersonList,o=new ArrayList,i=this,a=e.length;if(0==a)return o.add(Resource.getMessage("add_member_err_input")),{memberList:n,errList:o};for(var r="",s="",l=0;a>l;l++){var u=e[l],c=u.indexOf(ViewUtils.ACCOUNT_PREFIX);if(0==c){u=u.substring(1,u.length);var d=t.getByKey(u);null!=d?i._isExistMemberArea(d.getJid())?(""!==s&&(s+=" "),s+=Utils.convertEscapedHtml(e[l])):n.add(d):(""!==r&&(r+=" "),r+=Utils.convertEscapedHtml(e[l]))}else""!==r&&(r+=" "),r+=Utils.convertEscapedHtml(e[l])}return""!==r&&o.add('"'+r+'"'+Resource.getMessage("add_member_err_not_exist_account")),""!==s&&o.add('"'+s+'"'+Resource.getMessage("exist_in_list")),{memberList:n,errList:o}},t._isValidateJoinedMember=function(e,t){var n=new PersonList,o=new PersonList;t(_self._validateJoinedMember(e,n,o))},t._validateJoinedMember=function(e,t,n){return e},t.setInputAccount=function(e){var t=this;if(e&&!(e.length<0)){var n=t._dialogInnerElement,o=n.find('textarea[name="input-member"]');o.val(e.join(" "))}}}(),function(){DialogSelectChatRoomMemberView.prototype=$.extend({},DialogSelectMemberView.prototype);var e=DialogSelectMemberView.prototype,t=DialogSelectChatRoomMemberView.prototype;t._init=function(){var t=this;e._init.call(t)},t._isValidateJoinedMember=function(e,t){function n(n){var i=new PersonList,a=new PersonList;if(null===n)return void setTimeout(function(){t(null)},100);for(var r=e.memberList,s=r.getCount(),l=n.getMemberList(),u=l.getCount(),c=0;s>c;c++){for(var d=!1,g=e.memberList.get(c).getJid(),m=0;u>m;m++)if(g==l.get(m)){d=!0;break}d?i.add(r.get(c)):a.add(r.get(c))}t(o._validateJoinedMember(e,i,a))}var o=this,i=o._groupId,a=ColumnManager.getInstance()._getChatroomInformationFromColumnObjByRoomId(i);if(null===a){var r=CubeeController.getInstance().getRoomInfo(i,n);if(!r)return console.log("GetRoomInfo Request is fail"),o._dialogInnerElement.dialog("close"),!1}else n(a)},t._getRoomMemberList=function(e){return new Promise(function(t,n){function o(e){return null==e?n("getPersonData result no data"):void t(e)}function i(e){return null==e?n("GetRoomInfo result no data"):void CubeeController.getInstance().getPersonDataByJidFromServer(e.getMemberList(),o)}var a=ColumnManager.getInstance()._getChatroomInformationFromColumnObjByRoomId(e);if(null==a){var r=CubeeController.getInstance().getRoomInfo(e,i);if(!r)return n("GetRoomInfo Request is fail")}else i(a)})}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogSelectChatRoomAddMemberView.prototype=$.extend({},DialogSelectChatRoomMemberView.prototype);var e=(DialogSelectChatRoomMemberView.prototype,DialogSelectChatRoomAddMemberView.prototype);e._init=function(){function e(e){var t=e.content.users,n={},o=!0,i=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){var l=r.value;n[l.user]=l.policies[0].rights[0].action}}catch(u){i=!0,a=u}finally{try{!o&&s["return"]&&s["return"]()}finally{if(i)throw a}}return n}var t=this;t.displayMembers=[],t.allItemCount=-1,t.personCount=0,t.startId=0,t.frame=t.getHtml(),t._dialogAreaElement.html(t.frame),t._dialogInnerElement=t._dialogAreaElement.children(),t.ps=new PerfectScrollbar(t.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t.frame.find(".scroll_content").off("scroll"),t.frame.find(".scroll_content").on("scroll",function(){$(this).get(0).scrollHeight===$(this).scrollTop()+$(this).get(0).clientHeight&&t.searchExecute()}),t.memberList=new ArrayList,t._dialogInnerElement.find(".success_btn").off("click"),t._dialogInnerElement.find(".success_btn").on("click",function(){t._request(t.memberList,t)}),t._dialogInnerElement.find(".user_search_btn").off("click"),t._dialogInnerElement.find(".user_search_btn").on("click",function(){t.firstSearch()}),t._dialogInnerElement.find(".field").keypress(function(e){return(e.which&&13===e.which||e.keyCode&&13===e.keyCode)&&t.firstSearch(),13!==e.which}),t._dialogInnerElement.find("input[name=allcheck]").off("change"),t._dialogInnerElement.find("input[name=allcheck]").on("change",function(){t._dialogInnerElement.find("input[name=addprojectmember]").prop("checked",this.checked);for(var e=t._dialogInnerElement.find("input[name=addprojectmember]"),n=t._dialogInnerElement.find("select.field[name=authority]"),o=[],i=0;i<e.length;i++)e[i].checked&&(o[e[i].value]=n[i].value);if(this.checked){for(var a in o)if(0===t.memberList._array.filter(function(e){return e.jid===a}).length){var r=t.displayMembers.filter(function(e){return e.getJid()===a})[0];t.memberList.add({jid:a,action:o[a],accountName:r._profile._loginAccount})}}else for(var i=0;i<e.length;i++)t.memberList.remove(t.memberList._array.map(function(e){return e.jid}).indexOf(e[i].value));var s=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(s)}),t.groupMembers=[],Promise.all([CubeeController.getInstance().getUserPoliciesByResource(t._roomId),t._getRoomMemberList(t._roomId)]).then(function(n){t.allAuthLists=e(n[0]),t.groupMembers=n[1];var o=LoginUser.getInstance(),i=Utils.getSafeArrayData(o.getGroup()),a=i.length>0?i[0]:"";t._dialogInnerElement.find("input.field").val(a),t.searchExecute()})["catch"](function(e){})},e.firstSearch=function(){var e=this;e.allItemCount=-1,e.personCount=0,e.startId=0,e.displayMembers=[],e._dialogInnerElement.find(".select_list").empty(),e.searchExecute(),e.frame.find(".scroll_content").scrollTop(0)},e.getHtml=function(){var e='<div id="addprojectmember_modal" class="card modal_card">          <div class="card_title">            <p>'+Resource.getMessage("community_add_member_dialog_title")+'</p>          </div>          <div class="select_menu">            <span class="select_number"><i class="fa fa-user"></i><span class="checkedCnt">0</span></span>            <form class="search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("wizard_chatlist_conditions")+'">              <button type="button" name="search" class="user_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>            <label class="modal_btn all_check">'+Resource.getMessage("wizard_chatlist_allcheck")+'<label class="checkbox"><input name="allcheck" type="checkbox"><span></span></label></label>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>            <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text"></span></button>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},e._createMemberElement=function(e){var t=this,n=e._array,o=LoginUser.getInstance(),i=o.getJid();$.each(n,function(e,n){if(i!==n.getJid()){var o=Utils.getSafeStringData(n.getUserName());o=Utils.convertEscapedHtml(o);var a=n._profile._loginAccount,r=Utils.getSafeArrayData(n.getGroup());r=r.length>0?r.join(","):Resource.getMessage("group_title_no_group"),r=Utils.convertEscapedHtml(r);var s=ViewUtils.getAvatarDataHtmlFromPerson(n),l='<li title="'+o+" "+r+'"><label>                   <span class="ico ico_user"></span>                    <span class="name">'+o+'</span>                    <span class="group">'+r+'</span>                    <label class="checkbox">                     <input type="checkbox" name="addprojectmember"><span></span></label>                    <select class="field" name="authority">                   <option value="'+AuthorityDef.AUTHORITY_ACTIONS.GC_MANAGE+'">'+Resource.getMessage("policy_manage")+'</option>                   <option value="'+AuthorityDef.AUTHORITY_ACTIONS.GC_SEND+'" selected>'+Resource.getMessage("policy_send")+'</option>                   <option value="'+AuthorityDef.AUTHORITY_ACTIONS.GC_VIEW+'">'+Resource.getMessage("policy_view")+"</option>                   </select> </label></li>",u=$(l);t._dialogInnerElement.find(".select_list").append(u);if(u.find(".ico_user").append(s),u.find("input:checkbox").val(n.getJid()),t.allAuthLists.hasOwnProperty(a)){var c=t.allAuthLists[a];u.find('select.field option[value="'+c+'"]').prop("selected",!0)}0<=t.memberList._array.map(function(e){return e.jid}).indexOf(n.getJid())&&u.find("input:checkbox").prop("checked",!0);var d=t.groupMembers._array.map(function(e){return e.getJid()});-1===d.indexOf(n.getJid())?(u.find("input[name=addprojectmember]").off("change"),u.find("input[name=addprojectmember]").on("change",function(){var e=this.value,n=t.displayMembers.filter(function(t){return t.getJid()===e})[0],o=u.find("select.field[name=authority]").val();this.checked?t.memberList.add({jid:this.value,action:o,accountName:n._profile._loginAccount}):t.memberList._array.forEach(function(n,o){n.jid===e&&t.memberList.remove(o)});var i=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(i)}),u.find("select.field[name=authority]").off("change"),u.find("select.field[name=authority]").on("change",function(){var e=this.value,n=u.find("input[name=addprojectmember]").val();t.memberList._array.filter(function(e){return e.jid===n}).forEach(function(t){return t.action=e})})):(u.find("input[name=addprojectmember]").prop("disabled",!0),u.find("input[name=addprojectmember]").attr("name",""),u.find(".field").prop("disabled",!0))}})},e.searchExecute=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,this);if(t.displayMembers.length!==t.allItemCount){t._dialogInnerElement.find("input[name=allcheck]").prop("checked",!1);var n=e?e:t.frame.find(".field").val(),o=Utils.trimStringMulutiByteSpace(n);if(o&&""!=o){var i=ViewUtils.getKeywordFilterFromKeywordInputString(o,!1);if(i&&"object"==("undefined"==typeof i?"undefined":_typeof(i))){var a=new ColumnSortCondition;a.getItems().removeAll(),a.getItems().add("login_account"),a.getOrders().removeAll(),a.getOrders().add(ColumnSortCondition.SORT_ORDER_ASC);var r=i,s=new ColumnSearchCondition(r,a),l=Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST");return CubeeController.getInstance().searchPerson(t.startId,l,s,function(e){var n=e._array[e._array.length-1];t.startId=n?n.getId():0,t.displayMembers=t.displayMembers.concat(e._array),t.allItemCount=e._allItemCount,t.personCount+=e.getCount(),t._createMemberElement(e)})}}}},e._createMemberListFromMemberListElement=function(){var e=this,t=e._dialogInnerElement,n=t.find('ul[name="member-list"]');if(0!=n.length){var o=new ArrayList;return n.children(".change_authority").each(function(){var e=$(this).children("span.item").attr("accountName"),t=$(this).children("span.item").attr("jid"),n=$("#auth_list_"+e).children("option:selected").val();o.add({jid:t,action:n,accountName:e})}),o}},e.getPersonData=function(e){return new Promise(function(t,n){function o(e){t(e)}for(var i=new ArrayList,a=0;a<e.getCount();a++)i.add(e.get(a).jid);CubeeController.getInstance().getPersonDataByJidFromServer(i,o)})},e._request=function(e,t){function n(t,n){for(var o=0;o<t.getCount();o++)for(var i=0;i<e.getCount();i++)t.get(o).getJid()==e.get(i).jid?e.remove(i):null==n.getByKey(e.get(i).jid)&&e.remove(i)}function o(){return new Promise(function(t,n){function o(o){return o.content.result?(i.push(o.content.items[0].members[0]),i.length==e.getCount()?t(o):void 0):n(o)}for(var i=[],a=0;a<e.getCount();a++){var r=new ArrayList;r.add(e.get(a).jid),CubeeController.getInstance().addGroupChatRoomMember(l,r,o)}})}function i(e){if(null!=e){var t=[],n=!0,o=!1,i=void 0;try{for(var r,d=u[Symbol.iterator]();!(n=(r=d.next()).done);n=!0){var g=r.value;0!=c[g].length&&t.push(CubeeController.getInstance().assignPolicyToUser(Utils.getPolicyIdByActionAndResource(g,l),c[g]))}}catch(m){o=!0,i=m}finally{try{!n&&d["return"]&&d["return"]()}finally{if(o)throw i}}Promise.all(t).then(function(e){s.cleanup()})["catch"](function(e){a(403e3==e.content.reason?Resource.getMessage("authority_err"):404e3==e.content.reason?e.content.error_users+Resource.getMessage("not_assign_account_type_err"):Resource.getMessage("add_member_err_authority_change"))})}}function a(e){s._dialogInnerElement.find("#dialog-error").text(e),s._dialogInnerElement.find(".success_btn").attr("disabled",!1)}function r(){ViewUtils.hideLoadingIconInChild($("#dialog-error")),ViewUtils.showLoadingTopInChild($("#dialog-error")),s._dialogInnerElement.find(".success_btn").attr("disabled",!0),s._dialogInnerElement.find("#dialog-error").text("")}var s=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))&&0!=e.getCount()){var s=this,l=s._groupId,u=[AuthorityDef.AUTHORITY_ACTIONS.GC_MANAGE,AuthorityDef.AUTHORITY_ACTIONS.GC_SEND,AuthorityDef.AUTHORITY_ACTIONS.GC_VIEW],c={manageGroupchat:[],sendMessageToGroupchat:[],viewMessageInGroupchat:[]};r(),Promise.all([s._getRoomMemberList(l),s.getPersonData(e)]).then(function(t){n(t[0],t[1]);for(var i=0;i<e.getCount();i++){var a=e.get(i);c[a.action].push(a.accountName)}return 0==e.getCount()?void s.cleanup():o()}).then(function(e){i("")})["catch"](function(e){a(e.hasOwnProperty("content")?403e3==e.content.reason?Resource.getMessage("authority_err"):Resource.getMessage("add_member_err_submit"):Resource.getMessage("add_member_err_submit"))})}},e._isValidateOk=function(e,t,n){var o=this,i=o._validateInputMemberList(e,t);o._isValidateJoinedMember(i,n)},e._validateJoinedMember=function(e,t,n){for(var o="",i=t.getCount(),a=0;i>a;a++)""!==o&&(o+=" "),o+=Utils.convertEscapedHtml("@"+t.get(a).getLoginAccount());return""!==o&&e.errList.add('"'+o+'"'+Resource.getMessage("add_member_err_exist")),{memberList:n,errList:e.errList}},e.cleanup=function(){ViewUtils.modal_allexit()}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogSelectChatRoomChangeAuthorityMemberView.prototype=$.extend({},DialogSelectChatRoomMemberView.prototype);var e=(DialogSelectChatRoomMemberView.prototype,DialogSelectChatRoomChangeAuthorityMemberView.prototype);e._init=function(){function e(e){var t=e.content.users,n={},o=!0,i=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){var l=r.value;n[l.user]=l.policies[0].rights[0].action}}catch(u){i=!0,a=u}finally{try{!o&&s["return"]&&s["return"]()}finally{if(i)throw a}}return n}var t=this;t.frame=t.getHtml(),t.allMembers=[],t._dialogAreaElement.html(t.frame),t._dialogInnerElement=t._dialogAreaElement.children(),t.ps=new PerfectScrollbar(t.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t.personCount=0,t.frame.find(".scroll_content").off("scroll"),t.frame.find(".scroll_content").on("scroll",function(){$(this).get(0).scrollHeight===$(this).scrollTop()+$(this).get(0).clientHeight&&t.personCount!==t.allPersons.length&&t.addPersons()}),t._dialogInnerElement.find(".success_btn").off("click"),t._dialogInnerElement.find(".success_btn").on("click",function(){for(var e=new ArrayList,n=t._dialogInnerElement.find("select.field[name=authority]"),o=[],i=0;i<n.length;i++)o.push(n[i].value);$.each(t.allPersons._array,function(n,i){e.add({jid:i._jid,action:o[n]?o[n]:t.allAuthLists[i._profile._loginAccount],accountName:i._profile._loginAccount})}),t._request(e,t)}),Promise.all([CubeeController.getInstance().getUserPoliciesByResource(t._roomId),t._getRoomMemberList(t._roomId)]).then(function(n){
var o=e(n[0]);t.allPersons=n[1],t.allAuthLists=o,t.addPersons()})["catch"](function(e){})},e.getHtml=function(){var e='<div id="projectauthority_modal" class="card modal_card">        <div class="card_title">          <p>'+this._title+'</p>        </div>        <div class="list_wrapper scroll_content">          <ul class="modal_list select_list"></ul>        </div>        <div class="btn_wrapper">          <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>          <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+'</span></button>        </div>        <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>      </div>';return $(e)},e._createMemberElement=function(e,t){var n=this,o=LoginUser.getInstance().getJid();n.allMembers=e,$.each(n.allMembers,function(e,i){var a=i._profile,r=Utils.getSafeStringData(a._nickName);r=Utils.convertEscapedHtml(r);var s=a._loginAccount,l=ViewUtils.getAvatarDataHtmlFromPerson(i),u='<li title="'+r+" @"+s+'"><label>            <span class="ico ico_user"></span>             <span class="name">'+r+'</span>             <span class="group"></span>             <select class="field" name="authority">            <option value="'+AuthorityDef.AUTHORITY_ACTIONS.GC_MANAGE+'">'+Resource.getMessage("policy_manage")+'</option>            <option value="'+AuthorityDef.AUTHORITY_ACTIONS.GC_SEND+'">'+Resource.getMessage("policy_send")+'</option>            <option value="'+AuthorityDef.AUTHORITY_ACTIONS.GC_VIEW+'">'+Resource.getMessage("policy_view")+"</option>            </select>            </label></li>",c=$(u);n._dialogInnerElement.find(".select_list").append(c);if(c.find(".ico_user").append(l),c.find(".group").text("@"+s).html(),t.hasOwnProperty(s)){var d=t[s];c.find('select.field option[value="'+d+'"]').prop("selected",!0),o===i.getJid()&&c.find("select.field").attr("disabled","disabled")}})},e.addPersons=function(){for(var e=Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST"),t=this,n=[],o=t.personCount;o<Math.min(t.personCount+e,t.allPersons._length);o++)n.push(t.allPersons._array[o]);t.personCount+=n.length,t._createMemberElement(n,t.allAuthLists)},e._request=function(e,t){function n(e,t){function n(e,t){for(var n in e)-1!=e[n].indexOf(t)&&e[n].splice(e[n].indexOf(t),1);return e}for(var o,i=(o={},_defineProperty(o,l[0],[]),_defineProperty(o,l[1],[]),_defineProperty(o,l[2],[]),o),a=t,r=0;r<e.getCount();r++){var s=e.get(r);if(""==s.action)return null;for(var u=!1,c=0;c<l.length;++c){var d=l[c];if(s.action==d&&-1==t[d].indexOf(s.accountName)){i[d].push(s.accountName),u=!0;break}}u||(a=n(a,s.accountName))}return{update:i,"delete":a}}function o(e){var t,n=e.content.users,o=(t={},_defineProperty(t,l[0],[]),_defineProperty(t,l[1],[]),_defineProperty(t,l[2],[]),t),i=!0,a=!1,r=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;o[c.policies[0].rights[0].action].push(c.user)}}catch(d){a=!0,r=d}finally{try{!i&&u["return"]&&u["return"]()}finally{if(a)throw r}}return o}function i(e){r._dialogInnerElement.find("#dialog-error").text(e),r._dialogInnerElement.find(".success_btn").attr("disabled",!1)}function a(){ViewUtils.hideLoadingIconInChild($("#dialog-error")),ViewUtils.showLoadingTopInChild($("#dialog-error")),r._dialogInnerElement.find(".success_btn").attr("disabled",!0),r._dialogInnerElement.find("#dialog-error").text("")}var r=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))&&0!=e.getCount()){var r=this,s=r._groupId,l=[AuthorityDef.AUTHORITY_ACTIONS.GC_MANAGE,AuthorityDef.AUTHORITY_ACTIONS.GC_SEND,AuthorityDef.AUTHORITY_ACTIONS.GC_VIEW];a(),CubeeController.getInstance().getUserPoliciesByResource(s).then(function(t){var i=o(t),a=n(e,i);if(null==a)return Resource.getMessage("not_selected_authority_info");var r=[],u=!0,c=!1,d=void 0;try{for(var g,m=l[Symbol.iterator]();!(u=(g=m.next()).done);u=!0){var _=g.value;0!=a.update[_].length&&r.push(CubeeController.getInstance().assignPolicyToUser(Utils.getPolicyIdByActionAndResource(_,s),a.update[_])),0!=a["delete"][_].length&&r.push(CubeeController.getInstance().unassignPolicyFromUser(a["delete"][_],Utils.getPolicyIdByActionAndResource(_,s)))}}catch(f){c=!0,d=f}finally{try{!u&&m["return"]&&m["return"]()}finally{if(c)throw d}}return Promise.all(r)}).then(function(e){e==Resource.getMessage("not_selected_authority_info")?i(Resource.getMessage("not_selected_authority_info")):r.cleanup()})["catch"](function(e){i(403e3==e.content.reason?Resource.getMessage("authority_err"):404e3==e.content.reason?e.content.error_users+Resource.getMessage("not_assign_account_type_err"):Resource.getMessage("change_member_authority_err"))})}},e._isValidateOk=function(e,t,n){var o=this,i=o._validateInputMemberList(e,t);o._isValidateJoinedMember(i,n)},e._validateJoinedMember=function(e,t,n){for(var o="",i=t.getCount(),a=0;i>a;a++)""!==o&&(o+=" "),o+=Utils.convertEscapedHtml("@"+t.get(a).getLoginAccount());return""!==o&&e.errList.add('"'+o+'"'+Resource.getMessage("add_member_err_exist")),{memberList:n,errList:e.errList}},e.cleanup=function(){ViewUtils.modal_allexit()}}(),function(){DialogSelectChatRoomConfirmAuthorityMemberView.prototype=$.extend({},DialogSelectChatRoomMemberView.prototype);var e=(DialogSelectChatRoomMemberView.prototype,DialogSelectChatRoomConfirmAuthorityMemberView.prototype);e._init=function(){function e(e){var t=e.content.users,n={},o=!0,i=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){var l=r.value;n[l.user]=l.policies[0].rights[0].action}}catch(u){i=!0,a=u}finally{try{!o&&s["return"]&&s["return"]()}finally{if(i)throw a}}return n}var t=this;t.frame=t.getHtml(),t._dialogAreaElement.html(t.frame),t._dialogInnerElement=t._dialogAreaElement.children(),t.ps=new PerfectScrollbar(t.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t.personCount=0,t.frame.find(".scroll_content").off("scroll"),t.frame.find(".scroll_content").on("scroll",function(){$(this).get(0).scrollHeight===$(this).scrollTop()+$(this).get(0).clientHeight&&t.personCount!==t.allPersons.length&&t.addPersons()}),t._dialogInnerElement.find(".success_btn").off("click"),t._dialogInnerElement.find(".success_btn").on("click",function(){t.cleanup()}),Promise.all([CubeeController.getInstance().getUserPoliciesByResource(t._roomId),t._getRoomMemberList(t._roomId)]).then(function(n){var o=e(n[0]);t.allPersons=n[1],t.allAuthLists=o,t.addPersons()})["catch"](function(e){})},e.getHtml=function(){var e='<div id="projectauthority_modal" class="card modal_card">          <div class="card_title">            <p>'+this._title+'</p>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>            <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+'</span></button>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},e._createMemberElement=function(e,t){var n=this,o=(LoginUser.getInstance().getJid(),LoginUser.getInstance().getLoginAccount());$.each(e,function(e,i){var a=i._profile,r=Utils.getSafeStringData(a._nickName);r=Utils.convertEscapedHtml(r);var s=a._loginAccount,l=ViewUtils.getAvatarDataHtmlFromPerson(i),u='<li title="'+r+" @"+s+'"><label>              <span class="ico ico_user"></span>               <span class="name">'+r+'</span>               <span class="group"></span>               <select class="field" name="authority">              <option value="'+AuthorityDef.AUTHORITY_ACTIONS.GC_MANAGE+'">'+Resource.getMessage("policy_manage")+'</option>              <option value="'+AuthorityDef.AUTHORITY_ACTIONS.GC_SEND+'">'+Resource.getMessage("policy_send")+'</option>              <option value="'+AuthorityDef.AUTHORITY_ACTIONS.GC_VIEW+'">'+Resource.getMessage("policy_view")+"</option>              </select>              </label></li>",c=$(u);n._dialogInnerElement.find(".select_list").append(c);if(c.find(".ico_user").append(l),c.find(".group").text("@"+s).html(),t[o]&&"manageGroupchat"!=t[o]||o!=s){var d=t[s];c.find('select.field option[value="'+d+'"]').prop("selected",!0),c.find("select.field").attr("disabled","disabled")}})},e.addPersons=function(){for(var e=Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST"),t=this,n=[],o=t.personCount;o<Math.min(t.personCount+e,t.allPersons._length);o++)n.push(t.allPersons._array[o]);t.personCount+=n.length,t._createMemberElement(n,t.allAuthLists)},e.submit=function(e){_self.cleanup()},e.cleanup=function(){ViewUtils.modal_allexit()}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogSelectChatRoomForceLeaveMemberView.prototype=$.extend({},DialogSelectChatRoomMemberView.prototype);var e=(DialogSelectChatRoomMemberView.prototype,DialogSelectChatRoomForceLeaveMemberView.prototype);e._init=function(){var e=this;e.allMembers=[],e.frame=e.getHtml(),e._getRoomMemberList(e._roomId).then(function(t){e.allMembers=t._array,e.allPersons=t._array,e.addPersons()})["catch"](function(e){}),e._dialogAreaElement.html(e.frame),e._dialogInnerElement=e._dialogAreaElement.children(),e.ps=new PerfectScrollbar(e.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(e.ps),e.personCount=0,e.frame.find(".scroll_content").off("scroll"),e.frame.find(".scroll_content").on("scroll",function(){$(this).get(0).scrollHeight===$(this).scrollTop()+$(this).get(0).clientHeight&&e.personCount!==e.allPersons.length&&e.addPersons()}),e.memberList=new ArrayList,e._dialogInnerElement.find(".success_btn").off("click"),e._dialogInnerElement.find(".success_btn").on("click",function(){e._request(e.memberList,e)}),e._dialogInnerElement.find(".user_search_btn").off("click"),e._dialogInnerElement.find(".user_search_btn").on("click",function(){e.filterMembers()}),e._dialogInnerElement.find(".field").keypress(function(t){return(t.which&&13===t.which||t.keyCode&&13===t.keyCode)&&e.filterMembers(),13!==t.which}),e._dialogInnerElement.find("input[name=allcheck]").off("change"),e._dialogInnerElement.find("input[name=allcheck]").on("change",function(){e._dialogInnerElement.find("input[name=removeprojectmember]").prop("checked",this.checked);var t=e._dialogInnerElement.find("input[name=removeprojectmember]");if(this.checked)for(var n=0;n<t.length;n++)0===e.memberList._array.filter(function(e){return e===t[n].value}).length&&e.memberList.add(t[n].value);else for(var n=0;n<t.length;n++)e.memberList.remove(e.memberList._array.indexOf(t[n].value));var o=e.memberList.getCount();e._dialogInnerElement.find(".checkedCnt").text(o)})},e.getHtml=function(){var e='<div id="removeprojectmember_modal" class="card modal_card">          <div class="card_title">            <p>'+Resource.getMessage("dialog_title_group_chat_leave_member")+'</p>          </div>          <div class="select_menu">            <span class="select_number"><i class="fa fa-user"></i><span class="checkedCnt">0</span></span>            <form action="#" method="get" class="search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("wizard_chatlist_conditions_account")+'">              <button type="button" name="search" class="user_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>            <label class="modal_btn all_check">'+Resource.getMessage("wizard_chatlist_allcheck")+'<label class="checkbox"><input name="allcheck" type="checkbox"><span></span></label></label>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>            <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("button_force_leave")+'</span></button>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},e._createMemberElement=function(e){var t=this,n=LoginUser.getInstance(),o=n.getJid();$.each(e,function(e,n){if(o!==n.getJid()){var i=n._profile,a=Utils.getSafeStringData(i._nickName);a=Utils.convertEscapedHtml(a);var r="@"+i._loginAccount,s=ViewUtils.getAvatarDataHtmlFromPerson(n),l='<li title="'+a+" "+r+'"><label>                   <span class="ico ico_user"></span>                    <span class="name">'+a+'</span>                    <span class="group"></span>                    <label class="checkbox">                   <input type="checkbox" name="removeprojectmember"><span></span></label>                    </label></li>',u=$(l);t._dialogInnerElement.find(".select_list").append(u);u.find(".ico_user").append(s),u.find(".group").text(r).html(),u.find("input:checkbox").val(n._jid),0<=t.memberList._array.indexOf(n.getJid())&&u.find("input:checkbox").prop("checked",!0),u.find("input[name=removeprojectmember]").off("change"),u.find("input[name=removeprojectmember]").on("change",function(){var e=this.value;this.checked?t.memberList.add(this.value):t.memberList._array.forEach(function(n,o){n===e&&t.memberList.remove(o)});var n=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(n)})}})},e.filterMembers=function(){var e=this;e.personCount=0,e._dialogInnerElement.find(".select_list").empty(),e._dialogInnerElement.find("input[name=allcheck]").prop("checked",!1);var t=e.frame.find(".field").val(),n=e.allMembers.filter(function(e){var n=Utils.getSafeStringData(e.getUserName()),o=e._profile.getLoginAccount();return 0<=n.indexOf(t)||0<=o.indexOf(t)});e.allPersons=n,e.addPersons(),e.frame.find(".scroll_content").scrollTop(0)},e.addPersons=function(){for(var e=Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST"),t=this,n=[],o=t.personCount;o<Math.min(t.personCount+e,t.allPersons.length);o++)n.push(t.allPersons[o]);t.personCount+=n.length,t._createMemberElement(n)},e._request=function(e,t){function n(e,t){var n,o=(n={},_defineProperty(n,l[0],[]),_defineProperty(n,l[1],[]),_defineProperty(n,l[2],[]),n),i=t.content.users,a=!0,r=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value,g=!0,m=!1,_=void 0;try{for(var f,p=i[Symbol.iterator]();!(g=(f=p.next()).done);g=!0){var h=f.value;if(h.user==d){o[h.policies[0].rights[0].action].push(d);break}}}catch(C){m=!0,_=C}finally{try{!g&&p["return"]&&p["return"]()}finally{if(m)throw _}}}}catch(C){r=!0,s=C}finally{try{!a&&c["return"]&&c["return"]()}finally{if(r)throw s}}return o}function o(e){return e.hasOwnProperty("content")?void i(403e3==e.content.reason?Resource.getMessage("authority_err"):Resource.getMessage("leave_member_err")):void r.cleanup()}function i(e){r._dialogInnerElement.find("#dialog-error").text(e),r._dialogInnerElement.find(".success_btn").attr("disabled",!1)}function a(){ViewUtils.hideLoadingIconInChild($("#dialog-error")),ViewUtils.showLoadingTopInChild($("#dialog-error")),r._dialogInnerElement.find(".success_btn").attr("disabled",!0),r._dialogInnerElement.find("#dialog-error").text("")}var r=this;if(r._dialogInnerElement.find(".checkedCnt").text("0"),null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))&&0!=e.getCount()){var s=r._groupId,l=[AuthorityDef.AUTHORITY_ACTIONS.GC_MANAGE,AuthorityDef.AUTHORITY_ACTIONS.GC_SEND,AuthorityDef.AUTHORITY_ACTIONS.GC_VIEW];a(),Promise.all([CubeeController.getInstance().getUserPoliciesByResource(s),r._getRoomMemberList(s)]).then(function(t){for(var o=[],i=0;i<e.getCount();i++)o.push(t[1].getByKey(e.get(i)).getLoginAccount());var a=n(o,t[0]),r=[],u=!0,c=!1,d=void 0;try{for(var g,m=l[Symbol.iterator]();!(u=(g=m.next()).done);u=!0){var i=g.value;0!=a[i].length&&r.push(CubeeController.getInstance().unassignPolicyFromUser(a[i],Utils.getPolicyIdByActionAndResource(i,s)))}}catch(_){c=!0,d=_}finally{try{!u&&m["return"]&&m["return"]()}finally{if(c)throw d}}return Promise.all(r)}).then(function(t){CubeeController.getInstance().removeChatRoomMember(s,e,"member",o)})["catch"](function(e){i(403e3==e.content.reason?Resource.getMessage("authority_err"):Resource.getMessage("leave_member_err"))})}},e._isValidateOk=function(e,t,n){for(var o=this,i=LoginUser.getInstance(),a=i.getJid(),r=o._validateInputMemberList(e,t),s=r.memberList,l=s.getCount(),u=0;l>u;u++)if(a==s.get(u).getJid()){r.errList.add(Resource.getMessage("not_force_leave_yourself")),s.remove(u);break}o._isValidateJoinedMember(r,n)},e._validateJoinedMember=function(e,t,n){for(var o="",i=n.getCount(),a=0;i>a;a++)""!==o&&(o+=" "),o+=Utils.convertEscapedHtml("@"+n.get(a).getLoginAccount());return""!==o&&e.errList.add('"'+o+'"'+Resource.getMessage("add_member_err_not_exist")),{memberList:t,errList:e.errList}},e.cleanup=function(){ViewUtils.modal_allexit()}}(),function(){DialogSelectCommunityMemberView.prototype=$.extend({},DialogSelectMemberView.prototype);var e=DialogSelectMemberView.prototype,t=DialogSelectCommunityMemberView.prototype;t._init=function(){var t=this;e._init.call(t)},t._isValidateJoinedMember=function(e,t){function n(n){var i=new PersonList,a=new PersonList;if(null===n)return void setTimeout(function(){t(null)},100);for(var r=e.memberList,s=r.getCount(),l=n.getOwnerList(),u=l.getCount(),c=n.getGeneralMemberList(),d=c.getCount(),g=0;s>g;g++){for(var m=!1,_=e.memberList.get(g).getJid(),f=0;u>f;f++)if(_==l.get(f).getJid()){m=!0;break}for(var p=0;d>p;p++)if(_==c.get(p).getJid()){m=!0;break}m?i.add(r.get(g)):a.add(r.get(g))}t(o._validateJoinedMember(e,i,a))}var o=this,i=o._groupId;CubeeController.getInstance().getCommunityMemberInfo(i,n)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){return new Promise(function(t,n){function o(e){for(var n=new Array,o=e.getOwnerList(),i=o.getCount(),a=0;i>a;a++){var r=o.get(a);n.push(r)}t(n)}CubeeController.getInstance().getCommunityMemberInfo(e,o)})}DialogSelectCommunityAddMemberView.prototype=$.extend({},DialogSelectCommunityMemberView.prototype);var t=(DialogSelectCommunityMemberView.prototype,DialogSelectCommunityAddMemberView.prototype);t._init=function(){function e(e){var t=e.content.users,n={},o=!0,i=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){var l=r.value;n[l.user]=l.policies[0].rights[0].action}}catch(u){i=!0,a=u}finally{try{!o&&s["return"]&&s["return"]()}finally{if(i)throw a}}return n}var t=this;t.displayMembers=[],t.allItemCount=-1,t.personCount=0,t.startId=0,t.frame=t.getHtml(),t._dialogAreaElement.html(t.frame),t._dialogInnerElement=t._dialogAreaElement.children(),t.ps=new PerfectScrollbar(t.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t.frame.find(".scroll_content").off("scroll"),t.frame.find(".scroll_content").on("scroll",function(){$(this).get(0).scrollHeight===$(this).scrollTop()+$(this).get(0).clientHeight&&t.searchExecute()}),t.memberList=new ArrayList,t._dialogInnerElement.find(".success_btn").off("click"),t._dialogInnerElement.find(".success_btn").on("click",function(){t._request(t.memberList,t)}),t._dialogInnerElement.find(".user_search_btn").off("click"),t._dialogInnerElement.find(".user_search_btn").on("click",function(){t.firstSearch()}),t._dialogInnerElement.find(".field").keypress(function(e){return(e.which&&13===e.which||e.keyCode&&13===e.keyCode)&&t.firstSearch(),13!==e.which}),t._dialogInnerElement.find("input[name=allcheck]").off("change"),t._dialogInnerElement.find("input[name=allcheck]").on("change",function(){t._dialogInnerElement.find("input[name=addprojectmember]").prop("checked",this.checked);for(var e=t._dialogInnerElement.find("input[name=addprojectmember]"),n=t._dialogInnerElement.find("select.field[name=authority]"),o=[],i=0;i<e.length;i++)e[i].checked&&(o[e[i].value]=n[i].value);if(this.checked){for(var a in o)if(0===t.memberList._array.filter(function(e){return e.jid===a}).length){var r=t.displayMembers.filter(function(e){return e.getJid()===a})[0];t.memberList.add({jid:a,action:o[a],accountName:r._profile._loginAccount})}}else for(var i=0;i<e.length;i++)t.memberList.remove(t.memberList._array.map(function(e){return e.jid}).indexOf(e[i].value));var s=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(s)}),t.projectMembers=[],Promise.all([CubeeController.getInstance().getUserPoliciesByResource(t._communityId),t.getCommunityMemberList(t._communityId)]).then(function(n){t.allAuthLists=e(n[0]),t.projectMembers=n[1];var o=LoginUser.getInstance(),i=Utils.getSafeArrayData(o.getGroup()),a=i.length>0?i[0]:"";t._dialogInnerElement.find("input.field").val(a),t.searchExecute()})["catch"](function(e){})},t.firstSearch=function(){var e=this;e.allItemCount=-1,e.personCount=0,e.startId=0,e.displayMembers=[],e._dialogInnerElement.find(".select_list").empty(),e.searchExecute(),e.frame.find(".scroll_content").scrollTop(0)},t.getHtml=function(){var e='<div id="addprojectmember_modal" class="card modal_card">          <div class="card_title">            <p>'+Resource.getMessage("dialog_title_group_chat_add_member")+'</p>          </div>          <div class="select_menu">            <span class="select_number"><i class="fa fa-user"></i><span class="checkedCnt">0</span></span>            <form class="search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("wizard_chatlist_conditions")+'">              <button type="button" name="search" class="user_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>            <label class="modal_btn all_check">'+Resource.getMessage("wizard_chatlist_allcheck")+'<label class="checkbox"><input name="allcheck" type="checkbox"><span></span></label></label>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>            <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text"></span></button>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},t.searchExecute=function(){var e=this;if(e.displayMembers.length!==e.allItemCount){e._dialogInnerElement.find("input[name=allcheck]").prop("checked",!1);var t=e.frame.find(".field").val(),n=Utils.trimStringMulutiByteSpace(t);if(n&&""!=n){var o=ViewUtils.getKeywordFilterFromKeywordInputString(n,!1);if(o&&"object"==("undefined"==typeof o?"undefined":_typeof(o))){var i=new ColumnSortCondition;i.getItems().removeAll(),i.getItems().add("login_account"),i.getOrders().removeAll(),i.getOrders().add(ColumnSortCondition.SORT_ORDER_ASC);var a=o,r=new ColumnSearchCondition(a,i),s=Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST");return CubeeController.getInstance().searchPerson(e.startId,s,r,function(t){var n=t._array[t._array.length-1];e.startId=n?n.getId():0,e.displayMembers=e.displayMembers.concat(t._array),e.allItemCount=t._allItemCount,e.personCount+=t.getCount(),e._createMemberElement(t)})}}}},t._createMemberElement=function(e){var t=this,n=e._array,o=LoginUser.getInstance(),i=o.getJid();$.each(n,function(e,n){if(i!==n.getJid()){var o=Utils.getSafeStringData(n.getUserName());o=Utils.convertEscapedHtml(o);var a=n._profile._loginAccount,r=Utils.getSafeArrayData(n.getGroup());r=r.length>0?r.join(","):Resource.getMessage("group_title_no_group"),r=Utils.convertEscapedHtml(r);var s=ViewUtils.getAvatarDataHtmlFromPerson(n),l='<li title="'+o+" "+r+'"><label>                   <span class="ico ico_user"></span>                    <span class="name">'+o+'</span>                    <span class="group">'+r+'</span>                    <label class="checkbox">                     <input type="checkbox" name="addprojectmember"><span></span></label>                    <select class="field" name="authority">                   <option value="'+AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_MANAGE+'">'+Resource.getMessage("policy_manage")+'</option>                   <option value="'+AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_SEND+'">'+Resource.getMessage("policy_send")+'</option>                   <option value="'+AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_VIEW+'">'+Resource.getMessage("policy_view")+"</option>                   </select> </label></li>",u=$(l);t._dialogInnerElement.find(".select_list").append(u);if(u.find(".ico_user").append(s),u.find("input:checkbox").val(n.getJid()),t.allAuthLists.hasOwnProperty(a)){var c=t.allAuthLists[a];u.find('select.field option[value="'+c+'"]').prop("selected",!0)}else u.find('select.field option[value="'+AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_SEND+'"]').prop("selected",!0);0<=t.memberList._array.map(function(e){return e.jid}).indexOf(n.getJid())&&u.find("input:checkbox").prop("checked",!0);var d=t.projectMembers.map(function(e){return e.getJid()});-1===d.indexOf(n.getJid())?(u.find("input[name=addprojectmember]").off("change"),u.find("input[name=addprojectmember]").on("change",function(){var e=this.value,n=t.displayMembers.filter(function(t){return t.getJid()===e})[0],o=u.find("select.field[name=authority]").val();this.checked?t.memberList.add({jid:this.value,action:o,accountName:n._profile._loginAccount}):t.memberList._array.forEach(function(n,o){n.jid===e&&t.memberList.remove(o)});var i=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(i)}),u.find("select.field[name=authority]").off("change"),u.find("select.field[name=authority]").on("change",function(){var e=this.value,n=u.find("input[name=addprojectmember]").val();t.memberList._array.filter(function(e){return e.jid===n}).forEach(function(t){return t.action=e})})):(u.find("input[name=addprojectmember]").prop("disabled",!0),u.find("input[name=addprojectmember]").attr("name",""),u.find(".field").prop("disabled",!0))}})},t._createMemberListFromMemberListElement=function(){var e=this,t=e._dialogInnerElement,n=t.find('ul[name="member-list"]');if(0!=n.length){var o=new ArrayList;return n.children(".change_authority").each(function(){var e=$(this).children("span.item").attr("accountName"),t=$(this).children("span.item").attr("jid"),n=$("#auth_list_"+e).children("option:selected").val();o.add({jid:t,action:n,accountName:e})}),o}},t.getCommunityMemberList=function(e){return new Promise(function(t,n){function o(e){if(null==e)return void n();for(var o=new Array,i=e.getOwnerList(),a=i.getCount(),r=e.getGeneralMemberList(),s=r.getCount(),l=0;a>l;l++){var u=i.get(l);o.push(u)}for(var l=0;s>l;l++){var c=r.get(l);o.push(c)}t(o)}CubeeController.getInstance().getCommunityMemberInfo(e,o)})},t.getPersonData=function(e){return new Promise(function(t,n){function o(e){t(e)}CubeeController.getInstance().getPersonDataByJidFromServer(e,o)})},t._request=function(t,n){function o(e,t){var n=!0,o=!1,i=void 0;try{for(var a,r=e[Symbol.iterator]();!(n=(a=r.next()).done);n=!0)for(var s=a.value,l=0;l<m.getCount();l++)s.getJid()==m.get(l)&&m.remove(l),null==t.getByKey(m.get(l))&&m.remove(l)}catch(u){o=!0,i=u}finally{try{!n&&r["return"]&&r["return"]()}finally{if(o)throw i}}}function i(n){return n.hasOwnProperty("content")?void r(403e3==n.content.reason?Resource.getMessage("authority_err"):Resource.getMessage("add_member_err_submit")):void(0!=g.manageCommunity.length?e(c).then(function(e){var n=new ArrayList,o=!0,i=!1,r=void 0;try{for(var s,l=e[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value;n.add(u.getJid())}}catch(d){i=!0,r=d}finally{try{!o&&l["return"]&&l["return"]()}finally{if(i)throw r}}for(var m=0;m<t.getCount();m++)member=t.get(m),member.action==AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_MANAGE&&g[AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_MANAGE].includes(member.accountName)&&n.add(member.jid);CubeeController.getInstance().updateCommunityOwner(c,n,a)}):a("changedOwnerList"))}function a(e){if(e.hasOwnProperty("content"))return void r(403e3==e.content.reason?Resource.getMessage("authority_err_on_add_member"):Resource.getMessage("add_member_err_authority_change"));var t=[],n=!0,o=!1,i=void 0;try{for(var a,s=d[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;0!=g[l].length&&t.push(CubeeController.getInstance().assignPolicyToUser(Utils.getPolicyIdByActionAndResource(l,c),g[l]))}}catch(m){o=!0,i=m}finally{try{!n&&s["return"]&&s["return"]()}finally{if(o)throw i}}Promise.all(t).then(function(e){var t=new CommunityDetailsView;t.init(c),new Promise(function(e){setTimeout(function(){e(t.setCommunityDetailData(c))},3e3)}),u.cleanup()})["catch"](function(e){r(403e3==e.content.reason?Resource.getMessage("authority_err_on_add_member"):404e3==e.content.reason?e.content.error_users+Resource.getMessage("not_assign_account_type_err"):Resource.getMessage("add_member_err_authority_change"))})}function r(e){u._dialogInnerElement.find("#dialog-error").text(e),u._dialogInnerElement.find(".success_btn").attr("disabled",!1)}function s(){ViewUtils.hideLoadingIconInChild($("#dialog-error")),ViewUtils.showLoadingTopInChild($("#dialog-error")),u._dialogInnerElement.find(".success_btn").attr("disabled",!0),u._dialogInnerElement.find("#dialog-error").text("")}var l;if(null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))&&null!=n&&"object"==("undefined"==typeof n?"undefined":_typeof(n))&&0!=t.getCount()){for(var u=this,c=u._communityId,d=[AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_MANAGE,AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_SEND,AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_VIEW],g=(l={},_defineProperty(l,d[0],[]),_defineProperty(l,d[1],[]),_defineProperty(l,d[2],[]),l),m=new ArrayList,_=0;_<t.getCount();_++)m.add(t.get(_).jid);var f=u._dialogInnerElement;f.find(".btn_wrapper").find("button").eq(0).attr("disabled",!0),f.find("#dialog-error").text(""),s(),Promise.all([u.getCommunityMemberList(c),u.getPersonData(m)]).then(function(e){if(o(e[0],e[1]),0==m.getCount())return void u.cleanup();for(var n=0;n<m.getCount();n++)for(var a=0;a<t.getCount();a++){var r=t.get(a);r.jid==m.get(n)&&g[r.action].push(r.accountName)}CubeeController.getInstance().addCommunityMember(c,m,i)})["catch"](function(e){r(Resource.getMessage("add_member_err_submit"))})}},t._isValidateOk=function(e,t,n){var o=this,i=o._validateInputMemberList(e,t);o._isValidateJoinedMember(i,n)},t._validateJoinedMember=function(e,t,n){for(var o="",i=t.getCount(),a=0;i>a;a++)""!==o&&(o+=" "),o+=Utils.convertEscapedHtml("@"+t.get(a).getLoginAccount());return""!==o&&e.errList.add('"'+o+'"'+Resource.getMessage("add_member_err_exist")),{memberList:n,errList:e.errList}},t.cleanup=function(){ViewUtils.modal_allexit()}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e;
};!function(){DialogSelectCommunityForceLeaveMemberView.prototype=$.extend({},DialogSelectCommunityMemberView.prototype);var e=(DialogSelectCommunityMemberView.prototype,DialogSelectCommunityForceLeaveMemberView.prototype);e._init=function(){var t=this;t.allMembers=[],t.frame=t.getHtml(),e.getCommunityMemberList(t._communityId).then(function(e){t.allMembers=e,t.allPersons=e,t.addPersons()})["catch"](function(e){}),t._dialogAreaElement.html(t.frame),t._dialogInnerElement=t._dialogAreaElement.children(),t.ps=new PerfectScrollbar(t.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t.personCount=0,t.frame.find(".scroll_content").off("scroll"),t.frame.find(".scroll_content").on("scroll",function(){$(this).get(0).scrollHeight===$(this).scrollTop()+$(this).get(0).clientHeight&&t.personCount!==t.allPersons.length&&t.addPersons()}),t.memberList=new ArrayList,t._dialogInnerElement.find(".success_btn").off("click"),t._dialogInnerElement.find(".success_btn").on("click",function(){t._request(t.memberList,t)}),t._dialogInnerElement.find(".user_search_btn").off("click"),t._dialogInnerElement.find(".user_search_btn").on("click",function(){t.filterMembers()}),t._dialogInnerElement.find(".field").keypress(function(e){return(e.which&&13===e.which||e.keyCode&&13===e.keyCode)&&t.filterMembers(),13!==e.which}),t._dialogInnerElement.find("input[name=allcheck]").off("change"),t._dialogInnerElement.find("input[name=allcheck]").on("change",function(){t._dialogInnerElement.find("input[name=removeprojectmember]").prop("checked",this.checked);var e=t._dialogInnerElement.find("input[name=removeprojectmember]");if(this.checked)for(var n=0;n<e.length;n++)0===t.memberList._array.filter(function(t){return t===e[n].value}).length&&t.memberList.add(e[n].value);else for(var n=0;n<e.length;n++)t.memberList.remove(t.memberList._array.indexOf(e[n].value));var o=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(o)})},e.getHtml=function(){var e='<div id="removeprojectmember_modal" class="card modal_card">          <div class="card_title">            <p>'+Resource.getMessage("community_force_leave_member_dialog_title")+'</p>          </div>          <div class="select_menu">            <span class="select_number"><i class="fa fa-user"></i><span class="checkedCnt">0</span></span>            <form action="#" method="get" class="search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("wizard_chatlist_conditions_account")+'">              <button type="button" name="search" class="user_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>            <label class="modal_btn all_check">'+Resource.getMessage("wizard_chatlist_allcheck")+'<label class="checkbox"><input name="allcheck" type="checkbox"><span></span></label></label>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>            <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("button_force_leave")+'</span></button>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},e.searchExecute=function(){var e=this,t=e.frame.find(".field").val(),n=Utils.trimStringMulutiByteSpace(t);if(n&&""!=n){var o=ViewUtils.getKeywordFilterFromKeywordInputString(n,!1);if(o&&"object"==("undefined"==typeof o?"undefined":_typeof(o))){if(e._dialogInnerElement.find("input[name=allcheck]").prop("checked",!1),0<e.allMembers.length)return void e.filterMembers();var i=new ColumnSortCondition;i.getItems().removeAll(),i.getItems().add("login_account"),i.getOrders().removeAll(),i.getOrders().add(ColumnSortCondition.SORT_ORDER_ASC);var a=o,r=new ColumnSearchCondition(a,i),s=0,l=Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST");return CubeeController.getInstance().searchPerson(s,l,r,function(t){e.frame.find(e.selector_list).empty(),e.setUserListHtml(t),e.applySelectedInfoToView(),e.applyExcludedList()})}}},e._createMemberElement=function(e){var t=this,n=LoginUser.getInstance(),o=n.getJid();$.each(e,function(e,n){if(o!==n.getJid()){var i=n._profile,a=Utils.getSafeStringData(i._nickName);a=Utils.convertEscapedHtml(a);var r="@"+i._loginAccount,s=ViewUtils.getAvatarDataHtmlFromPerson(n),l='<li title="'+a+" "+r+'"><label>                   <span class="ico ico_user"></span>                    <span class="name">'+a+'</span>                    <span class="group"></span>                    <label class="checkbox">                   <input type="checkbox" name="removeprojectmember"><span></span></label>                    </label></li>',u=$(l);t._dialogInnerElement.find(".select_list").append(u);u.find(".ico_user").append(s),u.find(".group").text(r).html(),u.find("input:checkbox").val(n._jid),0<=t.memberList._array.indexOf(n.getJid())&&u.find("input:checkbox").prop("checked",!0),u.find("input[name=removeprojectmember]").off("change"),u.find("input[name=removeprojectmember]").on("change",function(){var e=this.value;this.checked?t.memberList.add(this.value):t.memberList._array.forEach(function(n,o){n===e&&t.memberList.remove(o)});var n=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(n)})}})},e.filterMembers=function(){var e=this;e.personCount=0,e._dialogInnerElement.find(".select_list").empty(),e._dialogInnerElement.find("input[name=allcheck]").prop("checked",!1);var t=e.frame.find(".field").val(),n=e.allMembers.filter(function(e){var n=Utils.getSafeStringData(e.getUserName()),o=e._profile.getLoginAccount();return 0<=n.indexOf(t)||0<=o.indexOf(t)});e.allPersons=n,e.addPersons(),e.frame.find(".scroll_content").scrollTop(0)},e.addPersons=function(){for(var e=Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST"),t=this,n=[],o=t.personCount;o<Math.min(t.personCount+e,t.allPersons.length);o++)n.push(t.allPersons[o]);t.personCount+=n.length,t._createMemberElement(n)},e.getCommunityMemberList=function(e){return new Promise(function(t,n){function o(e){if(null==e)return void n();for(var o=new Array,i=e.getOwnerList(),a=i.getCount(),r=e.getGeneralMemberList(),s=r.getCount(),l=0;a>l;l++){var u=i.get(l);o.push(u)}for(var l=0;s>l;l++){var c=r.get(l);o.push(c)}t(o)}CubeeController.getInstance().getCommunityMemberInfo(e,o)})},e._request=function(e,t){function n(e,t){var n,o=(n={},_defineProperty(n,l[0],[]),_defineProperty(n,l[1],[]),_defineProperty(n,l[2],[]),n),i=t.content.users,a=!0,r=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value,g=!0,m=!1,_=void 0;try{for(var f,p=i[Symbol.iterator]();!(g=(f=p.next()).done);g=!0){var h=f.value;if(h.user==d){o[h.policies[0].rights[0].action].push(d);break}}}catch(C){m=!0,_=C}finally{try{!g&&p["return"]&&p["return"]()}finally{if(m)throw _}}}}catch(C){r=!0,s=C}finally{try{!a&&c["return"]&&c["return"]()}finally{if(r)throw s}}return o}function o(e){if(e.hasOwnProperty("content"))return void i(403e3==e.content.reason?Resource.getMessage("authority_err"):Resource.getMessage("leave_member_err"));var t=new CommunityDetailsView;t.init(s),new Promise(function(e){setTimeout(function(){e(t.setCommunityDetailData(s))},3e3)}),r.cleanup()}function i(e){r._dialogInnerElement.find("#dialog-error").text(e),r._dialogInnerElement.find(".success_btn").attr("disabled",!1)}function a(){ViewUtils.hideLoadingIconInChild($("#dialog-error")),ViewUtils.showLoadingTopInChild($("#dialog-error")),r._dialogInnerElement.find(".success_btn").attr("disabled",!0),r._dialogInnerElement.find("#dialog-error").text("")}var r=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))&&0!=e.getCount()){var s=r._communityId,l=[AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_MANAGE,AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_SEND,AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_VIEW];r._dialogInnerElement;a(),Promise.all([CubeeController.getInstance().getUserPoliciesByResource(s),r.getCommunityMemberList(s)]).then(function(t){for(var o=[],i=0;i<e.getCount();i++){var a=!0,r=!1,u=void 0;try{for(var c,d=t[1][Symbol.iterator]();!(a=(c=d.next()).done);a=!0){var g=c.value;g.getJid()==e.get(i)&&o.push(g.getLoginAccount())}}catch(m){r=!0,u=m}finally{try{!a&&d["return"]&&d["return"]()}finally{if(r)throw u}}}var _=n(o,t[0]),f=[],p=!0,h=!1,C=void 0;try{for(var v,y=l[Symbol.iterator]();!(p=(v=y.next()).done);p=!0){var i=v.value;0!=_[i].length&&f.push(CubeeController.getInstance().unassignPolicyFromUser(_[i],Utils.getPolicyIdByActionAndResource(i,s)))}}catch(m){h=!0,C=m}finally{try{!p&&y["return"]&&y["return"]()}finally{if(h)throw C}}return Promise.all(f)}).then(function(t){CubeeController.getInstance().removeCommunityMember(s,e,o)})["catch"](function(e){i(403e3==e.content.reason?Resource.getMessage("authority_err"):Resource.getMessage("leave_member_err"))})}},e._isValidateOk=function(e,t,n){for(var o=this,i=LoginUser.getInstance(),a=i.getJid(),r=o._validateInputMemberList(e,t),s=r.memberList,l=s.getCount(),u=0;l>u;u++)if(a==s.get(u).getJid()){r.errList.add(Resource.getMessage("not_force_leave_yourself")),s.remove(u);break}o._isValidateJoinedMember(r,n)},e._validateJoinedMember=function(e,t,n){for(var o="",i=n.getCount(),a=0;i>a;a++)""!==o&&(o+=" "),o+=Utils.convertEscapedHtml("@"+n.get(a).getLoginAccount());return""!==o&&e.errList.add('"'+o+'"'+Resource.getMessage("add_member_err_not_exist")),{memberList:t,errList:e.errList}},e.cleanup=function(){ViewUtils.modal_allexit()}}(),function(){DialogCreateCommunityView.prototype=$.extend({},DialogCommunityCreateSettingBaseView.prototype);var e=DialogCommunityCreateSettingBaseView.prototype,t=DialogCreateCommunityView.prototype;t._init=function(){var t=this;e._init.call(t)},t._request=function(e){function t(e){if(e.hasOwnProperty("content"))return o(403e3==e.content.reason?Resource.getMessage("authority_err"):Resource.getMessage("create_community_err")),void ViewUtils.hideLoadingIconInChild($("#dialog-error"));var t=r.find('input[name="logofile"]'),i=$(".project_btn").attr("data_value");if(""!=t.val()){var a=function(t){var n=t.result;return"failed"==n?(o(Resource.getMessage("community_logo_setting_failed")),void r.find(".btn_wrapper #onCreatePrj").prop("disabled",!0)):(g.setRoomId(e.getRoomId()),g.setLogoUrl(t.path),CubeeController.getInstance().updateCommunity(g,s))},s=function(e){null==e?(o(Resource.getMessage("community_logo_setting_failed")),r.find(".btn_wrapper #onCreatePrj").prop("disabled",!0)):n(e.getRoomId(),e,i)},l=t.prop("files"),u=l[0];return CubeeController.getInstance().uploadCommunityLogo(e.getRoomId(),u,a)}n(e.getRoomId(),e,i)}function n(e,t,n){function o(){var e=new TabCommunityItemView;"myworkplace"!=n&&e.init(n),TabManager.getInstance()._deleteProject(e)}SelectAndAddProjectView.getInstance().getProjectList(t),SideMenuMurmurView.getInstance().close(),TabManager.getInstance().selectOrAddTabByCommunityInfo(e,t,o),ViewUtils.hideLoadingIconInChild($("#dialog-error")),ViewUtils.modal_allexit()}function o(e){var t=r.find("#dialog-error");t.text(e),r.find(".btn_wrapper #onCreatePrj").prop("disabled",!1),$(".ui-dialog-titlebar-close").show()}function i(){r.find(".btn_wrapper #onCreatePrj").prop("disabled",!0),$(".ui-dialog-titlebar-close").hide(),ViewUtils.hideLoadingIconInChild($("#dialog-error")),ViewUtils.showLoadingTopInChild($("#dialog-error"))}var a=this,r=a._dialogInnerElement,s=r.find('input[name="community-title"]'),l=r.find('textarea[name="community-description"]'),u=s.val(),c=l.val(),d=$("input[name=community-color]:checked").val(),g=new CommunityInfo;g.setRoomName(u),g.setDescription(c);var m=parseInt($("#project_privacy_type").val());return g.setPrivacyType(m),null==d||""==d?g.setMemberEntryType(Conf.getVal("DEFAULT_PROJECT_COLOR")):g.setMemberEntryType(Utils.getSafeStringData(d)),g.setLogoUrl(""),i(),CubeeController.getInstance().createCommunity(g,t)}}(),function(){function e(e){return-1==e.indexOf("#")&&(e="#"+e),SelectAndAddProjectView._colors.indexOf(e)>=0?e:SelectAndAddProjectView._default_color}DialogSettingCommunityView.prototype=$.extend({},DialogCommunityCreateSettingBaseView.prototype);var t=DialogCommunityCreateSettingBaseView.prototype,n=DialogSettingCommunityView.prototype;n._init=function(){var n=this;t._init.call(n),CubeeController.getInstance().getCommunityInfo(n._communityId,function(t){n.communityInfo=t;var o=t.getRoomName(),i=t.getPrivacyType(),a=t.getMemberEntryType(),r=t.getDescription();a=ViewUtils.communityMemberEntryTypeNumToStr(a),n._dialogInnerElement.find("input[name=community-title]").val(o),n._dialogInnerElement.find("textarea[name=community-description]").val(r),n._dialogInnerElement.find("#project_privacy_type").val(i),n._dialogInnerElement.find(".project_memberentrytype").html(a);var s=e(t.getMemberEntryType());n._dialogInnerElement.find('input[name=community-color][value="#E04F5F"]').prop("checked","#E04F5F"===s),n._dialogInnerElement.find('input[name=community-color][value="#E7953B"]').prop("checked","#E7953B"===s),n._dialogInnerElement.find('input[name=community-color][value="#FAD43D"]').prop("checked","#FAD43D"===s),n._dialogInnerElement.find('input[name=community-color][value="#98D44E"]').prop("checked","#98D44E"===s),n._dialogInnerElement.find('input[name=community-color][value="#32BEA6"]').prop("checked","#32BEA6"===s),n._dialogInnerElement.find('input[name=community-color][value="#51B8FD"]').prop("checked","#51B8FD"===s),n._dialogInnerElement.find('input[name=community-color][value="#187BCE"]').prop("checked","#187BCE"===s),n._dialogInnerElement.find('input[name=community-color][value="#AF69C4"]').prop("checked","#AF69C4"===s),n._dialogInnerElement.find('input[name=community-color][value="#F195AD"]').prop("checked","#F195AD"===s),n._dialogInnerElement.find('input[name=community-color][value="#A17255"]').prop("checked","#A17255"===s),n._dialogInnerElement.find('input[name=community-color][value="#8CA8BC"]').prop("checked","#8CA8BC"===s),n._dialogInnerElement.find('input[name=community-color][value="#555555"]').prop("checked","#555555"===s)})},n._request=function(e){function t(e){var t=e.result;return"failed"==t?(a.find("#dialog-error").text(Resource.getMessage("config_community_change_failed")),void a.find(".success_btn").attr("disabled",!1)):(d.setLogoUrl(e.path),CubeeController.getInstance().updateCommunity(d,n))}function n(e){if(a.find(".success_btn").attr("disabled",!1),null==e)return void a.find("#dialog-error").text(Resource.getMessage("config_community_change_failed"));var t=new CommunityDetailsView;t.init(e.getRoomId()),t.setCommunityDetailData(e.getRoomId()),SelectAndAddProjectView.getInstance().getProjectList(e),TabManager.getInstance().selectOrAddTabByCommunityInfo(e.getRoomId(),e),i.cleanup()}function o(){ViewUtils.hideLoadingIconInChild($("#dialog-error")),ViewUtils.showLoadingTopInChild($("#dialog-error")),i._dialogInnerElement.find(".success_btn").attr("disabled",!0),i._dialogInnerElement.find("#dialog-error").text("")}var i=this,a=i._dialogInnerElement,r=a.find('input[name="community-title"]'),s=a.find('textarea[name="community-description"]'),l=Utils.excludeControleCharacters(r.val()),u=Utils.excludeControleCharacters(s.val()),c=$("input[name=community-color]:checked").val(),d=new CommunityInfo;d.setRoomId(i._communityId),d.setRoomName(l),d.setDescription(u);var g=parseInt($("#project_privacy_type").val());d.setPrivacyType(g),null==c||""==c?d.setMemberEntryType(Conf.getVal("DEFAULT_PROJECT_COLOR")):d.setMemberEntryType(Utils.getSafeStringData(c)),o();var m=a.find('input[name="logofile"]');if(""!=m.val()){var _=m.prop("files"),f=_[0];return CubeeController.getInstance().uploadCommunityLogo(i.communityInfo.getRoomId(),f,t)}var p=i.communityInfo.getLogoUrl();return d.setLogoUrl(p),CubeeController.getInstance().updateCommunity(d,n)},n.cleanup=function(){ViewUtils.modal_allexit()}}(),function(){DialogUnsubscribeCheckView.prototype=$.extend({},DialogOkCancelView.prototype);var e=(DialogOkCancelView.prototype,DialogUnsubscribeCheckView.prototype);e._init=function(){var e=this;e.submitFalse=!1,e.member=new ArrayList,e.member.add(LoginUser.getInstance().getJid()),e.frame=e.getHtml(),e._dialogAreaElement.html(e.frame),e._dialogInnerElement=e._dialogAreaElement.children(),e._dialogInnerElement.find(".success_btn").on("click",function(){e.request()}),e._dialogInnerElement.find(".cancel_btn").on("click",function(){ViewUtils.modal_allexit()})},e.getHtml=function(){var e='<div id="groupleave_modal" class="card modal_card">            <div class="card_title">                <p>'+Resource.getMessage("dialog_confirmation_title")+'</p>            </div>            <div class="modal_content_wrapper">                <p class="txt">'+Resource.getMessage("dialog_label_remove_member")+'</p>            </div>            <div class="btn_wrapper">                <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>                <button type="button" class="modal_btn cancel_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_cancel_title")+'</span></button>                <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+'</span></button>            </div>            <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},e.request=function(){function e(e){return e.hasOwnProperty("content")?(t(Resource.getMessage("leave_member_err")),void(_self.submitFalse=!0)):void ViewUtils.modal_allexit()}function t(e){var t=_self._dialogInnerElement,n=t.find("#dialog-error");n.text(e),t.find("button").attr("disabled",!1),t.find(".modal_exit").attr("disabled",!1)}function n(){var e=_self._dialogInnerElement;e.find("button").eq(0).attr("disabled",!0),e.find(".modal_exit").eq(0).attr("disabled",!0),ViewUtils.hideLoadingIconInChild($("#dialog-error")),ViewUtils.showLoadingTopInChild($("#dialog-error"))}var o=AuthorityInfo.getInstance().getWhichRightToGroupchatResource(_self._roomId),i=Utils.getPolicyIdByActionAndResource(o,_self._roomId),a=[LoginUser.getInstance().getLoginAccount()];return _self.submitFalse?void ViewUtils.modal_allexit():(_self._dialogInnerElement.find("#dialog-error").text(""),n(),""==i?void CubeeController.getInstance().removeChatRoomMember(_self._roomId,_self.member,"own",e):void CubeeController.getInstance().unassignPolicyFromUser(a,i).then(function(t){CubeeController.getInstance().removeChatRoomMember(_self._roomId,_self.member,"own",e)})["catch"](function(e){t(Resource.getMessage("leave_member_err")),_self.submitFalse=!0}))}}(),function(){DialogGroupChatUnsubscribeCheckView.prototype=$.extend({},DialogOkCancelView.prototype);var e=(DialogOkCancelView.prototype,DialogGroupChatUnsubscribeCheckView.prototype);e._init=function(){var e=this;e.submitFalse=!1,e.member=new ArrayList,e.member.add(LoginUser.getInstance().getJid()),e.frame=e.getHtml(),e._dialogAreaElement.html(e.frame),e._dialogInnerElement=e._dialogAreaElement.children(),e._dialogInnerElement.find(".success_btn").on("click",function(){e.request()}),e._dialogInnerElement.find(".cancel_btn").on("click",function(){ViewUtils.modal_allexit()})},e.getHtml=function(){var e='<div id="groupleave_modal" class="card modal_card">            <div class="card_title">                <p>'+Resource.getMessage("dialog_confirmation_title")+'</p>            </div>            <div class="modal_content_wrapper">                <p class="txt">'+Resource.getMessage("dialog_label_remove_member")+'</p>            </div>            <div class="btn_wrapper">                <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>                <button type="button" class="modal_btn cancel_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_cancel_title")+'</span></button>                <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+'</span></button>            </div>            <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},e.request=function(){function e(e){return e.hasOwnProperty("content")?(t(e.content.mess&&"NOT_FOUND_OTHER_MANAGER"==e.content.mess?Resource.getMessage("leave_last_manager_member_err"):Resource.getMessage("leave_member_err")),void(_self.submitFalse=!0)):void ViewUtils.modal_allexit()}function t(e){var t=_self._dialogInnerElement,n=t.find("#dialog-error");n.text(e),t.find("button").attr("disabled",!1),t.find(".modal_exit").attr("disabled",!1)}function n(){var e=_self._dialogInnerElement;e.find("button").eq(0).attr("disabled",!0),e.find(".modal_exit").eq(0).attr("disabled",!0),ViewUtils.hideLoadingIconInChild($("#dialog-error")),ViewUtils.showLoadingTopInChild($("#dialog-error"))}return _self.submitFalse?void ViewUtils.modal_allexit():(_self._dialogInnerElement.find("#dialog-error").text(""),n(),void CubeeController.getInstance().removePublicChatRoomMember(_self._roomId,e))}}(),function(){DialogProjectUnsubscribeCheckView.prototype=$.extend({},DialogOkCancelView.prototype);var e=(DialogOkCancelView.prototype,DialogProjectUnsubscribeCheckView.prototype);e._init=function(){var e=this;e.submitFalse=!1,e.member=new ArrayList,e.member.add(LoginUser.getInstance().getJid()),e.frame=e.getHtml(),e._dialogAreaElement.html(e.frame),e._dialogInnerElement=e._dialogAreaElement.children(),e._dialogInnerElement.find(".success_btn").on("click",function(){e.request()}),e._dialogInnerElement.find(".cancel_btn").on("click",function(){ViewUtils.modal_allexit()})},e.getHtml=function(){var e='<div id="groupleave_modal" class="card modal_card">            <div class="card_title">                <p>'+Resource.getMessage("dialog_confirmation_title")+'</p>            </div>            <div class="modal_content_wrapper">                <p class="txt">'+Resource.getMessage("dialog_label_project_remove_member")+'</p>            </div>            <div class="btn_wrapper">                <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>                <button type="button" class="modal_btn cancel_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_cancel_title")+'</span></button>                <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+'</span></button>            </div>            <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},e.request=function(){function e(e){if(e.hasOwnProperty("content"))return t(e.content.mess&&"NOT_FOUND_OTHER_MANAGER"==e.content.mess?Resource.getMessage("leave_last_manager_member_err"):Resource.getMessage("leave_member_err")),void(_self.submitFalse=!0);for(var n=LoginUser.getInstance().getJid(),o=location.hostname,i=TabColumnStateStore.COLUMN_LIST_KEY+"_"+o+"_"+n,a=TabColumnStateStore.getInstance()._getItem(i),r=JSON.parse(a),s=0;s<r.length;s++)null!=r[s].communityId&&r[s].communityId==_self._roomId&&(delete r[s],TabColumnStateStore.getInstance()._localStorage.removeItem(_self._roomId+"_"+i));TabColumnStateStore.getInstance()._setItem(i,JSON.stringify(r)),$("ul.#project > li > a[data_value="+_self._roomId+"]").parent().remove(),$("ul.#project").parent().css("height","auto"),ViewUtils.modal_allexit(),TabManager.getInstance().activeMyWorkplaceTab(function(){})}function t(e){var t=_self._dialogInnerElement,n=t.find("#dialog-error");n.text(e),t.find("button").attr("disabled",!1),t.find(".modal_exit").attr("disabled",!1)}function n(){var e=_self._dialogInnerElement;e.find("button").eq(0).attr("disabled",!0),e.find(".modal_exit").eq(0).attr("disabled",!0),ViewUtils.hideLoadingIconInChild($("#dialog-error")),ViewUtils.showLoadingTopInChild($("#dialog-error"))}[LoginUser.getInstance().getLoginAccount()];return _self.submitFalse?void ViewUtils.modal_allexit():(_self._dialogInnerElement.find("#dialog-error").text(""),n(),void CubeeController.getInstance().removePublicCommunityMember(_self._roomId,e))}}(),function(){DialogFavoriteGroupView.prototype=$.extend({},DialogSettingView.prototype);var e=DialogSettingView.prototype,t=DialogFavoriteGroupView.prototype;t._init=function(){var t=this;e._init.call(t),t.showDialog()},t.getInnerHtml=function(){var e="";e+='<div class="controls form_controls" style="text-align:center;">',e+='<select class="favorite-select ui-corner-all" style="margin-top:2em;">';for(var t=FavoriteStore.getInstance().getGroupCount(),n=0;t>n;n++)e+='<option value="'+n+'"',0==n&&(e+="selected "),e+='style="margin-top:0;">'+FavoriteStore.getInstance().getGroupName(n)+"</option>";return e+="</select>",e+="</div>"},t.createSubmitButtonObj=function(){var e=this;e._submitButtonFunc=function(){var t=this;e.submit(t)},e._cancelButtonFunc=function(){var e=this;$(e).dialog("close")};var t=[];return t.push({text:e.getButtonTitle(),click:e._submitButtonFunc}),t.push({text:Resource.getMessage("dialog_label_cancel"),click:e._cancelButtonFunc}),t},t.submit=function(e){for(var t=this,n=t._dialogInnerElement,o=n.find("select.favorite-select").val(),i=parseInt(o),a=[],r=t._selectedUserList.getCount(),s=0;r>s;s++)a.add(t._selectedUserList.get(s));FavoriteStore.getInstance().addGroupMember(i,a),t._dialogInnerElement.dialog("close"),this._callback(i)}}(),function(){DialogGroupchatListView.prototype=$.extend({},DialogOkCancelView.prototype);var e=DialogOkCancelView.prototype,t=DialogGroupchatListView.prototype;t._init=function(){var t=this;t.isGotRoomArrayList=!1,t.roomArrayList=new ArrayList,t.frame=t.getInnerHtml();var n=new GroupChatListView;n.init({numOfGroupchat:10}),n.showInnerFrameFromProject(function(){},t.currentTabInfo),t.frame.find(".modal_list").append(n._frame),t._dialogAreaElement.html(t.frame),t._dialogInnerElement=t._dialogAreaElement.children(),t.ps=new PerfectScrollbar(t.frame.find(".scroll_content")[0],{suppressScrollX:!0}),t._createEventHandler(),t._dialogInnerElement.find(".modal_list").on("click",function(){ViewUtils.modal_allexit()}),t._dialogInnerElement.find(".scroll_content").on("ps-y-reach-end",function(){n._showReadMore()}),t._dialogInnerElement.on("click",".modal_exit",function(){e.cleanup.call(t)})},t.getInnerHtml=function(){var e='<div id="grouplist_modal" class="card modal_card">          <div class="card_title">            <p> '+Resource.getMessage("GroupChatList")+' </p>          </div>          <div class="select_menu">            <form action="#" method="get" class="search_form title_search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("dialog_label_groupchatlist_search")+'">              <button type="button" name="search" class="title_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},t._createEventHandler=function(){var e=this;e._dialogInnerElement.find(".title_search_btn").off("click"),e._dialogInnerElement.find(".title_search_btn").on("click",function(){e.filterColumnName()}),e._dialogInnerElement.find("input.field").keypress(function(t){return(t.which&&13===t.which||t.keyCode&&13===t.keyCode)&&e.filterColumnName(),13!==t.which})},t._createColumnNameElement=function(e,t){var n=this,o=this,i=o._dialogAreaElement.find("#dialog-error");if(i.text(""),0==t)return void i.text(Resource.getMessage("dialog_groupchatlist_nothing"));if(0==e.length)return void o._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_groupchatlist_search_nothing"));for(var a=0;a<e.length;a++)if(null!=e[a].getRoomName()&&e[a].getRoomName().length>0){var r,s,l;!function(){r=Utils.avatarCreate({type:"group",name:e[a].getRoomName()});var t=e[a].getPrivacyType(),o="";"sidebar"!=n._mode&&null!=t&&0==t&&(o=' <span class="public-room-chip"></span>'),s='                    <li title="'+Utils.convertEscapedHtml(e[a].getRoomName())+'">                    <a roomid='+e[a].getRoomId()+' title="'+Utils.convertEscapedHtml(e[a].getRoomName())+'">                        <span class="ico ico_group">                           <div class="no_img" style="background-color:'+r.color+'">                             <div class="no_img_inner">'+r.name+'</div>                           </div></span>                        <span class="name room-list-name">'+Utils.convertEscapedHtml(e[a].getRoomName())+"</span>"+o+"                    </a>                </li>",l=$(s);var i=e[a].getRoomId();n._dialogInnerElement.find(".select_list").append(l),l.on("click",function(e){var t=CubeeController.getInstance().getChatRoomInfoByRoomId(i),n=ViewUtils.getGroupChatColumnInfo(t);ColumnManager.getInstance().addColumn(n,!0,!0),ViewUtils.unsetNewNoticeMark($(e.currentTarget)),NotificationIconManager.getInstance().onColumnClicked(n)})}()}},t.filterColumnName=function(){var e=this;e._dialogInnerElement.find(".select_list").empty();var t=e._dialogInnerElement.find("input.field").val();if(e.isGotRoomArrayList||0!=t.length){var n=function(n){for(var o=[],i=0;i<n.getCount();i++){var a=n.get(i);a.getRoomName().indexOf(t)>=0&&o.push(a),e.isGotRoomArrayList||e.roomArrayList.add(a)}e.isGotRoomArrayList=!0,e._createColumnNameElement(o,-1,!0),e._dialogInnerElement.find(".scroll_content").scrollTop(0)};if(e.isGotRoomArrayList)n(e.roomArrayList);else{var o=new ColumnSortCondition;o.getItems().removeAll(),o.getItems().add("updated_at"),o.getOrders().removeAll(),o.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC);var i=new ArrayList;i.add(this.currentTabInfo),CubeeController.getInstance().getRoomInfoList(0,Conf.getVal("NUMBER_OF_ITEMS_SEARCH_MAX_LIST"),i,o,n)}}},$(function(){var e=$("#left_sidebar").find(".groupchat_list .all_gc_list_btn a");e.on("click",function(){var e=TabManager.getInstance().getCommunityInfo(),t=new DialogGroupchatListView(e);t.showDialog()})})}(),function(){DialogPublicGroupchatListView.prototype=$.extend({},DialogOkCancelView.prototype);var e=DialogOkCancelView.prototype,t=DialogPublicGroupchatListView.prototype;t._init=function(){var t=this;t.isGotRoomArrayList=!1,t.roomArrayList=new ArrayList,t.frame=t.getInnerHtml();var n=new PublicGroupChatListView;n.init({numOfGroupchat:10}),n.showInnerFrameFromProject(function(){},t.currentTabInfo),t.frame.find(".modal_list").append(n._frame),t._dialogAreaElement.html(t.frame),t._dialogInnerElement=t._dialogAreaElement.children(),t.ps=new PerfectScrollbar(t.frame.find(".scroll_content")[0],{suppressScrollX:!0}),t._createEventHandler(),t._dialogInnerElement.find(".scroll_content").on("ps-y-reach-end",function(){
n._showReadMore()}),t._dialogInnerElement.on("click",".modal_exit",function(){e.cleanup.call(t)})},t.getInnerHtml=function(){var e='<div id="public_grouplist_modal" class="card modal_card">          <div class="card_title">            <p> '+Resource.getMessage("PublicGroupChatList")+' </p>          </div>          <div class="select_menu">            <form action="#" method="get" class="search_form title_search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("dialog_label_groupchatlist_search")+'">              <button type="button" name="search" class="title_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>            <button type="button" role="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" id="dialog-public-groupchat-joining-button">             <span>'+Resource.getMessage("dialog_public_groupchat_joining")+'</span>            </button>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},t._createEventHandler=function(){var e=this;e._dialogInnerElement.find(".title_search_btn").off("click"),e._dialogInnerElement.find(".title_search_btn").on("click",function(){e.filterColumnName()}),e._dialogInnerElement.find("input.field").keypress(function(t){return(t.which&&13===t.which||t.keyCode&&13===t.keyCode)&&e.filterColumnName(),13!==t.which}),$("#dialog-public-groupchat-joining-button").click(function(){var t=e._dialogInnerElement.find("input[name=public-gc-room-id]:checked").val();null!=t&&CubeeServerConnector.getInstance().addPublicGroupChatRoomMember(t,function(){setTimeout(function(){var n=CubeeController.getInstance().getChatRoomInfoByRoomId(t);if(null==n){var o=e._dialogAreaElement.find("#dialog-error");return void o.text(Resource.getMessage("add_member_err_submit"))}var i=LoginUser.getInstance().getJid();n.addMemberList(i);var a=ViewUtils.getGroupChatColumnInfo(n);ColumnManager.getInstance().addColumn(a,!0,!0),ViewUtils.modal_allexit()},500)})})},t._createColumnNameElement=function(e,t){var n=this,o=n._dialogAreaElement.find("#dialog-error");if(o.text(""),0==t)return void o.text(Resource.getMessage("dialog_groupchatlist_nothing"));if(0==e.length)return void n._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_groupchatlist_search_nothing"));for(var i=LoginUser.getInstance().getJid(),a=0;a<e.length;a++)if(null!=e[a].getRoomName()&&e[a].getRoomName().length>0){var r=e[a].getMemberList();if(r._array.indexOf(i)>=0)continue;var s=Utils.avatarCreate({type:"group",name:e[a].getRoomName()}),l='                    <li title="'+Utils.convertEscapedHtml(e[a].getRoomName())+'">                    <label for="pub_gc_'+e[a].getRoomId()+'"><div><a roomid='+e[a].getRoomId()+' title="'+Utils.convertEscapedHtml(e[a].getRoomName())+'">                        <span class="ico ico_group">                           <div class="no_img" style="background-color:'+s.color+'">                             <div class="no_img_inner">'+s.name+'</div>                           </div></span>                        <span class="name room-list-name">'+Utils.convertEscapedHtml(e[a].getRoomName())+'</span>                    </a>                    <input type="radio" name="public-gc-room-id" value="'+e[a].getRoomId()+'" id="pub_gc_'+e[a].getRoomId()+'" />                    <span class="public-gc-room-list-radio"></span>                </div></label></li>',u=$(l);e[a].getRoomId();this._dialogInnerElement.find(".select_list").append(u)}},t.filterColumnName=function(){var e=this;e._dialogInnerElement.find(".select_list").empty();var t=e._dialogInnerElement.find("input.field").val();if(e.isGotRoomArrayList||0!=t.length){var n=function(n){for(var o=[],i=0;i<n.getCount();i++){var a=n.get(i);a.getRoomName().indexOf(t)>=0&&o.push(a),e.isGotRoomArrayList||e.roomArrayList.add(a)}e.isGotRoomArrayList=!0,e._createColumnNameElement(o,-1,!0),e._dialogInnerElement.find(".scroll_content").scrollTop(0)};if(e.isGotRoomArrayList)n(e.roomArrayList);else{var o=new ColumnSortCondition;o.getItems().removeAll(),o.getItems().add("updated_at"),o.getOrders().removeAll(),o.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC);var i=new ArrayList;i.add(this.currentTabInfo),CubeeController.getInstance().getPublicGroupRoomInfoList(0,Conf.getVal("NUMBER_OF_ITEMS_SEARCH_MAX_LIST"),o,n)}}},$(function(){var e=$("#left_sidebar").find(".groupchat_list .all_public_list_btn a");e.on("click",function(){var e=TabManager.getInstance().getCommunityInfo(),t=new DialogPublicGroupchatListView(e);t.showDialog()})})}(),function(){DialogChatListView.prototype=$.extend({},DialogOkCancelView.prototype);var e=DialogOkCancelView.prototype,t=DialogChatListView.prototype;t._init=function(){var t=this;t.frame=t.getInnerHtml(),t._dialogAreaElement.html(t.frame),t._dialogInnerElement=t._dialogAreaElement.children();for(var n=ContactList.getInstance(),o=n.getCount(),i=[],a=0;a<n.getCount();a++)i.push(n.get(a));t._createColumnNameElement(i,o),t.ps=new PerfectScrollbar(t.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t._createEventHandler(),t._dialogInnerElement.find(".scroll_content").on("ps-y-reach-end",function(){for(var e=[],i=t._dialogInnerElement.find("ul.modal_list.select_list li").length,a=0;e.length<Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST")&&a+i<n.getCount()&&i%(Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST")-1)==0;a++){var r=a+i;t._searchword.length>0?(n.get(r).getUserName().indexOf(t._searchword)>=0||n.get(r).getGroup().indexOf(t._searchword)>=0||n.get(r).getLoginAccount().indexOf(t._searchword)>=0)&&e.push(n.get(r)):e.push(n.get(r))}t._createColumnNameElement(e,o,!0)}),t._dialogInnerElement.on("click",".modal_exit",function(){e.cleanup.call(t)})},t.getInnerHtml=function(){var e='<div id="chatlist_modal" class="card modal_card">          <div class="card_title">            <p> '+Resource.getMessage("dialog_title_chatlist")+' </p>          </div>          <div class="select_menu">            <form action="#" method="get" class="search_form title_search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("dialog_label_chatlist_search")+'">              <button type="button" name="search" class="title_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},t._createEventHandler=function(){var e=this;e._dialogInnerElement.find(".title_search_btn").off("click"),e._dialogInnerElement.find(".title_search_btn").on("click",function(){e.filterColumnName()}),e._dialogInnerElement.find("input.field").keypress(function(t){return(t.which&&13===t.which||t.keyCode&&13===t.keyCode)&&e.filterColumnName(),13!==t.which})},t._createColumnNameElement=function(e,t,n){var o=this,i=o._dialogAreaElement.find("#dialog-error");if(i.text(""),0==t)return void i.text(Resource.getMessage("dialog_chatlist_nothing"));if(0==e.length&&!n)return void o._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_chatlist_search_nothing"));for(var a=0;a<e.length;a++)if(null!=e[a].getUserName()&&e[a].getUserName().length>0){var r=ViewUtils.getAvatarDataHtmlFromPerson(e[a]),s=" status "+ViewUtils.getPresenceColorCss(e[a].getPresence()),l=e[a].getGroup().length>0?e[a].getGroup().join(" "):Resource.getMessage("group_title_no_group"),u='                <li jid="'+e[a].getJid()+'">                    <a title="'+e[a].getUserName()+" "+Utils.convertEscapedHtml(l)+'">                        <span class="ico ico_user '+s+'">'+r+'</span>                        <span class="name">'+Utils.convertEscapedHtml(e[a].getUserName())+'</span>                        <span class="group">'+Utils.convertEscapedHtml(l)+"</span>                    </a>                </li>",c=$(u);this._dialogInnerElement.find(".select_list").append(c),c.on("click",function(e){var t=$(e.currentTarget).attr("jid"),n=new ColumnInformation;n.setColumnType(ColumnInformation.TYPE_COLUMN_CHAT),n.setFilterCondition(t),ColumnManager.getInstance().addColumn(n,!0,!0),ViewUtils.unsetNewNoticeMark($(e.currentTarget)),NotificationIconManager.getInstance().onColumnClicked(n),ViewUtils.modal_allexit()})}},t.filterColumnName=function(){var e=this;e._dialogInnerElement.find(".select_list").empty();for(var t=e._dialogInnerElement.find("input.field").val(),n=ContactList.getInstance(),o=n.getCount(),i=[],a=0;a<n.getCount();a++){var r=n.get(a);(r.getUserName().indexOf(t)>=0||r.getGroup().indexOf(t)>=0||r.getLoginAccount().indexOf(t)>=0)&&i.push(r)}e._searchword=t,e._createColumnNameElement(i,o),e._dialogInnerElement.find(".scroll_content").scrollTop(0)},$(function(){var e=$("#left_sidebar").find(".contact_list .all_list_btn a");e.on("click",function(){var e=new DialogChatListView;e.showDialog()})})}(),function(){function e(e){return e.match(/ico_user/)?Message.TYPE_CHAT:e.match(/ico_group/)?Message.TYPE_GROUP_CHAT:e.match(/ico_project/)?Message.TYPE_COMMUNITY:void 0}function t(e){var t=e._dialogInnerElement.find("input.field").val(),n=new ArrayList;return e._allProjectList._array.filter(function(e){var o=e.getRoomName();0<=o.indexOf(t)&&n.add(e)}),n.getCount()?(e._dialogAreaElement.find("#showList_for_quote").append(m(e,n)),void e._dialogInnerElement.find(".scroll_content").scrollTop(0)):void _(e._dialogMessageToPage,Resource.getMessage("dialog_search_room_nothing"))}function n(e){var t=e._dialogInnerElement.find("input.field").val(),n=new ArrayList;return e._allFolloweeList._array.filter(function(e){var o=followInfo.getRoomName();0<=o.indexOf(t)&&n.add(e)}),n.getCount()?(e._dialogAreaElement.find("#showList_for_quote").append(setFolloweeListFrame(e,n)),void e._dialogInnerElement.find(".scroll_content").scrollTop(0)):void _(e._dialogMessageToPage,Resource.getMessage("dialog_search_followee_nothing"))}function o(e){var t=e._dialogInnerElement.find("input.field").val(),n=new ArrayList;return e._allFollowerList._array.filter(function(e){var o=followeeInfo.getRoomName();0<=o.indexOf(t)&&n.add(e)}),n.getCount()?(e._dialogAreaElement.find("#showList_for_quote").append(setFollowerListFrame(e,n)),void e._dialogInnerElement.find(".scroll_content").scrollTop(0)):void _(e._dialogMessageToPage,Resource.getMessage("dialog_search_follower_nothing"))}function i(e){var t=e._dialogInnerElement.find("input.field").val(),n=new ArrayList;return e._allGroupchatList._array.filter(function(e){var o=e.getRoomName();0<=o.indexOf(t)&&n.add(e)}),n.getCount()?(e._dialogAreaElement.find("#showList_for_quote").append(u(e,n)),void e._dialogInnerElement.find(".scroll_content").scrollTop(0)):void _(e._dialogMessageToPage,Resource.getMessage("dialog_search_room_nothing"))}function a(e){var t=e._dialogInnerElement.find("input.field").val(),n=new ArrayList;return e._allChatList._array.filter(function(e){var o=e.getUserName(),i=e.getLoginAccount(),a=ViewUtils.getGroupName(e);(0<=o.indexOf(t)||0<=i.indexOf(t)||0<=a.indexOf(t))&&n.add(e)}),n.getCount()?(e._dialogAreaElement.find("#showList_for_quote").append(d(e,n)),void e._dialogInnerElement.find(".scroll_content").scrollTop(0)):void _(e._dialogMessageToPage,Resource.getMessage("dialog_search_room_nothing"))}function r(e){var t="",n=e._message,o=n.getQuotationItem();if(o)t=o.getFrom()?s(e,o,!0):s(e,o,!1);else switch(e._message.getType()){case Message.TYPE_PUBLIC:t=s(e,n,!0);break;case Message.TYPE_CHAT:t=s(e,n,!1);break;case Message.TYPE_GROUP_CHAT:var i=0;i=e._column.getType()==ColumnInformation.TYPE_COLUMN_GROUP_CHAT?e._column.getColumnInfo().getChatRoomInfomation().getPrivacyType():e._roomPrivacyType,t=0==i?s(e,n,!0):s(e,n,!1);break;case Message.TYPE_COMMUNITY:var i=0;i=e._column.getType()==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED?e._column.getColumnInfo().getCommunityInfomation().getPrivacyType():e._roomPrivacyType,t=0==i?s(e,n,!0):s(e,n,!1);break;case Message.TYPE_MURMUR:t=s(e,n,!0)}return t}function s(e,t,n){var o="",i="message-body-quote-anonymous",a=ViewUtils.urlAutoLink(t.getUIShortenUrls(),ViewUtils.removeAttachmentUrl(t.getMessage()),!0,null,!1,t.getItemId()),r=e._column.getMsgObjByItemId(e._message.getItemId());n&&(i="message-body-quote",o=r.getMessageHeaderHtmlFromObj(t));var s='      <div class="quote_from scroll_content">                            '+o+"                            <div class="+i+">                              "+a+"                              "+r.getMessageBodyThumbnailImageHtml(t)+"                            </div>                          </div>";return s}function l(e){function t(t){e._allGroupchatList=t,e._dialogAreaElement.find("#showList_for_quote").append(u(e,t)),e._dialogInnerElement.on("click","#showList_for_quote li",function(){e.addDestinationRoom($(this).prop("outerHTML"))})}var n=new ColumnSortCondition;n.getItems().removeAll(),n.getItems().add("updated_at"),n.getOrders().removeAll(),n.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC);var o=new ArrayList;o.add(new CommunityInfo),CubeeController.getInstance().getRoomInfoList(0,1e3,o,n,t)}function u(e,t){var n=t.getCount();if(0==n)return void _(e._dialogMessageToPage,Resource.getMessage("dialog_error_no_groupchat"));for(var o="",i=0;n>i;i++){var a=t.get(i),r=Utils.convertEscapedHtml(a.getRoomName()),s=Utils.avatarCreate({type:"group",name:a.getRoomName()});o+="<li>",o+='<a title="'+r+'"roomid="'+a.getRoomId()+'" class="text-overflow-ellipsis" title="'+r+'">',o+='  <span class="ico ico_group">',o+='    <div class="no_img" style="background-color:'+s.color+'">',o+='      <div class="no_img_inner">'+s.name+"</div>",o+="    </div></span>",o+='  <span class="name">'+r+"</span>",o+="</a></li>"}return o}function c(e){e._allChatList=ContactList.getInstance(),e._dialogAreaElement.find("#showList_for_quote").append(d(e,e._allChatList)),e._dialogInnerElement.on("click","#showList_for_quote li",function(){e.addDestinationRoom($(this).prop("outerHTML"))})}function d(e,t){var n=t.getCount();if(0==n)return void _(e._dialogMessageToPage,Resource.getMessage("dialog_error_no_chatlist"));for(var o="",i=0;n>i;i++){var a=t.get(i),r=a.getJid(),s=ViewUtils.getGroupName(a),l="";l=ViewUtils.getAvatarUrl(a)==ViewUtils.DEFAULT_USER_AVATAR_SRC?ViewUtils.getDefaultAvatarHtml(a):ViewUtils.getAvatarDataHtmlFromPerson(a),o+='<li jid="'+r+'">',o+='  <a title="'+Utils.convertEscapedHtml(a.getUserName())+"  "+Utils.convertEscapedHtml(s)+'">',o+='    <span class="ico ico_user status '+ViewUtils.getPresenceColorCss(a.getPresence())+'">',o+=l,o+="    </span>",o+='    <span class="name">'+Utils.convertEscapedHtml(a.getUserName())+ViewUtils.getUserStatusString(a.getStatus())+"</span>",o+='    <span class="group">'+Utils.convertEscapedHtml(s)+"</span>",o+="</a></li>"}return o}function g(e){function t(t){e._allProjectList=t,e._dialogAreaElement.find("#showList_for_quote").append(m(e,t)),e._dialogInnerElement.on("click","#showList_for_quote li",function(){e.addDestinationRoom($(this).prop("outerHTML"))})}var n=new ColumnSortCondition;n.getItems().removeAll(),n.getItems().add("updated_at"),n.getOrders().removeAll(),n.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC),CubeeController.getInstance().getJoinedCommunityInfoList(0,1e3,n,t)}function m(e,t){var n=t.getCount();if(0==n)return void _(e._dialogMessageToPage,Resource.getMessage("project_list_zero"));for(var o="",i=0;n>i;i++){var a=t.get(i);if(_avaterDate=a.getLogoUrl(),projectname=a.getRoomName(),o+='<li class="cf"><a  data_value="'+a.getRoomId()+'" title="'+Utils.convertEscapedHtml(projectname)+'"><span class="ico ico_project">',null==_avaterDate||""==_avaterDate){var r=Utils.avatarCreate({name:projectname,type:DialogProjectListView.AvaterType});o+='<div class="no_img" style="background-color:'+r.color+'"><div class="no_img_inner">'+r.name+"</div></div></span>"}else o+='<img src="'+_avaterDate+'" alt=""></span>';o+='<span class="name">'+Utils.convertEscapedHtml(projectname,!1)+"</span>"}return o}function _(e,t){e.find("#dialog-error").text(t)}DialogQuoteMessageView.prototype=$.extend({},DialogOkCancelView.prototype);var f=DialogOkCancelView.prototype,p=DialogQuoteMessageView.prototype;p._init=function(){var e=this;f._init.call(e),e._dialogAreaElement.html(e.getMainHtmlElement()),e._dialogInnerElement=e._dialogAreaElement.children(),e._dialogInnerElement.find("#quotemessage_modal").html(e.getInnerMessageHtml()),e._dialogInnerElement.find("#quotemessage_modal_for_to").html(e.getInnerToMessageHtml()),e._dialogMessagePage=e._dialogInnerElement.find("#quotemessage_modal"),e._dialogMessageToPage=e._dialogInnerElement.find("#quotemessage_modal_for_to"),e._dialogAreaElement.on("click","#quote_next_btn",function(){e.nextModal()}),e._dialogAreaElement.on("click","#quote_before_btn",function(){e.beforeModal()}),e._dialogAreaElement.on("click","#quote_send_btn",function(){e.sendQuoteMessageExecute()}),e._dialogAreaElement.on("click",".modal_exit",function(){ViewUtils.modal_allexit(),e._dialogAreaElement.off()}),e._dialogAreaElement.on("change",'input[name="destination_room"]:radio',function(){switch(e._dialogInnerElement.off(),e._dialogInnerElement.find(".scroll_content").off(),$("#showList_for_quote").children().remove(),e.ps.update(),_(e._dialogMessageToPage,""),$(this).attr("id")){case"quote_project":g(e);break;case"quote_groupchat":l(e);break;case"quote_chat":c(e)}}),e._createEventHandler()},p.getMainHtmlElement=function(){var e='<div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-draggable" tabindex="-1" role="dialog" aria-labelledby="ui-dialog-title-tab-column-add">                      <div id="quote_modal" class="card modal_card modal_slider">                        <div class="modal_slide_wrapper cf">                          <div class="modal_slide quote_message_slide"  id="quotemessage_modal">                          </div>                          <div class="modal_slide password_slide" id="quotemessage_modal_for_to">                          </div>                        </div>                        <!--  -->                        <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>                      </div>                    </div>';return e},p.addDestinationRoom=function(t){var n=this;t=$(t),n._dialogAreaElement.find("ul.quote_distination").children().remove();var o=t.find("span.ico").attr("class"),i=e(o);switch(i){case Message.TYPE_CHAT:t.find("span.group").text(Resource.getMessage("Chat")),t.find("a").attr("data_value",t.attr("jid"));break;case Message.TYPE_GROUP_CHAT:var a='<span class="group">'+Resource.getMessage("GroupChat")+"</span>";t.find("a").append($(a)),t.find("a").attr("data_value",t.find("a").attr("roomid"));break;case Message.TYPE_COMMUNITY:t.find("span.detail").remove();var a='<span class="group">'+Resource.getMessage("Community")+"</span>";t.find("a").append($(a))}t.find("a").attr("roomType",i),t.attr("title",t.find("span.name").text()+" "+t.find("span.group").text()),n._dialogAreaElement.find("ul.quote_distination").append(t.prop("outerHTML")),n.displayRoomInfo=t},p._createEventHandler=function(){var e=this;autosize(e._dialogInnerElement.find(".message-input-area"));var t=e._dialogInnerElement.find("div.frm-message > textarea.message-input-area");e._textarea=new ColumnTextAreaView(t,e,Resource.getMessage("default_placeholder")),ViewUtils.setCharCounter(t,e._dialogInnerElement.find(".char-counter-column"),ColumnView.TEXTAREA_MAX_LENGTH);var n=ViewUtils.getAttachmentFileName(e._message.getMessage());n&&(e._dialogInnerElement.find("p.file-name").text(n),e._dialogInnerElement.find("p.file-name").attr("title",n));var o=e._dialogInnerElement.find("img.image-thumbnail"),i=ColumnManager.getInstance().getImageMaxWidth();o.each(function(t,n){var o=$(n);if(!o.attr("src")){var a=e._message.getItemId(),r=o.attr("data-url");CubeeController.getInstance().downloadThumbnailImage(r,a,o)}o.css("max-width",i)}),ViewUtils.showOpenGraphProtocolImage(e._dialogInnerElement),e.quote_from_ps=new PerfectScrollbar(e._dialogInnerElement.find(".scroll_content")[0],{suppressScrollX:!0}),g(e),e.ps=new PerfectScrollbar(e._dialogInnerElement.find("#quotemessage_modal_for_to .scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(e.ps),e._dialogInnerElement.find(".title_search_btn").off("click"),e._dialogInnerElement.find(".title_search_btn").on("click",function(){e.filterRoomList()}),e._dialogInnerElement.find("input.field").keypress(function(t){return(t.which&&13===t.which||t.keyCode&&13===t.keyCode)&&e.filterRoomList(),13!==t.which})},p.showDialog=function(){var e=this;e._onOpenDialog()},p._onOpenDialog=function(){var e=this;$("#modal_area").css("display","block"),$("#modal_area").prepend('<div class="overlay modal_exit"></div>'),e._dialogInnerElement.addClass("on").css("display","block").animate({"margin-top":0,opacity:1},200),e._dialogInnerElement.find("#quote_modal").addClass("on").css("display","block").animate({"margin-top":0,opacity:1},200),$(".overlay").animate({opacity:.3},200)},p.nextModal=function(){var e=this;return _(e._dialogMessagePage,""),ViewUtils.isValidInputTextLength(e._textarea.getText())?void e._dialogAreaElement.find(".modal_slide_wrapper").css("transform","translateX(-480px)"):void _(e._dialogMessagePage,ColumnView.TEXTAREA_MAX_LENGTH+Resource.getMessage("dialog_update_message_number_error"))},p.filterRoomList=function(){var e=this;switch($("#showList_for_quote").children().remove(),_(e._dialogMessageToPage,""),Number(e._dialogInnerElement.find("input[type=radio]:checked").val())){case Message.TYPE_COMMUNITY:t(e);break;case Message.TYPE_Followee:n(e);case Message.TYPE_Follower:o(e);case Message.TYPE_GROUP_CHAT:i(e);break;case Message.TYPE_CHAT:a(e)}},p.beforeModal=function(){var e=this;e._dialogAreaElement.find(".modal_slide_wrapper").css("transform","translateX(0px)")},p.getInnerMessageHtml=function(){var e=this,t="<div>",n="autocomplete";e._message.getType()==Message.TYPE_COMMUNITY?n='autocomplete-for-community" groupId="'+e._message.getTo()+'"':e._message.getType()==Message.TYPE_GROUP_CHAT&&(n='autocomplete-for-chatroom" groupId="'+e._message.getTo()+'"'),t+='<textarea class="ui-corner-all autoresize-textarea message-input-area '+n+' placeholder="" style="min-height: 4em; max-height: 300px;"></textarea>',t+=ColumnFileUploadPartsView.getHtml(1),t+=ColumnTextAreaView.getCharCounterHtml(1,!0),t+="</div>";var o="";return o='    <div class="card_title">',o+="      <p>"+Resource.getMessage("dialog_label_quote_message")+"</p>",o+="    </div>",o+='    <div class="modal_content_wrapper">',o+='      <p class="modal_title">'+Resource.getMessage("dialog_comment_for_quote_message")+":</p>",o+='      <div class="flex1 frm-message update_message">',o+=$(t).find(".message-input-area").prop("outerHTML"),o+=$(t).find(".char-counter-column").prop("outerHTML"),o+="      </div>",o+='      <p class="modal_title">'+Resource.getMessage("dialog_quote_message")+":</p>",o+=r(e),o+='      <p class="modal_title">'+Resource.getMessage("dialog_quote_message_attention_anonymous")+"</p>",o+="    </div>",o+='    <div class="btn_wrapper">',o+='      <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',o+='      <button id="quote_next_btn" type="button" class="modal_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("wizard_btn_next")+"</span></button>",o+="    </div>"},p.getInnerToMessageHtml=function(){var e="";return e='    <div class="card_title">',e+="      <p>"+Resource.getMessage("dialog_label_quote_message")+"</p>",e+="    </div>",e+='    <div class="modal_content_wrapper">',e+='      <p class="modal_title">'+Resource.getMessage("dialog_select_quote_room")+":</p>",e+='<div class="select-quote-target">                  <label for="quote_project" class="radio">                  <input type="radio" name="destination_room" id="quote_project" value='+Message.TYPE_COMMUNITY+' checked="">                  <span></span>'+Resource.getMessage("Community")+'</label>                  <label for="quote_groupchat" class="radio">                  <input type="radio" name="destination_room" id="quote_groupchat" value='+Message.TYPE_GROUP_CHAT+">                  <span></span>"+Resource.getMessage("GroupChat")+'</label>                  <label for="quote_chat" class="radio">                  <input type="radio" name="destination_room" id="quote_chat" value='+Message.TYPE_CHAT+">                  <span></span>"+Resource.getMessage("Chat")+"</label>                </div>",e+='<div class="select_menu">                  <form action="#" method="get" class="search_form">                    <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("dialog_search_room_name")+'">                    <button type="button" name="search" class="title_search_btn ico_btn"><i class="fa fa-search"></i></button>                  </form>                </div>',e+='<div class="list_wrapper scroll_content" id="quote_dest_list">',e+='  <ul class="modal_list" id="showList_for_quote">',e+="  </ul>",e+="</div>",e+='<p class="modal_title" id=quote_click_chat style="                  margin-top: 15px;                  ">'+Resource.getMessage("dialog_selected_quote_room")+": </p>",e+='<ul class="modal_list quote_distination">                </ul>',e+="    </div>",e+='    <div class="btn_wrapper">',e+='      <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',e+='      <button id="quote_before_btn" type="button" class="modal_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("wizard_btn_before")+"</span></button>",e+='      <button id="quote_send_btn" type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("column_btn_submit")+"</span></button>",e+="    </div>"},p.sendQuoteMessageExecute=function(){var e=this;if(!e.displayRoomInfo)return void _(e._dialogMessageToPage,Resource.getMessage("dialog_label_not_select_quote_room_error"));var t={type:parseInt(e.displayRoomInfo.find("a").attr("roomtype")),sendto:e.displayRoomInfo.find("a").attr("data_value"),body:e._textarea.getText(),quotationItemId:e._message.getItemId()};CubeeController.getInstance().sendQuoteMessage(t).then(function(t){ViewUtils.modal_allexit(),e._dialogAreaElement.off()})["catch"](function(t){if(t&&t.content.reason)switch(t.content.reason){case 403e3:_(e._dialogMessageToPage,Resource.getMessage("authority_err"));break;default:_(e._dialogMessageToPage,Resource.getMessage("dialog_label_send_quote_message_error"))}else _(e._dialogMessageToPage,Resource.getMessage("dialog_label_send_quote_message_error"))})}}(),function(){DialogReadInBulkCheckView.prototype=$.extend({},DialogOkCancelView.prototype);var e=DialogOkCancelView.prototype,t=DialogReadInBulkCheckView.prototype;t._init=function(){var t=this;e._init.call(t),this._dialogAreaElement.html(t.getReadInBulkMessageCheckHtml()),this._dialogInnerElement=this._dialogAreaElement.children(),t._dialogInnerElement.find("#read_in_bulk_ok_btn").on("click",function(){function e(e){console.log("message read done : "+e)}var n=[];$(t._columnjq).find("div > div > div.message-border > div[itemid]").each(function(e,t){n.push($(t).attr("itemid"))});for(var o=[],i=0;i<n.length;i++)CubeeServerConnector.getInstance().sendSetReadOneMessage(n[i],e)||o.push(n[i]);o.length>0?$("#read_in_bulk_modal > div.modal_content_wrapper > p").text(Resource.getMessage("read_in_bulk_error_message")):ViewUtils.modal_allexit()}),t._dialogInnerElement.find("#read_in_bulk_cancel_btn").on("click",function(){ViewUtils.modal_allexit()})},t.getReadInBulkMessageCheckHtml=function(){var e=this,t=e._columnInfo.getDisplayName(),n=t+Resource.getMessage("read_in_bulk_attention_message"),o=Resource.getMessage("read_in_bulk_attention_nonify_message"),i="";return i+='<div id="read_in_bulk_modal" class="card modal_card">',i+='  <div class="card_title">',i+="    <p>"+Resource.getMessage("dialog_confirmation_title")+"</p>",i+="  </div>",i+='  <div class="modal_content_wrapper">',i+='    <p class="txt">'+n+'<span style="display:block;">'+Resource.getMessage("read_in_bulk_attention_message_last_line")+'</span><span style="color:#f00;display:block;margin-top:10px;">'+o+"</span></p>",i+="  </div>",i+='  <div class="btn_wrapper">',i+='    <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',i+='    <button type="button" id="read_in_bulk_cancel_btn" class="modal_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_cancel")+"</span></button>",i+='    <button type="button" id="read_in_bulk_ok_btn" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+"</span></button>",i+="  </div>",i+='  <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',i+="</div>"}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogMenthionCommunityPersonList.prototype=$.extend({},DialogSelectCommunityMemberView.prototype);var e=(DialogSelectCommunityMemberView.prototype,DialogMenthionCommunityPersonList.prototype);e._init=function(){var t=this;t.allMembers=[],t.frame=t.getHtml(),e.getCommunityMemberList(t._communityId).then(function(e){t.allMembers=e,t.allPersons=e,t.addPersons()})["catch"](function(e){}),t._dialogAreaElement.html(t.frame),t._dialogInnerElement=t._dialogAreaElement.children(),t.ps=new PerfectScrollbar(t.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t.personCount=0,t.frame.find(".scroll_content").off("scroll"),t.frame.find(".scroll_content").on("scroll",function(){$(this).get(0).scrollHeight===$(this).scrollTop()+$(this).get(0).clientHeight&&t.personCount!==t.allPersons.length&&t.addPersons()}),t.memberList=new ArrayList,t._dialogInnerElement.find(".success_btn").off("click"),t._dialogInnerElement.find(".success_btn").on("click",function(){t._request(t.memberList,t)}),t._dialogInnerElement.find(".user_search_btn").off("click"),t._dialogInnerElement.find(".user_search_btn").on("click",function(){t.filterMembers()}),t._dialogInnerElement.find(".field").keypress(function(e){return(e.which&&13===e.which||e.keyCode&&13===e.keyCode)&&t.filterMembers(),13!==e.which}),t._dialogInnerElement.find("input[name=allcheck]").off("change"),t._dialogInnerElement.find("input[name=allcheck]").on("change",function(){t._dialogInnerElement.find("input[name=mentionmember]").prop("checked",this.checked);var e=t._dialogInnerElement.find("input[name=mentionmember]");if(this.checked)for(var n=0;n<e.length;n++)0===t.memberList._array.filter(function(t){t===e[n].attr("uid")}).length&&t.memberList.add(e[n].attr("uid"));else for(var n=0;n<e.length;n++)t.memberList.remove(t.memberList._array.indexOf(e[n].attr("uid")));
var o=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(o)});var n=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(n)},e.getHtml=function(){var e='<div id="mentionmember_modal" class="card modal_card">          <div class="card_title">            <p>'+Resource.getMessage("menthion_community_person_list_dialog_title")+'</p>          </div>          <div class="select_menu">            <form action="#" method="get" class="search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("wizard_chatlist_conditions_account")+'">              <button type="button" name="search" class="user_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>            <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("menthion_button_force_selected")+'</span></button>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},e.searchExecute=function(){var e=this,t=e.frame.find(".field").val(),n=Utils.trimStringMulutiByteSpace(t);if(n&&""!=n){var o=ViewUtils.getKeywordFilterFromKeywordInputString(n,!1);if(o&&"object"==("undefined"==typeof o?"undefined":_typeof(o))){if(e._dialogInnerElement.find("input[name=allcheck]").prop("checked",!1),0<e.allMembers.length)return void e.filterMembers();var i=new ColumnSortCondition;i.getItems().removeAll(),i.getItems().add("login_account"),i.getOrders().removeAll(),i.getOrders().add(ColumnSortCondition.SORT_ORDER_ASC);var a=o,r=new ColumnSearchCondition(a,i),s=0,l=Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST");return CubeeController.getInstance().searchPerson(s,l,r,function(t){e.frame.find(e.selector_list).empty(),e.setUserListHtml(t),e.applySelectedInfoToView(),e.applyExcludedList()})}}},e._createMemberElement=function(e){var t=this,n=LoginUser.getInstance(),o=n.getJid();$.each(e,function(e,n){if(o!==n.getJid()){var i=n._profile,a=Utils.getSafeStringData(i._nickName);a=Utils.convertEscapedHtml(a);var r="@"+i._loginAccount,s=ViewUtils.getAvatarDataHtmlFromPerson(n),l='<li title="'+a+" "+r+'"><label>                   <span class="ico ico_user"></span>                    <span class="name">'+a+'</span>                    <span class="group"></span>                    <label class="checkbox">                   <input type="checkbox" name="mentionmember" uid="'+i._loginAccount+'"><span></span></label>                    </label></li>',u=$(l);t._dialogInnerElement.find(".select_list").append(u);u.find(".ico_user").append(s),u.find(".group").text(r).html(),u.find("input:checkbox").val(n._jid),0<=t.memberList._array.indexOf(i._loginAccount)?u.find("input:checkbox").attr("disabled",!0):0<=t._baseMessage.indexOf(r)&&(u.find("input:checkbox").attr("disabled",!0),t.memberList.add(i._loginAccount)),u.find("input[name=mentionmember]").off("change"),u.find("input[name=mentionmember]").on("change",function(){var e=$(this).attr("uid");this.checked?t.memberList.add($(this).attr("uid")):t.memberList._array.forEach(function(n,o){n===e&&t.memberList.remove(o)});var n=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(n)});var c=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(c)}var d=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(d)})},e.filterMembers=function(){var e=this;e.personCount=0,e._dialogInnerElement.find(".select_list").empty(),e._dialogInnerElement.find("input[name=allcheck]").prop("checked",!1);var t=e.frame.find(".field").val(),n=e.allMembers.filter(function(e){var n=Utils.getSafeStringData(e.getUserName()),o=e._profile.getLoginAccount();return 0<=n.indexOf(t)||0<=o.indexOf(t)});e.allPersons=n,e.addPersons(),e.frame.find(".scroll_content").scrollTop(0)},e.addPersons=function(){for(var e=Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST"),t=this,n=[],o=t.personCount;o<Math.min(t.personCount+e,t.allPersons.length);o++)n.push(t.allPersons[o]);t.personCount+=n.length,t._createMemberElement(n)},e.getCommunityMemberList=function(e){return new Promise(function(t,n){function o(e){if(null==e)return void n();for(var o=new Array,i=e.getOwnerList(),a=i.getCount(),r=e.getGeneralMemberList(),s=r.getCount(),l=0;a>l;l++){var u=i.get(l);o.push(u)}for(var l=0;s>l;l++){var c=r.get(l);o.push(c)}t(o)}CubeeController.getInstance().getCommunityMemberInfo(e,o)})},e._request=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t.doneFunction&&"function"==typeof t.doneFunction){for(var n=[],o=0;o<e.getCount();o++)n.push("@"+e.get(o));t.doneFunction(n),t.cleanup()}},e._isValidateOk=function(e,t,n){var o=this,i=LoginUser.getInstance(),a=(i.getJid(),o._validateInputMemberList(e,t));a.memberList;o._isValidateJoinedMember(a,n)},e._validateJoinedMember=function(e,t,n){for(var o="",i=n.getCount(),a=0;i>a;a++)""!==o&&(o+=" "),o+=Utils.convertEscapedHtml("@"+n.get(a).getLoginAccount());return""!==o&&e.errList.add('"'+o+'"'+Resource.getMessage("add_member_err_not_exist")),{memberList:t,errList:e.errList}},e.cleanup=function(){ViewUtils.modal_allexit()}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogMenthionGroupChatPersonList.prototype=$.extend({},DialogSelectChatRoomMemberView.prototype);var e=(DialogSelectChatRoomMemberView.prototype,DialogMenthionGroupChatPersonList.prototype);e._init=function(){var e=this;e.allMembers=[],e.frame=e.getHtml(),e._getRoomMemberList(e._roomId).then(function(t){e.allMembers=t._array,e.allPersons=t._array,e.addPersons()})["catch"](function(e){}),e._dialogAreaElement.html(e.frame),e._dialogInnerElement=e._dialogAreaElement.children(),e.ps=new PerfectScrollbar(e.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(e.ps),e.personCount=0,e.frame.find(".scroll_content").off("scroll"),e.frame.find(".scroll_content").on("scroll",function(){$(this).get(0).scrollHeight===$(this).scrollTop()+$(this).get(0).clientHeight&&e.personCount!==e.allPersons.length&&e.addPersons()}),e.memberList=new ArrayList,e._dialogInnerElement.find(".success_btn").off("click"),e._dialogInnerElement.find(".success_btn").on("click",function(){e._request(e.memberList,e)}),e._dialogInnerElement.find(".user_search_btn").off("click"),e._dialogInnerElement.find(".user_search_btn").on("click",function(){e.filterMembers()}),e._dialogInnerElement.find(".field").keypress(function(t){return(t.which&&13===t.which||t.keyCode&&13===t.keyCode)&&e.filterMembers(),13!==t.which}),e._dialogInnerElement.find("input[name=allcheck]").off("change"),e._dialogInnerElement.find("input[name=allcheck]").on("change",function(){e._dialogInnerElement.find("input[name=mentionmember]").prop("checked",this.checked);var t=e._dialogInnerElement.find("input[name=mentionmember]");if(this.checked)for(var n=0;n<t.length;n++)0===e.memberList._array.filter(function(e){return e===t[n].attr("uid")}).length&&e.memberList.add(t[n].attr("uid"));else for(var n=0;n<t.length;n++)e.memberList.remove(e.memberList._array.indexOf(t[n].attr("uid")));var o=e.memberList.getCount();e._dialogInnerElement.find(".checkedCnt").text(o)});var t=e.memberList.getCount();e._dialogInnerElement.find(".checkedCnt").text(t)},e.getHtml=function(){var e='<div id="mentionmember_modal" class="card modal_card">          <div class="card_title">            <p>'+Resource.getMessage("menthion_groupchat_person_list_dialog_title")+'</p>          </div>          <div class="select_menu">            <form action="#" method="get" class="search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("wizard_chatlist_conditions_account")+'">              <button type="button" name="search" class="user_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>            <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("menthion_button_force_selected")+'</span></button>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},e._createMemberElement=function(e){var t=this,n=LoginUser.getInstance(),o=n.getJid();$.each(e,function(e,n){if(o!==n.getJid()){var i=n._profile,a=Utils.getSafeStringData(i._nickName);a=Utils.convertEscapedHtml(a);var r="@"+i._loginAccount,s=ViewUtils.getAvatarDataHtmlFromPerson(n),l='<li title="'+a+" "+r+'"><label>                   <span class="ico ico_user"></span>                    <span class="name">'+a+'</span>                    <span class="group"></span>                    <label class="checkbox">                   <input type="checkbox" name="mentionmember" uid="'+i._loginAccount+'"><span></span></label>                    </label></li>',u=$(l);t._dialogInnerElement.find(".select_list").append(u);u.find(".ico_user").append(s),u.find(".group").text(r).html(),u.find("input:checkbox").val(n._jid),0<=t.memberList._array.indexOf(n.getJid())?u.find("input:checkbox").attr("disabled",!0):0<=t._baseMessage.indexOf(r)&&(u.find("input:checkbox").attr("disabled",!0),t.memberList.add(i._loginAccount)),u.find("input[name=mentionmember]").off("change"),u.find("input[name=mentionmember]").on("change",function(){var e=$(this).attr("uid");this.checked?t.memberList.add($(this).attr("uid")):t.memberList._array.forEach(function(n,o){n===e&&t.memberList.remove(o)});var n=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(n)});var c=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(c)}var d=t.memberList.getCount();t._dialogInnerElement.find(".checkedCnt").text(d)})},e.filterMembers=function(){var e=this;e.personCount=0,e._dialogInnerElement.find(".select_list").empty(),e._dialogInnerElement.find("input[name=allcheck]").prop("checked",!1);var t=e.frame.find(".field").val(),n=e.allMembers.filter(function(e){var n=Utils.getSafeStringData(e.getUserName()),o=e._profile.getLoginAccount();return 0<=n.indexOf(t)||0<=o.indexOf(t)});e.allPersons=n,e.addPersons(),e.frame.find(".scroll_content").scrollTop(0)},e.addPersons=function(){for(var e=Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST"),t=this,n=[],o=t.personCount;o<Math.min(t.personCount+e,t.allPersons.length);o++)n.push(t.allPersons[o]);t.personCount+=n.length,t._createMemberElement(n)},e._request=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t.doneFunction&&"function"==typeof t.doneFunction){for(var n=[],o=0;o<e.getCount();o++)n.push("@"+e.get(o));t.doneFunction(n),t.cleanup()}},e._isValidateOk=function(e,t,n){var o=this,i=LoginUser.getInstance(),a=(i.getJid(),o._validateInputMemberList(e,t));a.memberList;o._isValidateJoinedMember(a,n)},e._validateJoinedMember=function(e,t,n){for(var o="",i=n.getCount(),a=0;i>a;a++)""!==o&&(o+=" "),o+=Utils.convertEscapedHtml("@"+n.get(a).getLoginAccount());return""!==o&&e.errList.add('"'+o+'"'+Resource.getMessage("add_member_err_not_exist")),{memberList:t,errList:e.errList}},e.cleanup=function(){ViewUtils.modal_allexit()}}(),function(){function e(e,t){for(var n=e.length,o=0;n>o;o++){var i=e[o];if(t==i)return o}return-1}function t(e,t){var n=FavoriteStore.FAVORITE_KEY+"_"+location.hostname+"_"+LoginUser.getInstance().getJid();e.setItem(n,t)}function n(e){var t=FavoriteStore.FAVORITE_KEY+"_"+location.hostname+"_"+LoginUser.getInstance().getJid();return e.getItem(t)}FavoriteStore.FAVORITE_KEY="favorite",FavoriteStore.FAVORITE_GROUP_MAX=5;var o=FavoriteStore.prototype,i=null;FavoriteStore.getInstance=function(){return null==i&&(i=new FavoriteStore),i},o.init=function(){function e(e){for(var t=0;t<FavoriteStore.FAVORITE_GROUP_MAX;t++){var n={};n.id=t,n.name=Resource.getMessage("group_title_favorite")+parseInt(t+1),n.memberList=[],e.add(n)}}var t=n(this._localStorage);if(null!=t)try{this._favoriteGroupList=JSON.parse(t)}catch(o){e(this._favoriteGroupList)}else e(this._favoriteGroupList)},o.getGroupMember=function(e){return this._favoriteGroupList[e].memberList},o.getGroupIdByName=function(e){for(var t=-1,n=0;n<FavoriteStore.FAVORITE_GROUP_MAX;n++)if(this._favoriteGroupList[n].name==e){t=n;break}return t},o.getGroupName=function(e){return this._favoriteGroupList[e].name},o.getGroupCount=function(){return FavoriteStore.FAVORITE_GROUP_MAX},o.addGroupMember=function(n,o){for(var i=[],a=this._favoriteGroupList[n].memberList,r=o.length,s=0;r>s;s++){var l=o[s],u=-1;u=e(a,l),0>u&&i.add(l)}if(i.length>0){for(s=0;s<i.length;s++)a.push(i[s]);var c=JSON.stringify(this._favoriteGroupList);t(this._localStorage,c)}},o.removeGroupMember=function(n,o){for(var i=this._favoriteGroupList[n].memberList,a=o.length,r=0;a>r;r++){var s=o[r],l=-1;l=e(i,s),l>=0&&i.splice(l,1)}if(a){var u=JSON.stringify(this._favoriteGroupList);t(this._localStorage,u)}}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(){var e=new Date;return e.setMonth(e.getMonth()-3),e.setMonth(3),e.setDate(1),e}function t(e){var t="";if(e.getFullYear()){var n=e.getFullYear(),o=("00"+(e.getMonth()+1)).slice(-2),i=("00"+e.getDate()).slice(-2);t=n+"/"+o+"/"+i}return t}var n=new GeneralConfigButton,o=new Vue({el:"#sidebar-gj-tp",data:{total:{goodjob_count:0,goodjob_all_count:"-",thanks_count:0,thanks_all_count:"-"}},methods:{setGoodJobCount:function(e){this.total.goodjob_count=e},setThanksPointsCount:function(e){this.total.thanks_count=e},setGoodJobAllCount:function(e){this.total.goodjob_all_count=e},setThanksPointsAllCount:function(e){this.total.thanks_all_count=e}}});GeneralConfigButton.getInstance=function(){return n};var i=GeneralConfigButton.prototype;i.updateGoodJobCount=function(){var n=t(e()),i='<div id="sidebar-collapse-goodjob-count">            <div><i class="fa fa-thumbs-o-up"></i></div>            <div><span id="goodjob_count"><span></div>            <div><span id="goodjob_count_total"><span></div>            </div>';$("#sidebar-collapse-goodjob-count").length||($("#sidebar-collapse-thanks-count").length?$("#sidebar-collapse-thanks-count").before(i):$("#loginAvatar .block-avatar").append(i),$(".sidebar-collapse").length||$("#sidebar-collapse-goodjob-count").hide()),CubeeController.getInstance().getGoodJobTotal(LoginUser.getInstance().getJid(),n).then(function(e){var t=e.content.items[0].points;"number"==typeof t&&(o.setGoodJobCount(t),$("#goodjob_count").text(t))})["catch"](function(e){o.setGoodJobCount("-")})},i.updateGoodJobAllCount=function(){CubeeController.getInstance().getGoodJobTotal(LoginUser.getInstance().getJid(),"").then(function(e){var t=e.content.items[0].points;"number"==typeof t&&(o.setGoodJobAllCount(t),$("#goodjob_count_total").text("("+t+")"))})["catch"](function(e){o.setGoodJobAllCount("-")})},i.updateThanksPointsCount=function(){var n=t(e()),i='<div id="sidebar-collapse-thanks-count">            <div><i class="fa fa-heart-o"></i></div>            <div><span id="thanks_count"></span></div>            <div><span id="thanks_count_total"></span></div>            </div>';$("#sidebar-collapse-thanks-count").length||($("#loginAvatar .block-avatar").append(i),$(".sidebar-collapse").length||$("#sidebar-collapse-thanks-count").hide()),CubeeController.getInstance().getThanksPointsTotal(LoginUser.getInstance().getJid(),n).then(function(e){var t=e.content.items[0].points;"number"==typeof t&&(o.setThanksPointsCount(t),$("#thanks_count").text(t))})["catch"](function(e){o.setThanksPointsCount("-")})},i.updateThanksPointsAllCount=function(){CubeeController.getInstance().getThanksPointsTotal(LoginUser.getInstance().getJid(),"").then(function(e){var t=e.content.items[0].points;"number"==typeof t&&(o.setThanksPointsAllCount(t),$("#thanks_count_total").text("("+t+")"))})["catch"](function(e){o.setThanksPointsAllCount("-")})},i.showLoginUserName=function(){var e=LoginUser.getInstance().getUserName();$("#loginUserName").text(e);var t=Utils.getSafeArrayData(LoginUser.getInstance().getGroup());$("#loginUserName").attr("title",e+" "+t)},i.showLoginUserAvatar=function(){var e=$("#loginAvatar").eq(0),t=e.find("span").attr("class"),n=t?t:"ico ico_user",o=CubeeController.getInstance().getPersonData(LoginUser.getInstance().getJid()),i="",a=o.getAvatarType(),r=o.getAvatarData();i=null!=a&&""!=a&&null!=r&&""!=r?ViewUtils.getAvatarDataHtml(LoginUser.getInstance().getJid()):ViewUtils.getAvatarDataHtmlFromPerson(o),e.html(i),e.find("span").removeClass("ico ico_user status online offline leave busy out"),e.find("span").addClass(n)},i.showLoginUserGroup=function(){var e=Utils.getSafeArrayData(LoginUser.getInstance().getGroup());$("#loginUserGroup").text(e.join(","))},i.updateFolloweeFollower=function(){var e=Utils.getSafeNumberData(LoginUser.getInstance().getFolloweeList().getCount());$("#followee-list-count").text(e);var t=Utils.getSafeNumberData(LoginUser.getInstance().getFollowerList().getCount());$("#follower-list-count").text(t)},i.setConfigMenu=function(e){var t=this,n=(GeneralConfigMenu.getHtml(e),new GeneralConfigMenu);t._generalConfigMenu=n},i.updateConfig=function(){var e=this;e.showLoginUserName(),e.showLoginUserAvatar(),e.showLoginUserGroup(),e.updateGoodJobCount(),e.updateGoodJobAllCount(),e.updateThanksPointsCount(),e.updateThanksPointsAllCount(),e.setConfigMenu(),e.updateFolloweeFollower(),View.resizeHeaderContent()},$(function(){$("#btnOption").button({icons:{secondary:"ui-icon-gear"}})})}(),function(){GeneralConfigMenu.ELEMENT_ID_NAME="config_menu",GeneralConfigMenu.ELEMENT_MENU_PROFILE_VAL_NAME="profile",GeneralConfigMenu.ELEMENT_MENU_PASSWORD_VAL_NAME="password",GeneralConfigMenu.ELEMENT_MENU_MAIL_COOPERATION_VAL_NAME="mailcooperation",GeneralConfigMenu.ELEMENT_MENU_LOGOUT_VAL_NAME="logout";var e=GeneralConfigMenu.prototype;GeneralConfigMenu.getHtml=function(e){var t=LoginUser.getInstance().isUpdatablePersonData(),n='<ul id="'+GeneralConfigMenu.ELEMENT_ID_NAME+'" class="'+GeneralConfigMenu.ELEMENT_ID_NAME+' list_none">';return n+='<li value="'+GeneralConfigMenu.ELEMENT_MENU_PROFILE_VAL_NAME+'">'+Resource.getMessage("config_profile")+"</li>",t&&(n+='<li value="'+GeneralConfigMenu.ELEMENT_MENU_PASSWORD_VAL_NAME+'">'+Resource.getMessage("config_password")+"</li>"),null!=e&&e.getCount()>0&&(n+='<li value="'+GeneralConfigMenu.ELEMENT_MENU_MAIL_COOPERATION_VAL_NAME+'">'+Resource.getMessage("config_mail_cooperation")+"</li>"),n+='<li value="'+GeneralConfigMenu.ELEMENT_MENU_LOGOUT_VAL_NAME+'">'+Resource.getMessage("config_logout")+"</li>",n+="</ul>"},e._createEventHandler=function(){var e=LoginUser.getInstance().getJid(),t=$("#left_sidebar").find(".followee-count, .followeelist");t.on("click",function(){var t=new DialogFolloweeListView(e);t.showDialog()});var n=$("#left_sidebar").find(".follower-count, .followerlist");n.on("click",function(){var t=new DialogFollowerListView(e);t.showDialog()});var o=$("#left_sidebar").find('li[value = "'+GeneralConfigMenu.ELEMENT_MENU_PROFILE_VAL_NAME+'"]');o.on("click",function(){var e=$("#left_sidebar").find('li[value = "'+GeneralConfigMenu.ELEMENT_MENU_PROFILE_VAL_NAME+'"]').text(),t=new DialogProfileView(e);t.showDialog()});var i=$("#left_sidebar").find('li[value = "'+GeneralConfigMenu.ELEMENT_MENU_PASSWORD_VAL_NAME+'"]');i.on("click",function(){var e=$("#left_sidebar").find('li[value = "'+GeneralConfigMenu.ELEMENT_MENU_PASSWORD_VAL_NAME+'"]').text(),t=new DialogPasswordView(e);t.showDialog()});var a=$("#left_sidebar").find('li[value = "'+GeneralConfigMenu.ELEMENT_MENU_LOGOUT_VAL_NAME+'"]');a.on("click",function(){$(".user_menu_btn").trigger("click"),View.getInstance().logout(),setTimeout("window.location.reload(true)",500),LoginTicket.remove()});var r=$("#left_sidebar").find(".murmur-open-send-dialog");r.on("click",function(){var e=new DialogSendMurmurMessageView;e.showDialog()})}}(),function(){GeneralConfigDialog.prototype=$.extend({},DialogView.prototype);DialogView.prototype,GeneralConfigDialog.prototype;$(function(){$("#mainSettingModal").dialog({autoOpen:!1,width:320,height:240,resizable:!1})})}(),function(){ColumnReplyTextAreaView.prototype=$.extend({},ViewCore.prototype);var e=ColumnReplyTextAreaView.prototype;e._createEventHandler=function(){var e=this,t=e.getHtmlElement();t.on("keydown",function(t){if(t.which&&13==t.which||t.keyCode&&13==t.keyCode){if(e._ctrlFlg){var n=e.getHtmlElement().val();if(ViewUtils.isValidInputTextLength(n)){var o=$(this.parentNode).children("button");$(o).mousedown(),$(o).mouseup(),e._ctrlFlg=!1}}}else t.which&&17==t.which||t.keyCode&&17==t.keyCode?e._ctrlFlg=!0:e._ctrlFlg=!1}),t.on("keyup",function(t){(t.which&&17==t.which||t.keyCode&&17==t.keyCode)&&(e._ctrlFlg=!1)})}}(),function(){ColumnLinkView.prototype=$.extend({},ViewCore.prototype);var e=ColumnLinkView.prototype;e._createEventHandler=function(){var e=this,t=e.getHtmlElement();t.on("keydown",function(t){if(t.which&&13==t.which||t.keyCode&&13==t.keyCode){if(e._ctrlFlg)return e._ctrlFlg=!1,!1}else t.which&&17==t.which||t.keyCode&&17==t.keyCode?e._ctrlFlg=!0:e._ctrlFlg=!1}),t.on("keyup",function(t){(t.which&&17==t.which||t.keyCode&&17==t.keyCode)&&(e._ctrlFlg=!1)})}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t){var n=a(i());CubeeController.getInstance().getGoodJobTotal(e,n).then(function(e){var n=e.content.items[0].points;"number"==typeof n&&t.setGoodJobCount(n)})["catch"](function(e){t.setGoodJobCount("-")})}function t(e,t){CubeeController.getInstance().getGoodJobTotal(e,"").then(function(e){var n=e.content.items[0].points;"number"==typeof n&&t.setGoodJobAllCount(n)})["catch"](function(e){t.setGoodJobAllCount("-")})}function n(e,t){var n=a(i());CubeeController.getInstance().getThanksPointsTotal(e,n).then(function(e){var n=e.content.items[0].points;e.content.items[0].rank;"number"==typeof n&&t.setThanksPointsCount(n)})["catch"](function(e){t.setThanksPointsCount("-")})}function o(e,t){CubeeController.getInstance().getThanksPointsTotal(e,"").then(function(e){var n=e.content.items[0].points;"number"==typeof n&&t.setThanksPointsAllCount(n)})["catch"](function(e){t.setThanksPointsAllCount("-")})}function i(){var e=new Date;return e.setMonth(e.getMonth()-3),e.setMonth(3),e.setDate(1),e}function a(e){var t="";if(e.getFullYear()){var n=e.getFullYear(),o=("00"+(e.getMonth()+1)).slice(-2),i=("00"+e.getDate()).slice(-2);t=n+"/"+o+"/"+i}return t}function r(e){if(0==_({goodJobList:e}))return"";for(var t=e.getCount(),n=t-1,o=Conf.getVal("GOODJOB_USER_TOOLTIP_DISPLAY_COUNT"),i=n-o,a='<div class="goodJob_list">',r=n;r>i;r--)a+=s(e.get(r));return a+=c(t,o),a+="</div>"}function s(e){if(0==_({goodJobData:e}))return"";var t=e.getJid(),n=new Person;n.setJid(t),n.setLoginAccount(e.getLoginAccount()),n.setUserName(e.getNickName()),n.setAvatarType(e.getAvatarType()),n.setAvatarData(e.getAvatarData()),n.setStatus(e.getStatus());var o=u(n);return o}function l(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return"";for(var t=e.getExistingReaderItemList(),n=t.getCount(),o='<div class="existing_user_list">',i=0;n>i;i++){var a=t.get(i),r=a.getPerson();o+=u(r)}var s=e.getAllCount();return o+=c(s,n),o+="</div>"}function u(e){if(0==_({person:e}))return"";var t="images/user_noimage.png",n=e,o=n.getJid(),i=n.getUserName();(null==i||""==i)&&(i=ViewUtils.getUserName(o));var a=ViewUtils.getAvatarUrl(n),r=Person.PROFILE_STATUS_ACTIVE;null!=n&&(r=n.getStatus());var s='<div class="user-tooltip-item text-abbreviation" jid="'+o+'">';return a==t?(s+='<span class="tooltip_avatar ico ico_user">',s+=ViewUtils.getDefaultAvatarHtml(e),s+="</span>"):s+='<img class="tooltip_avatar" src="'+a+'">',s+="<h>"+Utils.convertEscapedHtml(i)+ViewUtils.getUserStatusString(r)+"</h>",s+="</div>"}function c(e,t){if(null==e||"number"!=typeof e)return"";if(null==t||"number"!=typeof t)return"";var n=e-t;return 0>=e-t?"":'<div class="text-align-right">'+Resource.getMessage("existing_reader_other")+n+Resource.getMessage("existing_reader_count")+"</div>"}function d(e){if(0==_({siblingList:e}))return"";for(var t=e.getCount(),n='<div id="sibling_list" class="sibling_list box-border olient-vertical">',o=0;t>o;o++)n+=g(e.get(o));return n+="</div>"}function g(e){if(0==_({siblingTaskData:e}))return"";var t="images/user_noimage.png",n=e.getSiblingOwnerJid(),o=e.getNickName();(null==o||""==o)&&(o=ViewUtils.getUserName(n));var i=new Person;i.setJid(n),i.setAvatarType(e.getAvatarType()),i.setAvatarData(e.getAvatarData()),i.setUserName(e.getNickName()),i.setLoginAccount(e.getLoginAccount()),i.setStatus(e.getStatus());var a=ViewUtils.getAvatarUrl(i),r=Person.PROFILE_STATUS_ACTIVE;null!=i&&(r=i.getStatus());var s=e.getSiblingTaskStatus(),l="";switch(s){case TaskMessage.STATUS_ASSIGNING:l="task-status-icon-color-assigning";break;case TaskMessage.STATUS_NEW:l="task-status-icon-color-new";break;case TaskMessage.STATUS_DOING:l="task-status-icon-color-doing";break;case TaskMessage.STATUS_FINISHED:l="task-status-icon-color-finished";break;case TaskMessage.STATUS_REJECTED:l="task-status-icon-color-rejected"}var u='<div class="tooltip-sibling-list-item box-border olient-horizontal" jid="'+n+'">',c=m(s,l);return ViewUtils.isIE89()&&(u+=c),u+='<div class="tooltip-sibling-owner box-border-for-abbreviation flex1">',a==t?(u+='<span class="tooltip_avatar ico ico_user">',u+=ViewUtils.getDefaultAvatarHtml(i),u+="</span>"):u+='<img class="tooltip_avatar" src="'+a+'">',u+=Utils.convertEscapedHtml(o)+ViewUtils.getUserStatusString(r)+"</div>",ViewUtils.isIE89()||(u+=c),u+="</div>"}function m(e,t){var n="";return""!=t&&(n+=e==TaskMessage.STATUS_REJECTED?'  <div class="tooltip-sibling-task-status box-border '+t+'">'+Resource.getMessage("task_statuc_reject")+"</div>":'  <div class="tooltip-sibling-task-status box-border '+t+'">'+Resource.getMessage("task_statuc_other")+"</div>"),n}function _(e){for(var t in e)if("type"==t){if(null==e[t]||"number"!=typeof e[t])return!1}else if("owner"==t||"message"==t||"goodJobList"==t||"goodJobData"==t||"siblingList"==t||"siblingTaskData"==t||"htmlElement"==t||"toolTipIconElm"==t){if(null==e[t]||"object"!=_typeof(e[t]))return!1}else if("isToolTipOwner"==t||"isReadMore"==t){if(null==e[t]||"boolean"!=typeof e[t])return!1}else if("jid"==t){if(null==e[t]||""==e[t])return!1}else if("contentHtmlString"==t){if(null==e[t]||"string"!=typeof e[t])return!1}else if("content"==t){if(null==e[t]||"object"!=_typeof(e[t]))return!1}else if("person"==t&&(null==e[t]||"object"!=_typeof(e[t])))return!1;return!0}TooltipView.prototype=$.extend({},ViewCore.prototype);var f=(ViewCore.prototype,TooltipView.prototype),p=new TooltipView;TooltipView.getInstance=function(){return p},TooltipView.TYPE_UNKNOWN=0,TooltipView.TYPE_PUBLIC=1,TooltipView.TYPE_PUBLIC_REPLY=2,TooltipView.TYPE_TASK=3,TooltipView.TYPE_CHAT=4,TooltipView.TYPE_SYSTEM_MESSAGE_ASSIGNED_TASK=5,TooltipView.TYPE_ASSIGNED_TASK=6,TooltipView.TYPE_USER_AVATAR=7,TooltipView.TYPE_INBOX=8,TooltipView.TYPE_PARENT_TASK=9,TooltipView.TYPE_PARENT_TASK_CANCEL=10,TooltipView.TYPE_CHILD_TASK=11,TooltipView.TYPE_PUBLIC_REPLY_CAN_DELETE=12,TooltipView.TYPE_CHAT_CAN_DELETE=13,TooltipView.TYPE_INNER_MESSAGE_CHILD_TASK_ACTION=14,TooltipView.TYPE_INNER_MESSAGE_CHILD_ASSIGNED_TASK_ACTION=15,TooltipView.TYPE_INNER_MESSAGE_CHILD_ASSIGNED_MY_TASK_ACTION=16,TooltipView.TYPE_QUESTIONNAIRE=17;var h=0,C=0,v=1e5,y="80%",T="80%",b="80%";TooltipView.displayedActionToolTipTargetElem=null,f.setActionToolTip=function(e,t,n,o){if(0==_({type:e,owner:t}))return!1;0!=o&&(o=!0);var i=null;switch(e){case TooltipView.TYPE_PUBLIC:i="#tooltipTimelineMessageActionBar";break;case TooltipView.TYPE_PUBLIC_REPLY:i="#tooltipReplyMessageActionBar";break;case TooltipView.TYPE_PUBLIC_REPLY_CAN_DELETE:i="#tooltipReplyMessageActionCanDeleteBar";break;case TooltipView.TYPE_TASK:i="#tooltipTaskMessageAction";break;case TooltipView.TYPE_CHILD_TASK:i="#tooltipChildTaskMessageAction";break;case TooltipView.TYPE_CHAT:i="#tooltipChatMessageActionBar";break;case TooltipView.TYPE_CHAT_CAN_DELETE:i="#tooltipChatMessageActionCanDeleteBar";break;case TooltipView.TYPE_SYSTEM_MESSAGE_ASSIGNED_TASK:i="#tooltipSystemMessageTaskAction";break;case TooltipView.TYPE_ASSIGNED_TASK:i="#tooltipTaskMessageAssignedTaskAction";break;case TooltipView.TYPE_INBOX:i="#tooltipInboxMessageAction";break;case TooltipView.TYPE_PARENT_TASK:i="#tooltipParentTaskMessageAction";break;case TooltipView.TYPE_PARENT_TASK_CANCEL:i="#tooltipParentTaskMessageCancelAction";break;case TooltipView.TYPE_INNER_MESSAGE_CHILD_TASK_ACTION:i="#tooltipInnerMesasgeChildTaskAction";break;case TooltipView.TYPE_INNER_MESSAGE_CHILD_ASSIGNED_TASK_ACTION:i="#tooltipInnerMesasgeChildAssignedTaskAction";break;case TooltipView.TYPE_INNER_MESSAGE_CHILD_ASSIGNED_MY_TASK_ACTION:i="#tooltipInnerMesasgeChildAssignedMyTaskAction";break;case TooltipView.TYPE_QUESTIONNAIRE:i="#tooltipQuestionnaireMessageAction"}return i?(0!=n.find(".popup_menu.msg_menu").length?n.find(".popup_menu.msg_menu").append($(i).html()):n.append($(i).html()),t.append(n),!0):!1},f.setActionToolTipEvent=function(e,t){var n=t.find(".action-Reject-task_child");1==n.length&&n.on("click",function(){function t(e){console.log("update task : "+e)}$(this).parent().hide();var n=e.childTask,o=new TaskMessage;o.copy(n),o.setStatus(TaskMessage.STATUS_REJECTED),0==CubeeController.getInstance().updateTask(o,t)&&console.log("faild to update task")});var o=t.find(".action-accept-new-task_child");1==o.length&&o.on("click",function(){function t(e){console.log("update task : "+e)}$(this).parent().hide();var n=e.childTask,o=new TaskMessage;o.copy(n),o.setStatus(TaskMessage.STATUS_NEW),0==CubeeController.getInstance().updateTask(o,t)&&console.log("faild to update task")});var i=t.find(".action-doing-task_child");1==i.length&&i.on("click",function(){function t(e){console.log("update task : "+e)}$(this).parent().hide();var n=e.childTask,o=new TaskMessage;o.copy(n),o.setStatus(TaskMessage.STATUS_DOING),0==CubeeController.getInstance().updateTask(o,t)&&console.log("faild to update task")});var a=t.find(".action-finish-task_child");1==a.length&&a.on("click",function(){function t(e){console.log("update task : "+e)}$(this).parent().hide();var n=e.childTask,o=new TaskMessage;o.copy(n),o.setStatus(TaskMessage.STATUS_FINISHED),0==CubeeController.getInstance().updateTask(o,t)&&console.log("faild to update task")})},f._setMessageInnerActionToolTip=function(e,t,n,o){if(0==_({type:e,owner:t}))return!1;var i=this,a=i._getActionToolTipSetting(t);switch(i._setExclusionControlActionToolTip(t,n,a),e){case TooltipView.TYPE_INNER_MESSAGE_CHILD_TASK_ACTION:a.content=$("#tooltipInnerMesasgeChildTaskAction").html(),a.spacing=[-110,-30];break;case TooltipView.TYPE_INNER_MESSAGE_CHILD_ASSIGNED_TASK_ACTION:a.content=$("#tooltipInnerMesasgeChildAssignedTaskAction").html(),a.spacing=[-55,-30];break;case TooltipView.TYPE_INNER_MESSAGE_CHILD_ASSIGNED_MY_TASK_ACTION:
a.content=$("#tooltipInnerMesasgeChildAssignedMyTaskAction").html(),a.spacing=[-82,-30];break;default:a=null}if(null==a)return!1;ViewUtils.isIE8()&&(a.updateOn="dummy");var r=t.children(".mTip:last"),s=r.find(".action-doing-inner-task");1==s.length&&s.on("click",function(){function e(e){console.log("update task : "+e)}$(this).parent().hide();var t=o.childTask,n=new TaskMessage;n.copy(t),n.setStatus(TaskMessage.STATUS_DOING),0==CubeeController.getInstance().updateTask(n,e)&&console.log("faild to update task")});var l=r.find(".action-finish-inner-task");1==l.length&&l.on("click",function(){function e(e){console.log("update task : "+e)}$(this).parent().hide();var t=o.childTask,n=new TaskMessage;n.copy(t),n.setStatus(TaskMessage.STATUS_FINISHED),0==CubeeController.getInstance().updateTask(n,e)&&console.log("faild to update task")});var u=r.find(".action-reject-inner-task");1==u.length&&u.on("click",function(){function e(e){console.log("update task : "+e)}$(this).parent().hide();var t=o.childTask,n=new TaskMessage;n.copy(t),n.setStatus(TaskMessage.STATUS_REJECTED),0==CubeeController.getInstance().updateTask(n,e)&&console.log("faild to update task")});var c=r.find(".action-accept-new-inner-task");return 1==c.length&&c.on("click",function(){function e(e){console.log("update task : "+e)}$(this).parent().hide();var t=o.childTask,n=new TaskMessage;n.copy(t),n.setStatus(TaskMessage.STATUS_NEW),0==CubeeController.getInstance().updateTask(n,e)&&console.log("faild to update task")}),!0},f._getActionToolTipSetting=function(e){return{showOn:"showOn",hideOn:"hideOn",align:"top right",holder:e,delay:[h,C]}},f._setExclusionControlActionToolTip=function(e,t,n){$(t).on("click",function(t){var o=$(this);"block"==$(e).children(".mTip:last").eq(0).css("display")?(o.trigger(n.hideOn),TooltipView.displayedActionToolTipTargetElem=null):(TooltipView.displayedActionToolTipTargetElem&&TooltipView.displayedActionToolTipTargetElem.trigger(n.hideOn),o.trigger(n.showOn),TooltipView.displayedActionToolTipTargetElem=o)})},f.setAvatarToolTip=function(e,t,n,o){var i=t.attr("jid");if(0==_({type:e,owner:t,isToolTipOwner:n,jid:i}))return!1;if(t.find(".black.mTip").length>0)return!0;var a='<div class="black mTip mTip-bottom-right"></div>';return t.hasClass("block-avatar")?t.append(a):t.parent().children(".block-avatar").append(a),t.on("mouseenter",function(e){0==$(this).find(".change").length&&TooltipView.getInstance().updateAvatarToolTip(t)}),t.on("mouseenter",function(){var e=$(this).offset().top,n=$(window).outerHeight(),o=$(this).outerHeight();return $(this).parent().hasClass("emotionAvatarList")?void $(this).children(".mTip").css({top:"auto",bottom:o+"px"}).addClass("hover"):(e>n/1.5?$(this).children(".mTip").css({top:"auto",bottom:o+"px"}).addClass("hover"):$(this).children(".mTip").css({top:o+"px",bottom:"auto"}).addClass("hover"),void(0==$(this).find(".change").length&&TooltipView.getInstance().updateAvatarToolTip(t)))}),t.on("mouseleave",function(){$(this).children(".mTip").removeClass("hover"),1==$(this).find(".change").length&&$(this).find(".change").removeClass("change")}),!0},f.updateAvatarToolTip=function(i,a){var r=i.attr("jid");if(0==_({jid:r}))return!1;var s=function(s){function l(e){if(r==m){var t=LoginUser.getInstance().getFolloweeList().getCount();$(".followee-count").html(t)}else CubeeController.getInstance().getFolloweeList(r).then(function(e){var t=e.getCount();$(".followee-count").html(t)})}function u(e){if(r==m){var t=LoginUser.getInstance().getFollowerList().getCount();$(".follower-count").html(t)}else CubeeController.getInstance().getFollowerList(r).then(function(e){var t=e.getCount();$(".follower-count").html(t)})}function c(e,t){"follow"==t&&e.on("click",function(){CubeeController.getInstance().addUserFollow(r).then(function(){e.off("click"),e.addClass("unfollow-btn change"),e.removeClass("follow-btn"),e.text(Resource.getMessage("del_followee_text")),c(e,"unfollow");var t=i.find(".follower-count")[0].textContent,n=Number(t)+1;i.find(".follower-count").text(n)})["catch"](function(e){})}),"unfollow"==t&&e.on("click",function(){CubeeController.getInstance().delUserFollow(r).then(function(){e.off("click"),e.addClass("follow-btn change"),e.removeClass("unfollow-btn"),e.text(Resource.getMessage("add_followee_text")),c(e,"follow");var t=i.find(".follower-count")[0].textContent,n=Number(t)-1;i.find(".follower-count").text(n)})["catch"](function(e){})})}if(!s||!s.get(0))return void i.find("div.black.mTip").hide();var d=s.get(0),g=Utils.getRandomNumber(0,Math.pow(2,31)-1);i.find("div.black.mTip").show(),i.find("div.black.mTip").empty(),i.find("div.black.mTip").append(ViewUtils.createAvatarToolTipHtml(d,g));var m=LoginUser.getInstance().getJid();i.find("div.black.mTip .followee-count"),l(i.find(".followee-count")),i.find("div.black.mTip .follower-count"),u(i.find(".follower-count")),i.find("div.black.mTip .followeeList");var _=i.find(".followeelist");_.on("click",function(){CubeeController.getInstance().getFolloweeList(r).then(function(){var e=new DialogFolloweeListView(r);e.showDialog()})["catch"](function(e){})}),i.find("div.black.mTip .followerList");var f=i.find(".followerlist");f.on("click",function(){CubeeController.getInstance().getFollowerList(r).then(function(){var e=new DialogFollowerListView(r);e.showDialog()})["catch"](function(e){})});var p="follow";p=i.find("button").hasClass("follow-btn")?"follow":"unfollow",c(i.find(".follow-btn, .unfollow-btn"),p),i.find("div.black.mTip .murmur-btn");var h=i.find(".murmur-btn");h.on("click",function(){ColumnManager.getInstance().addMurmurColumn(r,!0,!1,!1)}),a&&"function"==typeof a&&a();var C=null;C=new Vue({el:"#sidebar-gj-tp-"+g,data:{total:{goodjob_count:0,goodjob_all_count:"-",thanks_count:0,thanks_all_count:"-"}},methods:{setGoodJobCount:function(e){this.total.goodjob_count=e},setThanksPointsCount:function(e){this.total.thanks_count=e},setGoodJobAllCount:function(e){this.total.goodjob_all_count=e},setThanksPointsAllCount:function(e){this.total.thanks_all_count=e}}}),e(r,C),t(r,C),n(r,C),o(r,C),i.find('[data-toggle="tooltip"]').tooltip({trigger:"hover"})};CubeeController.getInstance().getPersonDataByJidFromServer(r,s)},f.setUserNameNickNameToolTip=function(e,t,n){if(0==_({owner:e,contentHtmlString:t,isToolTipOwner:n}))return!1;var o="top",i=Utils.convertEscapedHtml(t,!0),a={showOn:"longtap",hideOn:"touchend touchmove touchcancel",content:i,align:o,spacing:[0,0],delay:[h,C],css:{"z-index":v,"max-width":y},className:"black break-word"};return ViewUtils.isIE8()&&(a.updateOn="dummy"),n&&(a.holder=e),null==a?!1:(null==e.data("mTip")?e.mTip(a):e.data("mTip").tip&&e.data("mTip").tip.html(i),!0)},f.setMyMemoToolTip=function(e,t,n,o){if(0==_({owner:e,jid:t,isToolTipOwner:n}))return!1;var i=o?o:"",a=CubeeController.getInstance().getPersonData(t);null!=a&&(i=a.getMyMemo());var r=Utils.convertEscapedHtml(i,!0),s="top",l={showOn:"longtap",hideOn:"touchend touchmove touchcancel",content:r,align:s,spacing:[0,0],delay:[h,C],css:{"z-index":v,"max-width":y},className:"black break-word"};return ViewUtils.isIE8()&&(l.updateOn="dummy"),n&&(l.holder=e),null==l?!1:(null==e.data("mTip")?e.mTip(l):e.data("mTip").tip&&e.data("mTip").tip.html(r),!0)},f.setColumnIconToolTip=function(e,t,n){if(0==_({owner:e,contentHtmlString:t,isToolTipOwner:n}))return!1;var o="bottom right",i={showOn:"longtap",hideOn:"touchend touchmove touchcancel",content:t,align:o,spacing:[40,0],delay:[h,C],css:{"z-index":1e5}};return ViewUtils.isIE8()&&(i.updateOn="dummy"),n&&(i.holder=e),null==i?!1:(null==e.data("mTip")?e.mTip(i):e.data("mTip").tip&&e.data("mTip").tip.html(t),!0)},f.removeNotificationTooltipMessage=function(e,t){},f.updateActionToolTip=function(e,t){if(0==_({type:t,owner:e}))return!1;var n="";switch(t){case TooltipView.TYPE_PARENT_TASK:n=$("#tooltipParentTaskMessageAction").html();break;case TooltipView.TYPE_PARENT_TASK_CANCEL:n=$("#tooltipParentTaskMessageCancelAction").html()}return 0==e.find(".popup_menu.msg_menu").length||""==n?!1:(e.find(".popup_menu.msg_menu ul.popup_list").find("a").off(),e.find(".popup_menu.msg_menu ul.popup_list").remove(),e.find(".popup_menu.msg_menu").append(n),!0)},f.createGoodJobTooltip=function(e,t,n){if(0==_({owner:e}))return!1;var o="";if(t.getCount()<=0)return!1;var o='<div class="black mTip mTip-top-right">';o+=r(t),o+="</div>";var i=e.find(".good-job-counter");return i.children(".mTip").remove(),i.append(o),!0},f.createSiblingTaskTooltip=function(e,t){if(0==_({owner:e,siblingList:t}))return!1;if(t.getCount()<=0)return!1;var n='<div class="black mTip mTip-top-right">';return n+=d(t),n+="</div>",e.children(".mTip").remove(),e.append(n),!0},f.createConfigMenuTooltip=function(e,t){if(0==_({owner:e,contentHtmlString:t}))return null;var n={showOn:"click touchend",holder:e.parent(),spacing:[-60,0],content:t,delay:[h,C]};return ViewUtils.isIE8()&&(n.updateOn="dummy"),e.mTip(n),e.mTip("get")},f.createColumnOptionMenuTooltip=function(e,t){return 0==_({owner:e,contentHtmlString:t})?null:e.append(t)},f.createColumnTitleTooltip=function(e,t,n){if(0==_({owner:e,contentHtmlString:t,isToolTipOwner:n}))return!1;var o={showOn:"touchend",holder:e,align:"bottom center",spacing:[0,0],content:t,delay:[h,C],css:{"max-width":T}};return ViewUtils.isIE8()&&(o.updateOn="dummy"),n&&(o.holder=e),e.mTip(o),!0},f.createMailMessageSubjectToolTip=function(e,t,n){if(0==_({owner:e,contentHtmlString:t,isToolTipOwner:n}))return!1;var o={showOn:"touchend",holder:e,align:"bottom center",spacing:[0,0],content:t,delay:[h,C],css:{"max-width":b}};return ViewUtils.isIE8()&&(o.updateOn="dummy"),n&&(o.holder=e),null==e.data("mTip")?e.mTip(o):e.data("mTip").tip&&e.data("mTip").tip.html(t),!0},f.setGroupChatNameToolTip=function(e,t,n){return null},f.setCommunityNameToolTip=function(e,t,n){return null},f.setRoomNameToolTip=function(e,t,n){if(0==_({owner:e,contentHtmlString:t,isToolTipOwner:n}))return!1;var o="top",i=Utils.convertEscapedHtml(t,!0),a={showOn:"longtap",hideOn:"touchend touchmove touchcancel",content:i,align:o,spacing:[0,0],delay:[h,C],css:{"z-index":v,"max-width":y},className:"black break-word"};return ViewUtils.isIE8()&&(a.updateOn="dummy"),n&&(a.holder=e),null==a?!1:(null==e.data("mTip")?e.mTip(a):e.data("mTip").tip&&e.data("mTip").tip.html(i),!0)},f.setCommunitySettingToolTip=function(e,t,n){if(0==_({owner:e,content:t,isToolTipOwner:n}))return null;var o="bottom,right",i={showOn:"click touchend",content:t,align:o,spacing:[-44,-5],delay:[h,C],css:{"z-index":v,"max-width":y},className:"black break-word"};return ViewUtils.isIE8()&&(i.updateOn="dummy"),n&&(i.holder=e),e.mTip(i),e.mTip("get")},f.createMessageExistingReaderTooltip=function(e,t,n){if(0==_({owner:e}))return!1;0!=n&&(n=!0);var o="";return null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t))?!1:(o+='<div class="black mTip mTip-top-right">',o+=l(t),o+="</div>",e.children(".mTip").off().remove(),e.children("span").append(o),e.find(".mTip").on("click",function(e){e.stopPropagation()}),!0)},$(function(){function e(e){var n=t(e);return null==n?null:n.getMessage()}function t(e){var t=n(e);if(null==t)return null;var i=o(e);return null==i?null:""==i?null:t.getMsgObjByItemId(i)}function n(e){if(0==_({toolTipIconElm:e}))return null;var t=a(e),n=t.parent(),o=n.children(".card.col_card.chat_card").index(t);if(-1==o&&$(e).closest("#side-bar-recent").length)return SideMenuRecentView.getInstance();if(-1==o&&$(e).closest("#side-bar-murmur").length)return SideMenuMurmurView.getInstance();var i=ColumnManager.getInstance().getColumnObjList();return i.get(o)}function o(e){var t=C(e).parent();return void 0!=t.attr("itemid")?t.attr("itemid"):t.parent().hasClass("thread-message")&&(t=t.parent(),void 0!=t.attr("itemid"))?t.attr("itemid"):t.parent().parent().hasClass("search-message")&&(t=t.parent().parent(),void 0!=t.attr("itemid"))?t.attr("itemid"):t.parent().hasClass("task-message")&&(t=t.parent(),void 0!=t.attr("itemid"))?t.attr("itemid"):t.hasClass("search-message-info")&&(t=t.find(".questionnaire-message-header > .message-info"),void 0!=t.attr("itemid"))?t.attr("itemid"):null}function i(e){var t=ColumnInformation.TYPE_COLUMN_UNKNOWN,o=n(e);return null==o?t:t=o.getType()}function a(e){if(0==_({toolTipIconElm:e}))return null;var t=$(e).parentsUntil(".card.col_card.chat_card");return t.parent()}function r(e){var t=e.getType(),n="";switch(t){case Message.TYPE_PUBLIC:n=ColumnView.DISPLAY_NAME_TIMELINE;break;case Message.TYPE_CHAT:var o=e.getFrom();o==LoginUser.getInstance().getJid()&&(o=e.getTo());var i="",a=e.getProfileMap();if(a&&"object"==("undefined"==typeof a?"undefined":_typeof(a))){var r=a.getByKey(o);r&&"object"==("undefined"==typeof r?"undefined":_typeof(r))&&(i=r.getNickName())}n=i;break;case Message.TYPE_GROUP_CHAT:var s=e.getRoomName();n=s;break;case Message.TYPE_COMMUNITY:var s=e.getRoomName();n=s;break;case Message.TYPE_MURMUR:if(LoginUser.getInstance().getJid()==e.getTo()){n=Resource.getMessage("Murmur");break}var o=e.getTo(),i="",a=e.getProfileMap();if(a&&"object"==("undefined"==typeof a?"undefined":_typeof(a))){var r=a.getByKey(o);r&&"object"==("undefined"==typeof r?"undefined":_typeof(r))&&(i=r.getNickName())}var l=e.getColumnName();l||(l=Resource.getMessage("Murmur")),n=l}return n}function s(e,t){var n=new ChatMessage,o=LoginUser.getInstance().getJid();n.setFrom(o),n.setReplyItemId(t.getItemId());var i=t.getTo();return o==i&&(i=t.getFrom()),n.setTo(i),n.setMessage(e),n.setDirection(ChatMessage.DIRECTION_SEND),CubeeController.getInstance().sendChatMessage(n)}function l(e,t){var n=new GroupChatMessage;return n.setFrom(LoginUser.getInstance().getJid()),n.setReplyItemId(t.getItemId()),n.setTo(t.getTo()),n.setMessage(e),n.setDirection(ChatMessage.DIRECTION_SEND),CubeeController.getInstance().sendGroupChatMessage(n)}function u(e,t){var n=new CommunityMessage;return n.setFrom(LoginUser.getInstance().getJid()),n.setReplyItemId(t.getItemId()),n.setTo(t.getTo()),n.setMessage(e),n.setDirection(ChatMessage.DIRECTION_SEND),CubeeController.getInstance().sendCommunityMessage(n,function(){})}function c(e,t){var n=new MurmurMessage;return n.setFrom(LoginUser.getInstance().getJid()),n.setReplyItemId(t.getItemId()),n.setTo(t.getTo()),n.setMessage(e),n.setDirection(ChatMessage.DIRECTION_SEND),CubeeController.getInstance().sendMurmurMessage(n,function(){})}function d(e,t,n){var o="",i=[];return i=g(e,t,n),o=m(i)}function g(e,t,n){var o="",i=LoginUser.getInstance().getLoginAccount(),a=e.getProfileMap();if(a&&"object"==("undefined"==typeof a?"undefined":_typeof(a))){var r=a.getByKey(t);r&&"object"==("undefined"==typeof r?"undefined":_typeof(r))&&(o=r.getLoginAccount())}var s=(new RegExp("@([0-9A-Za-z]|-|[''_.*!#$%&*+\\/=?^`{|}])+","g"),e.getMessage()),l=[],u=/(@[\w-+%$#!~\*\.']+?)(\s|$)/g,c=/(^|\s)$/;s.replace(u,function(e,t,n,o,i){if(i.indexOf(t)>=0&&t.length<=31){var a=i.substr(0,i.indexOf(t));if(a.match(c))return l.push(t),t}return""});var d=[];if(""!=o&&o!=i&&d.push(o),null!=l)for(var g=0;g<l.length;g++){var m=l[g].replace(/(^[\s]+)|([\s]+$)/g,"");m=m.replace("@",""),""!=m&&o!=m&&i!=m&&(d=f(d,m))}return d}function m(e){var t="";if(null!=e)for(var n=0;n<e.length;n++)t=t+"@"+e[n]+" ";return t}function f(e,t){return p(e,t)||e.push(t),e}function p(e,t){for(var n=0;n<e.length;n++)if(t==e[n])return!0;return!1}function h(t){var n=e(t),o="autocomplete",i="",a=n.getType();switch(a){case Message.TYPE_GROUP_CHAT:o="autocomplete-for-chatroom",i='groupId="'+n.getTo()+'"';break;case Message.TYPE_COMMUNITY:o="autocomplete-for-community",i='groupId="'+n.getTo()+'"'}return{autoCompleteType:o,roomIdAttribute:i}}function C(e){var t=$(e).parentsUntil(".message-header").parent();return t.hasClass("message-header")||(t=$(e).parentsUntil(".message-info").parent()),t.hasClass("message-header")||t.hasClass("message-info")||(t=$(e).parentsUntil(".message-footer")),t}function v(e){$(e).parent().hasClass("mTip")&&$(e).parent().hide()}$(document).on("click","li a.action-add-inbox-task",function(){var t=e(this);if(null!=t){2==t.getDeleteFlag()&&("deleted_by_admin"===t.getMessage()?t.setMessage(Resource.getMessage("deleted_message_body_by_admin")):t.setMessage(Resource.getMessage("deleted_message_body")));var n=new TaskMessage;n.setMessage(t.getMessage()),n.setReferenceMessageItemId(t.getItemId()),n.setReplyTo(t.getFrom());var o=LoginUser.getInstance().getJid();n.setOwnerJid(o),n.setStatus(TaskMessage.STATUS_INBOX),n.setQuotationItem(t.getQuotationItem()),t.getType()==Message.TYPE_MAIL?n.setClient(o):n.setClient(t.getFrom()),t.getType()==Message.TYPE_COMMUNITY&&n.setCommunityId(t.getTo());var i=CubeeController.getInstance().addTask(n,function(e){console.log("add to INBOX : "+e)});1!=i&&console.log("faild to add to INBOX")}}),$(document).on("click","li a.action-add-new-task",function(){var e=t(this);if(null!=e){var e=t(this);null!=e&&(2==e.getMessage().getDeleteFlag()&&("deleted_by_admin"===e.getMessage().getMessage()?e.getMessage().setMessage(Resource.getMessage("deleted_message_body_by_admin")):e.getMessage().setMessage(Resource.getMessage("deleted_message_body"))),e.onClickTaskAdd())}}),$(document).on("click","a.action-accept-new-task",function(){var t=e(this);if(null!=t){var n=new TaskMessage;n.copy(t),n.setStatus(TaskMessage.STATUS_NEW);var o=CubeeController.getInstance().updateTask(n,function(e){console.log("task was accepted : "+e)});1!=o&&console.log("task was not accepted")}}),$(document).on("click","a.action-Reject-task",function(){var t=e(this);if(null!=t){var n=new TaskMessage;n.copy(t),n.setStatus(TaskMessage.STATUS_REJECTED);var o=CubeeController.getInstance().updateTask(n,function(e){console.log("task was rejected : "+e)});1!=o&&console.log("task was not rejected")}}),$(document).on("click","li a.action-delete-message",function(){var t=e(this);if(null!=t){var n=t,o=new DialogDeleteCheckView(n);o.showDialog()}}),$(document).on("click","li a.action-update-thread-title",function(){var t=e(this);if(null!=t){var n=new DialogThreadTitleUpdateView(t);n.showDialog()}}),$(document).on("click","li a.action-update-message",function(){var t=e(this),o=n(this);if(null!=t&&null!=o){var i=new DialogUpdateMessageView(t,o);i.showDialog()}}),$(document).on("click","li a.action-quote-message",function(){var t=e(this),o=n(this);if(null!=t&&null!=o)if(t.getType()==Message.TYPE_GROUP_CHAT&&o.getType()!=ColumnInformation.TYPE_COLUMN_GROUP_CHAT){var i=function(e){var n=new DialogQuoteMessageView(t,o,e.getPrivacyType());n.showDialog()};CubeeController.getInstance().getRoomInfo(t.getTo(),i)}else if(t.getType()==Message.TYPE_COMMUNITY&&o.getType()!=ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED){var a=function(e){var n=new DialogQuoteMessageView(t,o,e.getPrivacyType());n.showDialog()};CubeeController.getInstance().getCommunityInfo(t.getTo(),a)}else{var r=new DialogQuoteMessageView(t,o);r.showDialog()}}),$(document).on("click","li a.action-move-message-room",function(t){var o=e(this),i=n(this);if(null!=o&&null!=i){SideMenuRecentView.getInstance().close();var a=ColumnManager.getInstance();switch(o.getType()){case Message.TYPE_PUBLIC:TabManager.getInstance().isActiveMyWorkplace()?a.addColumnInfo(Message.TYPE_PUBLIC,!0,!1,i):TabManager.getInstance().activeMyWorkplaceTab(function(){a.addColumnInfo(Message.TYPE_PUBLIC,!0,!1,i)});break;case Message.TYPE_CHAT:var r=o.getTo();LoginUser.getInstance().getJid()==r&&(r=o.getFrom()),a.addChatColumn(r,!0,!1,i);break;case Message.TYPE_GROUP_CHAT:if(TabManager.getInstance().isActiveMyWorkplace())a.addGroupChatColumn(o.getTo(),!0,!1,i);else{var s=TabManager.getInstance().getCommunityInfo();o.getParentRoomId()&&o.getParentRoomId()==s.getRoomId()?a.addGroupChatColumn(o.getTo(),!0,!1,i):TabManager.getInstance().activeMyWorkplaceTab(function(){a.addGroupChatColumn(o.getTo(),!0,!1,i)})}break;case Message.TYPE_COMMUNITY:if(o.getTo())if(o.getParentRoomId()&&o.getParentRoomId()==s.getRoomId())a.addCommunityFeedColumn(o.getTo(),!0,!1,i);else{var l=function(e){TabManager.getInstance().selectOrAddTabByCommunityInfo(e.getRoomId(),e,function(){})};CubeeController.getInstance().getCommunityInfo(o.getTo(),l)}break;case Message.TYPE_MURMUR:var u=o.getTo();TabManager.getInstance().getCurrentTabInfo().type==ColumnInformation.TYPE_COLUMN_TIMELINE?a.addMurmurColumn(u,!0,!1,i):TabManager.getInstance().selectOrAddTabByCommunityInfo("myworkplace",null,function(){a.addMurmurColumn(u,!0,!1,i)})}}}),$(document).on("click","li a.action-assign-note",function(){var t=e(this),n=new DialogAssignNoteView(t);n.showDialog()}),$(document).on("click","a.action-edit-task",function(){var e=t(this);null!=e&&e.onClickTaskEdit()}),$(document).on("click","a.action-finish-task",function(){function t(e){console.log("update task : "+e)}var n=e(this),o=new TaskMessage;o.copy(n),o.setStatus(TaskMessage.STATUS_FINISHED),0==CubeeController.getInstance().updateTask(o,t)&&console.log("faild to update task")}),$(document).on("click","a.action-doing-task",function(){function t(e){console.log("update task : "+e)}var n=e(this),o=new TaskMessage;o.copy(n),o.setStatus(TaskMessage.STATUS_DOING),0==CubeeController.getInstance().updateTask(o,t)&&console.log("faild to update task")}),$(document).on("click","a.action-demand-task",function(){function t(e){console.log("demand task : "+e)}var n=e(this);n.getItemId();if(null==n.getItemId()||""==n.getItemId())return null;var o=CubeeController.getInstance().getChildrenTaskItemIds(n.getItemId());if(null==o||0==o.getCount())return null;for(var i=0;i<o.getCount();i++){var a=CubeeController.getInstance().getMessage(o.get(i));null!=a&&(ViewUtils.isFinishedTask(a)||0==CubeeController.getInstance().sendDemandTask(o.get(i),t)&&console.log("faild to demand task"))}}),$(document).on("click","a.action-clear-demanded-task",function(){var t=e(this);t.getItemId();if(null==t.getItemId()||""==t.getItemId())return null;var n=ViewUtils.getDemandTaskListByMessage(t);if(n.getCount()>0)for(var o=function(e){console.log("clear demand task : "+e)},i=0;i<n.getCount();i++)0==CubeeController.getInstance().sendClearDemandedTask(n.get(i).getItemId(),o)&&console.log("faild to clear demand task")}),$(document).on("click","a.action-reply",function(){v(this),$("#columnContainer div.column div.column-content div.wrap-frm-message-reply").hide();var e=C(this).parent().parent().children("div.message-info").eq(0);ViewUtils.isIE89()&&(e=$(this).parent().parent().nextAll("div.message-info").eq(0));var n=$("div.wrap-frm-message-reply",e),o=t(this);if(!o)throw n.show(),"TooltipView:: message object is null.";var a=o.getMessage().getType(),r=null;if(0==n.length){var g=Resource.getMessage("dialog_close_title"),m="";m+='<div class="ui-widget-content wrap-frm-message-reply frm-message">',m+='<div class="frm-message">',m+='<a class="ico_btn" id="reply_close_button" data-original-title="'+g+'" data-toggle="tooltip">',m+='<i class="fa fa-close"></i></a>';var _=h($(this));(a==Message.TYPE_GROUP_CHAT||a==Message.TYPE_COMMUNITY)&&(m+='<a class="menthion-dialog-btn-replay fa fa-at" data-original-title="'+Resource.getMessage("menthion_icon_title")+'" data-toggle="tooltip"></a>'),m+='<textarea class="message-input-area ui-corner-all input-message-reply autoresize-textarea '+_.autoCompleteType+'" '+_.roomIdAttribute+' placeholder="'+Resource.getMessage("reply_placeholder")+'"></textarea>';var f=i(this);m+=ColumnFileUploadPartsView.getFormHtml(),m+=ViewUtils.getCharCounterHtml("char-counter-reply"),m+='<button id="reply_button" data-toggle="tooltip" data-placement="bottom" data-original-title="'+Resource.getMessage("reply_button")+'">'+Resource.getMessage("reply_button")+"</button>",m+='<div style="position:relative; display: inline-block;">',m+='<a class="list_add ico_btn emojibtn" data-container="body" data-toggle="tooltip" data-placement="bottom" title="" data-target="addgroup_modal" data-original-title="'+Resource.getMessage("stamp_name")+'" style="top: 0px;right: 0px;"><i class="fa fa-smile-o"></i></a>',m+="</div>",m+="</div>",m+="</div>",e.append(m);var p=$("div.wrap-frm-message-reply",e),y=p.find("div.frm-message");y.find("button").button(),ViewUtils.setCharCounter(y.find("textarea"),y.find("span."+ViewUtils.CHAR_COUNTER_CLASSNAME),ColumnView.TEXTAREA_MAX_LENGTH),n=p.eq(0);var T=y.find("div.file-inputs");$.data(n,"fileUpload",new ColumnFileUploadPartsView(T)),$.data(n,"uploading",!1);var b=n.find("div.submit-message-progress");$.data(n,"progressBar",new ProgressBarView(b,!1)),e.find('[data-toggle="tooltip"]').tooltip({trigger:"hover"});var I=$(e.parent().parent()).children("a.box-border");0==I.length&&(I=$(e.parent().parent().parent()).children("a.box-border")),new ColumnLinkView(I);var M=$("textarea.input-message-reply",n);new ColumnReplyTextAreaView(M);var r=n.parent().prev("div.message-header"),E=$("div.block-avatar",r).attr("jid"),S=LoginUser.getInstance().getJid(),w="";a!=Message.TYPE_CHAT&&(w=d(o.getMessage(),E,S)),M.val(w),M.autosize(),ViewUtils.setCursorEndOfLineForText(M),M.focus(),M.siblings("button#reply_button").mousedown(function(){function e(e){var t;if(a==Message.TYPE_PUBLIC)t=CubeeController.getInstance().sendPublicMessage(e,_);else if(a==Message.TYPE_GROUP_CHAT)t=l(e,o.getMessage());else if(a==Message.TYPE_CHAT)t=s(e,o.getMessage());else if(a==Message.TYPE_COMMUNITY)t=u(e,o.getMessage());else{if(a!=Message.TYPE_MURMUR)throw"TooltipView:: tooltip action-reply _ invalid column type :"+f;t=c(e,o.getMessage())}if(!t)throw"faild to send Message:"+f;M.val(w),M.trigger("autosize.resize"),void 0!=p&&null!=p&&p.clearFileUpload(),n.hide()}function t(t){return"success"!=t.result?($.data(n,"uploading",!1),void(ViewUtils.isIE89()?(ViewUtils.hideLoadingIcon(M),ViewUtils.showErrorMessageIE(M,Resource.getMessage("error_file_up_request"))):(ViewUtils.switchAttachmentArea(n,!0),h.progressClear()))):(d+="\n"+t.path,e(d),$.data(n,"uploading",!1),void(ViewUtils.isIE89()?(ViewUtils.hideLoadingIcon(M),ViewUtils.hideErrorMessageIE(M)):(ViewUtils.switchAttachmentArea(n,!0),h.progressComplete())))}function i(e){h.setProgressValue(e)}n.show();var d=M.val();if(!ViewUtils.isValidInputTextLength(d))return!1;var g=$.data(n,"uploading");if(1==g)return!1;var m=$("div.message-info",r);if(null==m)return!1;var _=m.attr("itemid"),p=$.data(n,"fileUpload"),h=$.data(n,"progressBar");if(ViewUtils.isIE89()){var C=p.getFileForm();if(null==C)return void e(d);if(""==C.value)return void e(d)}else{if(void 0==p||null==p)return void e(d);var v=p.getFilesObject();if(null==v)return void e(d);if(v.length<=0)return void e(d)}if($.data(n,"uploading",!0),ViewUtils.isIE89())return ViewUtils.showLoadingIcon(M),CubeeController.getInstance().uploadFileIE(C,t);h.visibleProgressBar(),ViewUtils.switchAttachmentArea(n,!1);var y=v[0];return CubeeController.getInstance().uploadFile(y,t,i)}),M.siblings("a#reply_close_button").mousedown(function(){n.hide()}),$("button#reply_button").find('[data-toggle="tooltip"]').tooltip({trigger:"hover"}),$("a.menthion-dialog-btn-replay",n).on("click",ColumnView.mentionIconEvent)}else{n.show();var M=$("textarea.input-message-reply",n);M.trigger("autosize.resize"),M.focus()}}),$(document).on("click","a.action-show-conversation",function(){SideMenuRecentView.getInstance().close(),v(this);var t=e(this);if(null!=t){var o=t.getItemId();if(null==o)return null;if(""==o)return null;var i=new ShowConversationColumnInfomation;i.setItemId(o);var a=n(this);if(null==a)return null;var s=a._getRootReplyItemId(t);""!=s&&(o=s),i.setParentItemId(o);var l=r(t);i.setSourceColumnDisplayName(l);var u=a.getColumnInfo(),c=u.getColumnType(),d=null,g=!1;c==ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER?(c=u.getSourceColumnType(),c==ColumnInformation.TYPE_COLUMN_FILTER&&(d=u.getBeginningColumnType()),g=!0):c==ColumnInformation.TYPE_COLUMN_FILTER&&(d=u.getSourceColumnType()),i.setSourceColumnType(c),null!=d&&i.setSourceColumnType(d);var m={};if(g)m=u.getSubData();else if(c==ColumnInformation.TYPE_COLUMN_CHAT)m.partner=u.getFilterCondition();else if(c==ColumnInformation.TYPE_COLUMN_GROUP_CHAT){var _=u.getChatRoomInfomation(),f=_.getRoomId();m.roomId=f}else if(c==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED){var _=u.getCommunityInfomation(),f=_.getRoomId();m.roomId=f}else(c==ColumnInformation.TYPE_COLUMN_SEARCH||c==ColumnInformation.TYPE_COLUMN_FILTER)&&(m=CustomFilterColumnInfomation.copySubData(u.getSubData()));var p;if(c==ColumnInformation.TYPE_COLUMN_SEARCH||c==ColumnInformation.TYPE_COLUMN_FILTER){var h=u.getKeyword(),C=null;if(c==ColumnInformation.TYPE_COLUMN_SEARCH){for(var y=u.getSourceColumnTypeList(),T=new ArrayList,b=y.getCount(),I=0;b>I;I++)T.add(y.get(I));C=null!=m&&null!=m.roomId&&""!=m.roomId?ColumnFilterManager.getColumnFilterForCommunity(T,m):ColumnFilterManager.getColumnFilterList(T)}else C=ColumnFilterManager.getColumnFilter(d,m);var M=ViewUtils.getKeywordFilterFromKeywordInputString(h);p=new AndCondition,p.addChildCondition(C),p.addChildCondition(M)}else p=ColumnFilterManager.getColumnFilter(c,m);var E=new ColumnSortCondition,S=new ColumnSearchCondition(p,E);i.setSearchCondition(S),ColumnManager.getInstance().insertAfterColumn(i,a,!0,!0)}}),$("#columnContainer").on("scroll",function(e){var t=TooltipView.displayedActionToolTipTargetElem;t&&(t.trigger("hideOn"),t=null)})})}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(){var e=Utils.trimStringMulutiByteSpace($("#txtSearchContext").val()),i=n(e);i&&o(e)&&t()}function t(){$("#txtSearchContext").val("")}function n(e){var t=$("#txtSearchContext");t.removeClass("input-error");var n=e;if(null==n||"string"!=typeof n||""==n||""==Utils.trimStringMulutiByteSpace(n))return!1;var o=ViewUtils.getKeywordListFromKeywordInputString(n);if(null==o)return!1;var i=o.getCount();if(1>i)return!1;for(var a=0;i>a;a++){var r=o.get(a),s=encodeURIComponent(r);if(s.length<=1)return t.addClass("input-error"),!1}return!0}function o(e,t,n){var o=this,i=!1;if(""==e)return i;(void 0===n||"boolean"!=typeof n)&&(n=!1);var a=ContextSearchView.getInstance(),r=new SearchColumnInfomation,s=e;r.setKeyword(s);a._contextSearchOptionController;if(null==o._checkedOptions&&!n)return i;for(var l=n?o._checkedOptionsAll:o._checkedOptions,u=0;u<l.getCount();u++)r.getSourceColumnTypeList().add(l.get(u));var c=ViewUtils.getKeywordFilterFromKeywordInputString(s),d=TabManager.getInstance().getCurrentTabInfo(),g=d.type,m=null;g==TabItemView.TYPE_COMMUNITY&&(m={},m.roomId=d.extras.communityId,r.setSubData(m));var _=ColumnFilterManager.getColumnFilterList(n?o._checkedOptionsAll:o._checkedOptions);if(null!=c&&null!=_){var f=new AndCondition;f.addChildCondition(c),f.addChildCondition(_);var p=new ColumnSortCondition,h=new ColumnSearchCondition(f,p);r.setSearchCondition(h),void 0!==t?ColumnManager.getInstance().insertAfterColumn(r,t,!0,!0):ColumnManager.getInstance().addColumn(r,!0,!0),i=!0}return i}var i=this;ContextSearchView.prototype=$.extend({},SearchView.prototype);var a=(SearchView.prototype,ContextSearchView.prototype),r=new ContextSearchView;i._checkedOptions=new ArrayList,_checkedOptions.add(ColumnInformation.TYPE_COLUMN_TIMELINE),_checkedOptions.add(ColumnInformation.TYPE_COLUMN_CHAT),_checkedOptions.add(ColumnInformation.TYPE_COLUMN_TASK),_checkedOptions.add(ColumnInformation.TYPE_COLUMN_INBOX),_checkedOptions.add(ColumnInformation.TYPE_COLUMN_GROUP_CHAT),_checkedOptions.add(ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED),_checkedOptions.add(ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK),_checkedOptions.add(ColumnInformation.TYPE_COLUMN_MAIL),_checkedOptions.add(ColumnInformation.TYPE_COLUMN_MURMUR),_checkedOptions.add(ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE),i._checkedOptionsAll=new ArrayList,i._checkedOptionsAll._array=_checkedOptions._array.slice(),i._checkedOptionsAll._length=_checkedOptions._length,a.getOptions=function(){return _checkedOptions},a.setOptions=function(e){_checkedOptions.removeAll();for(var t=0;t<e.length;t++)_checkedOptions.add(e[t])},ContextSearchView.getInstance=function(){return r},a.toggleSearchOption=function(){var e=this;e._contextSearchOptionController.toggleSearchOption();
},a.closeSearchOption=function(){var e=this,t=!0;e._contextSearchOptionController.toggleSearchOption(t)},a.setAutoComplete=function(e){var t=this;if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=$("#txtSearchContext");if(n){switch(n.removeClass("autocomplete autocomplete-for-community"),n.removeAttr("groupId"),n.data("iBinded",!1),e.type){case TabItemView.TYPE_MY_WORK_PLACE:n.addClass("autocomplete");break;case TabItemView.TYPE_COMMUNITY:n.addClass("autocomplete-for-community"),n.attr("groupId",e.extras.communityId)}t.closeSearchOption()}}},$(function(){$("#search_btn").button({icons:{primary:"ui-icon-search"},text:!1}),$("#txtSearchContext").on("keypress",function(t){return t.which&&13==t.which||t.keyCode&&13==t.keyCode?(e(),!1):void 0}),$("#search_btn").on("click",function(){e()})}),a.search=function(e,t,n){return o(e,t,n)}}(),function(){$(function(){$("#btnSearchOption").button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}),$(".search_menu_btn").on("click",function(){var e=new DialogSearchOptionView;e.showDialog()})})}(),function(){var e=ContextSearchOptionController.prototype;e.getSearchColumnFilter=function(e,t){var n=TabManager.getInstance().getCurrentTabInfo(),o=n.type,i=null;switch(o){case TabItemView.TYPE_MY_WORK_PLACE:i=ColumnFilterManager.getColumnFilterList(e);break;case TabItemView.TYPE_COMMUNITY:i=ColumnFilterManager.getColumnFilterForCommunity(e,t)}return i},e.getSearchOptionView=function(){var e=this,t=e._showSearchOptionView;return null!=t?t:e._initSearchOptionView()},e.toggleSearchOption=function(e){function t(){o.remove(),null!=n._showSearchOptionView&&(n._showSearchOptionView.cleanup(),n._showSearchOptionView=null)}var n=this,o=$("#frmSearch").children("div.search-option-view");if(null!=o&&0!=o.length){if(o.is(":visible"))return void o.slideToggle(t);t()}if(e!==!0){var i=n._initSearchOptionView();n._showSearchOptionView=i,n._showSearchOptionView.toggleView()}},e._initSearchOptionView=function(){var e=this,t=e._createSearchOptionHtml();$("#frmSearch").append(t);var n=$("#frmSearch").children("div.search-option-view"),o=e._createSearchOptionView(n);return o},e._createSearchOptionHtml=function(){var e=TabManager.getInstance().getCurrentTabInfo(),t=e.type,n="";switch(t){case TabItemView.TYPE_MY_WORK_PLACE:n=ContextSearchOptionView.getHtml();break;case TabItemView.TYPE_COMMUNITY:n=CommunityContextSearchOptionView.getHtml()}return n},e._createSearchOptionView=function(e){function t(){n.toggleSearchOption()}var n=this,o=TabManager.getInstance().getCurrentTabInfo(),i=o.type,a=null;switch(i){case TabItemView.TYPE_MY_WORK_PLACE:a=new ContextSearchOptionView(e,t);break;case TabItemView.TYPE_COMMUNITY:a=new CommunityContextSearchOptionView(e,t)}return a}}(),function(){function e(){var e="";return e+='<div class="search-option-view hide-view">',e+='<div class="search-option-header box-border olient-horizontal width-100">',e+='<span class="search-option-title">'+Resource.getMessage("search_option_title")+"</span>",e+='<div class="action-search-option">',e+='<span class="cancel">',e+='<img class="img-cancel action-button-base" id="cancel-option" src="images/add_close.png" alt="'+Resource.getMessage("dialog_cancel_title")+'" title="'+Resource.getMessage("dialog_cancel_title")+'">',e+='<span class="register-task-label-margin"></span>',e+='<span class="register-task-label-margin"></span>',e+="</span>",e+="</div>",e+="</div>",e+='<form class="search-option-area">',e+='<div class="box-border olient-horizontal width-100 margin-clear">',e+='<div class="flex1 margin-clear">',e+='<div class="float-left search-option-label">'+Resource.getMessage("search_option_label"),e+="</div>",e+='<div class="float-left">',e+='<a class="search-option-check-control" id="link-checked-all">'+Resource.getMessage("search_option_checked_all")+"</a>",e+="</div>",e+="<div>",e+='<a class="search-option-check-control" id="link-unchecked-all">'+Resource.getMessage("search_option_unchecked_all")+"</a>",e+="</div>",e+='<div class="search-column-type margin-clear">',e+="<div>",e+='<span class="select-column-left">',e+='<input type="checkbox" checked="checked" id="column-info-search-myfeed" value="'+ColumnInformation.TYPE_COLUMN_TIMELINE+'" name="search-column-checkbox"><label for="column-info-search-myfeed" class="search-option-label">'+Resource.getMessage("MyFeed")+"</label>",e+="</span>",e+="<span>",e+='<input type="checkbox" checked="checked" id="column-info-search-chat" value="'+ColumnInformation.TYPE_COLUMN_CHAT+'" name="search-column-checkbox"><label for="column-info-search-chat" class="search-option-label">'+Resource.getMessage("Chat")+"</label>",e+="</span>",e+="</div>",e+="<div>",e+='<span class="select-column-left">',e+='<input type="checkbox" checked="chcked" id="column-info-search-groupchat" value="'+ColumnInformation.TYPE_COLUMN_GROUP_CHAT+'" name="search-column-checkbox"><label for="column-info-search-groupchat" class="search-option-label">'+Resource.getMessage("GroupChat")+"</label>",e+="</span>",e+="<span>",e+='<input type="checkbox" checked="chcked" id="column-info-search-task" value="'+ColumnInformation.TYPE_COLUMN_TASK+'" name="search-column-checkbox"><label for="column-info-search-task" class="search-option-label">'+Resource.getMessage("MyTask")+"</label>",e+="</span>",e+="</div>",e+="<div>",e+='<span class="select-column-left">',e+='<input type="checkbox" checked="checked" id="column-info-search-inbox" value="'+ColumnInformation.TYPE_COLUMN_INBOX+'" name="search-column-checkbox"><label for="column-info-search-inbox" class="search-option-label">'+Resource.getMessage("Inbox")+"</label>",e+="</span>",e+="</div>",e+="<div>",e+='<span class="select-column-left">',e+='<input type="checkbox" checked="chcked" id="column-info-search-community-feed" value="'+ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED+'" name="search-column-checkbox"><label for="column-info-search-community-feed" class="search-option-label">'+Resource.getMessage("CommunityFeed")+"</label>",e+="</span>",e+="</div>",e+="<div>",e+='<span class="select-column-left">',e+='<input type="checkbox" checked="chcked" id="column-info-search-community-task" value="'+ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK+'" name="search-column-checkbox"><label for="column-info-search-community-task" class="search-option-label">'+Resource.getMessage("ContextSearchCommunityTask")+"</label>",e+="</span>",e+="</div>",e+="</div>",e+="</div>",e+="</div>",e+='<p class="ui-state-error-text error-footer margin-clear"></p>',e+="</form>",e+="</div>"}var t=ContextSearchOptionView.prototype;ContextSearchOptionView.ERROR_SEARCH_CONDITION_COLUMN=Resource.getMessage("dialogerrorSelect"),ContextSearchOptionView.getHtml=function(){return e()},t.cleanup=function(){var e=this;null==e._htmlElement},t.toggleView=function(){var e=this;e._htmlElement.slideToggle()},t.isVisible=function(){var e=this;return null==e._htmlElement||0==e._htmlElement.length||e._htmlElement.is(":hidden")?!1:!0},t._createEventHandler=function(){},t.getColumnTypeList=function(){var e=this,t=e._htmlElement.find("div.search-column-type"),n=e._htmlElement.find("p.error-footer");t.removeClass("input-error"),n.text(""),n.addClass("margin-clear");var o=e._getColumnTypeList(),i=o.getCount()>0;return i?o:(e._showError(),null)},t.getFilterCondition=function(){var e=this,t=e.getColumnTypeList();return ColumnFilterManager.getColumnFilterList(t)},t._showError=function(){var e=this;if(e.isVisible()){var t=e._htmlElement.find("div.search-column-type"),n=e._htmlElement.find("p.error-footer");t.addClass("input-error"),n.text(ContextSearchOptionView.ERROR_SEARCH_CONDITION_COLUMN),n.removeClass("margin-clear")}},t._getColumnTypeList=function(){var e=this,t=new ArrayList;if(!e.isVisible())return e._getDefaultColumnTypeList();var n=e._htmlElement.find('input[type="checkbox"]'),o=n.length;if(o>0)for(var i=0;o>i;i++)1==n[i].checked&&t.add(parseInt(n[i].value));return t},t._getDefaultColumnTypeList=function(){var e=new ArrayList;return e.add(ColumnInformation.TYPE_COLUMN_TIMELINE),e.add(ColumnInformation.TYPE_COLUMN_CHAT),e.add(ColumnInformation.TYPE_COLUMN_TASK),e.add(ColumnInformation.TYPE_COLUMN_INBOX),e.add(ColumnInformation.TYPE_COLUMN_GROUP_CHAT),e.add(ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED),e.add(ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK),e},$(function(){})}(),function(){function e(){var e="";return e+='<div class="search-option-view hide-view">',e+='<div class="search-option-header box-border olient-horizontal width-100">',e+='<span class="search-option-title">'+Resource.getMessage("search_option_title")+"</span>",e+='<div class="action-search-option">',e+='<span class="cancel">',e+='<img class="img-cancel action-button-base" id="cancel-option" src="images/add_close.png" alt="'+Resource.getMessage("dialog_cancel_title")+'" title="'+Resource.getMessage("dialog_cancel_title")+'">',e+='<span class="register-task-label-margin"></span>',e+='<span class="register-task-label-margin"></span>',e+="</span>",e+="</div>",e+="</div>",e+='<form class="search-option-area">',e+='<div class="box-border olient-horizontal width-100 margin-clear">',e+='<div class="flex1 margin-clear">',e+='<div class="float-left search-option-label">'+Resource.getMessage("search_option_label"),e+="</div>",e+='<div class="float-left">',e+='<a class="search-option-check-control" id="link-checked-all">'+Resource.getMessage("search_option_checked_all")+"</a>",e+="</div>",e+="<div>",e+='<a class="search-option-check-control" id="link-unchecked-all">'+Resource.getMessage("search_option_unchecked_all")+"</a>",e+="</div>",e+='<div class="search-column-type margin-clear">',e+="<div>",e+='<span class="select-column-left">',e+='<input type="checkbox" checked="chcked" id="column-info-search-community-feed" value="'+ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED+'" name="search-column-checkbox"><label for="column-info-search-community-feed" class="search-option-label">'+Resource.getMessage("CommunityFeed")+"</label>",e+="</span>",e+="</div>",e+="<div>",e+='<span class="select-column-left">',e+='<input type="checkbox" checked="chcked" id="column-info-search-community-task" value="'+ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK+'" name="search-column-checkbox"><label for="column-info-search-community-task" class="search-option-label">'+Resource.getMessage("ContextSearchCommunityTask")+"</label>",e+="</span>",e+="</div>",e+="</div>",e+="</div>",e+='<p class="ui-state-error-text error-footer margin-clear"></p>',e+="</form>",e+="</div>"}CommunityContextSearchOptionView.prototype=$.extend({},ContextSearchOptionView.prototype);var t=(ContextSearchOptionView.prototype,CommunityContextSearchOptionView.prototype);CommunityContextSearchOptionView.getHtml=function(){return e()},t._getDefaultColumnTypeList=function(){var e=new ArrayList;return e.add(ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED),e.add(ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK),e}}(),function(){PersonSearchView.prototype=$.extend({},SearchView.prototype);SearchView.prototype,PersonSearchView.prototype;$(function(){$("#btnSearchPerson").button({icons:{primary:"ui-icon-search"},text:!1}),$("#frmSearchPerson").hide("blind","fast"),$("#serarchPersonContainer > div:first").on("mouseover",function(){$(this).css("cursor","pointer")}).on("click",function(){return $(this).next().toggle("slow"),!1}).next().show(),$("#txtSearchPerson").on("keypress",function(e){e.which&&13==e.which||e.keyCode&&13==e.keyCode}),$("#btnSearchPerson").on("click",function(){})})}(),function(){var e=($("#presence_type"),$("#myMemo > input"),new MyPresenceView);MyPresenceView.getInstance=function(){return e};var t=MyPresenceView.prototype;t.notifyDisconnect=function(){!LoginView.getInstance().getLoginCompleted()},t.updateChangePresence=function(e,t){null!=e&&"number"==typeof e&&null!=t&&"string"==typeof t&&($("#loginAvatar span.ico.ico_user").removeClass("status online offline leave busy out"),$("#loginAvatar span.ico.ico_user").addClass("status "+ViewUtils.getPresenceColorCss(e)))}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){$(function(){$("#menuIcons").sortable({items:".sortable-item",axis:"x",tolerance:"pointer",scrollSensitivity:5}),$("#menuIcons").disableSelection()})}(),function(){ColumnIconArea.COLUM_ICON_SPARATOR_ELEMENT=$("ul#menuIcons").children("li.menu-separator"),ColumnIconArea.prototype=$.extend({},IconAreaView.prototype);var e=(IconAreaView.prototype,ColumnIconArea.prototype),t=new ColumnIconArea;ColumnIconArea.getInstance=function(){return t},e.getColumnIconViewList=function(){return this._iconViewList},e.addIcon=function(e){var t=this;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var n=new ColumnIconView,o=n.initColumnIconView(e);return t._iconViewList.add(n),o},e.insertIcon=function(e,t){var n=this;if(null==e||"number"!=typeof e)return!1;if(!t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return!1;var o=new ColumnIconView,i=o.initColumnIconView(t,e);return n._iconViewList.insert(e,o),i},e.removeIcon=function(e){return null==e||"number"!=typeof e?!1:(this._iconAreaContener.children().eq(e).find("*").off(),this._iconAreaContener.children().eq(e).off(),this._iconAreaContener.children().eq(e).find("*").remove(),this._iconAreaContener.children().eq(e).remove(),this.removeIconObj(e),LayoutManager.resetScreenLayout(),!0)},e.removeIconObj=function(e){if(null==e||"number"!=typeof e)return!1;var t=this._iconViewList.get(e);return t.cleanup(),this._iconViewList.remove(e),!0},e.startSortIcon=function(e){return null==e||"number"!=typeof e?!1:void(this._movingIconIndex=e)},e.updateSortIcon=function(e){if(null==e||"number"!=typeof e)return!1;var t=this._movingIconIndex;if(_ret=ColumnManager.getInstance().sortColumn(t,e),_ret)this._iconViewList.move(t,e);else{var n=this._iconAreaContener.children().eq(e),o=-1;o=originalIndex>e?originalIndex:originalIndex-1;this._iconAreaContener.children().eq(o);n.detach(),0==o?_targetElm.before(n):_targetElm.after(n)}return this._movingIconIndex=-1,_ret},e.receiveMessage=function(e){if(null==e||"number"!=typeof e)return!1;var t=!1,n=this._iconViewList.get(e);return null!=n&&(LayoutManager.iconAreaScrollToShow(e),t=!0),t},e.removeColumnNotificationIcon=function(e){if(null==e||"number"!=typeof e)return!1;var t=!1,n=this._iconViewList.get(e);return null!=n&&(n.removeColumnNotificationIcon(),t=!0),t},e.removeColumnNotificationIconByColumnInformation=function(e){for(var t=this,n=!1,o=t._iconViewList.getCount(),i=0;o>i;i++){var a=t._iconViewList.get(i);if(null!=a&&a.isMatchColumnInfo(e)){a.removeColumnNotificationIcon(),n=!0;break}}return n},e.updateIconTitle=function(e){var t=this;if(null==e||"number"!=typeof e)return!1;var n=t._iconViewList.get(e);null!=n&&n.updateTitle()},e.updateColumnIcon=function(e){var t=this;if(null==e||"number"!=typeof e)return!1;var n=t._iconViewList.get(e);null!=n&&n.updateColumnIcon()},e.updateDisplay=function(e){var t=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;for(var n=t._iconViewList.getCount(),o=0;n>o;o++){var i=t._iconViewList.get(o);if(null!=i&&i.isMatchColumnInfo(e)){i.onUpdateDisplay(e);break}}},e.onNewlyArrived=function(e){var t=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;for(var n=t._iconViewList.getCount(),o=0;n>o;o++){var i=t._iconViewList.get(o);if(null!=i&&i.isMatchColumnInfo(e)){i.onNewlyArrived();break}}},e.cleanup=function(){var e=this;e._iconAreaContener.children(".sortable-item").remove(),e._iconViewList.removeAll()},e.getIconColumnInfo=function(e){var t=this;if(null==e||"number"!=typeof e)return null;var n=t._iconViewList.get(e);return null==n?null:n.getColumnInfo()}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t){var n=ViewUtils.isToMeMessage(t);if(n&&t.getFrom()!=LoginUser.getInstance().getJid()){var o=(t.getType(),NotificationSettingManager.getInstance());if(!o.isSetting(ColumnInformation.TYPE_COLUMN_TOME,null)){var i=e._getIconViewList(),a=e.checkNotificationIconExistence(ColumnInformation.TYPE_COLUMN_TOME);if(-1==a){var r=new ToMeNotificationIconView(t);e._getIconViewList().add(r),e.addAttentionHeaderColumnIcon('li[columntype="'+ColumnInformation.TYPE_COLUMN_TOME+'"].sortable-item .ico_system')}else{var s=i.get(a);s.updateNotificationArea(t)}}}}NotificationIconManager.prototype=$.extend({},IconAreaView.prototype);var t=(IconAreaView.prototype,NotificationIconManager.prototype),n=new NotificationIconManager;NotificationIconManager.getInstance=function(){return n},t._getIconViewList=function(){return this._iconViewList},t._getCautionIconViewList=function(){return this._cautionIconViewList},t.notifyMessage=function(t){function n(e){var t=e.getType();switch(t){case Message.TYPE_CHAT:return e.getFrom()}return null}if(null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var o=this,i=LoginUser.getInstance().getJid();if(t.getType()==Message.TYPE_TASK){if(i==t.getUpdatedBy())return;if(i!=t.getOwnerJid())return}else if(t.getType()==Message.TYPE_QUESTIONNAIRE&&i==t.getFrom())return;var a=o._getNotificationColumnType(t);e(o,t);var r=NotificationSettingManager.getInstance(),s=n(t);if(!r.isSetting(a,s)){var l=o.checkNotificationIconExistence(a);-1==l?o._createNotificationIcon(t):o._updateNotificationIcon(t),o.addAttention()}}},t._createNotificationIcon=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this,n=e.getType(),o=null;switch(n){case Message.TYPE_PUBLIC:break;case Message.TYPE_CHAT:o=new ChatNotificationIconView(e);var i=e.getFrom();t.addAttentionHeaderColumnIcon('li[jid="'+i+'"][columntype="3"].sortable-item .ico');break;case Message.TYPE_TASK:var a=ViewUtils.isInboxColumnMessage(e);if(a)o=new InboxNotificationIconView(e),t.addAttentionHeaderColumnIcon('li[columntype="'+ColumnInformation.TYPE_COLUMN_INBOX+'"].sortable-item .ico_system');else{o=new TaskNotificationIconView(e);var r=e.getCommunityId();t.addAttentionHeaderColumnIcon('li[msgto="'+r+'"][columntype="'+ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK+'"].sortable-item .ico_system')}break;case Message.TYPE_MAIL:o=new MailNotificationIconView(e);break;case Message.TYPE_QUESTIONNAIRE:var s=e.getOptionItems(),l=!1;for(var u in s._array)if(s._array[u].optionValue>0){l=!0;break}if(l)break;switch(o=new QuestionnaireNotificationIconView(e),t.addAttentionHeaderColumnIcon("li[columntype=17].sortable-item .ico_system"),e.getRoomType()){case Message.TYPE_GROUP_CHAT+"":var c=e.getRoomId();t.addAttentionHeaderColumnIcon('li[msgto="'+c+'"][columntype="'+ColumnInformation.TYPE_COLUMN_GROUP_CHAT+'"].sortable-item .ico_group');break;case Message.TYPE_COMMUNITY+"":var d=e.getRoomId();t.addAttentionHeaderColumnIcon('li[msgto="'+d+'"][columntype="'+ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED+'"].sortable-item .ico_project')}break;case Message.TYPE_MURMUR:o=new MurmurNotificationIconView(e),i=e.getFrom(),t.addAttentionHeaderColumnIcon('li[jid="'+i+'"][columntype="18"].sortable-item .ico');break;default:o=new NotificationIconView(e)}null!=o&&(t._getIconViewList().add(o),LayoutManager.resetScreenLayout(),LayoutManager.iconAreaScrollToShow(-1),View.resizeHeaderContent())}},t._updateNotificationIcon=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this,n=t._getNotificationColumnType(e),o=t.checkNotificationIconExistence(n);if(-1!=o){var i=t._getIconViewList(),a=i.get(o);a.updateNotificationArea(e),LayoutManager.resetScreenLayout(),LayoutManager.iconAreaScrollToShow(o)}}},t.removeNotificationIcon=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this;t.removeAttention();var n=t.checkNotificationIconExistence(e.getType());-1!=n&&(t._getIconViewList().remove(n),0==t._getIconViewList().getCount()&&View.getInstance().invalidBlinkTitleBar(),View.resizeHeaderContent())}},t.checkNotificationIconExistence=function(e){if(null==e||"number"!=typeof e)return-1;for(var t=this,n=t._getIconViewList(),o=n.getCount(),i=0;o>i;i++){var a=n.get(i),r=a.getType();if(r==e)return i}return-1},t._getNotificationColumnType=function(e){var t=null,n=e.getType(),o=ViewUtils.getColumnTypeListFromMessage(e);switch(n){case Message.TYPE_PUBLIC:for(var i=0;i<o.getCount();i++){var a=o.get(i);if(a==ColumnInformation.TYPE_COLUMN_MENTION){t=a;break}}break;case Message.TYPE_CHAT:case Message.TYPE_TASK:case Message.TYPE_MAIL:for(var i=0;i<o.getCount();i++)t=o.get(i);break;case Message.TYPE_QUESTIONNAIRE:for(var i=0;i<o.getCount();i++)t=o.get(i)}return t},t.notifyGroupChat=function(t){if(null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var n=this;if(t.getSubType()===GroupChatNotification.SUB_TYPE_MESSAGE){var o=t.getGroupChatMessage();e(n,o);var i=NotificationSettingManager.getInstance();if(!i.isSetting(ColumnInformation.TYPE_COLUMN_GROUP_CHAT,t.getGroupChatMessage().getTo())){var a=n.checkNotificationIconExistence(ColumnInformation.TYPE_COLUMN_GROUP_CHAT);if(-1==a){var r=new GroupChatNotificationIconView(t);r.getHtmlElement();n._getIconViewList().add(r),View.resizeHeaderContent()}else{var s=n._getIconViewList().get(a);s.onNotificationRecieved(t)}n.addAttention();var l=t.getRoomInfo(),u=l.getRoomId();n.addAttentionHeaderColumnIcon('li[msgto="'+u+'"][columntype="'+ColumnInformation.TYPE_COLUMN_GROUP_CHAT+'"].sortable-item .ico_group')}}}},t.updateRoomInfo=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this,n=t.checkNotificationIconExistence(ColumnInformation.TYPE_COLUMN_GROUP_CHAT);if(-1!=n){var o=t._getIconViewList().get(n);o.onUpdateRoomInfoNotificationRecieved(e)}t.addAttention()}},t.reLoadProjectMenu=function(e){var t,n;"object"!=_typeof(e._updatedCommunityInfo)?(n="function"==typeof e.getCommunityMessage?e.getCommunityMessage().getTo():e.getRoomId(),t=TabManager.getInstance().getCommunityInfo()):(n=e._updatedCommunityInfo.getRoomId(),t=e._updatedCommunityInfo),TabManager.getInstance().isActiveMyWorkplace()?SelectAndAddProjectView.getInstance().getProjectList(null):n==TabManager.getInstance().getCommunityInfo().getRoomId()?SelectAndAddProjectView.getInstance().getProjectList(t):SelectAndAddProjectView.getInstance().getProjectList(TabManager.getInstance().getCommunityInfo())},t.onCommunityNotificationRecieved=function(t){function n(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=o.checkNotificationIconExistence(ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED);if(-1==n){var i=new CommunityNotificationIconView(t,e);o._getIconViewList().add(i),View.resizeHeaderContent()}else{var a=o._getIconViewList().get(n);a._communityInfo=e,a.onNotificationRecieved(t)}o.addAttention();var r=t.getCommunityMessage().getTo();o.addAttentionHeaderColumnIcon('li[msgto="'+r+'"][columntype="'+ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED+'"].sortable-item .ico_project')}}if(null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var o=this;if(t.getSubType()!==CommunityNotification.SUB_TYPE_MESSAGE)return void o.reLoadProjectMenu(t);o.reLoadProjectMenu(t);var i=t.getCommunityMessage(),a=i.getFrom();e(o,i);var r=NotificationSettingManager.getInstance();r.isSetting(ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED,t.getCommunityMessage().getTo())||a!=LoginUser.getInstance().getJid()&&CubeeController.getInstance().getCommunityInfo(t.getCommunityMessage().getTo(),n)}},t.onMurmurNotificationRecieved=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&e.getMurmurMessage()&&e.getMurmurMessage().getFrom()&&LoginUser.getInstance().getJid()!=e.getMurmurMessage().getFrom()){var t=this;t.addAttention();var n=e.getMurmurMessage().getTo();t.addAttentionHeaderColumnIcon('li[jid="'+n+'"][columntype="'+ColumnInformation.TYPE_COLUMN_MURMUR+'"].sortable-item .ico_user')}},t.onColumnClicked=function(e){var t=this;if(null!=e)for(var n=t._getIconViewList(),o=n.getCount(),i=0;o>i;i++){var a=n.get(i);if(a)try{a.onColumnClicked(e)}catch(r){}}},t.askCautionExistence=function(e,t){if(null!=e&&"number"==typeof e){var n=this,o=!0,i=!0,a=null,r=NotificationSettingManager.getInstance();r.isSetting(ColumnInformation.TYPE_COLUMN_TASK,"")&&(i=!1),r.isSetting(ColumnInformation.TYPE_COLUMN_INBOX,"")&&(o=!1);var s=n.checkNotificationIconExistence(ColumnInformation.TYPE_COLUMN_TASK);i&&(-1!=s?n._getIconViewList().get(s).setDemandData(t):t.getByKey(ColumnInformation.TYPE_COLUMN_TASK.toString())>0&&(a=new TaskNotificationIconView(null),a.setDemandData(t),n._getIconViewList().add(a),n.addAttentionHeaderColumnIcon('li[columntype="'+ColumnInformation.TYPE_COLUMN_TASK+'"].sortable-item .ico_system'))),s=n.checkNotificationIconExistence(ColumnInformation.TYPE_COLUMN_INBOX),o&&(-1!=s?n._getIconViewList().get(s).setDemandData(t):t.getByKey(Message.TYPE_SYSTEM.toString())>0&&(a=new InboxNotificationIconView(null),a.setDemandData(t),n._getIconViewList().add(a),n.addAttentionHeaderColumnIcon('li[columntype="'+ColumnInformation.TYPE_COLUMN_INBOX+'"].sortable-item .ico_system'))),null!=a&&(LayoutManager.resetScreenLayout(),LayoutManager.iconAreaScrollToShow(-1),View.resizeHeaderContent())}},t._addCautionIcon=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this;e.getHtmlElement();t._getCautionIconViewList().add(e),LayoutManager.resetScreenLayout(),LayoutManager.iconAreaScrollToShow(-1)}},t._updateCautionIcon=function(e,t){if(null!=e&&"number"==typeof e){var n=this,o=n.checkCautionIconExistence(e);if(-1!=o){var i=n._getCautionIconViewList(),a=i.get(o);a.updateNotificationArea(t),LayoutManager.resetScreenLayout(),LayoutManager.iconAreaScrollToShow(o)}}},t.removeCautionIcon=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this,n=t.checkCautionIconExistence(e.getType());-1!=n&&(t._getCautionIconViewList().remove(n),0==t._getCautionIconViewList().getCount()&&View.getInstance().invalidBlinkTitleBar())}},t.checkCautionIconExistence=function(e){if(null==e||"number"!=typeof e)return-1;for(var t=this,n=t._getCautionIconViewList(),o=n.getCount(),i=0;o>i;i++){var a=n.get(i),r=a.getType();if(r==e)return i}return-1},t.addAttention=function(){var e=this;0!=e._iconAreaContener.find("li").size()&&0==e._iconAreaContener.prevAll("a.popup_btn").hasClass("alert_btn")&&(e._iconAreaContener.prevAll("a.ico_btn").addClass("alert_btn"),e._iconAreaContener.prevAll("a.ico_btn").addClass("popup_btn"))},t.removeAttention=function(){var e=this;0==e._iconAreaContener.find("li").size()&&1==e._iconAreaContener.prevAll("a.popup_btn").hasClass("alert_btn")&&(e._iconAreaContener.prevAll("a.ico_btn").removeClass("alert_btn"),e._iconAreaContener.prevAll("a.ico_btn").removeClass("popup_btn"))},t.removeColumnNotificationIconByMessage=function(e){function t(){var t=ViewUtils.isToMeMessage(e);if(t){var n=i.checkNotificationIconExistence(ColumnInformation.TYPE_COLUMN_TOME);if(-1!=n){r=new ToMeColumnInfomation,r.setColumnType(ColumnInformation.TYPE_COLUMN_TOME),r.setFilterCondition("");var a=ColumnFilterManager.getColumnFilter(r.getColumnType(),null),s=new ColumnSearchCondition(a,new ColumnSortCondition);r.setSearchCondition(s,!1),o(r)}}}function n(e){null!=e&&(r=ViewUtils.getGroupChatColumnInfo(e),null!=r&&o(r))}function o(e){i.onColumnClicked(e)}var i=this,a=i._getIconViewList(),r=null,s=i._getNotificationColumnType(e);if(null!=s){var l=i.checkNotificationIconExistence(s);if(-1!=l){var u=a.get(l);switch(u.getType()){case ColumnInformation.TYPE_COLUMN_MENTION:r=new FilterColumnInfomation,r.setColumnType(ColumnInformation.TYPE_COLUMN_MENTION),r.setFilterCondition("");var c=ColumnFilterManager.getColumnFilter(r.getColumnType(),null),d=new ColumnSearchCondition(c,new ColumnSortCondition);r.setSearchCondition(d,!1);break;case ColumnInformation.TYPE_COLUMN_CHAT:r=new ColumnInformation,r.setColumnType(ColumnInformation.TYPE_COLUMN_CHAT);var g=e.getFrom();g==LoginUser.getInstance().getJid()&&(g=e.getTo()),r.setFilterCondition(g);break;case ColumnInformation.TYPE_COLUMN_TASK:r=new ColumnInformation,r.setColumnType(ColumnInformation.TYPE_COLUMN_TASK);var g=LoginUser.getInstance().getJid(),m=ViewUtils.getTaskFilterAndSortCondition(g);r.setFilterCondition(m.getFilterConditionJSONString());break;case ColumnInformation.TYPE_COLUMN_INBOX:r=ViewUtils.createIndexColumnInfo();break;case ColumnInformation.TYPE_COLUMN_MAIL:r=ViewUtils.getMailColumnInfomation()}}}else{var _=e.getType();switch(_){case Message.TYPE_GROUP_CHAT:CubeeController.getInstance().getRoomInfo(e.getTo(),n);break;case Message.TYPE_COMMUNITY:var f=new CommunityInfo;f.setRoomId(e.getTo()),r=ViewUtils.getCommunityFeedColumnInfo(f)}}null!=r&&o(r),t()},t.addAttentionHeaderColumnIcon=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,n=this;"boolean"==typeof t&&t&&(t=!0);var o=this._attentionHeaderColumnIconPanelConntener.find(e);void 0!=o&&null!=o&&0!=o.size()&&(t&&void 0!=this._attentionHeaderColumnIconSelectors[encodeURIComponent(e)]&&"boolean"==typeof this._attentionHeaderColumnIconSelectors[encodeURIComponent(e)]&&this._attentionHeaderColumnIconSelectors[encodeURIComponent(e)]?o.addClass("message-notice-mainheader"):o.addClass("message-notice-mainheader"),'li[columntype="'+ColumnInformation.TYPE_COLUMN_INBOX+'"].sortable-item .ico_system'!=e&&'li[columntype="'+ColumnInformation.TYPE_COLUMN_TASK+'"].sortable-item .ico_system'!=e&&o.on("click",function(){n.removeAttentionHeaderColumnIcon(e)})),t||(this._attentionHeaderColumnIconSelectors[encodeURIComponent(e)]=!0)},t.removeAttentionHeaderColumnIcon=function(e){var t=this;this._attentionHeaderColumnIconPanelConntener.ready(function(){var n=t._attentionHeaderColumnIconPanelConntener.find(e);n.ready(function(){void 0!=n&&null!=n&&0!=n.size()&&n.removeClass("message-notice-mainheader")})}),void 0!=this._attentionHeaderColumnIconSelectors[encodeURIComponent(e)]&&"boolean"==typeof this._attentionHeaderColumnIconSelectors[encodeURIComponent(e)]&&1==this._attentionHeaderColumnIconSelectors[encodeURIComponent(e)]&&delete this._attentionHeaderColumnIconSelectors[encodeURIComponent(e)]},t.updateAttentionHeaderColumnIconView=function(){var e=this;this._attentionHeaderColumnIconPanelConntener.ready(function(){var t=function(t){var n=decodeURIComponent(t),o=e._attentionHeaderColumnIconPanelConntener.find(n);o.size()>0&&o.ready(function(){e.addAttentionHeaderColumnIcon(n,!0)})};for(var n in e._attentionHeaderColumnIconSelectors)t(n)})}}(),function(){ColumnAddIconView.prototype=$.extend({},IconAreaIconView.prototype);var e={};e[TabItemView.TYPE_MY_WORK_PLACE]=DialogAddColumnView,e[TabItemView.TYPE_COMMUNITY]=DialogAddColumnForCommunityView;var t=function(){var t=TabManager.getInstance().getCurrentTabInfo(),n=t.type,o=Utils.getSafeValue(e,n,DialogAddColumnView),i=LoginView.getInstance().getMailCooperationSettingServerList(),a=new o(i);a.showDialog()};$(function(){var e=$("#left_sidebar").find("a.addcolum_modal");e.on("click",t)})}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return"";var t="",n="",o="ico_system",i=Utils.convertEscapedTag(e.getDisplayName()),a=e.getColumnType(),r=e.getIconImage(),s='id="'+e.getFilterCondition()+'_icon"',l=e.getSearchCondition(),u="";switch(a){case ColumnInformation.TYPE_COLUMN_TIMELINE:n='<i class="menu-column fa fa-comments" title="'+e.getDisplayName()+'"></i>';break;case ColumnInformation.TYPE_COLUMN_MENTION:n='<i class="menu-column fa fa-user" title="'+e.getDisplayName()+'"></i>';break;case ColumnInformation.TYPE_COLUMN_CHAT:t='jid="'+e.getFilterCondition()+'"',o="ico_user";
var c=CubeeController.getInstance().getPersonData(e.getFilterCondition());if(null!=c){i=c.getUserName();var d=Utils.avatarCreate({type:"user",name:i});i=Utils.convertEscapedTag(i),ViewUtils.getAvatarUrl(c)==ViewUtils.DEFAULT_USER_AVATAR_SRC?(n='    <div class="menu-column no_img" style="background-color:'+d.color+'" title="'+i+'">',n+='      <div class="no_img_inner">'+d.name+"</div>",n+="    </div>"):n="<img "+s+' class="menu-column " src="'+r+'" title="'+i+'">'}else{i=e.getDisplayName();var d=Utils.avatarCreate({type:"user",name:i});i=Utils.convertEscapedTag(i),e.getIconImage()==ViewUtils.DEFAULT_USER_AVATAR_SRC?(n='    <div class="menu-column no_img" style="background-color:'+d.color+'" title="'+i+'">',n+='      <div class="no_img_inner">'+d.name+"</div>",n+="    </div>"):n="<img "+s+' class="menu-column " src="'+r+'" title="'+i+'">'}break;case ColumnInformation.TYPE_COLUMN_TASK:n='<i class="menu-column fa fa-check" title="'+i+'"></i>';break;case ColumnInformation.TYPE_COLUMN_INBOX:n='<i class="menu-column fa fa-archive" title="'+i+'"></i>';break;case ColumnInformation.TYPE_COLUMN_SEARCH:case ColumnInformation.TYPE_COLUMN_FILTER:case ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER:n='<i class="menu-column fa fa-search" title="'+e.getDisplayName()+'"></i>';break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:o="ico_group";var d=Utils.avatarCreate({type:"group",name:e.getDisplayName()});if(n='    <div class="menu-column no_img" style="background-color:'+d.color+'" title="'+i+'">',n+='      <div class="no_img_inner">'+d.name+"</div>",n+="    </div>",void 0!=l&&""!=l&&"object"==("undefined"==typeof l?"undefined":_typeof(l))){var g=l._filterCondition._columnFilterConditionList._array;if(void 0!=g&&"object"==("undefined"==typeof g?"undefined":_typeof(g)))for(var m=0;m<g.length;m++)"msgto"==g[m]._name&&void 0!=g[m]._value&&(u=' msgto="'+g[m]._value+'"')}break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:o="ico_project";var d=Utils.avatarCreate({type:"project",name:e.getDisplayName()});if(n='    <div class="menu-column no_img" style="background-color:'+d.color+'" title="'+i+'">',n+='      <div class="no_img_inner">'+d.name+"</div>",n+="    </div>",void 0!=l&&""!=l&&"object"==("undefined"==typeof l?"undefined":_typeof(l))){var _=l._filterCondition._columnFilterConditionList._array;if(void 0!=_&&"object"==("undefined"==typeof _?"undefined":_typeof(_)))for(var f=0;f<_.length;f++)"msgto"==_[f]._name&&void 0!=_[f]._value&&(u=' msgto="'+_[f]._value+'"')}break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:if(n='<i class="menu-column fa fa-check-circle" title="'+i+'"></i>',void 0!=l&&""!=l&&"object"==("undefined"==typeof l?"undefined":_typeof(l))){var p=l._filterCondition._columnFilterConditionList._array;if(void 0!=p&&"object"==("undefined"==typeof p?"undefined":_typeof(p)))for(var h=0;h<p.length;h++)"group_name"==p[h]._name&&void 0!=p[h]._value&&(u=' msgto="'+p[h]._value+'"')}break;case ColumnInformation.TYPE_COLUMN_RECENT:n='<i class="menu-column fa fa-exclamation" title="'+i+'"></i>';break;case ColumnInformation.TYPE_COLUMN_TOME:n='<i class="menu-column fa fa-at" title="'+e.getDisplayName()+'"></i>';break;case ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION:n='<i class="menu-column fa fa-comment" title="'+e.getDisplayName()+'"></i>';break;case ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE:n='<i class="menu-column fa fa-pie-chart" title="'+e.getDisplayName()+'"></i>';break;case ColumnInformation.TYPE_COLUMN_MURMUR:o="ico_user";var C=MurmurColumnInformation.getOwnJidFromSearchCondition(e),c=null;c=CubeeController.getInstance().getPersonData(C),t='jid="'+C+'"',s='id="'+C+'_icon"';var v=Resource.getMessage("Murmur");if(e._columnName&&(v=e._columnName),null!=c){var y=c.getUserName(),d=Utils.avatarCreate({type:"user",name:y});v=Utils.convertEscapedTag(v),ViewUtils.getAvatarUrl(c)==ViewUtils.DEFAULT_USER_AVATAR_SRC?(n='    <div class="menu-column no_img" style="background-color:'+d.color+'" title="'+v+" ("+c.getUserName()+')">',n+='      <div class="no_img_inner">'+d.name+"</div>",n+="    </div>"):n="<img "+s+' class="menu-column " src="'+r+'" title="'+v+" ("+c.getUserName()+')">'}else CubeeController.getInstance().getPersonDataByJidFromServer(C,function(t){for(var o=0;o<t.getCount();o++){var i=t.get(o);{if(null!=i){var a=ViewUtils.getAvatarUrl(i);e.setIconImage(a);var r=i.getUserName();if($('#menuIcons > li[jid="'+C+'"][columntype=18] > span.ico > div').remove(),"images/user_noimage.png"==a){var s=Utils.avatarCreate({type:"user",name:r});v=Utils.convertEscapedTag(v),n='    <div class="menu-column no_img" style="background-color:'+s.color+'" title="'+v+" ("+r+')">',n+='      <div class="no_img_inner">'+s.name+"</div>",n+="    </div>",$('#menuIcons > li[jid="'+C+'"][columntype=18] > span.ico').append(n)}else $('#menuIcons > li[jid="'+C+'"][columntype=18] > span.ico > img').length&&$('#menuIcons > li[jid="'+C+'"][columntype=18] > span.ico > img').remove(),$('#menuIcons > li[jid="'+C+'"][columntype=18] > span.ico').append('<img jid="'+C+'_icon" class="menu-column " src="'+a+'" title="'+v+" ("+r+')">');return}console.error("_person is null")}}});break;default:n="<img "+s+' class="menu-column " src="'+r+'" title="'+e.getDisplayName()+'">'}var T="<li "+t+" "+u+' columntype="'+a+'"  class="sortable-item"><span class="ico '+o+'">'+n+'</span><span class="name">'+i+"</span></li>";return T}function t(){return'<input type="image" class="newly-arrived button_column_notification" src="images/column_notification.png" />'}function n(){return'<input type="image" class="demamd-task  button_column_notification" src="images/demand_red.png" />'}ColumnIconView.prototype=$.extend({},IconAreaIconView.prototype);var o=(IconAreaIconView.prototype,ColumnIconView.prototype);o.getColumnInfo=function(){return this._columnInfo},o.initColumnIconView=function(t,n){var o=this;if(!t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return!1;o._columnInfo=t,o._columnType=t.getColumnType(),o._filterCondition=t.getFilterCondition();var i=e(t);if(null==n||"number"!=typeof n)ColumnIconArea.COLUM_ICON_SPARATOR_ELEMENT.before(i),o._iconElement=ColumnIconArea.COLUM_ICON_SPARATOR_ELEMENT.prev();else{var a=$("ul#menuIcons").eq(0);a.children().eq(n).before(i),o._iconElement=a.children().eq(n)}return o.updateTitle(),LayoutManager.isMobile&&LayoutManager.resetScreenLayout(),!0},o.cleanup=function(){var e=this;e._iconElement.off(),delete e._iconElement,delete e._columnType,delete e._filterCondition,delete e._columnInfo},o.showNotificationIcon=function(){if(null!=this._iconElement){var e=this._iconElement.children("input.newly-arrived");if(0==e.length){this._iconElement.append(t());var n=this._iconElement.children("input.newly-arrived");$(n).position({my:"right top",at:"right top",of:this._iconElement});var o=$(n).css("margin-top").replace("px",""),i=$(n).css("height").replace("px",""),a=o-i,r=500,s=Math.floor(r/6);$(n).animate({"margin-top":a+"px"},s,"easeOutCubic",function(){$(this).animate({"margin-top":o+"px"},s,"easeInCubic",function(){$(this).animate({"margin-top":a/2+"px"},s,"easeOutCubic",function(){$(this).animate({"margin-top":o+"px"},s,"easeInCubic",function(){$(this).animate({"margin-top":a/4+"px"},s,"easeOutCubic",function(){$(this).animate({"margin-top":o+"px"},s,"easeInCubic",function(){})})})})})})}}},o.removeColumnNotificationIcon=function(){null!=this._iconElement&&(this._iconElement.children("input.newly-arrived").remove(),View.getInstance().invalidBlinkTitleBar())},o.isMatchColumnInfo=function(e){var t=this,n=!1,o=e.getColumnType(),i=e.getFilterCondition();e.getSearchCondition();if(t._columnType!=o)return n;if(null!=i&&""!=i)t._filterCondition==i&&(n=!0);else if(t._columnType==ColumnInformation.TYPE_COLUMN_GROUP_CHAT){var a=e.getChatRoomInfomation(),r=t.getColumnInfo().getChatRoomInfomation();a.getRoomId()==r.getRoomId()&&(n=!0)}else if(t._columnType==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED){var s=e.getCommunityInfomation(),r=t.getColumnInfo().getCommunityInfomation();s.getRoomId()==r.getRoomId()&&(n=!0)}else if(t._columnType==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK){var s=e.getCommunityInfomation(),r=t.getColumnInfo().getCommunityInfomation();s.getRoomId()==r.getRoomId()&&(n=!0)}else n=!0;return n},o.updateTitle=function(){var e=this;null!=e._columnInfo&&e._iconElement.children(".menu-column").eq(0).attr("title",Utils.convertEscapedTag(e._columnInfo.getDisplayName()))},o.checkColumnImage=function(e,t){switch(t){case ColumnInformation.TYPE_COLUMN_CHAT:if(""==e||e==ViewUtils.DEFAULT_USER_AVATAR_SRC)return!0;break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:if(""==e||"images/community_onebit.png"==e)return!0;break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:if(""==e||"images/column_community_feed.png"==e)return!0}return!1},o.updateColumnIcon=function(){var e=this,t=!1;if(null!=e._columnInfo){var n=e._columnInfo.getIconImage(),o=Utils.convertEscapedTag(e._columnInfo.getDisplayName()),i=o,a=e._columnInfo.getDisplayName(),r=e._columnInfo.getColumnType(),s="";switch(r){case ColumnInformation.TYPE_COLUMN_CHAT:s="user",t=!0;break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:s="group",t=!0;break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:a=e._columnInfo.getCommunityInfomation().getRoomName(),i=Utils.convertEscapedTag(a),TabManager.getInstance().isActiveMyWorkplace()&&(o=i),s="project",t=!0;break;case ColumnInformation.TYPE_COLUMN_MURMUR:s="user",n!=ViewUtils.DEFAULT_USER_AVATAR_SRC&&(t=!0)}if(e._iconElement.find(".name").html(o),t)if(0==e._iconElement.find("img.menu-column").size()&&e.checkColumnImage(n,r)){var l=Utils.avatarCreate({type:s,name:a});e._iconElement.find("div.menu-column").attr({title:a,style:"background-color:"+l.color}),e._iconElement.find("div.menu-column > .no_img_inner").html(l.name)}else if(0==e._iconElement.find("img.menu-column").size()&&0==e.checkColumnImage(n,r)){var u='id="'+e._columnInfo.getFilterCondition()+'_icon"';e._iconElement.find("div.menu-column").remove(),e._iconElement.find("span.ico").append("<img "+u+' class="menu-column " src="'+n+'" title="'+a+'">')}else if(0!=e._iconElement.find("img.menu-column").size()&&e.checkColumnImage(n,r)){e._iconElement.find("img.menu-column").remove();var l=Utils.avatarCreate({type:s,name:a}),c='    <div class="menu-column no_img" style="background-color:'+l.color+'" title="'+a+'">';c+='      <div class="no_img_inner">'+l.name+"</div>",c+="    </div></span>",e._iconElement.find("span.ico").append(c)}else 0!=e._iconElement.find("img.menu-column").size()&&0==e.checkColumnImage(n,r)&&e._iconElement.find("img.menu-column").attr({src:n,title:a});else e._iconElement.find(".menu-column").attr("title",a)}},o.onUpdateDisplay=function(e){var t=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(t._columnType!=ColumnInformation.TYPE_COLUMN_TASK&&t._columnType!=ColumnInformation.TYPE_COLUMN_INBOX)return!1;var n=t._iconElement,o=n.find("input.newly-arrived");if($(o).length>0)return!1;var i=n.find("input.demamd-task");$(i).length>0&&$(i).remove();var a=ColumnManager.getInstance().checkDemandTask(t._columnInfo);return a&&t.showDemandIcon(),!0},o.onNewlyArrived=function(){var e=this,t=e._iconElement,n=t.find("input.demamd-task");$(n).length>0&&$(n).remove(),e.showNotificationIcon(),View.getInstance().validBlinkTitleBar(800,View.getInstance().getTitle(),View.getInstance().getBlinkTitle())},o.showDemandIcon=function(){if(null!=this._iconElement){var e=this._iconElement.children("input.demamd-task");0==e.length&&(this._iconElement.append(n()),e=this._iconElement.children("input.demamd-task")),$(e).position({my:"right bottom",at:"right bottom",of:this._iconElement})}},$(function(){$("#menuIcons").on("click","li.sortable-item",function(){if(null!=$(this).data("longtapped"))return void $(this).data("longtapped",null);var e=$(this),t=$(e).index();ColumnManager.getInstance().bringColumnIntoView(t);var n=$(e).children("input.newly-arrived");if($(n).length>0){var o=-1;o=$(e).parent().find("li > input.newly-arrived").length-1,$(n).remove(),0==o&&View.getInstance().invalidBlinkTitleBar()}ColumnManager.getInstance().attentionColumn(t,!0);var i=ColumnIconArea.getInstance().getIconColumnInfo(t);null!=i&&NotificationIconManager.getInstance().onColumnClicked(i)}),$("#menuIcons").on("sortstart",function(e,t){var n=t.item.index();ColumnIconArea.getInstance().startSortIcon(n)}),$("#menuIcons").on("sortupdate",function(e,t){var n=t.item.index();ColumnIconArea.getInstance().updateSortIcon(n),ColumnManager.getInstance().bringColumnIntoView(n),ColumnManager.getInstance().attentionColumn(n,!0)}),$("#menuIcons").on("longtap","img.menu-column,div.menu-column,i.menu-column",function(e){$(this).data("longtapped","true")})})}(),function(){NotificationIconView.prototype=$.extend({},IconAreaIconView.prototype);var e=(IconAreaIconView.prototype,NotificationIconView.prototype);e.getType=function(){return this._type},e._init=function(e){var t=this;t._setType()},e.getHtmlElement=function(){var e=this;return e._htmlElement},e.updateNotificationArea=function(e){var t=this;t._addNotificationCount(t._count+1)},e._addNotificationCount=function(e){if(!(null==e||"number"!=typeof e||0>e)){var t=this,n=t._htmlElement,o=n.children(".notification-count");t._count=e,o.text(e)}},e._getIconPath=function(){return"images/notice_blue.png"},e.onLogin=function(){}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ChatNotificationIconView.prototype=$.extend({},NotificationIconView.prototype,ViewCore.prototype);var e=NotificationIconView.prototype,t=ChatNotificationIconView.prototype;t._init=function(t){var n=this;e._init.call(n,t),n._createNotificationTooltip(t)},t.updateNotificationArea=function(t){var n=this;e.updateNotificationArea.call(n,t);var o=n._jidList.set(t.getFrom(),n._jidList.getByKey()+1);o||n._jidList.add(t.getFrom(),new Number(1)),n.updateNotificationTooltipMessage(t)},t._getIconPath=function(){return"images/column_chat_notice.png"},t._setType=function(){var e=this;e._type=ColumnInformation.TYPE_COLUMN_CHAT},t._createNotificationTooltip=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=this,n=t._htmlElement,o=function(o){var i=o,a=e.getFrom(),r=n.find("[jid='"+a+"']");r.length>0&&r.parent("li").off().remove(),n.append(i);var s=n.find("[jid='"+a+"']");return t._addEventClick(s),NotificationIconManager.getInstance().addAttention(),!0};t._notificationTooltipHtml(e,o)},t.updateNotificationTooltipMessage=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=this,n=function(n){var o=t._htmlElement,i=n,a=e.getFrom(),r=o.find("[jid='"+a+"']");r.length>0&&r.parent("li").off().remove(),o.append(i),t._addEventClick(o.find("[jid='"+a+"']"))};t._notificationTooltipMessageHtml(e,n)},t._notificationTooltipHtml=function(e,t){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return"";if(null==t||"function"!=typeof t)return"";var n=this,o=function(e){t(e)};n._notificationTooltipMessageHtml(e,o)},t._notificationTooltipMessageHtml=function(e,t){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return"";if(null==t||"function"!=typeof t)return"";var n=this,o=n._htmlElement,i=e.getFrom(),a=function(e){var n="",a=ViewUtils.getAvatarUrl(null);if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var r=e.getByKey(i);n=r.getUserName(),a=ViewUtils.getAvatarUrl(r)}var s=o.find("[jid='"+i+"']"),l=0;s.length>0&&(l=s.find(".count").html()),l++;var u="<li>";if(u+='<a jid="'+i+'" class="text_btn">',u+='<span class="ico ico_user">',a!=ViewUtils.DEFAULT_USER_AVATAR_SRC)u+='<img src="'+a+'">';else{var c=Utils.avatarCreate({type:"user",name:n});u+='    <div class="no_img" style="background-color:'+c.color+'" title="'+Utils.convertEscapedHtml(n)+'">',u+='      <div class="no_img_inner">'+c.name+"</div>",u+="    </div>"}u+="</span>",u+='<span class="name">'+Utils.convertEscapedHtml(n)+'</span>(<span class="count">'+l+"</span>"+Resource.getMessage("notification_items")+")",u+="</a></li>",t(u)};return CubeeController.getInstance().getPersonDataByJidFromServer(i,a)},t._addEventClick=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this;e.on("click",function(){var e=$(this).attr("jid");t._onListItemClicked(e),ColumnManager.getInstance().addChatColumn(e,!0)})}},t._onListItemClicked=function(e){var t=this,n=t._htmlElement,o=n.find("[jid='"+e+"']");o.length<=0||(o.parent("li").off().remove(),t._jidList.removeByKey(e),NotificationIconManager.getInstance().removeNotificationIcon(t),0!=$("#left_sidebar .contact_list").find('li[jid="'+e+'"]').find(".new_message_notice").size()&&ViewUtils.unsetNewNoticeMark($("#left_sidebar .contact_list").find('li[jid="'+e+'"]')),NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[jid="'+e+'"][columntype="3"].sortable-item .ico'))},t.onAddColumn=function(e){var t=this,n=t._htmlElement,o=n.children(".notification-count"),i=e.getFilterCondition(),a=n.children(".mTip").children(".notification_list"),r=a.children("[jid='"+i+"']");r.remove(),t._jidList.removeByKey(_selectedJid),0==t._count?NotificationIconManager.getInstance().removeNotificationIcon(t):o.text(t._count)},t.onColumnClicked=function(e){var t=this,n=e.getColumnType();if(t.getType()==n){var o=e.getFilterCondition();null!=o&&"string"==typeof o&&""!=o&&t._onListItemClicked(o)}}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){TaskNotificationIconView.prototype=$.extend({},NotificationIconView.prototype,ViewCore.prototype);var e=NotificationIconView.prototype,t=TaskNotificationIconView.prototype;t._init=function(t){var n=this;e._init.call(n,t),n._createNotificationTooltip(t)},t.updateNotificationArea=function(t){var n=this;e.updateNotificationArea.call(n,t),n.updateNotificationTooltipMessage(t)},t._setType=function(){var e=this;e._type=ColumnInformation.TYPE_COLUMN_TASK},t._createNotificationTooltip=function(e){var t=this,n=t._htmlElement,o=function(e){var o=e,i=n.find(".alert_mytask");i.length>0&&i.parent("li").off().remove(),n.append(o);var a=n.find(".alert_mytask");return t._addEventClick(a),NotificationIconManager.getInstance().addAttention(),!0};t._notificationTooltipHtml(e,o)},t.makeNumber=function(e){var t=this,n="";return t.getNormalTask()>0&&(n='(<span class="count">'+t.getNormalTask()+"</span>"+Resource.getMessage("notification_items")+")"),t.getDemandTask()>0&&(n+="("+t.getDemandTask()+Resource.getMessage("notification_items")+")"),n},t.setNormalTask=function(e){var t=this;t._normalTask=e},t.getNormalTask=function(){var e=this;return e._normalTask},t.setDemandData=function(e){var t=this,n=t._htmlElement,o=n.find(".alert_mytask");t._demandTask=e.getByKey(ColumnInformation.TYPE_COLUMN_TASK.toString()),"0"==t.getTaskCount().toString()?t._onListItemClicked():o.find(".number").html(t.makeNumber())},t.getDemandTask=function(){var e=this;return e._demandTask},t.getTaskCount=function(){var e=this;return e.getNormalTask()+e.getDemandTask()},t.updateNotificationTooltipMessage=function(e){var t=this,n=function(e){var n=t._htmlElement,o=e,i=n.find(".alert_mytask");i.length>0&&i.parent("li").off().remove(),n.append(o),t._addEventClick(n.find(".alert_mytask"))};t._notificationTooltipMessageHtml(e,n)},t._notificationTooltipHtml=function(e,t){if(null==t||"function"!=typeof t)return"";var n=this,o=function(e){t(e)};n._notificationTooltipMessageHtml(e,o)},t._notificationTooltipMessageHtml=function(e,t){if(null==t||"function"!=typeof t)return"";var n=this,o=n._htmlElement;o.find(".alert_mytask");null!=e&&n.setNormalTask(n.getNormalTask()+1);var i='<li class="sortable-item">';i+='<a  class="alert_mytask text_btn">',i+='<span class="ico ico_system">',i+='<i class="menu-column fa fa-check" title=""></i>',i+="</span>",i+='<span class="name"></span><span class="number">'+n.makeNumber()+"</span>",i+="</a></li>",t(i)},t._addEventClick=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this;e.on("click",function(){function e(){var e=ColumnManager.getInstance();e.addTaskColumn("",!0)}TabManager.getInstance().isActiveMyWorkplace()?e():TabManager.getInstance().activeMyWorkplaceTab(e),t._onListItemClicked()})}},t._onListItemClicked=function(){var e=this,t=e._htmlElement,n=t.find(".alert_mytask");n.length<=0||(e.setNormalTask(0),"0"==e.getTaskCount().toString()||NotificationSettingManager.getInstance().isSetting(ColumnInformation.TYPE_COLUMN_TASK,"")?(n.parent("li").off().remove(),NotificationIconManager.getInstance().removeNotificationIcon(e),NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[columntype="'+ColumnInformation.TYPE_COLUMN_TASK+'"].sortable-item .ico_system')):n.find(".number").html(e.makeNumber()))},t.onColumnClicked=function(e){var t=this,n=e.getColumnType();t.getType()==n&&t._onListItemClicked()}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){InboxNotificationIconView.prototype=$.extend({},NotificationIconView.prototype,ViewCore.prototype);var e=NotificationIconView.prototype,t=InboxNotificationIconView.prototype;t._init=function(t){var n=this;e._init.call(n,t),n._createNotificationTooltip(t)},t.updateNotificationArea=function(t){var n=this;e.updateNotificationArea.call(n,t),n.updateNotificationTooltipMessage(t)},t._setType=function(){var e=this;e._type=ColumnInformation.TYPE_COLUMN_INBOX},t._createNotificationTooltip=function(e){var t=this,n=t._htmlElement,o=function(e){var o=e,i=n.find(".alert_inbox");i.length>0&&i.parent("li").off().remove(),n.append(o);var a=n.find(".alert_inbox");return t._addEventClick(a),NotificationIconManager.getInstance().addAttention(),!0};t._notificationTooltipHtml(e,o)},t.makeNumber=function(e){var t=this,n="";return t.getNormalTask()>0&&(n='(<span class="count">'+t.getNormalTask()+"</span>"+Resource.getMessage("notification_items")+")"),t.getDemandTask()>0&&(n+="("+t.getDemandTask()+Resource.getMessage("notification_items")+")"),n},t.setNormalTask=function(e){var t=this;t._normalTask=e},t.getNormalTask=function(){var e=this;return e._normalTask},t.setDemandData=function(e){var t=this,n=t._htmlElement,o=n.find(".alert_inbox");t._demandTask=e.getByKey(ColumnInformation.TYPE_COLUMN_INBOX.toString()),0==t.getTaskCount()?t._onListItemClicked():o.find(".number").html(t.makeNumber())},t.getDemandTask=function(){var e=this;return e._demandTask},t.getTaskCount=function(){var e=this;return e.getNormalTask()+e.getDemandTask()},t.updateNotificationTooltipMessage=function(e){var t=this,n=function(e){var n=t._htmlElement,o=e,i=n.find(".alert_inbox");i.length>0&&i.parent("li").off().remove(),n.append(o),t._addEventClick(n.find(".alert_inbox"))};t._notificationTooltipMessageHtml(e,n)},t._notificationTooltipHtml=function(e,t){if(null==t||"function"!=typeof t)return"";var n=this,o=function(e){t(e)};n._notificationTooltipMessageHtml(e,o)},t._notificationTooltipMessageHtml=function(e,t){if(null==t||"function"!=typeof t)return"";var n=this,o=n._htmlElement;o.find(".alert_inbox");null!=e&&n.setNormalTask(n.getNormalTask()+1);var i='<li class="sortable-item">';i+='<a  class="alert_inbox text_btn">',i+='<span class="ico ico_system">',i+='<i class="menu-column fa fa-archive" title=""></i>',i+="</span>",i+='<span class="name"></span><span class="number">'+n.makeNumber()+"</span>",i+="</a></li>",t(i)},t._addEventClick=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this;e.on("click",function(){function e(){var e=ColumnManager.getInstance();e.addInboxColumn(!0)}TabManager.getInstance().isActiveMyWorkplace()?e():TabManager.getInstance().activeMyWorkplaceTab(e),t._onListItemClicked()})}},t._onListItemClicked=function(){var e=this,t=e._htmlElement,n=t.find(".alert_inbox");n.length<=0||(e.setNormalTask(0),0==e.getTaskCount()||NotificationSettingManager.getInstance().isSetting(ColumnInformation.TYPE_COLUMN_INBOX,"")?(n.parent("li").off().remove(),NotificationIconManager.getInstance().removeNotificationIcon(e),NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[columntype="'+ColumnInformation.TYPE_COLUMN_INBOX+'"].sortable-item .ico_system')):n.find(".number").html(e.makeNumber()))},t.onColumnClicked=function(e){var t=this,n=e.getColumnType();t.getType()==n&&t._onListItemClicked()}}(),function(){MentionNotificationIconView.prototype=$.extend({},NotificationIconView.prototype);var e=(NotificationIconView.prototype,MentionNotificationIconView.prototype);e._addEventHandler=function(){var e=this,t=e._htmlElement;t.click(function(){if(console.log("MentionNotificationIconView::_addEventHandler  click!"),TabManager.getInstance().isActiveMyWorkplace())ColumnManager.getInstance().addColumnInfo(e._type,!0,!0),NotificationIconManager.getInstance().removeNotificationIcon(e);else{var t=function(t){t&&ColumnManager.getInstance().addColumnInfo(e._type,!0,!0)};TabManager.getInstance().activeMyWorkplaceTab(t)}})},e._getIconPath=function(){return"images/notice_green.png"},e._setType=function(){var e=this;e._type=ColumnInformation.TYPE_COLUMN_MENTION},e.onAddColumn=function(e){var t=this;NotificationIconManager.getInstance().removeNotificationIcon(t)},e.onColumnClicked=function(e){var t=this,n=e.getColumnType();t.getType()==n&&NotificationIconManager.getInstance().removeNotificationIcon(t)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ToMeNotificationIconView.prototype=$.extend({},NotificationIconView.prototype,ViewCore.prototype);var e=NotificationIconView.prototype,t=ToMeNotificationIconView.prototype;t._init=function(t){var n=this;e._init.call(n,t),n._createNotificationTooltip(t)},t.updateNotificationArea=function(t){var n=this;e.updateNotificationArea.call(n,t),n.updateNotificationTooltipMessage(t)},t._setType=function(){var e=this;e._type=ColumnInformation.TYPE_COLUMN_TOME},t._createNotificationTooltip=function(e){var t=this,n=t._htmlElement,o=function(e){var o=e,i=n.find(".alert_tome");i.length>0&&i.parent("li").off().remove(),n.append(o);var a=n.find(".alert_tome");return t._addEventClick(a),NotificationIconManager.getInstance().addAttention(),!0};t._notificationTooltipHtml(e,o)},t.updateNotificationTooltipMessage=function(e){var t=this,n=function(e){var n=t._htmlElement,o=e,i=n.find(".alert_tome");i.length>0&&i.parent("li").off().remove(),n.append(o),t._addEventClick(n.find(".alert_tome"))};t._notificationTooltipMessageHtml(e,n)},t._notificationTooltipHtml=function(e,t){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return"";if(null==t||"function"!=typeof t)return"";var n=this,o=function(e){t(e)};n._notificationTooltipMessageHtml(e,o)},t._notificationTooltipMessageHtml=function(e,t){if(null==t||"function"!=typeof t)return"";var n=this,o=n._htmlElement,i=o.find(".alert_tome"),a=0;i.length>0&&(a=i.find(".count").html()),a++;var r='<li class="sortable-item">';r+='<a  class="alert_tome text_btn">',r+='<span class="ico ico_system">',r+='<i class="menu-column fa fa-at" title=""></i>',r+="</span>",r+='<span class="name"></span>(<span class="count">'+a+"</span>"+Resource.getMessage("notification_items")+")",r+="</a></li>",t(r)},t._addEventHandler=function(){var e=this,t=e._htmlElement;t.click(function(){if(console.log("ToMeNotificationIconView::_addEventHandler  click!"),TabManager.getInstance().isActiveMyWorkplace())ColumnManager.getInstance().addColumnInfo(e._type,!0,!0),NotificationIconManager.getInstance().removeNotificationIcon(e);else{var t=function(t){t&&ColumnManager.getInstance().addColumnInfo(e._type,!0,!0)};TabManager.getInstance().activeMyWorkplaceTab(t)}})},t._addEventClick=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this;e.on("click",function(){function e(){var e=ColumnManager.getInstance();e.addColumnInfo(ColumnInformation.TYPE_COLUMN_TOME,!0),t._onListItemClicked()}TabManager.getInstance().isActiveMyWorkplace()?e():TabManager.getInstance().activeMyWorkplaceTab(e)})}},t._onListItemClicked=function(){var e=this,t=e._htmlElement,n=t.find(".alert_tome");n.length<=0||(n.parent("li").off().remove(),NotificationIconManager.getInstance().removeNotificationIcon(e),NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[columntype="'+ColumnInformation.TYPE_COLUMN_TOME+'"].sortable-item .ico_system'))},t.onColumnClicked=function(e){var t=this,n=e.getColumnType();t.getType()==n&&t._onListItemClicked()},t._getIconPath=function(){return"images/notice_tome.png"},t.onAddColumn=function(e){var t=this;NotificationIconManager.getInstance().removeNotificationIcon(t)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){GroupChatNotificationIconView.prototype=$.extend({},NotificationIconView.prototype);var e=NotificationIconView.prototype,t=GroupChatNotificationIconView.prototype;t._setType=function(){var e=this;e._type=ColumnInformation.TYPE_COLUMN_GROUP_CHAT},t._getIconPath=function(){return"images/notice_blue.png"},t._init=function(t){if(null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var n=this;e._init.call(n,t),n._toolTipView=new GroupChatNotificationToolTipView(n,t)}},t._addNotificationCount=function(e){},t.onNotificationRecieved=function(e){var t=this;t.updateNotificationArea(e)},t.updateNotificationArea=function(e){var t=this,n=t._toolTipView;n.onNotificationRecieved(e)},t.onToolTipUpdated=function(){var e=this,t=e._toolTipView.getCount();return 0==t?void NotificationIconManager.getInstance().removeNotificationIcon(e):void 0},t.getHtmlElement=function(){return this._htmlElement},t.onAddColumn=function(e){var t=this;t._toolTipView.onAddColumn(e)},t.onUpdateRoomInfoNotificationRecieved=function(e){var t=this,n=t._toolTipView;n.onUpdateRoomInfoNotificationRecieved(e)},t.onColumnClicked=function(e){var t=this,n=e.getColumnType();if(t.getType()==n){var o=t._toolTipView;null!=o&&o.onColumnClicked(e)}}}(),function(){MailNotificationIconView.prototype=$.extend({},NotificationIconView.prototype);var e=(NotificationIconView.prototype,MailNotificationIconView.prototype);e._addEventHandler=function(){var e=this,t=e._htmlElement;t.click(function(){if(console.log("MailNotificationIconView::_addEventHandler  click!"),TabManager.getInstance().isActiveMyWorkplace())ColumnManager.getInstance().addMailColumn(!0,!0),NotificationIconManager.getInstance().removeNotificationIcon(e);else{var t=function(e){e&&ColumnManager.getInstance().addMailColumn(!0,!0)};TabManager.getInstance().activeMyWorkplaceTab(t)}})},e._getIconPath=function(){return"images/mail_box.png"},e._setType=function(){var e=this;e._type=ColumnInformation.TYPE_COLUMN_MAIL},e.onAddColumn=function(e){var t=this;NotificationIconManager.getInstance().removeNotificationIcon(t)},e.onColumnClicked=function(e){var t=this,n=e.getColumnType();t.getType()==n&&NotificationIconManager.getInstance().removeNotificationIcon(t)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){CommunityNotificationIconView.prototype=$.extend({},NotificationIconView.prototype);var e=NotificationIconView.prototype,t=CommunityNotificationIconView.prototype;
t._setType=function(){var e=this;e._type=ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED},t._getIconPath=function(){return"images/notice_red.png"},t._init=function(t){if(null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var n=this;e._init.call(n,t),n._toolTipView=new CommunityNotificationToolTipView(n,t,this._communityInfo)}},t._addNotificationCount=function(e){},t.onNotificationRecieved=function(e){var t=this;t.updateNotificationArea(e)},t.updateNotificationArea=function(e){var t=this,n=t._toolTipView;n.onNotificationRecieved(e)},t._updateNotificationCount=function(e){},t.onToolTipUpdated=function(){var e=this,t=e._toolTipView.getCount();return 0==t?void NotificationIconManager.getInstance().removeNotificationIcon(e):void 0},t.getHtmlElement=function(){return this._htmlElement},t.onAddColumn=function(e){var t=this;t._toolTipView.onAddColumn(e)},t.onColumnClicked=function(e){var t=this,n=e.getColumnType();if(t.getType()==n){var o=t._toolTipView;null!=o&&o.onColumnClicked(e)}}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=GroupChatNotificationToolTipView.prototype;e._init=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this,n=t._parent.getHtmlElement(),o=t._getHtml();t._htmlElement=n.append(o);var i=t._createToolTipItemView(e);null!=i&&t._itemViewList.insert(0,i)}},e.destruct=function(){var e=this,t=e._htmlElement;t&&t.unbind().remove()},e._getHtml=function(){var e="";return e+='<div class="notification_list"></div>'},e.getHtmlElement=function(){return this._htmlElement},e.getCount=function(){return this._itemViewList.getCount()},e.onNotificationRecieved=function(e){var t=this,n=e.getRoomInfo(),o=n.getRoomId(),i=t._getToolTipItemViewIdxsByRoomId(o),a=t._checkUpdateExistToolTipItem(e);if(!a)return void t._addToolTipItemView(e);for(var r=i.getCount(),s=e.getSubType(),l=0;r>l;l++){var u=i.get(l),c=t._itemViewList.get(u),d=c.getType();if(s==d){t._updateToolTipItemView(u);break}}},e._checkUpdateExistToolTipItem=function(e){var t=this,n=!1,o=e.getRoomInfo(),i=o.getRoomId(),a=t._getToolTipItemViewIdxsByRoomId(i),r=a.getCount();if(0==r)return n;for(var s=e.getSubType(),l=0;r>l;l++){var u=a.get(l),c=t._itemViewList.get(u),d=c.getType();if(s==d){n=!0;break}}return n},e._addToolTipItemView=function(e){var t=this,n=t._createToolTipItemView(e);t._itemViewList.insert(0,n),t._parent.onToolTipUpdated()},e._updateToolTipItemView=function(e){var t=this,n=t._itemViewList.get(e);null!=n&&n.onNotificationRecieved()},e._getToolTipItemViewIdxsByRoomId=function(e){for(var t=this,n=new ArrayList,o=t._itemViewList,i=o.getCount(),a=0;i>a;a++){var r=t._itemViewList.get(a),s=r.getRoomId();s==e&&n.add(a)}return n},e._createToolTipItemView=function(e){var t=this,n=e.getSubType(),o=e.getRoomInfo(),i=ViewUtils.getGroupChatColumnInfo(o),a=null;switch(n){case GroupChatNotification.SUB_TYPE_MESSAGE:a=new GroupChatMessageNotificationToolTipItemView(t,i);break;case GroupChatNotification.SUB_TYPE_CREATE_ROOM:a=new GroupChatCreateRoomNotificationToolTipItemView(t,i);break;case GroupChatNotification.SUB_TYPE_ADD_MEMBER:a=new GroupChatAddMemberNotificationToolTipItemView(t,i);break;case GroupChatNotification.SUB_TYPE_REMOVE_MEMBER:var r=!1,s=e.getRemovedMemberList(),l=LoginUser.getInstance().getJid(),u=s.getCount();for(_j=0;_j<u;_j++)if(l==s.get(_j)){r=!0;for(var c=e.getRoomInfo().getRoomId(),d=t._getToolTipItemViewIdxsByRoomId(c),u=d.getCount(),g=0;u>g;g++){var m=d.get(g),a=t._itemViewList.get(m);a.removeHtmlElement()}for(var _=t._itemViewList.getCount(),f=_;f>0;f--){var m=f-1,p=t._itemViewList.get(m),h=p.getRoomId();c==h&&t._itemViewList.remove(m)}break}a=new GroupChatRemoveMemberNotificationToolTipItemView(t,i,r);break;case GroupChatNotification.SUB_TYPE_UPDATE_ROOM_INFO:for(var C=e.getUpdatedItems(),g=0;g<C.length;g++)switch(C[g]){case GroupChatInfoUpdateNotification.SUB_TYPE_CHANGE_ROOM_NAME:a=new GroupChatUpdateRoomNameNotificationToolTipItemView(t,i,e.getPreviousRoomName())}break;case GroupChatNotification.SUB_TYPE_AUTHORITY_CHANGED:a=new GroupChatAuthorityChanagedNotificationToolTipItemView(t,i)}return a},e.onListItemClicked=function(e){var t=this;t._removeTooltipItem(e)},e._removeTooltipItem=function(e){for(var t=this,n=t._parent,o=t._getToolTipItemViewIdxsByRoomId(e),i=o.getCount(),a=0;i>a;a++){var r=o.get(a),s=t._itemViewList.get(r);s.removeHtmlElement()}for(var l=t._itemViewList.getCount(),u=l;u>0;u--){var r=u-1,c=t._itemViewList.get(r),d=c.getRoomId();e==d&&t._itemViewList.remove(r)}0!=$("#groupChatList").find('a[roomid="'+e+'"]').children(".new_message_notice").size()&&ViewUtils.unsetNewNoticeMark($("#groupChatList").find('a[roomid="'+e+'"]').parent("li")),n.onToolTipUpdated()},e.onUpdateRoomInfoNotificationRecieved=function(e){for(var t=this,n=e.getRoomInfo(),o=n.getRoomId(),i=t._getToolTipItemViewIdxsByRoomId(o),a=i.getCount(),r=0;a>r;r++){var s=i.get(r),l=t._itemViewList.get(s),u=l.getColumnInfo();u.setChatRoomInfomation(n),l.onUpdateRoomInfoNotificationRecieved()}},e.onAddColumn=function(e){var t=this,n=e.getChatRoomInfomation(),o=n.getRoomId();t._removeTooltipItem(o)},e.onColumnClicked=function(e){var t=this,n=e.getColumnType();if(ColumnInformation.TYPE_COLUMN_GROUP_CHAT==n){var o=e.getChatRoomInfomation();if(null!=o){var i=o.getRoomId();t.onListItemClicked(i)}}}}(),function(){GroupChatNotificationToolTipItemView.TYPE_UNKOWN=0,GroupChatNotificationToolTipItemView.TYPE_MESSAGE=1,GroupChatNotificationToolTipItemView.TYPE_CREATE_ROOM=2,GroupChatNotificationToolTipItemView.TYPE_ADD_MEMBER=3,GroupChatNotificationToolTipItemView.TYPE_UPDATE_ROOM_NAME=4,GroupChatNotificationToolTipItemView.TYPE_REMOVE_MEMBER_NOT_INCLUDE_OWN=5,GroupChatNotificationToolTipItemView.TYPE_REMOVE_MEMBER_INCLUDE_OWN=6,GroupChatNotificationToolTipItemView.TYPE_AUTHORITY_CHANGED=7,GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_NAME="span",GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_ELEMENT_START="<"+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_NAME+">",GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_ELEMENT_END="</"+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_NAME+">",GroupChatNotificationToolTipItemView.COUNT_DEFAULT_UNIT_NAME=Resource.getMessage("notification_items"),GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_CLASS_COUNT="count",GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_CLASS_ROOM_NAME="room_name",GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_COUNT_ELEMENT_START="<"+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_NAME+' class="'+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_CLASS_COUNT+'">',GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_ROOM_NAME_ELEMENT_START="<"+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_NAME+' class="'+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_CLASS_ROOM_NAME+'">';var e=GroupChatNotificationToolTipItemView.prototype;e._init=function(){var e=this,t=e._parent.getHtmlElement(),n=e._getHtml();t.prepend(n),e._htmlElement=t.children(":first"),e._count+=1,e._updateCount(e._count),e._addCreateEvent()},e.destruct=function(){var e=this,t=e._htmlElement;t&&t.unbind().remove()},e.getColumnInfo=function(){return this._columnInfo},e.removeHtmlElement=function(){var e=this,t=e._htmlElement;t&&t.unbind().remove()},e._addCreateEvent=function(){var e=this,t=e._htmlElement,n=e._columnInfo,o=n.getChatRoomInfomation(),i=o.getRoomId(),a=o.getParentRoomId();o.getRoomName();t.on("click",function(){var t=e._parent;if(t.onListItemClicked(i),e.getType()!=GroupChatNotificationToolTipItemView.TYPE_REMOVE_MEMBER_INCLUDE_OWN){var o=function(){"myworkplace"!=$(".project_btn").attr("data_value")?$("#project").find('a[data_value="myworkplace"]').trigger("click",e._columnInfo):ColumnManager.getInstance().addColumn(e._columnInfo,!0,!0)};if(""!=a){var r=function(t){if(t&&"object"==("undefined"==typeof t?"undefined":_typeof(t)))if($(".project_btn").attr("data_value")!=a){var i=function(e){function t(){ColumnManager.getInstance().addColumn(n,!0,!0)}TabManager.getInstance().selectOrAddTabByCommunityInfo(a,e,t)};CubeeController.getInstance().getCommunityInfo(a,i)}else ColumnManager.getInstance().addColumn(e._columnInfo,!0,!0);else o()};CubeeController.getInstance().getCommunityInfo(a,r)}else o();i&&NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[msgto="'+i+'"][columntype="'+ColumnInformation.TYPE_COLUMN_GROUP_CHAT+'"].sortable-item .ico_group')}})},e._getHtml=function(){var e=this,t='<li><a class="txt_btn"> ';t+='<span class="ico ico_group">';var n=Utils.avatarCreate({type:"group",name:e._getRoomName()});return t+='<div class="no_img" style="background-color:'+n.color+'">',t+='<div class="no_img_inner">'+n.name+"</div>",t+="</div>",t+="</span>",t+=GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_ROOM_NAME_ELEMENT_START,t+=e._getRoomNameHtml(),t+=GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_ELEMENT_END,t+=e._getNotificationInfoHtml(),t+="</a></li>"},e.onNotificationRecieved=function(){var e=this;e._count+=1,e._updateCount(e._count)},e.onUpdateRoomInfoNotificationRecieved=function(){var e=this;e._updateRoomName()},e._updateRoomName=function(){var e=this,t=e._htmlElement,n=e._columnInfo.getChatRoomInfomation().getRoomName();t.find(GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_NAME+"."+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_CLASS_ROOM_NAME).text(n)},e._updateCount=function(e){var t=this,n=t._htmlElement;n.find(GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_NAME+"."+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_CLASS_COUNT).text(e)},e._getRoomName=function(){var e=this,t=e._columnInfo,n=t.getChatRoomInfomation(),o=n.getRoomName(),i=o;return i},e._getRoomNameHtml=function(){var e=this,t=e._columnInfo,n=t.getChatRoomInfomation(),o=Utils.convertEscapedHtml(n.getRoomName()),i=o;return i},e._getNotificationInfoHtml=function(){return""},e.getRoomId=function(){var e=this,t=e._columnInfo,n=t.getChatRoomInfomation(),o=n.getRoomId(),i=o;return i},e.getType=function(){return this._type}}(),function(){var e=function(){};e.prototype=GroupChatNotificationToolTipItemView.prototype,GroupChatMessageNotificationToolTipItemView.prototype=new e;var t=(e.prototype,GroupChatMessageNotificationToolTipItemView.prototype);t._getNotificationInfoHtml=function(){var e="( "+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_COUNT_ELEMENT_START+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_ELEMENT_END+GroupChatNotificationToolTipItemView.COUNT_DEFAULT_UNIT_NAME+" )";return e}}(),function(){var e=function(){};e.prototype=GroupChatNotificationToolTipItemView.prototype,GroupChatCreateRoomNotificationToolTipItemView.prototype=new e;var t=(e.prototype,GroupChatCreateRoomNotificationToolTipItemView.prototype);t._getNotificationInfoHtml=function(){return"( "+Resource.getMessage("group_chat_notification_join")+" )"}}(),function(){var e=function(){};e.prototype=GroupChatNotificationToolTipItemView.prototype,GroupChatAddMemberNotificationToolTipItemView.prototype=new e;var t=(e.prototype,GroupChatAddMemberNotificationToolTipItemView.prototype);t._getNotificationInfoHtml=function(){var e="( "+Resource.getMessage("group_chat_notification_add_member")+"  "+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_COUNT_ELEMENT_START+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_ELEMENT_END+GroupChatNotificationToolTipItemView.COUNT_DEFAULT_UNIT_NAME+" )";return e}}(),function(){var e=function(){};e.prototype=GroupChatNotificationToolTipItemView.prototype,GroupChatUpdateRoomNameNotificationToolTipItemView.prototype=new e;var t=(e.prototype,GroupChatUpdateRoomNameNotificationToolTipItemView.prototype);t._getNotificationInfoHtml=function(){var e=this,t=e._columnInfo._chatRoomInfomation;return"( "+t.getPreRoomName()+" "+Resource.getMessage("group_chat_notification_update_room_name")+" )"}}(),function(){GroupChatRemoveMemberNotificationToolTipItemView.prototype=$.extend({},GroupChatNotificationToolTipItemView.prototype);var e=(GroupChatNotificationToolTipItemView.prototype,GroupChatRemoveMemberNotificationToolTipItemView.prototype);e._getNotificationInfoHtml=function(){var e=this,t=Resource.getMessage("group_chat_notification_remove_member");e.getType()==GroupChatNotificationToolTipItemView.TYPE_REMOVE_MEMBER_INCLUDE_OWN&&(t=Resource.getMessage("group_chat_notification_remove_member_own"));var n="( "+t+"  "+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_COUNT_ELEMENT_START+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_ELEMENT_END+GroupChatNotificationToolTipItemView.COUNT_DEFAULT_UNIT_NAME+" )";return n}}(),function(){GroupChatAuthorityChanagedNotificationToolTipItemView.prototype=$.extend({},GroupChatNotificationToolTipItemView.prototype);var e=(GroupChatNotificationToolTipItemView.prototype,GroupChatAuthorityChanagedNotificationToolTipItemView.prototype);e._getNotificationInfoHtml=function(){var e=Resource.getMessage("group_chat_notification_change_authority"),t="( "+e+"  "+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_COUNT_ELEMENT_START+GroupChatNotificationToolTipItemView.COUNT_AREA_TAG_ELEMENT_END+GroupChatNotificationToolTipItemView.COUNT_DEFAULT_UNIT_NAME+" )";return t}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){CommunityNotificationToolTipItemView.TYPE_UNKOWN=0,CommunityNotificationToolTipItemView.TYPE_CHANGE_INFO=1,CommunityNotificationToolTipItemView.TYPE_MESSAGE=2,CommunityNotificationToolTipItemView.TYPE_AUTHORITY_CHANGED=3,CommunityNotificationToolTipItemView.COUNT_AREA_TAG_NAME="span",CommunityNotificationToolTipItemView.COUNT_AREA_TAG_ELEMENT_START="<"+CommunityNotificationToolTipItemView.COUNT_AREA_TAG_NAME+">",CommunityNotificationToolTipItemView.COUNT_AREA_TAG_ELEMENT_END="</"+CommunityNotificationToolTipItemView.COUNT_AREA_TAG_NAME+">",CommunityNotificationToolTipItemView.COUNT_DEFAULT_UNIT_NAME=Resource.getMessage("notification_items"),CommunityNotificationToolTipItemView.COUNT_AREA_TAG_CLASS_COUNT="count",CommunityNotificationToolTipItemView.COUNT_AREA_TAG_CLASS_ROOM_NAME="room_name",CommunityNotificationToolTipItemView.COUNT_AREA_TAG_COUNT_ELEMENT_START="<"+CommunityNotificationToolTipItemView.COUNT_AREA_TAG_NAME+' class="'+CommunityNotificationToolTipItemView.COUNT_AREA_TAG_CLASS_COUNT+'">',CommunityNotificationToolTipItemView.COUNT_AREA_TAG_ROOM_NAME_ELEMENT_START="<"+CommunityNotificationToolTipItemView.COUNT_AREA_TAG_NAME+' class="'+CommunityNotificationToolTipItemView.COUNT_AREA_TAG_CLASS_ROOM_NAME+'">';var e=CommunityNotificationToolTipItemView.prototype;e._init=function(){var e=this,t=e._parent.getHtmlElement(),n=e._getHtml();t.prepend(n),e._htmlElement=t.children(":first"),e._count+=1,e._updateCount(e._count),e._addCreateEvent()},e.destruct=function(){var e=this,t=e._htmlElement;t&&t.unbind().remove()},e.getCommunityId=function(){return this._communityId},e.getCommunityName=function(){return this._communityName},e.getCommunityImage=function(){return this._communityImage},e.removeHtmlElement=function(){var e=this,t=e._htmlElement;t&&t.unbind().remove()},e._addCreateEvent=function(){var e=this,t=e._htmlElement;t.on("click",function(){e._toolTipItemClicked($(this))})},e._toolTipItemClicked=function(e){var t=this,n=t.getCommunityId();NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[msgto="'+n+'"][columntype="'+ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED+'"].sortable-item .ico_project');var o=t._parent;o.onListItemClicked(n)},e._getHtml=function(){var e=this,t='<li><a class="txt_btn">';if(t+='<span class="ico ico_project">',""==e.getCommunityImage()){var n=Utils.avatarCreate({type:"project",name:e._getRoomName()});t+='<div class="no_img" style="background-color:'+n.color+'">',t+='<div class="no_img_inner">'+n.name+"</div>",t+="</div>"}else t+='<img src="'+e.getCommunityImage()+'">';return t+="</span>",t+=CommunityNotificationToolTipItemView.COUNT_AREA_TAG_ROOM_NAME_ELEMENT_START,t+=e._getRoomNameHtml(),t+=CommunityNotificationToolTipItemView.COUNT_AREA_TAG_ELEMENT_END,t+=e._getNotificationInfoHtml(),t+="</a></li>"},e.onNotificationRecieved=function(){var e=this;e._count+=1,e._updateCount(e._count)},e.onUpdateCommynityInfoNotificationRecieved=function(e){var t=this;t._updateCommunityName(e)},e._updateCommunityName=function(e){var t=this,n=t._htmlElement,o=e.getRoomName();n.find(CommunityNotificationToolTipItemView.COUNT_AREA_TAG_NAME+"."+CommunityNotificationToolTipItemView.COUNT_AREA_TAG_CLASS_ROOM_NAME).text(o),t._communityName=o},e._updateCount=function(e){var t=this,n=t._htmlElement;n.find(CommunityNotificationToolTipItemView.COUNT_AREA_TAG_NAME+"."+CommunityNotificationToolTipItemView.COUNT_AREA_TAG_CLASS_COUNT).text(e)},e._getRoomName=function(){var e=this,t=e.getCommunityName(),n=t;return n},e._getRoomNameHtml=function(){var e=this,t=Utils.convertEscapedHtml(e.getCommunityName()),n=t;return n},e._getNotificationInfoHtml=function(){return""},e.getType=function(){return this._type}}(),function(){var e=function(){};e.prototype=CommunityNotificationToolTipItemView.prototype,CommunityInfoChangeNotificationToolTipItemView.prototype=new e;var t=(e.prototype,CommunityInfoChangeNotificationToolTipItemView.prototype);t._getNotificationInfoHtml=function(){var e="( "+Resource.getMessage("community_notification_change_info")+"  "+CommunityNotificationToolTipItemView.COUNT_AREA_TAG_COUNT_ELEMENT_START+CommunityNotificationToolTipItemView.COUNT_AREA_TAG_ELEMENT_END+CommunityNotificationToolTipItemView.COUNT_DEFAULT_UNIT_NAME+" )";return e}}(),function(){var e=function(){};e.prototype=CommunityNotificationToolTipItemView.prototype,CommunityMessageNotificationToolTipItemView.prototype=new e;var t=(e.prototype,CommunityMessageNotificationToolTipItemView.prototype);t._getNotificationInfoHtml=function(){var e="( "+CommunityNotificationToolTipItemView.COUNT_AREA_TAG_COUNT_ELEMENT_START+CommunityNotificationToolTipItemView.COUNT_AREA_TAG_ELEMENT_END+CommunityNotificationToolTipItemView.COUNT_DEFAULT_UNIT_NAME+" )";return e}}(),function(){var e=function(){};e.prototype=CommunityNotificationToolTipItemView.prototype,CommunityAuthorityChangedNotificationToolTipItemView.prototype=new e;var t=(e.prototype,CommunityAuthorityChangedNotificationToolTipItemView.prototype);t._getNotificationInfoHtml=function(){var e="( "+Resource.getMessage("community_notification_change_authority")+"  "+CommunityNotificationToolTipItemView.COUNT_AREA_TAG_COUNT_ELEMENT_START+CommunityNotificationToolTipItemView.COUNT_AREA_TAG_ELEMENT_END+CommunityNotificationToolTipItemView.COUNT_DEFAULT_UNIT_NAME+" )";return e}}(),function(){function e(e){var t=CommunityNotificationToolTipItemView.TYPE_UNKOWN,n=e.getSubType();switch(n){case CommunityNotification.SUB_TYPE_UPDATE_ROOM_INFO:case CommunityNotification.SUB_TYPE_ADD_MEMBER:case CommunityNotification.SUB_TYPE_REMOVE_MEMBER:break;case CommunityNotification.SUB_TYPE_UPDATE_OWNER:break;case CommunityNotification.SUB_TYPE_MESSAGE:t=CommunityNotificationToolTipItemView.TYPE_MESSAGE;break;case CommunityNotification.SUB_TYPE_AUTHORITY_CHANGED:}return t}var t=[];t[CommunityNotificationToolTipItemView.TYPE_CHANGE_INFO]=CommunityInfoChangeNotificationToolTipItemView,t[CommunityNotificationToolTipItemView.TYPE_MESSAGE]=CommunityMessageNotificationToolTipItemView,t[CommunityNotificationToolTipItemView.TYPE_AUTHORITY_CHANGED]=CommunityAuthorityChangedNotificationToolTipItemView;var n=CommunityNotificationToolTipView.prototype;n._init=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this,n=t._parent.getHtmlElement(),o=t._getHtml();t._htmlElement=n.append(o);var i=t._createToolTipItemView(e);null!=i&&t._itemViewList.insert(0,i)}},n.destruct=function(){var e=this,t=e._htmlElement;t&&t.unbind().remove()},n._getHtml=function(){var e="";return e+='<div class="notification_list"></div>'},n.getHtmlElement=function(){return this._htmlElement},n.getCount=function(){return this._itemViewList.getCount()},n.onNotificationRecieved=function(t){var n=this,o=n._getCommunityIdAndCommunityNameFromCommunityNotification(t)[0],i=n._getToolTipItemViewIdxsByCommunityId(o),a=n._checkUpdateExistToolTipItem(t);if(!a)return void n._addToolTipItemView(t);for(var r=i.getCount(),s=(t.getSubType(),0);r>s;s++){var l=i.get(s),u=n._itemViewList.get(l),c=u.getType(),d=e(t);if(d==c){n._updateToolTipItemView(l);break}}},n._checkUpdateExistToolTipItem=function(t){var n=this,o=!1,i=n._getCommunityIdAndCommunityNameFromCommunityNotification(t)[0],a=n._getToolTipItemViewIdxsByCommunityId(i),r=a.getCount();if(0==r)return o;for(var s=(t.getSubType(),0);r>s;s++){var l=a.get(s),u=n._itemViewList.get(l),c=u.getType(),d=e(t);if(d==c){o=!0;break}}return o},n._addToolTipItemView=function(e){var t=this,n=t._createToolTipItemView(e);t._itemViewList.insert(0,n),t._parent.onToolTipUpdated()},n._updateToolTipItemView=function(e){var t=this,n=t._itemViewList.get(e);null!=n&&n.onNotificationRecieved()},n._getToolTipItemViewIdxsByCommunityId=function(e){for(var t=this,n=new ArrayList,o=t._itemViewList,i=o.getCount(),a=0;i>a;a++){var r=t._itemViewList.get(a),s=r.getCommunityId();s==e&&n.add(a)}return n},n._createToolTipItemView=function(n){var o=this,i=(n.getSubType(),null),a=e(n),r=o._getCommunityIdAndCommunityNameFromCommunityNotification(n),s=t[a];return null==s||""==r[0]?null:i=new s(o,r[0],r[1],r[2])},n.onListItemClicked=function(e){function t(t){function n(){var e=new CommunityFeedColumnInformation;e.setColumnType(ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED),e.setCommunityInfomation(t),ColumnManager.getInstance().addColumn(e,!0,!0)}$(".project_btn").attr("data_value")==e?n():TabManager.getInstance().selectOrAddTabByCommunityInfo(e,t,n)}var n=this;CubeeController.getInstance().getCommunityInfo(e,t),n._removeTooltipItem(e)},n._removeTooltipItem=function(e){for(var t=this,n=t._parent,o=t._getToolTipItemViewIdxsByCommunityId(e),i=o.getCount(),a=0;i>a;a++){var r=o.get(a),s=t._itemViewList.get(r);s.removeHtmlElement()}for(var l=t._itemViewList.getCount(),u=l;u>0;u--){var r=u-1,c=t._itemViewList.get(r),d=c.getCommunityId();e==d&&t._itemViewList.remove(r)}n.onToolTipUpdated()},n.onUpdateNotificationRecieved=function(e){},n.onAddColumn=function(e){var t=this,n=e.getChatRoomInfomation(),o=n.getRoomId();t._removeTooltipItem(o)},n.onColumnClicked=function(e){var t=this,n=e.getColumnType();if(ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED==n){var o=e.getCommunityInfomation();if(null!=o){for(var i=o.getRoomId(),a=t._parent,r=t._getToolTipItemViewIdxsByCommunityId(i),s=r.getCount(),l=0;s>l;l++){var u=r.get(l),c=t._itemViewList.get(u);c.getType()==CommunityNotificationToolTipItemView.TYPE_MESSAGE&&c.removeHtmlElement()}for(var d=t._itemViewList.getCount(),g=d;g>0;g--){var u=g-1,m=t._itemViewList.get(u),_=m.getCommunityId();if(i==_){if(m.getType()!=CommunityNotificationToolTipItemView.TYPE_MESSAGE)continue;t._itemViewList.remove(u)}}a.onToolTipUpdated()}}},n._getCommunityIdAndCommunityNameFromCommunityNotification=function(e){var t=this,n=t._parent,o=e.getSubType(),i="",a="",r="";switch(o){case CommunityNotification.SUB_TYPE_UPDATE_ROOM_INFO:case CommunityNotification.SUB_TYPE_ADD_MEMBER:case CommunityNotification.SUB_TYPE_UPDATE_OWNER:break;case CommunityNotification.SUB_TYPE_REMOVE_MEMBER:case CommunityNotification.SUB_TYPE_MESSAGE:var s=e.getCommunityMessage();i=s.getTo(),a=s.getRoomName(),r=n._communityInfo.getLogoUrl();break;case CommunityNotification.SUB_TYPE_AUTHORITY_CHANGED:}return[i,a,r]}}(),function(){RightSlideContainerView.prototype=$.extend({},SlideContainerView.prototype);var e=(SlideContainerView.prototype,new RightSlideContainerView);RightSlideContainerView.getInstance=function(){return e};var t=RightSlideContainerView.prototype;t.resizeButton=function(){var e=$("body").outerHeight(!0),t=$("#mainHeader").outerHeight(!0),n=e-t,o=$("#mainContainer"),i=parseInt(o.css("marginTop"))+parseInt(o.css("marginBottom")),a=parseInt(o.css("borderTopWidth"))+parseInt(o.css("borderBottomWidth")),r=parseInt(o.css("paddingTop"))+parseInt(o.css("paddingBottom")),s=n-i-a-r,l=$("#toggler > button");l.css("height",s),ViewUtils.isIE8()&&l.css("width","12px")},$(function(){var e=$("#toggler > button"),t=$("#listInnerContainer"),n=$("#listContainer");e.button({icons:{primary:"ui-icon-triangle-1-e"},text:!1}),e.on("click",function(){t.toggle("slide",{direction:"right"},100,function(){var t="";-1==e.find("span:first").attr("class").indexOf("ui-icon-triangle-1-w")?(t="ui-icon-triangle-1-w",n.removeClass("listcontainer-width")):(t="ui-icon-triangle-1-e",n.addClass("listcontainer-width")),e.button({icons:{primary:t},text:!1}),View.getInstance().resizeContent()})})})}(),function(){var e=BaseSideListViewImpl.prototype;e.init=function(e){var t=this;return t._listContainerElm=$("#listContainer"),t._listInnerContainerElm=t._listContainerElm.children("#listInnerContainer"),null==t._tabInfo&&(null!=e?t._tabInfo=e:t._tabInfo={type:TabItemView.TYPE_UNKNOWN,columnListId:"",extras:{}}),null==t._accordionView&&(t._accordionView=(new AccordionView).init()),t},e.refresh=function(){var e=this;e._accordionView.removeDom();var t=e._accordionView.createFrame();e._listInnerContainerElm.append(t),e._accordionView.showInnerFrame()},e.resizeContents=function(){var e=this;if(e._accordionView.resizeAreaForSubView(),ViewUtils.isIE89()){var t=e._accordionView.getHtmlElement(),n=$("#userProfile").outerHeight(!0),o=e._listInnerContainerElm.outerHeight(!0),i=o-n;t.height(i),e._accordionView.resizeAreaForIE89()}e._accordionView.resizeContent()},e.onProfileChanged=function(e){var t=this;if(t.sidebarParts)for(var n=0;n<t.sidebarParts.length;n++)t.sidebarParts[n].onProfileChanged(e)},e.onNotification=function(e){var t=this;if(t.sidebarParts)for(var n=0;n<t.sidebarParts.length;n++)t.sidebarParts[n].onNotification(e)},e.notifyChatMessage=function(e){var t=this;if(t.sidebarParts)for(var n=0;n<t.sidebarParts.length;n++)"function"==typeof t.sidebarParts[n].notifyChatMessage&&t.sidebarParts[n].notifyChatMessage(e)},e.setAccordionParts=function(e){var t=this;t._accordionView.cleanUp(),t._accordionView.addPartsList(e)},e.cleanUp=function(){var e=this;null!=e._accordionView&&(e._accordionView.cleanUp(),e._accordionView=null),e._listContainerElm=null,e._listInnerContainerElm=null}}(),function(){MyWorkPlaceSideListViewImpl.prototype=$.extend({},BaseSideListViewImpl.prototype);var e=BaseSideListViewImpl.prototype,t=MyWorkPlaceSideListViewImpl.prototype;t.init=function(t){var n=this;e.init.call(n,t);var o=(new GroupChatListView).init({mode:"sidebar"});o.showInnerFrame(function(){$("#groupChatList > .sidebar_list").append(o._frame)});var i=(new ContactListView).init();return i.showInnerFrame(function(){$(".contact_list .sidebar_list").append(i._frame)}),n.sidebarParts=[o,i],n}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=new SideListView;SideListView.getInstance=function(){return e};var t=SideListView.prototype;t.refreshContents=function(e,t){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var n=this,o=null;n._sideListViewImpl&&(o=n._sideListViewImpl.sidebarParts[1],"object"!=("undefined"==typeof o?"undefined":_typeof(o))&&(o=null),n._sideListViewImpl.cleanUp()),n._sideListViewImpl=e.init(t,o),n._sideListViewImpl.refresh()}},t.resizeContents=function(){var e=this;null!=e._sideListViewImpl&&e._sideListViewImpl.resizeContents()},t.onProfileChanged=function(e){var t=this;null!=t._sideListViewImpl&&t._sideListViewImpl.onProfileChanged(e)},t.onNotification=function(e){var t=this;if(null!=t._sideListViewImpl){if(e.getType()==Notification_model.TYPE_GROUP_CHAT){if("function"==typeof e.getGroupChatMessage){var n=e.getGroupChatMessage(),o=NotificationSettingManager.getInstance();if(o.isSetting(ColumnInformation.TYPE_COLUMN_GROUP_CHAT,n.getTo()))return}}else if(e.getType()==Notification_model.TYPE_QUESTIONNAIRE){if(e.getQuestionnaireMessage().getRoomType()!=Message.TYPE_GROUP_CHAT)return;var o=NotificationSettingManager.getInstance();if(o.isSetting(ColumnInformation.TYPE_COLUMN_GROUP_CHAT,e.getQuestionnaireMessage().getRoomId()))return}t._sideListViewImpl.onNotification(e)}},t.notifyChatMessage=function(e){var t=this;if(null!=t._sideListViewImpl){var n=NotificationSettingManager.getInstance(),o=e.getFrom();n.isSetting(ColumnInformation.TYPE_COLUMN_CHAT,o)||t._sideListViewImpl.notifyChatMessage(e)}},t.addChatMember=function(e,t){var n=this;null!=n._sideListViewImpl&&n._sideListViewImpl.sidebarParts[1].addChatMember(e,t)}}(),function(){var e=SideMenuParts.prototype;e.init=function(){var e=this;return e},e.getHtmlElement=function(){return this._frame},e.createFrame=function(){var e=this,t=$();return e._frame=t,t},e.showInnerFrame=function(e){setTimeout(function(){null!=e&&"function"==typeof e&&e()},1)},e.resizeContent=function(){},e.onProfileChanged=function(e){},e.onNotification=function(e){},e._createEventHandler=function(){},e.cleanUp=function(){var e=this,t=e._frame;null!=t&&(t.find("*").off(),t.remove(),e._frame=null)}}(),function(){AccordionView.prototype=$.extend({},SideMenuParts.prototype);var e=SideMenuParts.prototype,t=AccordionView.prototype;t.cleanUp=function(){for(var t=this,n=t._partsList,o=(n.length,0);o<n.length;o++){var i=n[o];null!=i&&i.cleanUp()}t._partsList=new Array,e.cleanUp.call(t),t._activePats&&t._activePats.cleanUp()},t.removeDom=function(){var e=this;null!=e._frame&&(e._frame.remove(),e._frame=null)},t.addPartsList=function(e){var t=this,n=t._partsList.concat(e);t._partsList=n},t.createFrame=function(){var e=this,t='<dl class="accordion box-border olient-vertical flex1"></dl>',n=$(t);return e._frame=n,n},t.showInnerFrame=function(){function e(){}for(var t=this,n=t._partsList,o=(n.length,0);o<n.length;o++){var i=n[o];if(null!=i){var a=i.viewPartsListHeader?" "+i.viewPartsListHeader:"",r='<dt class="ui-widget-header list-header'+a+'">'+i.getHeaderDisplayName()+"</dt>",s=$(r);t._frame.append(s);var l=i.createFrame(),u=$('<dd class="box-border olient-vertical flex1'+a+'"></dd>');u.append(l),u.css("display","none"),t._frame.append(u),i.showInnerFrame(e)}}t._frame.children("dd:first").css("display",""),t._activePats=n[0],t._frame.children("dt").on("click",function(){if("none"==$("+dd",this).css("display")){for(var e=t._frame.children("dd"),n=0,o=0;o<e.length;o++)if("none"!=e.eq(o).css("display")){n=e.eq(o).css("height");break}$("+dd",this).css("height",n);var i=t._notifyBeforeActivate($("+dd",this));t._frame.children("dd").slideUp(),$("+dd",this).slideDown("normal",function(){t._notifyActivate(i),t._activePats=i,t.resizeContent()})}}),t.resizeContent()},t.resizeContent=function(){var e=this;if(null!=e._frame)for(var t=e._partsList,n=0;n<t.length;n++){var o=t[n];null!=o&&"none"!=e._frame.children("dd").eq(n).css("display")&&o.resizeContent()}},t.resizeAreaForIE89=function(){if(ViewUtils.isIE89()){var e=this;if(null!=e._frame){var t=e._frame,n=t.outerHeight(!0),o=0,i=e._frame.children("dt");i.each(function(){o+=$(this).outerHeight(!0)});var a=n-o;e._frame.children("dd").height(a);for(var r=e._partsList,s=(r.length,0);s<r.length;s++){var l=r[s];null!=l&&l.resizeAreaForIE89()}}}},t.resizeAreaForSubView=function(){for(var e=this,t=e._partsList,n=(t.length,0);n<t.length;n++){var o=t[n];null!=o&&o.resizeAreaForSubView(e._activePats)}},t.onProfileChanged=function(e){function t(){if(!(a>=i)){var n=o[a];null!=n&&n.onProfileChanged(e),a++,setTimeout(t,r)}}var n=this;if(null!=n._frame){var o=n._partsList,i=o.length,a=0,r=10;setTimeout(t,r)}},t.onNotification=function(e){function t(){if(!(a>=i)){var n=o[a];
null!=n&&n.onNotification(e),a++,setTimeout(t,r)}}var n=this;if(null!=n._frame){var o=n._partsList,i=o.length,a=0,r=10;setTimeout(t,r)}},t._notifyBeforeActivate=function(e){var t=this,n=null,o=null;if(e.find(".contact-list-for-community-top").length>0?n=ContactListForCommunityView:e.find(".contact-list-top").length>0?n=ContactListView:e.find(".list-groupchat").length>0?n=GroupChatListView:e.find(".list-community").length>0?n=CommunityListView:e.find(".list-community-member").length>0?n=CommunityMemberListView:e.find(".community-detail").length>0&&(n=CommunityDetailsView),!n)return null;for(var i=0;i<t._partsList.length;i++)if(t._partsList[i]instanceof n){o=t._partsList[i];break}for(var a=0;a<t._partsList.length;a++)t._partsList[a].beforeActivate.call(t._partsList[a],o);return o},t._notifyActivate=function(e){var t=this;if(e){for(var n=0;n<t._partsList.length;n++)t._partsList[n].activate.call(t._partsList[n],e);return e}}}(),function(){SideMenuAccordionParts.prototype=$.extend({},SideMenuParts.prototype);var e=(SideMenuParts.prototype,SideMenuAccordionParts.prototype);e.getHeaderDisplayName=function(){var e=this;return e._headerDisplayName},e.resizeAreaForIE89=function(){if(ViewUtils.isIE89()){var e=this;if(null!=e._frame){var t=e._frame,n=t.parent(),o=n.outerHeight(!0);t.height(o)}}},e.beforeActivate=function(e){},e.activate=function(e){},e.resizeAreaForSubView=function(e){var t=this;if(t._subView&&e&&e===t){var n=$("#toggler").outerWidth();$("#listContainer").outerWidth()>n?t._subView.show():t._subView.hide()}}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(){SideListView.getInstance().resizeContents()}GroupChatStartFormView.DEFAULT_CHAT_NAME=Resource.getMessage("default_group_chat_suffix");var t=GroupChatStartFormView.prototype;t.cleanUp=function(){var e=this,t=e.getHtmlElement();t&&(t.find("*").off(),t.off(),t.find("*").remove(),t.remove()),e._htmlElement=null,e._parent=null,e._chatroomInfo=null},t._getChatRoomInfo=function(){return this._chatroomInfo},t._setChatRoomInfo=function(e){this._chatroomInfo=e},t.getHtmlElement=function(){return this._htmlElement},t._createEventHandler=function(){var e=this,t=e.getHtmlElement();if(t){var n=t.find(".action-chatroom-form-button > button#cancel-chat");n.click(function(){e._clickCancelButton()});var o=t.find(".action-chatroom-form-button > button#start-chat");o.click(function(){e._clickStartButton()})}},GroupChatStartFormView.getHtml=function(){var e="";return e+='<div class="box-border flex1 olient-vertical start-chatroom-form-border hide-view">',e+='<div class="start-chatroom-form">',e+='<div class="start-chatroom-form-item form-title">'+Resource.getMessage("group_chat_start_title")+"</div>",e+='<div class="start-chatroom-form-item form-caption">'+Resource.getMessage("group_chat_start_explain")+"</div>",e+="<div>",e+='<div class="box-border start-chatroom-form-item chatroom-name olient-horizontal width-100">',e+='<div class="start-chatroom-form-label-title">'+Resource.getMessage("group_chat_start_label_title")+"</div>",e+='<input name="room-name" class="ui-corner-all form-input-chatname" maxlength="50">',e+="</div>",e+='<div class="box-border start-chatroom-form-item olient-horizontal width-100">',e+='<div class="start-chatroom-form-label-count">'+Resource.getMessage("group_chat_start_label_selected_users")+"</div>",e+='<div class="selected-count"></div>',e+="</div>",e+="</div>",e+='<div class="start-chatroom-form-item start-chatroom-form-button-center action-chatroom-form-button">',e+='<button id="start-chat" class="start-chatroom-form-btn  ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only">',e+='<span class="ui-button-text">'+Resource.getMessage("group_chat_start_label_start_button")+"</span></button>",e+='<button id="cancel-chat" class="start-chatroom-form-btn  ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only">',e+='<span class="ui-button-text">'+Resource.getMessage("group_chat_start_label_cancel_button")+"</span></button>",e+="</div>",e+="</div>",e+="</div>"},t._clickCancelButton=function(){var e=this;e._parent.cancelSelectedUserListAll()},t._clickStartButton=function(){function e(e){console.log("create chatroom : "+e)}var t=this;t.getHtmlElement();t._isValidationOk()&&(t._setCreateChatRoomInfo(),1==CubeeController.getInstance().createChatRoom(t._getChatRoomInfo(),e)?t._clickCancelButton():console.log("faild to create chatroom"))},t._setCreateChatRoomInfo=function(){var e=this,t=new ChatRoomInformation,n=e.getHtmlElement(),o=e._parent.getSelectedUserList(),i=LoginUser.getInstance().getJid(),a=n.find(".chatroom-name > input");t.setRoomName(a.val());for(var r=o.getCount(),s=0;r>s;s++)t.addMemberList(o.get(s));t.addMemberList(i),t.setCreatedBy(i),e._setChatRoomInfo(t)},t.showStartForm=function(){var t=this,n=t.getHtmlElement();t._setRoomName(),t.updateSelectedCount(),n.show("slow",function(){e()})},t.hideStartForm=function(){var t=this,n=t.getHtmlElement();n.hide("slow",function(){e()})},t._setRoomName=function(){var e=this,t=e.getHtmlElement(),n=t.find(".chatroom-name > input"),o=Utils.getDate(Utils.DISPLAY_STANDARD_DATE_FORMAT);o+=" "+GroupChatStartFormView.DEFAULT_CHAT_NAME,n.removeClass("input-error"),n.val(o)},t.updateSelectedCount=function(){var e=this,t=e.getHtmlElement(),n=e._parent.getSelectedUserList().getCount(),o=t.find(".selected-count");o.html(n+Resource.getMessage("group_chat_start_selected_users_count_suffix"))},t._isValidationOk=function(){var e=this,t=!0,n=e.getHtmlElement(),o=n.find(".chatroom-name > input"),i=o.val();return o.removeClass("input-error"),(""==i||""==Utils.trimStringMulutiByteSpace(i))&&(t=!1,o.addClass("input-error")),t}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t){var n=t.getJid();e.updateContactListPresence(n)}function t(e,t){var n=t.getJid();e.updateContactListProfile(n)}ContactListView.SELECTED_AVATARS_AREA_CLS_NAME="selected_users_area",ContactListView._VIEW_PARTS_LIST_HEADER="contact-list-header",ContactListView.prototype=$.extend({},SideMenuAccordionParts.prototype);var n=SideMenuAccordionParts.prototype,o=ContactListView.prototype;o.init=function(e){var t=this;return t.opts=e,n.init.call(t),t._headerDisplayName=Resource.getMessage("ContactList"),t._callbacks={getSelectedUserList:t.getSelectedUserList.bind(t),addSelectedUserList:t.addSelectedUserList.bind(t),removeSelectedUserList:t.removeSelectedUserList.bind(t),removeSelectedUserListAll:t.removeSelectedUserListAll.bind(t),onRemoveView:t.onRemoveView.bind(t),searchExecuteFromAllUser:t.searchExecuteFromAllUser.bind(t),onAddContactListMemberSuccessCallback:t.onAddContactListMemberSuccessCallback.bind(t),onRemoveContactListMemberSuccessCallback:t.onRemoveContactListMemberSuccessCallback.bind(t),onAddFavoriteMemberSuccessCallback:t.onAddFavoriteMemberSuccessCallback.bind(t),onRemoveFavoriteListMemberSuccessCallback:t.onRemoveFavoriteMemberSuccessCallback.bind(t)},t._userListView=new ContactListMemberView(t.VIEW_PARTS_TYPE,t._callbacks),t._subParts=[t._subView,t._userListView,t._searchView,t._searchResultView],t.createFrame(),t},o.cleanUp=function(){var e=this;n.cleanUp.call(e),e._startChatFormObj&&(e._startChatFormObj.cleanUp(),e._startChatFormObj=null),e._selectedUserList&&(e._selectedUserList.removeAll(),e._selectedUserList=null),e._headerDisplayName=null,e._userListView&&(e._userListView.cleanUp(),e._userListView=null),e._subView&&(e._subView.cleanUp(),e._subView=null),e._searchView&&(e._searchView.cleanUp(),e._searchView=null),e._searchResultView&&(e._searchResultView.cleanUp(),e._searchResultView=null)},o.createFrame=function(){var e=this,t='<div class="sidebar_list '+this.VIEW_PARTS_TYPE+'-top box-border olient-vertical flex1"></div>',n=e._userListView._frame,o=$(t).append(n);return e._frame=o,o},o.showInnerFrame=function(e){var t=this,n=ContactList.getInstance();return t._userListView._asyncShowPersonList(n,e,t.opts)},o.moreAddPerson=function(e){var t=this,n=ContactList.getInstance();return t._userListView._addContactListDialog(n,e)};var i={};i[ProfileChangeNotice.TYPE_PRESENCE]=e,i[ProfileChangeNotice.TYPE_PROFILE]=t,o.onProfileChanged=function(e){var t=this,n=e.getType(),o=Utils.getSafeValue(i,n,function(){});o(t,e)},o.updateContactListPresence=function(e){if(null==e||"string"!=typeof e)return!1;var t=CubeeController.getInstance().getContactListData(e);if(null==t)return!1;var n=this,o=n.getHtmlElement(),i=o.find("li[jid='"+e+"']");if(i){var a=n._userListView._createHtmlOnePersonFromPersonData(t),r=!1;0!=i.find(".new_message_notice").size()&&(r=!0),i.replaceWith(a),r&&ViewUtils.setNewNoticeMark(o.find("li[jid='"+e+"']").children("a"))}return!0},o.updateContactListProfile=function(e){if(null==e||"string"!=typeof e)return!1;var t=CubeeController.getInstance().getContactListData(e);if(null==t)return!1;var n=this,o=n.getHtmlElement(),i=o.find("li[jid='"+e+"']");if(i){var a=n._userListView._createHtmlOnePersonFromPersonData(t),r=!1;0!=i.find(".new_message_notice").size()&&(r=!0),i.replaceWith(a),r&&ViewUtils.setNewNoticeMark(o.find("li[jid='"+e+"']").children("a"))}return!0},o.resizeContent=function(){var e=this,t=e.getHtmlElement();if(null!=t&&"none"!=t.css("display")&&(e._subParts.forEach(function(e){e&&e.resizeContent&&e.resizeContent()}),ViewUtils.isIE89())){var n=t.outerWidth(!0);t.find(".contact-list-box").width(n),t.find(".list-contact").css("overflow-x","hidden")}},o.resizeAreaForIE89=function(){var e=this;ViewUtils.isIE89()&&(e._subParts.forEach(function(e){e&&e.resizeAreaForIE89&&e.resizeAreaForIE89()}),e._subView&&e._subView.setListInnerContainerScrollForIE89())},o.getSelectedUserList=function(){return this._subView?this._subView.getSelectedUserList():new ArrayList},o.addSelectedUserList=function(e){var t=this;null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(t._subView||(t._subView=new ContactListSubView(t.VIEW_PARTS_TYPE,t._callbacks),$("#listInnerContainer").append(t._subView._frame)),t._subView.addSelectedUserList(e),t._subView.show(),t.notifyChangeSelectedUserList())},o.removeSelectedUserList=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&t._subView&&(t._subView.removeSelectedUserList(e),t.notifyChangeSelectedUserList(),0==t.getSelectedUserList().getCount())){t._subView.hide(),t._subView.cleanUp(),t._subView=null;var n=$("#listContainer #"+t.VIEW_PARTS_TYPE+"-subview");n.length>0&&n.remove()}},o.removeSelectedUserListAll=function(){var e=this;if(e._subView){e._subView.removeSelectedUserListAll(),e.notifyChangeSelectedUserList(),e._subView.hide(),e._subView.cleanUp(),e._subView=null;var t=$("#listContainer #"+e.VIEW_PARTS_TYPE+"-subview");t.length>0&&t.remove()}},o.notifyChangeSelectedUserList=function(){var e=this,t=e.getSelectedUserList();[e._subView,e._userListView,e._searchResultView].forEach(function(e){e&&e.receivedChangeSelectedUser(t)})},o.beforeActivate=function(e){var t=this;e instanceof ContactListView||t._subView&&t._subView.hide()},o.activate=function(e){var t=this;e instanceof ContactListView&&t._subView&&t._subView.show()},o.searchExecute=function(e,t){var n=this;if("number"==typeof e&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){if(n._searchResultView)n._searchResultView.initialize(t);else{var o={condition:t,isOpenSearchResultView:function(){return n._isOpenSearchResultView},selectedTabIndex:function(){return n._searchView._selectedTabIndex},lastExecSearchTabIndex:function(){return n._searchView._lastExecSearchTabIndex}};n._searchResultView=new SearchPersonResultView(n.VIEW_PARTS_TYPE,o,n._callbacks),n._frame.append(n._searchResultView._frame)}switch(e){case SearchPersonView.TAB_TYPE_INNER_SEARCH:n.searchExecuteFromContactListUser(t);break;case SearchPersonView.TAB_TYPE_ALL_USER_SEARCH:n.searchExecuteFromAllUser(t)}}},o.searchExecuteFromContactListUser=function(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this;if(t._searchResultView){var n=ContactList.getInstance();setTimeout(function(){ViewUtils.searchUserExecute(n,e,function(e){t._searchResultView&&t._searchResultView._asyncShowPersonList&&t._searchResultView._asyncShowPersonList(e,function(){t._searchResultView._refreshSearchResultList(e),t.notifyChangeSelectedUserList()})})},1),t.switchActiveView(1),t._searchResultView.getHtmlElement().addClass("hide-view"),ViewUtils.showLoadingIcon(t._searchResultView.getHtmlElement())}}},o.searchExecuteFromAllUser=function(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this;if(t._searchResultView){var n=t._searchResultView._currentLoadedJidForAllUserSearch,o=function(e){var n=e;n||(n=new SearchResultPersonList),t._searchResultView&&t._searchResultView.onSearchPersonCallback&&t._searchResultView.onSearchPersonCallback(n,function(){t.notifyChangeSelectedUserList()})},i=t._searchView.searchAllUser(n,e,o);i&&(t.switchActiveView(1),0==n&&t._searchResultView.getHtmlElement().addClass("hide-view"),ViewUtils.showLoadingIcon(t._searchResultView.getHtmlElement()))}}},o.switchActiveView=function(e){var t=this;switch(e){case 0:$("."+t.VIEW_PARTS_TYPE).removeClass("hide-view"),$("."+t.VIEW_PARTS_TYPE+"-search-result").addClass("hide-view"),t._isOpenSearchResultView=!1;break;case 1:$("."+t.VIEW_PARTS_TYPE).addClass("hide-view"),$("."+t.VIEW_PARTS_TYPE+"-search-result").removeClass("hide-view"),t._isOpenSearchResultView=!0}return e},o.onRemoveView=function(){var e=this;e.switchActiveView(0),e._searchResultView=null},o.onAddContactListMemberSuccessCallback=function(e){var t=this;if(t.removeSelectedUserListAll(),e){var n=e.addSuccessMemberList;t._subParts.forEach(function(e){e&&e.notifyAddContactListMemberCallBack&&e.notifyAddContactListMemberCallBack(n)})}},o.onRemoveContactListMemberSuccessCallback=function(e){var t=this;if(t.removeSelectedUserListAll(),e){var n=e.removeSuccessMemberList;t._subParts.forEach(function(e){e&&e.notifyRemoveContactListMemberCallBack&&e.notifyRemoveContactListMemberCallBack(n)})}},o.onAddFavoriteMemberSuccessCallback=function(e,t){this._userListView.notifyAddFavoriteMemberCallBack(e,t)},o.onRemoveFavoriteMemberSuccessCallback=function(e,t){this._userListView.notifyRemoveFavoriteMemberCallBack(e,t)},o.notifyChatMessage=function(e){var t=this;if(e){var n=e.getFrom(),o=e.getTo(),i=LoginUser.getInstance().getJid(),a=i==n?o:n,r=!1;n!=i&&(r=!0),t.addChatMember(a,r)}},o.addChatMember=function(e,t){function n(){t&&0==a.find(r).find(".new_message_notice").length&&ViewUtils.setNewNoticeMark(a.find(r)),a.find(r).parent().prependTo(a.find(r).parent().parent())}function o(){0==a.find(r).length?CubeeController.getInstance().getPersonDataByJidFromServer(e,function(e){e&&e.getCount()>0&&(5==a.find("li").size()&&(a.find("li").eq(4).find("*").off(),a.find("li").eq(4).remove()),i._userListView.showPerson(e.get(0)),n())}):n()}var i=this;if(e){var a=$("#left_sidebar").find(this.getHtmlElement()),r="li[jid='"+e+"'] a",s=new ArrayList;s.add({jid:e,contactListGroup:""}),CubeeController.getInstance().addContactListMember(s,o)}},o.onNotifyAddChatMember=function(e){var t=this,n=this.getHtmlElement(),o=n.find("li"),i=5-o.length;if(!(0>=i))for(var a=0;i>a;a++){if(a>e.getCount()-1)return;var r=e.get(a);t._userListView.showPerson(r.getPerson())}},o.onNotifyRemoveChatMember=function(e){for(var t=this,n=this.getHtmlElement(),o=ContactList.getInstance(),i=[],a=[],r=0;r<e.getCount();r++)a.push(e.get(r).jid);n.find("li").each(function(e,t){a.includes($(t).attr("jid"))?$(t).remove():i.push($(t).attr("jid"))});for(var r=0;r<o.getCount();r++){var s=n.find("li");if(5==s.length||o.getCount()<=s.length)break;i.includes(o.get(r).getJid())||t._userListView.showPerson(o.get(r))}}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var n=t.getSubType(),o=Utils.getSafeValue(s,n,function(){});o(e,t)}}function t(e,t){function n(){if(!(s>=r)){var t=a.get(s);e._addMember(t),s++,setTimeout(function(){n()},1)}}if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var o=t.getSubType();if(o==CommunityNotification.SUB_TYPE_ADD_MEMBER){var i=t.getRoomId();if(i==e._communityId){var a=t.getAddedMemberList(),r=a.getCount(),s=0;n()}}}}function n(e,t){function n(){if(!(s>=r)){var t=a.get(s);e._removeMember(t),s++,setTimeout(function(){n()},1)}}if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var o=t.getSubType();if(o==CommunityNotification.SUB_TYPE_REMOVE_MEMBER){var i=t.getRoomId();if(i==e._communityId){var a=t.getRemovedMemberList(),r=a.getCount(),s=0;n()}}}}function o(e,t){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var n=t.getSubType();if(n==CommunityNotification.SUB_TYPE_UPDATE_OWNER){var o=t.getRoomId();o==e._communityId&&e._updateOwner()}}}ContactListForCommunityView.prototype=$.extend({},ContactListView.prototype);var i=ContactListView.prototype,a=ContactListForCommunityView.prototype;a.init=function(e){var t=this;return i.init.call(t),t._communityId=e,t},a.createFrame=function(){var e=this,t='<div class="'+e.VIEW_PARTS_TYPE+"-top "+e.VIEW_PARTS_TYPE_ALIAS+'-top box-border olient-vertical flex1"></div>',n=e._userListView._frame,o=$(t).append(n);return e._frame=o,o},a.addSelectedUserList=function(e){var t=this;null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(t._subView||(t._subView=new CommunityMemberListSubView(t._communityId,t.VIEW_PARTS_TYPE,t._callbacks),$("#listInnerContainer").append(t._subView._frame)),t._subView.addSelectedUserList(e),t._subView.show(),t.notifyChangeSelectedUserList())},a.beforeActivate=function(e){var t=this;e instanceof ContactListForCommunityView||t._subView&&t._subView.hide()},a.activate=function(e){var t=this;e instanceof ContactListForCommunityView&&t._subView&&(t._subView.show(),t._subView._updateMemberControlButton())};var r={};r[Notification_model.TYPE_COMMUNITY]=e,a.onNotification=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this,n=e.getType(),o=Utils.getSafeValue(r,n,function(){});o(t,e)}};var s={};s[CommunityNotification.SUB_TYPE_ADD_MEMBER]=t,s[CommunityNotification.SUB_TYPE_REMOVE_MEMBER]=n,s[CommunityNotification.SUB_TYPE_UPDATE_OWNER]=o,a._addMember=function(e){var t=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?!1:void t.notifyChangeSelectedUserList()},a._removeMember=function(e){var t=this;e==LoginUser.getInstance().getJid()&&t._subView&&t._subView._updateMemberControlButton()},a._updateOwner=function(){var e=this;e._subView&&e._subView._updateMemberControlButton()}}(),function(){CommunitySideListViewImpl.prototype=$.extend({},BaseSideListViewImpl.prototype);var e=BaseSideListViewImpl.prototype,t=CommunitySideListViewImpl.prototype;t.init=function(t,n){var o=this,i=TabManager.getInstance().getCommunityInfo();e.init.call(o,t);var a=(new GroupChatListView).init({mode:"sidebar"});a.showInnerFrameFromProject(function(){$("#groupChatList > .sidebar_list").append(a._frame)},i),o.sidebarParts=[a,n];var r=o._tabInfo.extras.communityId,s=[(new CommunityMemberListView).init(r),(new CommunityDetailsView).init(r),(new ContactListForCommunityView).init(r),(new GroupChatListView).init({mode:"sidebar"}),(new CommunityListView).init()];return o.setAccordionParts(s),o}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t){var n=t.getSubType(),o=Utils.getSafeValue(u,n,function(){});o(e,t)}function t(e,t){e.onChangeCommunityName(t)}function n(e,t){function n(){if(!(r>=a)){var o=i.get(r),s=LoginUser.getInstance(),l=s.getJid(),u=o.getJid();if(l==u){var c=t.getRoomId(),d=t.getRoomName(),g=new CommunityInfo;return g.setRoomId(c),g.setRoomName(d),void e._addCommunity(g,!0)}r++,setTimeout(function(){n()},1)}}if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var o=t.getSubType();if(o==CommunityNotification.SUB_TYPE_ADD_MEMBER){var i=t.getAddedMemberList(),a=i.getCount(),r=0;n()}}}function o(e,t){function n(){if(!(r>=a)){var o=LoginUser.getInstance(),s=o.getJid(),l=i.get(r);if(s==l){var u=t.getRoomId(),c=e.getHtmlElement(),d=c.find("div[communityId='"+u+"']");return void d.remove()}r++,setTimeout(function(){n()},1)}}if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var o=t.getSubType();if(o==CommunityNotification.SUB_TYPE_REMOVE_MEMBER){var i=t.getRemovedMemberList(),a=i.getCount(),r=0;n()}}}function i(e){e.click(function(){var t=e.attr("communityId");TabManager.getInstance().selectOrAddTabByCommunityId(t)})}function a(e,t){TooltipView.getInstance().setCommunityNameToolTip(e,t,!1),e.attr("title",t)}CommunityListView._VIEW_PARTS_LIST_HEADER="community-list-header",CommunityListView.prototype=$.extend({},SideMenuAccordionParts.prototype);var r=SideMenuAccordionParts.prototype,s=CommunityListView.prototype;s.init=function(){var e=this;return r.init.call(e),this._currentLoadedItemId=0,this._allCommunityListReceived=!1,this._headerDisplayName=Resource.getMessage("CommunityList"),this._headerElm=null,e},s.cleanUp=function(){var e=this;r.cleanUp.call(e),e._headerElm&&(e._headerElm.remove(),e._headerElm=null),e._currentLoadedItemId=null,e._allCommunityListReceived=null,e._headerDisplayName=null},s.createFrame=function(){var e=this,t='<div class="list-community box-border flex1 olient-vertical vertical-scroll"></div>',n=$(t);return e._frame=n,n},s.showInnerFrame=function(e){var t=this;if(null!=t._frame){var n=AuthorityInfo.getInstance();if(n.checkRights("createCommunity")){var o=t._frame,i='<div class="list-form olient-horizontal">';i+='<button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only">'+Resource.getMessage("create_community_dialog_title")+"</button>",i+="</div>";var a=$(i);a.children("button").button().on("click",function(){var e=new DialogCreateCommunityView;e.showDialog()}),t._headerElm=a,o.before(a)}return t._asyncShowCommunityList(e)}},s._asyncShowCommunityList=function(e){function t(t){n._onGetCommunityListHistory(t,e)}var n=this,o=n.getHtmlElement();return o.find(".list-community").children().remove(),n.getCommunityInfoList(t),n._createEventHandler(),!0},s.getCommunityInfoList=function(e){function t(t){t&&(t.getCount()<20&&(n._allCommunityListReceived=!0),e(t))}var n=this,n=this,o=new ColumnSortCondition;o.getItems().removeAll(),o.getItems().add("updated_at"),o.getOrders().removeAll(),o.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC),CubeeController.getInstance().getJoinedCommunityInfoList(n._currentLoadedItemId,20,o,t)},s._onGetCommunityListHistory=function(e,t){var n=this;n._hideLoadingIconInSelf();var o=n.getHtmlElement();if(null!=o){for(var i=0;i<e.getCount();i++){var a=e.get(i),r=o.find("div[communityId='"+a.getRoomId()+"']");0==r.length&&n._addCommunity(a,!1)}setTimeout(function(){t()},1),n.resizeContent()}},s._addCommunity=function(e,t){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var n=this,o=e.getId();(0==n._currentLoadedItemId||n._currentLoadedItemId>o)&&(n._currentLoadedItemId=o);var r=n.getHtmlElement();if(null==r)return!1;var s=e.getRoomId(),l=r.find("div[communityId='"+s+"']");if(0==l.length){var u='<div class="box-border olient-horizontal community-list-box" communityId="'+e.getRoomId()+'" title="'+Utils.convertEscapedTag(e.getRoomName())+'">';u+='<div class="community-list-info box-border-for-abbreviation flex1">'+Utils.convertEscapedHtml(e.getRoomName())+"</div>",u+="</div>";var c=$(u);return t?r.prepend(c):r.append(c),i(c),a(c,e.getRoomName()),!0}};var l={};l[Notification_model.TYPE_COMMUNITY]=e,s.onNotification=function(e){var t=this,n=e.getType(),o=Utils.getSafeValue(l,n,function(){});o(t,e)};var u={};u[CommunityNotification.SUB_TYPE_UPDATE_ROOM_INFO]=t,u[CommunityNotification.SUB_TYPE_ADD_MEMBER]=n,u[CommunityNotification.SUB_TYPE_REMOVE_MEMBER]=o,s.onChangeCommunityName=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=this,n=e.getUpdatedCommunityInfo(),o=e.getPreviousCommunityInfo(),i=n.getRoomName(),r=o.getRoomName();if(i==r)return!1;var s=t.getHtmlElement(),l=s.find("div[communityId='"+n.getRoomId()+"']");return 0!=l.length?(l.find("div.community-list-info").text(n.getRoomName()),a(l,n.getRoomName()),!0):!1},s._createEventHandler=function(){var e=this,t=e.getHtmlElement(),n=t;n.bottom({proximity:.1}),n.on("bottom",function(){e._showReadMore()})},s._showReadMore=function(){function e(e){n._onGetCommunityListHistory(e,r)}var t,n=this,o=!1,i=0,a=n.getHtmlElement();if(!a||"object"!=("undefined"==typeof a?"undefined":_typeof(a)))return o;if(1==n._allCommunityListReceived)return!1;if(t=a.children("div:last"),t.hasClass("loading-readmore"))return!1;if(ViewUtils.showLoadingIcon(t),i=a.children("div").size(),0==i)return ViewUtils.hideLoadingIcon(t),!1;var r=function(){};return n.getCommunityInfoList(e),o=!0},s._hideLoadingIconInSelf=function(){var e=this,t=e.getHtmlElement();ViewUtils.hideLoadingIconInChild(t)},s.resizeContent=function(){function e(){n.prop("clientHeight")==n.prop("scrollHeight")&&(t._allCommunityListReceived||t._showReadMore())}var t=this,n=t.getHtmlElement();"none"!=n.parent().css("display")&&setTimeout(function(){e()},1)},s.resizeAreaForIE89=function(){if(ViewUtils.isIE89()){var e=this;if(null!=e._frame){var t=e._frame,n=t.parent(),o=n.outerHeight(!0),i=t.prev(),a=i.outerHeight(!0),r=o-a;t.height(r)}}}}(),function(){$(function(){$("#listCommunity ul").selectable({filter:"img"})})}(),function(){AllCommunityDialog.prototype=$.extend({},DialogView.prototype);DialogView.prototype,AllCommunityDialog.prototype;$(function(){$("#communityListModal").dialog({autoOpen:!1,width:500,height:320,resizable:!1})})}(),function(){CommunityAvatar.prototype=$.extend({},AvatarView.prototype);AvatarView.prototype,CommunityAvatar.prototype}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,n){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n)))return!1;var o=n,i=t(o);return e.append(i),!0}function t(e){var t="";if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var o='<div class="list-community-member"></div>',i=$(o),a=e.getJid(),r=CubeeController.getInstance().getPersonData(a),s=r?r.getMyMemo():e.getMyMemo();null==s&&(s="");var l="";l+='<div class="box-border olient-horizontal community-member-list-box" jid="'+a+'">',l+=ViewUtils.getAvatarDataHtmlFromPerson(e,"avatar-community-member-list"),l+='  <div class="flex1 block-info-community-member-list">',l+=n(e),l+='    <div class="community-member-list-info info-user-mymemo box-border-for-abbreviation display-none" title="'+Utils.convertEscapedTag(s)+'">'+Utils.convertEscapedHtml(s)+"</div>",l+="  </div>",l+="</div>";var u=$(l),c=r?r.getPresence():e.getPresence();ViewUtils.showPresenceIcon(u,c,ViewUtils.STATUS_PRESENCEICON_CONTACTLIST);var d=u.find(".info-user-nickname"),g=d.attr("title");d.attr("title",g),i.append(u);var m=i.find(".block-avatar");return TooltipView.getInstance().setAvatarToolTip(TooltipView.TYPE_USER_AVATAR,m,!1,{align:"bottom left"}),i}function n(e){var t="";if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=(e.getJid(),ViewUtils.getUserNameByPerson(e)),o=ViewUtils.getCubeeAccountNameByPerson(e),i=e.getStatus();return t='<div class="community-member-list-info info-user-nickname box-border-for-abbreviation" title="'+Utils.convertEscapedTag(n)+ViewUtils.getUserStatusString(i)+" @"+Utils.convertEscapedTag(o)+'">'+Utils.convertEscapedHtml(n)+ViewUtils.getUserStatusString(i)+'<span class="sender-account">@'+Utils.convertEscapedHtml(o)+"</span></div>"}function o(e){var t=e.attr("jid"),n=new ColumnInformation;n.setColumnType(ColumnInformation.TYPE_COLUMN_CHAT),n.setFilterCondition(t),ColumnManager.getInstance().addColumn(n,!0,!0)}function i(e,t){e.updateMemmberListPresence(t)}function a(e,t){e.updateMemberListProfile(t)}function r(e,t){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var n=t.getSubType(),o=Utils.getSafeValue(_,n,function(){});o(e,t)}}function s(e,t){function n(){if(!(s>=r)){var t=a.get(s);e._addMember(t),s++,setTimeout(function(){n()},1)}}if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var o=t.getSubType();if(o==CommunityNotification.SUB_TYPE_ADD_MEMBER){var i=t.getRoomId();if(i==e._communityId){var a=t.getAddedMemberList(),r=a.getCount(),s=0;n()}}}}function l(e,t){function n(){if(!(s>=r)){var t=a.get(s);e._removeMember(t),s++,setTimeout(function(){n()},1)}}if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var o=t.getSubType();if(o==CommunityNotification.SUB_TYPE_REMOVE_MEMBER){var i=t.getRoomId();if(i==e._communityId){var a=t.getRemovedMemberList(),r=a.getCount(),s=0;n()}}}}function u(e,t){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var n=t.getSubType();if(n==CommunityNotification.SUB_TYPE_UPDATE_OWNER){var o=t.getRoomId();o==e._communityId&&e._updateOwner()}}}CommunityMemberListView.prototype=$.extend({},SideMenuAccordionParts.prototype);var c=SideMenuAccordionParts.prototype,d=CommunityMemberListView.prototype;d.init=function(e){var t=this;return c.init.call(t),t._selectedUserList=new ArrayList,t._startChatFormObj=null,t._headerDisplayName=Resource.getMessage("CommunityMemberList"),t._communityId=e,t._callbacks={getSelectedUserList:t.getSelectedUserList.bind(t),addSelectedUserList:t.addSelectedUserList.bind(t),removeSelectedUserList:t.removeSelectedUserList.bind(t),removeSelectedUserListAll:t.removeSelectedUserListAll.bind(t)},t},d.cleanUp=function(){var e=this;if(c.cleanUp.call(e),e._startChatFormObj&&(e._startChatFormObj.cleanUp(),e._startChatFormObj=null),e._selectedUserList&&(e._selectedUserList.removeAll(),e._selectedUserList=null),e._headerDisplayName=null,e._subView&&(e._subView.cleanUp(),e._subView=null),e._mTipList){var t=e._mTipList.getCount(),n=0,o=function i(){if(n>=t)return void(e._mTipList=null);var o=e._mTipList.get(n);$("#"+o).remove(),n++,setTimeout(function(){i()},1)};setTimeout(function(){o()},1)}},d.createFrame=function(){var e=this,t='<div class="box-border flex1 olient-vertical vertical-scroll ui-widget ui-helper-reset  hide-view"></div>',n=$(t);return e._frame=n,e._createEventHandler(),n},d.showMemberList=function(){var e=this;return e._asyncShowMemberList(null)},d.showInnerFrame=function(e){var t=this;return t._asyncShowMemberList(e)},d._asyncShowMemberList=function(t){function n(){setTimeout(function(){null!=t&&"function"==typeof t&&t()},1);
}function o(){var e=null;return null==a?e:a.getHtmlElement()}function i(t){function i(){var e=o();if(null==e)return void n();var t=GroupChatStartFormView.getHtml();e.append(t),setTimeout(function(){r()},1)}function r(){function t(){var i=o();if(null==i)return void n();for(var a=20,d=0;a>d&&!(c>=u);d++)e(r,l[c]),c++;return c>=u?void s():void setTimeout(function(){t()},1)}var i=o();if(null==i)return void n();var a='<div class="member-list box-border-for-abbreviation olient-vertical flex1 vertical-scroll"></div>';i.append(a);var r=i.find(".member-list"),u=l.length,c=0;t()}function s(){var e=o();return null==e?void n():(ViewUtils.hideLoadingIconInChild(e),e.removeClass("hide-view"),a.resizeContent(),void n())}if(null==t)return void setTimeout(function(){var e=o();if(null==e)return void n();ViewUtils.hideLoadingIconInChild(e),e.removeClass("hide-view");var t='<div class="member-list box-border-for-abbreviation olient-vertical flex1 vertical-scroll">'+Resource.getMessage("not_referable_community")+"</div>";e.append(t),n()},1);for(var l=new Array,u=t.getOwnerList(),c=u.getCount(),d=t.getGeneralMemberList(),g=d.getCount(),m=0;c>m;m++){var _=u.get(m);l.push(_)}for(var m=0;g>m;m++){var f=d.get(m);l.push(f)}i()}var a=this,r=a._communityId;if(null==r||""==r)return void n();a.getHtmlElement().children().remove();var s=a.getHtmlElement();ViewUtils.showLoadingTopInChild(s),CubeeController.getInstance().getCommunityMemberInfo(r,i)},d.resizeContent=function(){var e=this,t=e.getHtmlElement();if(null!=t&&"none"!=t.css("display")&&ViewUtils.isIE89()){var n=t.outerWidth(!0);t.find(".community-member-list-box").width(n),t.find(".list-community-member").css("overflow-x","hidden")}},d._showStartChatForm=function(){var e=this,t=e.getHtmlElement().find(".start-chatroom-form-border"),n=e._selectedUserList.getCount();0==n?e._startChatFormObj&&e._startChatFormObj.hideStartForm():1==n?(e._startChatFormObj||(e._startChatFormObj=new GroupChatStartFormView(t,e)),e._startChatFormObj.showStartForm()):e._startChatFormObj&&e._startChatFormObj.updateSelectedCount()},d.cancelSelectedUserListAll=function(){var e=this,t=e.getHtmlElement().find(".community-member-list-selected");e._removeSelectedUserListAll(),t.removeClass("community-member-list-selected"),e._showStartChatForm()};var g={};g[ProfileChangeNotice.TYPE_PRESENCE]=i,g[ProfileChangeNotice.TYPE_PROFILE]=a,d.onProfileChanged=function(e){var t=this,n=e.getType(),o=Utils.getSafeValue(g,n,function(){});o(t,e)},d.updateMemmberListPresence=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;for(var t=e.getJid(),n=this,o=n.getHtmlElement().find(".community-member-list-box[jid='"+t+"']"),i=0;i<o.length;i++){var a=o.eq(i);ViewUtils.showPresenceIcon(a,e.getPresence(),ViewUtils.STATUS_PRESENCEICON_CONTACTLIST);var r=a.find(".info-user-mymemo"),s=e.getMyMemo();r.text(s),r.attr("title",s);var l=a.find(".block-avatar");TooltipView.getInstance().updateAvatarToolTip(l)}return!0},d.updateMemberListProfile=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=this,o=e.getJid(),i=e.getProfile(),a=t.getHtmlElement().find(".community-member-list-box[jid='"+o+"']"),r=new Person;if(r.setJid(o),r._profile=i,a.length>0){var s=a.eq(0).find(".info-user-nickname"),l=s.text(),u=l.indexOf(Resource.getMessage("suspend")),c=u>-1?Profile.STATUS_SUSPEND:Profile.STATUS_ACTIVE;r._profile.setStatus(c);var d=s.children("span").text();0===d.indexOf("@")&&(d=d.substr(1)),r._profile.setLoginAccount(d)}for(var g=n(r),m=0;m<a.length;m++){var _=a.eq(m),f=_.find(".block-avatar");f.remove(),_.prepend(ViewUtils.getAvatarDataHtmlFromPerson(r,"avatar-community-member-list"));var p=_.find(".info-user-nickname");p.replaceWith(g),p=_.find(".info-user-nickname");var h=p.attr("title");TooltipView.getInstance().setAvatarToolTip(TooltipView.TYPE_USER_AVATAR,_.find(".block-avatar"),!1,{align:"bottom left"}),p.attr("title",h)}return!0};var m={};m[Notification_model.TYPE_COMMUNITY]=r,d.onNotification=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=e.getRoomId(),n=new CommunityDetailsView;n.init(t),n.setCommunityDetailData(t)}};var _={};_[CommunityNotification.SUB_TYPE_ADD_MEMBER]=s,_[CommunityNotification.SUB_TYPE_REMOVE_MEMBER]=l,_[CommunityNotification.SUB_TYPE_UPDATE_OWNER]=u,d._addMember=function(t){var n=this;if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return!1;var o=n.getHtmlElement(),i=o.find(".member-list");e(i,t),n.notifyChangeSelectedUserList()},d._removeMember=function(e){var t=this,n=(t.getHtmlElement(),t.getHtmlElement().find(".community-member-list-box[jid='"+e+"']"));n.remove(),e==LoginUser.getInstance().getJid()&&t._subView&&t._subView._updateMemberControlButton()},d._updateOwner=function(){var e=this;e._subView&&e._subView._updateMemberControlButton()},d._createEventHandler=function(){var e=this,t=e.getHtmlElement();$(t).on("click","div.community-member-list-box",function(){var n=$(this),i=n.attr("jid"),a=LoginUser.getInstance(),r=a.getJid();if(r!=i){var s=CubeeController.getInstance().getCachedCommunityMember(e._communityId,i),l=t.find(".community-member-list-box[jid='"+i+"']");if(null==n.data("clickTimerId")){var u=setTimeout(function(){n.data("clickTimerId",null),s&&(n.hasClass("community-member-list-selected")?(l.removeClass("community-member-list-selected"),e.removeSelectedUserList(s)):(l.addClass("community-member-list-selected"),e.addSelectedUserList(s)))},ViewUtils.SINGLE_CLICK_DECISION_TIME);n.data("clickTimerId",u)}else clearTimeout(n.data("clickTimerId")),n.data("clickTimerId",null),o($(this))}}),ViewUtils.isIE8()&&$(t).on("dblclick","div.community-member-list-box",function(){var e=$(this),n=e.attr("jid");t.find(".community-member-list-box[jid='"+n+"']");clearTimeout(e.data("clickTimerId")),e.data("clickTimerId",null),o($(this))})},d.getSelectedUserList=function(){return this._subView?this._subView.getSelectedUserList():new ArrayList},d.addSelectedUserList=function(e){var t=this;null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(t._subView||(t._subView=new CommunityMemberListSubView(t._communityId,t.VIEW_PARTS_TYPE,t._callbacks),$("#listInnerContainer").append(t._subView._frame)),t._subView.addSelectedUserList(e),t._subView.show(),t.notifyChangeSelectedUserList())},d.removeSelectedUserList=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&t._subView&&(t._subView.removeSelectedUserList(e),t.notifyChangeSelectedUserList(),0==t.getSelectedUserList().getCount())){t._subView.hide(),t._subView.cleanUp(),t._subView=null;var n=$("#listContainer #"+t.VIEW_PARTS_TYPE+"-subview");n.length>0&&n.remove()}},d.removeSelectedUserListAll=function(){var e=this;if(e._subView){e._subView.removeSelectedUserListAll(),e.notifyChangeSelectedUserList(),e._subView.hide(),e._subView.cleanUp(),e._subView=null;var t=$("#listContainer #"+e.VIEW_PARTS_TYPE+"-subview");t.length>0&&t.remove()}},d.notifyChangeSelectedUserList=function(){var e=this,t=e.getSelectedUserList();[e,e._subView].forEach(function(e){e&&e.receivedChangeSelectedUser(t)})},d.receivedChangeSelectedUser=function(e){var t=this;t._frame.find("."+t.VIEW_PARTS_TYPE+"-box").removeClass(t.VIEW_PARTS_TYPE+"-selected");for(var n=e.getCount(),o=0;n>o;o++){var i=e.get(o).getJid(),a=t._frame.find("."+t.VIEW_PARTS_TYPE+"-box[jid='"+i+"']");a.length>0&&a.addClass(t.VIEW_PARTS_TYPE+"-selected")}},d.beforeActivate=function(e){var t=this;e instanceof CommunityMemberListView||t._subView&&t._subView.hide()},d.activate=function(e){var t=this;e instanceof CommunityMemberListView&&t._subView&&(t._subView.show(),t._subView._updateMemberControlButton())},d.resizeAreaForIE89=function(){if(c.resizeAreaForIE89.call(this),ViewUtils.isIE89()){var e=this;e._subView&&e._subView.setListInnerContainerScrollForIE89()}}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var n=t.getSubType(),o=Utils.getSafeValue(s,n,function(){});o(e,t)}}function t(e,t){function n(){}if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var o=t.getSubType();if(o==CommunityNotification.SUB_TYPE_UPDATE_ROOM_INFO){var i=t.getUpdatedCommunityInfo(),a=i.getRoomId();a==e._communityId&&e._asyncShowDetails(n)}}}function n(e,t){function n(e){}if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))&&t.getSubType()==CommunityNotification.SUB_TYPE_UPDATE_OWNER){var o=t.getRoomId();if(o==e._communityId){var i=e._getUserNameListElement(t.getOwnerList());null!==i&&""!==i&&$(".community-owner-list").empty().append(i),e._createConfToolTipDom(n)}}}CommunityDetailsView.prototype=$.extend({},SideMenuAccordionParts.prototype);var o=SideMenuAccordionParts.prototype,i=CommunityDetailsView.prototype,a=new CommunityDetailsView;i.init=function(e){var t=this;return o.init.call(t),t._headerDisplayName=Resource.getMessage("CommunityDetail"),t._headerElm=null,t._communityId=e,t.personCount=0,t.allPersons=[],$("#prj_ico").off("click"),$("#prj_ico").on("click",function(){$(".control-sidebar").hasClass("control-sidebar-open")||(SideMenuRecentView.getInstance().close(),t.setCommunityDetailData(e)),$(".control-sidebar").toggleClass("control-sidebar-open")}),$("#project_scroll_area").off("scroll"),$("#project_scroll_area").on("scroll",function(){$("#project_scroll_area").on("ps-y-reach-end",function(){t.personCount!==t.allPersons.length&&t.addPersons(t._communityId)})}),t},CommunityDetailsView.getInstance=function(){return a},i.cleanUp=function(){var e=this;o.cleanUp.call(e),e._headerElm&&(e._headerElm.children("*").off(),e._headerElm.remove(),e._headerElm=null),e._headerDisplayName=null,e._mtipObj&&e._mtipObj.remove()},i.createFrame=function(){var e=this,t='<div class="community-detail box-border flex1 olient-vertical vertical-scroll"></div>',n=$(t);return e._frame=n,n},i.showInnerFrame=function(e){function t(e){}var n=this;if(null!=n._frame){var o=n._frame,i='<div class="list-form olient-horizontal vertical-scroll"><button class="list-form-button community-settings"></button></div>';i=$(i),i.children("button").button({icons:{primary:"ui-icon-gear"},text:!1});i.children("button");return n._createConfToolTipDom(t),n._headerElm=i,o.before(i),n._asyncShowDetails(e)}},i._createConfToolTipDom=function(e){function t(t){if(null!=t){for(var a=!1,r=t.getOwnerList(),s=r.getCount(),l=LoginUser.getInstance(),u=l.getJid(),c=0;s>c;c++){var d=r.get(c),g=d.getJid();u==g&&(a=!0)}var m=AuthorityInfo.getInstance();if(!a){if(!m.checkRights("manageCommunity",i)){var _=n._confirmMemberToolTipDom();o.append(_)}return void e(o)}if(m.checkRights("manageCommunity",i)){var f=n._createAddMemberToolTipDom();o.append(f);var p=n._createAuthorityChangeMemberToolTipDom();o.append(p);var h=n._createForceLeaveMemberToolTipDom();o.append(h);var C=n._createCommunitySettingToolTipDom();o.append(C),e(o)}}}var n=this,o=$('<ul class="config_menu list_none"></ul>');o.css("text-align","center");var i=n._communityId;null!=i&&""!=i&&CubeeController.getInstance().getCommunityMemberInfo(i,t)},i._createCommunitySettingToolTipDom=function(){var e=this,t="<li><p>"+Resource.getMessage("conf_community_setting_tooltip")+"</p></li>",n=$(t);return n.on("click",function(){e._onClickSettingToolTip()}),n},i._onClickSettingToolTip=function(){var e=this,t=e._communityId;if(null!=t){var n=new DialogSettingCommunityView(t);n.showDialog()}},i._createAddMemberToolTipDom=function(){var e=this,t="<li><p>"+Resource.getMessage("conf_community_add_member_tooltip")+"</p></li>",n=$(t);return n.on("click",function(){e._onClickAddMemberToolTip()}),n},i._onClickAddMemberToolTip=function(){var e=this,t=e._communityId;if(null!=t){var n=new DialogSelectCommunityAddMemberView(t);n.showDialog()}},i._createAuthorityChangeMemberToolTipDom=function(){var e=this,t="<li><p>"+Resource.getMessage("conf_community_change_authority_tooltip")+"</p></li>",n=$(t);return n.on("click",function(){e._onClickAuthorityChengeMemberToolTipDom()}),n},i._onClickAuthorityChengeMemberToolTipDom=function(){var e=this,t=e._communityId;if(null!=t){var n=new DialogSelectCommunityChangeAuthorityMemberView(t);n.showDialog()}},i._confirmMemberToolTipDom=function(){var e=this,t="<li><p>"+Resource.getMessage("conf_confirm_authority_tooltip")+"</p></li>",n=$(t);return n.on("click",function(){e._onClickConfirmMemberToolTip()}),n},i._onClickConfirmMemberToolTip=function(){var e=this,t=e._communityId;if(null!=t){var n=new DialogSelectCommunityConfirmAuthorityMemberView(t);n.showDialog()}},i._createAuthorityChangeMemberToolTipDom=function(){var e=this,t="<li><p>"+Resource.getMessage("conf_community_change_authority_tooltip")+"</p></li>",n=$(t);return n.on("click",function(){e._onClickAuthorityChengeMemberToolTipDom()}),n},i._onClickAuthorityChengeMemberToolTipDom=function(){var e=this,t=e._communityId;if(null!=t){var n=new DialogSelectCommunityChangeAuthorityMemberView(t);n.showDialog()}},i._createForceLeaveMemberToolTipDom=function(){var e=this,t="<li><p>"+Resource.getMessage("conf_community_leave_member_tooltip")+"</p></li>",n=$(t);return n.on("click",function(){e._onClickForceLeaveMemberToolTip()}),n},i._onClickForceLeaveMemberToolTip=function(){var e=this,t=e._communityId;if(null!=t){var n=new DialogSelectCommunityForceLeaveMemberView(t);n.showDialog()}};var r={};r[Notification_model.TYPE_COMMUNITY]=e,i.onNotification=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this;t.setCommunityDetailData(e.getRoomId());var n=e.getType(),o=Utils.getSafeValue(r,n,function(){});o(t,e)}};var s={};s[CommunityNotification.SUB_TYPE_UPDATE_ROOM_INFO]=t,s[CommunityNotification.SUB_TYPE_UPDATE_OWNER]=n,i._asyncShowDetails=function(e){var t=this,n=t._communityId;null!=n&&""!=n&&t.setCommunityDetailData(n)},i._createDetailsDom=function(e){var t=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return Resource.getMessage("not_referable_community");var n=e.getPrivacyType(),o=e.getMemberEntryType(),i=e.getDescription();n=ViewUtils.communityPrivacyTypeNumToStr(n),o=ViewUtils.communityMemberEntryTypeNumToStr(o),i=Utils.convertEscapedHtml(i,!0);var a=e.getOwnerList(),r="";if(0==a.getCount()){var s=function(e){null!=e&&(r=t._getUserNameListElement(e.getOwnerList()),$(".community-owner-list").empty().append(r))},l=e.getRoomId();CubeeController.getInstance().getCommunityMemberInfo(l,s)}else r=t._getUserNameListElement(e.getOwnerList());var u="";return u+='<div class="table">',u+='  <div class="table_rh communuty-propaty">'+Resource.getMessage("community_privacy")+":</div>",u+='  <div class="table_d">'+n+"</div>",u+="</div>",u+='<div class="table">',u+='  <div class="table_rh communuty-propaty">'+Resource.getMessage("community_member_entry_type")+":</div>",u+='  <div class="table_d">'+o+"</div>",u+="</div>",u+='<div class="table">',u+='  <div class="table_rh communuty-propaty">'+Resource.getMessage("community_detail_label_owner")+":</div>",u+="</div>",u+='<div class="table">',u+='  <div class="table_d word-break-all community-owner-list">'+r+"</div>",u+="</div>",u+='<div class="table">',u+='  <div class="table_rh communuty-propaty">'+Resource.getMessage("community_description")+":</div>",u+="</div>",u+='<div class="table">',u+='  <div class="table_d word-break-all">'+i+"</div>",u+="</div>",u=$(u)},i.updateDetails=function(){},i.resizeAreaForIE89=function(){if(ViewUtils.isIE89()){var e=this;if(null!=e._frame){var t=e._frame,n=t.parent(),o=t._headerElm,i=n.outerHeight(!0),a=0;if(null!=o){_startChatFormObj.getHtmlElement();o.is(":visible")&&(a=o.outerHeight(!0))}var r=i-a;t.height(r)}}},i._getUserNameListElement=function(e){if(null==e||0===e.getCount())return"";var t=this,n='<ul class="community-detail-owner-list">';n+="</ul>";var o=function(e){e&&i(e.getOwnerList())},i=function(e){for(var n=e.getCount(),o=0;n>o;o++){var i=e.get(o),a=i.getJid();if(null!=a&&""!==a){var r=i.getUserName(),s=i.getLoginAccount(),l=Utils.convertEscapedTag(r)+" @"+Utils.convertEscapedTag(s);t.getHtmlElement().find(".community-detail-owner-list").append('<li class="community-detail-owner" title="'+l+'">'+Utils.convertEscapedHtml(r)+'<span class="sender-account">@'+Utils.convertEscapedHtml(s)+"</span></li>")}}};return e instanceof CommunityMemberList?setTimeout(function(){i(e)},1):CubeeController.getInstance().getCommunityMemberInfo(this._communityId,o),n},i.getCommunityMemberList=function(e){return new Promise(function(t,n){function o(e){if(null==e)return void n();for(var o=new Array,i=e.getOwnerList(),a=i.getCount(),r=e.getGeneralMemberList(),s=r.getCount(),l=0;a>l;l++){var u=i.get(l);u._role=2,o.push(u)}for(var l=0;s>l;l++){var c=r.get(l);c._role=1,o.push(c)}t(o)}CubeeController.getInstance().getCommunityMemberInfo(e,o)})},i.setOwners=function(e){$.each(e,function(e,t){var n=Utils.getSafeStringData(t._profile._nickName);n=Utils.convertEscapedHtml(n)+ViewUtils.getUserStatusString(t._profile._status);var o=(t._profile._avatarType,t._profile._avatarData,"@"+t._profile._loginAccount),i=ViewUtils.getAvatarDataHtmlFromPerson(t),a="<li title='"+n+" "+Utils.convertEscapedHtml(o)+"'>                <span class='ico ico_user status'></span>                <span class='name'>"+n+"</span>                <span class='group'></span>                </li>",r=$(a);$("#community_detail_owner_info").append(r);r.find(".ico_user").append(i),r.find(".status").addClass(ViewUtils.getPresenceColorCss(t.getPresence())),r.find(".group").text(o).html()})},i.setMembers=function(e){var t=LoginUser.getInstance();$.each(e,function(e,n){var o=Utils.getSafeStringData(n._profile._nickName);o=Utils.convertEscapedHtml(o)+ViewUtils.getUserStatusString(n._profile._status);var i=(n._profile._avatarType,n._profile._avatarData,"@"+n._profile._loginAccount),a=ViewUtils.getAvatarDataHtmlFromPerson(n),r="<li class='project_member' title='"+o+" "+Utils.convertEscapedHtml(i)+"'>               <a>               <span class='ico ico_user status'></span>               <span class='name'>"+o+"</span>               <span class='group'></span>               </a>               </li>",s=$(r),l=($("#community_detail_member_list").append(s),n.getJid()),u=CubeeController.getInstance().getPersonData(l);s.find(".ico_user").append(a),s.find(".status").addClass(ViewUtils.getPresenceColorCss(u?u.getPresence():n.getPresence())),s.find(".group").text(i).html(),l!==t.getJid()&&s.on("click",function(){ColumnManager.getInstance().addChatColumn(l,!0,!0)})})},i.setCommunityDetailData=function(e){var t=this;null!=e&&""!=e&&($("#project_scroll_area").scrollTop(0),t.personCount=0,t.allPersons=[],$("#community_detail_owner_info").empty(),$("#community_detail_member_list").empty(),CubeeController.getInstance().getCommunityInfo(e,function(n){if(null!=n){var o=n.getPrivacyType(),a=n.getMemberEntryType(),r=n.getDescription();o=ViewUtils.communityPrivacyTypeNumToStr(o),a=ViewUtils.communityMemberEntryTypeNumToStr(a),r=Utils.convertEscapedHtml(r,!0),$("#community_detail_publishing_setting").html(o),$("#community_detail_account_type").html(a),$("#community_detail_community_description").html(r),i.getCommunityMemberList(t._communityId).then(function(o){var i=LoginUser.getInstance();o.forEach(function(t){if(t._jid===i.getJid()){var o="";n.getPrivacyType()==CommunityInfo.PRIVACY_TYPE_ITEM_OPEN&&(o='<li><a class="txt_btn_project" data-modal="community_withdraw_member_modal">'+Resource.getMessage("conf_community_withdraw_member_tooltip")+"</a></li>"),2===t._role?$(".project_detail_menu").find("ul.popup_list").replaceWith($('<ul class="popup_list"><li><a class="txt_btn_project" data-modal="addprojectmember_modal">'+Resource.getMessage("conf_community_add_member_tooltip")+'</a></li>                                <li><a class="txt_btn_project" data-modal="removeprojectmember_modal">'+Resource.getMessage("conf_community_leave_member_tooltip")+'</a></li>                                <li><a class="txt_btn_project" data-modal="projectauthority_modal">'+Resource.getMessage("conf_community_change_owner_tooltip")+'</a></li>                                <li><a class="txt_btn_project" data-modal="settingproject_modal">'+Resource.getMessage("conf_community_setting_tooltip")+"</a></li>"+o+"</ul>")):$(".project_detail_menu").find("ul.popup_list").replaceWith($('<ul class="popup_list"><li><a class="txt_btn_project" data-modal="projectconfirmauthority_modal">'+Resource.getMessage("conf_confirm_authority_tooltip")+"</a></li>"+o+"</ul>")),$(".txt_btn_project").off("click");var a=void 0;$(".txt_btn_project").on("click",function(){var t=$(this).data("modal");"addprojectmember_modal"===t?a=new DialogSelectCommunityAddMemberView(e):"removeprojectmember_modal"===t?a=new DialogSelectCommunityForceLeaveMemberView(e):"projectauthority_modal"===t?a=new DialogSelectCommunityChangeAuthorityMemberView(e):"settingproject_modal"===t?a=new DialogSettingCommunityView(e):"projectconfirmauthority_modal"===t?a=new DialogSelectCommunityConfirmAuthorityMemberView(e):"community_withdraw_member_modal"===t&&(a=new DialogProjectUnsubscribeCheckView(e)),a?a.showDialog():""})}}),t.allPersons=o,t.addPersons(e);for(var a=$("#project_scroll_area"),r=a.get(0)?a.get(0).scrollHeight>a.innerHeight():!1;!(r||t.personCount>=t.allPersons.length);)t.addPersons(e),r=a.get(0)?a.get(0).scrollHeight>a.innerHeight():!1})["catch"](function(e){})}}))},i.addPersons=function(e){for(var t=Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST"),n=this,o=[],i=n.personCount;i<Math.min(n.personCount+t,n.allPersons.length);i++)o.push(n.allPersons[i]);n.personCount+=o.length;var a=[],r=[];$.each(o,function(e,t){2===t._role&&a.push(t),r.push(t)}),n.setOwners(a),n.setMembers(r)}}(),function(){$(function(){$("#listFollows").hide("blind","fast"),$("#followsListContainer > div:first").on("mouseover",function(){$(this).css("cursor","pointer")}).on("click",function(){return $(this).next().toggle("slow"),!1}).next().show()})}(),function(){FollowsListDialog.prototype=$.extend({},DialogView.prototype);DialogView.prototype,FollowsListDialog.prototype}(),function(){FollowListView.prototype=$.extend({},FollowsListDialog.prototype);FollowsListDialog.prototype,FollowListView.prototype}(),function(){FollowerListView.prototype=$.extend({},FollowsListDialog.prototype);FollowsListDialog.prototype,FollowerListView.prototype}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){var t="",n=e,o=e.getItemId(),i=n.getId(),a=n.getFrom(),r=n.getProfileByJid(a),s=new Person;s.setJid(a),s._profile=r;var l=s.getUserName();(null==l||""==l)&&(l=ViewUtils.getUserName(a));var u=s.getLoginAccount();(null==u||""==u)&&(u=ViewUtils.getCubeeAccountName(a));var c=null!=s?s.getStatus():Person.PROFILE_STATUS_ACTIVE,d=Utils.getDate(n.getDate(),Utils.DISPLAY_STANDARD_DATE_FORMAT),g=n.getUpdatedAt()?Date.create(n.getUpdatedAt()).format(Utils.DISPLAY_STANDARD_DATE_FORMAT):"",m=ViewUtils.getAvatarDataHtmlFromPerson(s);t+='<div class="box-border olient-horizontal message-header">',t+='<div class="message-info" messageid="'+(null==i?"":i)+'" itemid="'+o+'" />',ViewUtils.isIE89()&&(t+="<table><tr><td>"),t+=m,ViewUtils.isIE89()&&(t+='</td><td width="100%">'),t+='<div class="flex1 block-info">',t+='<div class="sender-name text-overflow-ellipsis-nosize box-border-for-abbreviation"',t+=' title="'+Utils.convertEscapedTag(l),t+=ViewUtils.getUserStatusString(c),t+=a?" @"+Utils.convertEscapedTag(u)+'">':'">',t+=Utils.convertEscapedHtml(l),t+=ViewUtils.getUserStatusString(c),t+=a?'<span class="sender-account">@'+Utils.convertEscapedHtml(u)+"</span></div>":"</div>";var _="";return g?(_=": "+d+"\n: "+g,t+='<div class="message-time" title="'+_+'">'+d+" ()</div>"):(_=": "+d,t+='<div class="message-time" title="'+_+'">'+d+"</div>"),t+="</div>",ViewUtils.isIE89()&&(t+="</td></tr></table>"),t+="</div>"}function t(t){var a="",r=t.getType(),l=t.getMessage(),u=(ViewUtils.extractUrls(l),ViewUtils.removeAttachmentUrl(l)),c=t.getDeleteFlag(),d="";if(d=r!=Message.TYPE_PUBLIC&&r!=Message.TYPE_CHAT&&r!=Message.TYPE_GROUP_CHAT&&r!=Message.TYPE_COMMUNITY&&r!=Message.TYPE_MURMUR||1==t.getBodyType()?ViewUtils.urlAutoLink(t.getUIShortenUrls(),u,!0,null,!1,t.getItemId()):s(t.getUIShortenUrls(),u,!1,t.getItemId(),!0),d=ViewUtils.replaceHashtagElement(d),2==c&&(d=d.replace("deleted_by_admin",Resource.getMessage("deleted_message_body_by_admin")),d=d.replace("deleted",Resource.getMessage("deleted_message_body"))),a+='<div class="box-border olient-vertical message-info">',a+='<div class="message-body',r===Message.TYPE_TASK&&t.getStatus()>=TaskMessage.STATUS_ASSIGNING&&(a+=" hide-view"),a+='">',t.getThreadTitle()&&2!=c){var g=[],m=t.getThreadTitle(),_=m;_=ViewUtils.replaceTenantBaseTitleCategory(_,m,g),_=ViewUtils.replaceOrignalTitleCategory(_,m,g);for(var f=g.sort(function(e,t){return e.index-t.index}),p="",h=0;h<f.length;h++)p+=f[h].data;a+='<pre class="message-title">'+p+'<span style="font-weight:700;">'+Utils.convertEscapedHtml(_)+"</span></pre>"}t.getNoteUrl()&&t.getNoteTitle()&&2!=c&&(a+=i(t)),a+=d,a+=o(t);var C=t.getQuotationItem();if(C&&0==c){C.getItemId()||C.setItemId("mask_itemId");var v="",y="message-body-quote-anonymous";C.getFrom()&&(v=e(C),y="message-body-quote");var T=ViewUtils.urlAutoLink(C.getUIShortenUrls(),ViewUtils.removeAttachmentUrl(C.getMessage()),!0,null,!1,t.getItemId());a+='      <div class="quote_in_message scroll_content">                              '+v+"                              <div class="+y+">                              "+T+"                              "+o(C)+"                              </div>                           </div>"}return a+="</div>",ViewUtils.isIE89()||(a+='<table class="actionToolBarTable"><tr>',a+='<td class="actionToolBarBase"></td>',a+='<td class="goodJobBase">'),a+='<div class="box-border pack-end good-job">',a+=n(t),(r==Message.TYPE_PUBLIC||r==Message.TYPE_SYSTEM||r==Message.TYPE_GROUP_CHAT||r==Message.TYPE_COMMUNITY||r==Message.TYPE_CHAT||r==Message.TYPE_MURMUR)&&(a+=ColumnMessageGoodJobButton.getHtml(t.getGoodJobList()),a+=ColumnMessageEmotionPointButton.getHtml(t.getEmotionPointList(),t.getEmotionIconList())),a+="</div>",ViewUtils.isIE89()||(a+="</td></tr></table>"),a+="</div>"}function n(e){var t="";if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;if(e.getType()==Message.TYPE_PUBLIC){var n=Resource.getMessage("existing_reader_link");return t+='<div class="frm-existing-reader not-read-message">',t+='<span class="frm-existing-reader-link txt_btn" title="'+n+'">',t+=n,t+="</span>",t+="</div>"}var o=e.getExistingReaderInfo();if(null==o)return t;var i=o.getAllCount();return 0==i?t:t=ColumnMessageExistingReaderInfoView.getHtml(o)}function o(e){var t="",n=e.getMessage(),o=(ViewUtils.removeAttachmentUrl(n).replace(/\n+$/g,""),e.getItemId()),i=ViewUtils.extractUrls(n),a=i.getCount();if(a>0){t+='<div class="thumbnail-area olient-horizontal" ',e.getType()===Message.TYPE_TASK&&e.getStatus()==TaskMessage.STATUS_INBOX||e.getType()===Message.TYPE_TASK&&e.getStatus()>=TaskMessage.STATUS_ASSIGNING&&(t+=' style="display: none;"'),t+='">';for(var r=0,s=0,l=0;a>l;l++){var u=ViewUtils.getThumbnailImageHtml(i.get(l),n,o);""==u?s+=1:r+=1}for(var l=0;a>l;l++){var c=ViewUtils.getThumbnailImageHtml(i.get(l),n,o);""==c&&1==s&&(c='<div class="ogp-area" value="'+i.get(l)+'"></div>'),t+=c}t+="</div>"}return t}function i(e){var t="",n=Utils.convertEscapedHtml(e.getNoteTitle());return t='            <div class="message-body-note">                <a href="'+e.getNoteUrl()+' " target="_brank" title="'+n+'">                    <i class="fa fa-pencil-square-o"></i>                    '+n+"                </a>            </div>        "}function a(e,t){return 0==u({message:e})?!1:t<e.split("\n").length?!0:!1}function r(e,t,n,o,i){if(0==u({message:t}))return t;var r=t.replace(/\n+$/g,""),s=a(r,ColumnMessageView.MESSAGE_ELLIPSIS_MAX_LINES);if(s){var c=null,d=null;i?(c=l(r,n),d='<div class="read-more-link-base"><span class="read-more-comment">...</span><a href class="read-more-link">'+Resource.getMessage("whole_text")+"</a></div>"):(c=r,d='<div class="read-more-link-base"><span class="read-more-comment">&nbsp;</span><a href class="read-more-link">'+Resource.getMessage("abbreviation")+"</a></div>");var g=ViewUtils.urlAutoLink(e,c,!0,null,!1,o);return g=ViewUtils.replaceHashtagElement(g),g.replace("</pre>","</pre>"+d)}return ViewUtils.urlAutoLink(e,r,!0,null,!1,o)}function s(e,t,n,o,i){if(0==u({message:t}))return t;var a=t.replace(/\n+$/g,""),r=ViewUtils.getCalculattionBody(a);if(r>Conf.getVal("MESSAGE_BODY_MAX_LENGTH")){var s=null,l=null;i?(s=ViewUtils.getSubstringBody(a,Conf.getVal("MESSAGE_BODY_MAX_LENGTH")),l='<div class="read-more-link-base"><span class="read-more-comment">...</span><a href class="read-more-link">'+Resource.getMessage("whole_text")+"</a></div>"):(s=a,l='<div class="read-more-link-base"><span class="read-more-comment">&nbsp;</span><a href class="read-more-link">'+Resource.getMessage("abbreviation")+"</a></div>");var c=ViewUtils.urlAutoLink(e,s,!0,null,!1,o);return c=ViewUtils.replaceHashtagElement(c),c.replace("</pre>","</pre>"+l)}return ViewUtils.urlAutoLink(e,a,!0,null,!1,o)}function s(e,t,n,o,i){if(0==u({message:t}))return t;var a=t.replace(/\n+$/g,""),r=ViewUtils.getCalculattionBody(a);if(r>Conf.getVal("MESSAGE_BODY_MAX_LENGTH")){var s=null,l=null;i?(s=ViewUtils.getSubstringBody(a,Conf.getVal("MESSAGE_BODY_MAX_LENGTH")),l='<div class="read-more-link-base"><span class="read-more-comment">...</span><a href class="read-more-link">'+Resource.getMessage("whole_text")+"</a></div>"):(s=a,l='<div class="read-more-link-base"><span class="read-more-comment">&nbsp;</span><a href class="read-more-link">'+Resource.getMessage("abbreviation")+"</a></div>");var c=ViewUtils.urlAutoLink(e,s,!0,null,!1,o);return c=ViewUtils.replaceHashtagElement(c),c.replace("</pre>","</pre>"+l)}return ViewUtils.urlAutoLink(e,a,!0,null,!1,o)}function l(e,t){if(0==u({message:e}))return e;var n=e.split("\n");if(ColumnMessageView.MESSAGE_ELLIPSIS_MAX_LINES<n.length){for(var o="",i=0;i<ColumnMessageView.MESSAGE_ELLIPSIS_MAX_LINES;i++)o+=n[i]+"\n";return o}return e}function u(e){for(var t in e)if("message"==t){if(!e[t]||"string"!=typeof e[t])return!1}else if("msg"==t){if(!e[t]||"object"!=_typeof(e[t]))return!1}else if("messageOptionNotification"==t){if(null==e[t]||"object"!=_typeof(e[t])||null==e[t].getType)return!1}else if("jid"==t&&(null==e[t]||"string"!=typeof e[t]))return!1;return!0}ColumnMessageView.MESSAGE_ELLIPSIS_MAX_LINES=3,ColumnMessageView.MESSAGE_READ_STATUS_UNREAD_CSS_CLS="unread-message",ColumnMessageView.MESSAGE_READ_STATUS_READ_CSS_CLS="read-message",ColumnMessageView.prototype=$.extend({},ViewCore.prototype);var c=ColumnMessageView.prototype;c.getMessageHtml=function(){},c.setHtmlElement=function(e,t){var n=this,o=n.getMessage();if(n._htmlElement=e,n._htmlElement){var i=n._htmlElement.find("div.frm-good-job").eq(0);1==i.length&&(0!=t&&(n._isToolTipOwner=!0),n._goodJobButton=new ColumnMessageGoodJobButton(i,n,n.getItemId(),o.getGoodJobList(),n._isToolTipOwner));var a=n._htmlElement.find("div.frm-emote").eq(0);1==a.length&&(0!=t&&(n._isToolTipOwner=!0),n._emotionButton=new ColumnMessageEmotionPointButton(a,n,n.getItemId(),o.getEmotionPointList(),n._isToolTipOwner));var r=n._htmlElement.find("a.hashtag");n._setHashtagEvent(r);var s=n._htmlElement.find("a.read-more-link").eq(0);n._setReadMoreEvent(s),n._createEventHandler(),n._setMessageReadFlgView();var l=n._htmlElement.find("div.frm-existing-reader").eq(0);
1==l.length&&(n._columnMessageExistingReaderInfoView=new ColumnMessageExistingReaderInfoView(l,n.getMessage(),n._isToolTipOwner));var u=n._htmlElement.find("img.image-thumbnail"),c=ColumnManager.getInstance().getImageMaxWidth();u.each(function(e,t){var o=$(t);if(!o.attr("src")){var i=n._msg.getItemId(),a=o.attr("data-url");CubeeController.getInstance().downloadThumbnailImage(a,i,o)}o.css("max-width",c)}),ViewUtils.showOpenGraphProtocolImage(n._htmlElement)}},c._setMessageReadFlgView=function(){var e=this,t=e.getMessage(),n=e._getMessageElement(),o=e._htmlElement.find(".toggle_reply");e._htmlElement&&(t.getReadFlag()==Message.READ_STATUS_UNREAD?(n.removeClass(ColumnMessageView.MESSAGE_READ_STATUS_READ_CSS_CLS),n.addClass(ColumnMessageView.MESSAGE_READ_STATUS_UNREAD_CSS_CLS),o.removeClass(ColumnMessageView.MESSAGE_READ_STATUS_READ_CSS_CLS),o.addClass(ColumnMessageView.MESSAGE_READ_STATUS_UNREAD_CSS_CLS)):(n.removeClass(ColumnMessageView.MESSAGE_READ_STATUS_UNREAD_CSS_CLS),n.addClass(ColumnMessageView.MESSAGE_READ_STATUS_READ_CSS_CLS),o.removeClass(ColumnMessageView.MESSAGE_READ_STATUS_UNREAD_CSS_CLS),o.addClass(ColumnMessageView.MESSAGE_READ_STATUS_READ_CSS_CLS)))},c.updateMessageReadStatus=function(e){var t=this,n=t.getMessage();n.setReadFlag(e),t._setMessageReadFlgView()},c.cleanup=function(){null!=this._goodJobButton&&(this._goodJobButton.cleanup(),delete this._goodJobButton),this._goodJobButton=null;var e=this._msg.getItemId();this.getParent().getType()!=ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION&&CubeeController.getInstance().onRemoveMessageView(e),delete this._parent,delete this._htmlElement,delete this._msg},c.getGoodJobButton=function(){return this._goodJobButton},c.getMessage=function(){if(null==this._msg)return null;var e=CubeeController.getInstance().getMessage(this._msg.getItemId());return null!=e&&(this._msg=e),this._msg},c.setMessage=function(e){0!=u({msg:e})&&(this._msg=e,this._itemId=e.getItemId())},c.getParent=function(){return this._parent},c.getItemId=function(){return this._itemId},c._createEventHandler=function(){var e=this,t=(e.getHtmlElement(),e._getMessageElement());t.on("click",function(){e._setReadMessage()})},c._setReadMoreEvent=function(e){var t=this;e&&e.on("click",function(){return t.changeMessage(),!1})},c._setHashtagEvent=function(e){var t=this;e&&e.on("click",function(){ContextSearchView.getInstance().search($(this).text(),t.getParent(),!0)})},c._getMessageElement=function(){var e=this,t=e.getHtmlElement(),n=t.find("div[itemId = '"+e.getItemId()+"']"),o=t.hasClass("thread-message");return o&&(n=t),n},c._setReadMessage=function(){var e=this,t=e.getMessage();ReadMessageSetter.setReadMessage(t)},c.sendGoodJob=function(){function e(e){}function t(){var e=LoginUser.getInstance().getJid(),t=CubeeController.getInstance().getPersonData(e),n=new GoodJobNotification;return n.setItemId(o),n.setFromJid(e),n.setFromName(t.getUserName()),n.setDate(new Date),n.setNickName(t.getUserName()),n.setAvatarType(t.getAvatarType()),n.setAvatarData(t.getAvatarData()),n.setLoginAccount(t.getLoginAccount()),n.setStatus(t.getStatus()),n}var n=this,o=n.getItemId(),i=n.getMessage();if(null!=i){var a=LoginUser.getInstance().getJid();if(null!=a&&""!=a&&!i.getGoodJobList().getByJid(a)){var r=CubeeController.getInstance().sendGoodJob(o,e);if(r){var s=t(),l=i.getGoodJobList(),u=l.getByJid(a);u=new GoodJobData,u.setJid(a),u.setDate(new Date(s.getDate())),u.setNickName(s.getNickName()),u.setAvatarType(s.getAvatarType()),u.setAvatarData(s.getAvatarData()),u.setLoginAccount(s.getLoginAccount()),u.setStatus(s.getStatus()),l.add(u),ColumnManager.getInstance().onNotification(s)}}}},c.onGoodJobReceive=function(){var e=this;null!=e._goodJobButton&&e._goodJobButton.onGoodJobReceive()},c.sendEmotionPoint=function(e){var t=this,n=t.getItemId();(0==e||e)&&CubeeController.getInstance().sendEmotionPoint(n,e,function(){})},c.onEmotionPointReceive=function(){var e=this;null!=e._emotionButton&&e._emotionButton.onEmotionPointReceive()},c.onMessageOptionReceive=function(e){var t=this;if(0!=u({messageOptionNotification:e})){var n=e.getType();n==Notification_model.TYPE_MESSAGE_OPTION&&t._onSetReadMessageReceive(e)}},c._onSetReadMessageReceive=function(e){var t=this;if(0!=u({messageOptionNotification:e})){var n=e.getType();if(n==Notification_model.TYPE_MESSAGE_OPTION){var o=e.getContentType();if(o==MessageOptionNotification.CONTENT_TYPE_SET_READ_MESSAGE){var i=t.getMessage();if(null!=i){var a=i.getType();if(a!=Message.TYPE_PUBLIC){if(null!=t._columnMessageExistingReaderInfoView)return void t._columnMessageExistingReaderInfoView.onSetReadMessageReceive();var r=i.getExistingReaderInfo();if(null!=r){var s=ColumnMessageExistingReaderInfoView.getHtml(r),l=$(s),c=t._htmlElement;c.find(".pack-end:first").prepend(l),t._columnMessageExistingReaderInfoView=new ColumnMessageExistingReaderInfoView(l,t.getMessage(),t._isToolTipOwner)}}}}}}},c.changeMessage=function(){var e,t=this,n=t.getMessage().isReadMore(),o=t._htmlElement.find("div.box-border[itemid='"+t.getItemId()+"']"),i=o.find("div.message-body"),a=o.find(".thumbnail-area").prop("outerHTML"),l=o.find(".message-title"),u=l.length?l.prop("outerHTML"):"",c=o.find(".message-body-note"),d=c.length?c.prop("outerHTML"):"",g=ViewUtils.removeAttachmentUrl(t.getMessage().getMessage()),m=t.getMessage().getType();e=m!=Message.TYPE_PUBLIC&&m!=Message.TYPE_CHAT&&m!=Message.TYPE_GROUP_CHAT&&m!=Message.TYPE_COMMUNITY||1==t.getMessage().getBodyType()?r(t.getMessage().getUIShortenUrls(),g,!0,t.getMessage().getItemId(),n):s(t.getMessage().getUIShortenUrls(),g,!0,t.getMessage().getItemId(),n),a&&(e+=a),(u||d)&&(e=u+d+e),i.html(e),n&&m!=Message.TYPE_PUBLIC&&m!=Message.TYPE_CHAT&&m!=Message.TYPE_GROUP_CHAT&&m!=Message.TYPE_COMMUNITY?o.find(".thumbnail-area").hide():o.find(".thumbnail-area").show(),t.getMessage().setReadMore(!n);var _=$(i).find("a.hashtag");t._setHashtagEvent(_);var f=$(i).find("a.read-more-link").eq(0);t._setReadMoreEvent(f)},c.getMessageHeaderHtml=function(){var e=this,t="",n=e.getMessage(),o=e.getItemId(),i=n.getId(),a=n.getFrom(),r=n.getProfileByJid(a),s=new Person;s.setJid(a),s._profile=r;var l=s.getUserName();(null==l||""==l)&&(l=ViewUtils.getUserName(a));var u=s.getLoginAccount();(null==u||""==u)&&(u=ViewUtils.getCubeeAccountName(a));var c=null!=s?s.getStatus():Person.PROFILE_STATUS_ACTIVE,d=Utils.getDate(n.getDate(),Utils.DISPLAY_STANDARD_DATE_FORMAT),g=n.getUpdatedAt()?Date.create(n.getUpdatedAt()).format(Utils.DISPLAY_STANDARD_DATE_FORMAT):"",m=ViewUtils.getAvatarDataHtmlFromPerson(s);t+='<div class="box-border olient-horizontal message-header">',t+='<div class="message-info" messageid="'+(null==i?"":i)+'" itemid="'+o+'" />',ViewUtils.isIE89()&&(t+="<table><tr><td>"),t+=m,ViewUtils.isIE89()&&(t+='</td><td width="100%">'),t+='<div class="flex1 block-info">',t+='<div class="sender-name text-overflow-ellipsis-nosize box-border-for-abbreviation"',t+=' title="'+Utils.convertEscapedTag(l),t+=ViewUtils.getUserStatusString(c),t+=" @"+Utils.convertEscapedTag(u)+'">',t+=Utils.convertEscapedHtml(l),t+=ViewUtils.getUserStatusString(c),t+='<span class="sender-account">@'+Utils.convertEscapedHtml(u)+"</span></div>";var _="";return g?(_=": "+d+"\n: "+g,t+='<div class="message-time" title="'+_+'">'+d+" ()</div>"):(_=": "+d,t+='<div class="message-time" title="'+_+'">'+d+"</div>"),t+="</div>",ViewUtils.isIE89()&&(t+="</td></tr></table>"),t+="</div>"},c.getMessageHeaderHtmlFromObj=function(t){var n="";return n=e(t)},c.getMessageBodyHtml=function(){var e=this,n="",o=e.getMessage();return n=t(o)},ColumnMessageView.getMessageBodyHtml=function(e){var n="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?n=t(e):n},c.getMessageBodyThumbnailImageHtml=function(e){var t="";return t=o(e)},c._editStart=function(e,t){var n=this,o=new TaskRegister(n,n.getMessage(),e),i=o.getRegisterForm(),a=$("#modal_area");a.html(i);var r=a.children();a.css("display","block"),a.prepend('<div class="overlay modal_exit"></div>'),r.addClass("on").css("display","block").animate({"margin-top":0,opacity:1},200),$(".overlay").animate({opacity:.3},200)},c._editEnd=function(e){e&&"function"==typeof e&&e(),ViewUtils.modal_allexit()},c._invisibleEditView=function(e){e.find("div.register-task-label").hide()},c._hideMessageView=function(){var e=this,t=e.getHtmlElement();null!=t&&(t.hasClass("message-border")&&(t=t.children(":first")),t.children().addClass("display-none"))},c._showMessageView=function(){var e=this,t=e.getHtmlElement();null!=t&&(t.hasClass("message-border")&&(t=t.children(":first")),t.children().removeClass("display-none"),t.attr("style",""))},c._showTaskEditView=function(e){var t=this,n=t.getHtmlElement();if(null!=n){n.hasClass("message-border")&&(n=n.children(":first"));var o=e.getRegisterForm();n.hasClass("olient-horizontal")&&o.addClass("flex1"),n.append(o),e._addTextareaAutosize(n.find("div.task-register-area")),e._addSelectBoxControlEvent(n.find("div.task-register-area"))}},c._hideTaskEditView=function(){var e=this,t=e.getHtmlElement();null!=t&&(t.hasClass("message-border")&&(t=t.children(":first")),t.children("div.task-register-area").remove())},c.onClickTaskAdd=function(){var e=this;e._editStart(TaskRegister.mode_add,void 0)},c.onClickTaskEdit=function(){var e=this;e._editStart(TaskRegister.mode_edit,void 0)},c.onTaskRegist=function(e){function t(e){e&&n._editEnd(void 0)}var n=this;e.registTask(t)},c.onTaskEditCancel=function(){var e=this;e._editEnd(void 0)},c.onAddMessageReferCount=function(){var e=this,t=e.getMessage();if(null!=t){var n=t.getItemId();CubeeController.getInstance().onAddMessageView(n)}},c.getMessageFooterHtml=function(){var e="";return e+='<div class="message-footer"></div>'},c.setMessageInnerActionToolTip=function(){},ColumnMessageView.updateMessageAvatarToolTip=function(e){function t(){i>=o||setTimeout(function(){var e=n.eq(i),o=e.data("mTip");if(o){var a=$("#"+o.tipID);a.length>0&&"none"!=a.css("display")&&TooltipView.getInstance().updateAvatarToolTip(e)}i++,t()},1)}if(0==u({jid:e}))return!1;var n=$("div.column-content").find("div.block-avatar[jid='"+e+"']"),o=n.length,i=0;return t(),!0},ColumnMessageView.updateMessageAvatarProfile=function(e){if(0==u({jid:e}))return!1;for(var t=ViewUtils.getUserName(e),n=$("div.column-content").find("div.block-avatar[jid='"+e+"']"),o=0;o<n.length;o++){var i=n.eq(o),a=i.parent(),r=a.find("div.block-info div.sender-name");i.remove(),a.prepend(ViewUtils.getAvatarDataHtml(e)),_updatedAvaterElem=a.find("div.block-avatar[jid='"+e+"']"),r.text(Utils.convertEscapedHtml(t)),TooltipView.getInstance().setAvatarToolTip(TooltipView.TYPE_USER_AVATAR,_updatedAvaterElem,!0)}return!0}}(),function(){ColumnMessageAvatar.prototype=$.extend({},AvatarView.prototype);AvatarView.prototype,ColumnMessageAvatar.prototype}(),function(){ColumnMessageAvatarTooltip.prototype=$.extend({},TooltipView.prototype);TooltipView.prototype,ColumnMessageAvatarTooltip.prototype}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=new Profile;return t.setNickName(e.getNickName()),t.setAvatarType(e.getAvatarType()),t.setAvatarData(e.getAvatarData()),t.setLoginAccount(e.getLoginAccount()),t.setStatus(e.getStatus()),t}}ColumnMessageGoodJobButton.prototype=$.extend({},ViewCore.prototype);var t=ColumnMessageGoodJobButton.prototype;t.cleanup=function(){var e=this,t=e.getHtmlElement();t.off(),this._htmlElement=null,this._parent=null,this._itemId=null,this._goodJobList=null,this._isToolTipOwner=null},ColumnMessageGoodJobButton.getHtml=function(e){var t="";t+='<div class="frm-good-job">',t+='<a class="msg_gj_btn ico_btn" data-toggle="tooltip" title="" data-original-title="'+Resource.getMessage("goodjob")+'">',t+='<i class="fa fa-thumbs-o-up"></i></a>';var n=e.getCount();return t+=0==n?'<span class="good-job-counter not-read-message txt_btn" data-toggle="tooltip" title="" data-original-title="'+Resource.getMessage("goodjob")+'">':'<span class="good-job-counter not-read-message txt_btn">',t+=""+n,t+="</span>",t+="</div>"},t.getParent=function(){return this._parent},t._createEventHandler=function(){var e=this,t=e.getHtmlElement();t.find(".fa-thumbs-o-up").on("click",function(){e._parent.sendGoodJob()}),t.find("span.good-job-counter").on("click",function(n){t.children(".mTip").hide(),e.showGoodJobUserList(),n.stopPropagation()}),TooltipView.getInstance().createGoodJobTooltip(t,e._getGoodJobList(),e._isToolTipOwner)},t._getGoodJobList=function(){var e=this;if(null==e._itemId)return null;var t=e.getParent().getMessage();return null==t?null:(e._goodJobList=t.getGoodJobList(),e._goodJobList)},t.showGoodJobUserList=function(){var t=this,n=t._getGoodJobList(),o=n.getCount();if(0!=o){for(var i=o-1,a=new ArrayList,r=i;r>=0;r--){var s=n.get(r),l=e(s),u=new Person;u.setJid(s.getJid()),u._profile=l,a.add(u)}var c=new DialogGoodJobPersonListView(t._itemId,a);ColumnManager.getInstance().showPersonListDialog(c)}},t.onGoodJobReceive=function(){var e=this,t=e.getHtmlElement(),n=e._getGoodJobList();t.find("span.good-job-counter").html(n.getCount()),TooltipView.getInstance().createGoodJobTooltip(t,n,e._isToolTipOwner),$(t).find(".good-job-counter").attr({"data-original-title":""})}}(),function(){function e(e){for(var t=0,n=0;n<e._length;n++)t+=e.get(n).getEmotionPoint();return t}function t(e){return 25>=e?"#FDB1B1":50>=e?"#FC5C5C":75>=e?"#FB0000":"#D00000"}ColumnMessageEmotionPointButton.prototype=$.extend({},ViewCore.prototype);var n=ColumnMessageEmotionPointButton.prototype;n.cleanup=function(){var e=this,t=e.getHtmlElement();t.off(),this._htmlElement=null,this._parent=null,this._itemId=null,this._emotionPointList=null,this._isToolTipOwner=null},ColumnMessageEmotionPointButton.getHtml=function(n,o){var i="",a=n.getByJid(LoginUser.getInstance().getJid()),r=e(n);i+='<div class="frm-emote popup_emotion_list">',i+='<a class="popup_btn ico_btn" data-toggle="tooltip" data-container="body" data-original-title="'+Resource.getMessage("data_modal_emotion")+'">',i+=r>0?'<i class="fa fa-heart" style="color:'+t(r)+'"></i></a>':'<i class="fa fa-heart-o"></i></a>',i+='<ul class="popup_list">';var s=o[0]?o[0]:"";i+=a?'<li><a class="txt_btn" data-emote=0>'+s+"</a></li>":'<li><a class="txt_btn selected" data-emote=0>'+s+"</a></li>";for(var l in o)0!=l&&(ViewUtils.isAttachmentUrl(o[l],o[l])?(i+=a&&l==a.getEmotionPoint()?'<li><a class="txt_btn selected" data-emote='+l+">":'<li><a class="txt_btn" data-emote='+l+">",i+=l+'<img class="image-thumbnail clickable" title="'+o[l]+'" data-url="'+o[l]+'"/>',i+="</a></li>"):i+=a&&l==a.getEmotionPoint()?'<li><a class="txt_btn selected" data-emote='+l+">"+o[l]+"("+l+")</a></li>":'<li><a class="txt_btn" data-emote='+l+">"+o[l]+"("+l+")</a></li>");return i+="</ul>",i+=0==r?'<span class="good-job-counter not-read-message txt_btn" data-toggle="tooltip" title="" data-container="body" data-original-title="'+Resource.getMessage("data_modal_emotion")+'">':'<span class="good-job-counter not-read-message txt_btn">',i+=""+r,i+="</span>",i+="</div>"},n.getParent=function(){return this._parent},n._createEventHandler=function(){var e=this,t=e.getHtmlElement();t.find(".popup_list li").on("click",function(){e._parent.sendEmotionPoint($(this).find("a").data("emote"))}),t.find("span.good-job-counter").on("click",function(n){t.children(".mTip").hide(),e.showEmotionPointUserList(),n.stopPropagation()}),TooltipView.getInstance().createGoodJobTooltip(t,e._getEmotionPointList(),e._isToolTipOwner)},n._getEmotionPointList=function(){var e=this;if(null==e._itemId)return null;var t=e.getParent().getMessage();return null==t?null:(e._emotionPointList=t.getEmotionPointList(),e._emotionPointList)},n.showEmotionPointUserList=function(){var e=this,t=e._getEmotionPointList(),n=t.getCount();if(0!=n){var o=new DialogEmotionPointPersonListView(e._itemId,e._emotionPointList,e.getParent().getMessage().getEmotionIconList());ColumnManager.getInstance().showPersonListDialog(o)}},n.onEmotionPointReceive=function(){var t=this,n=t.getHtmlElement(),o=t._getEmotionPointList(),i=ColumnMessageEmotionPointButton.getHtml(o,t.getParent().getMessage().getEmotionIconList());n.children("*").off(),n.children().remove(),n.append($(i).children()),t._createEventHandler(),$(n).find('[data-toggle="tooltip"]').tooltip({trigger:"hover"}),e(o)&&$(n).find(".good-job-counter").attr({"data-original-title":""}),0!=t._emotionPointList._length&&ViewUtils.animateCss(n.find("a.popup_btn"),"rubberBand");var a=n.find("img.image-thumbnail");a.each(function(e,t){var n=$(t);if(!n.attr("src")){var o=n.attr("data-url");CubeeController.getInstance().downloadThumbnailImage(o,"item",n)}})}}(),function(){ColumnMessageReadMoreButton.prototype=$.extend({},ViewCore.prototype);var e=ColumnMessageReadMoreButton.prototype;e.cleanup=function(){var e=this,t=e.getHtmlElement();t.off(),this._htmlElement=null,this._parent=null},ColumnMessageReadMoreButton.getReadMoreImgHtml=function(){return this.getHtmlElement().prop("outerHTML")},e._createEventHandler=function(){var e=this,t=e.getHtmlElement();t.on("click",function(){e._parent.changeMessage()})}}(),function(){ColumnMessageExistingReaderInfoView.prototype=$.extend({},ViewCore.prototype);var e=ColumnMessageExistingReaderInfoView.prototype;e.cleanup=function(){var e=this,t=e.getHtmlElement();t.off(),this._htmlElement=null,this._itemId=null,this._isToolTipOwner=null,this._message=null},ColumnMessageExistingReaderInfoView.getHtml=function(e){var t="";return t+='<div class="frm-existing-reader not-read-message">',t+='<span class="frm-existing-reader-link txt_btn">',t+=""+e.getAllCount(),t+=Resource.getMessage("existing_reader_label"),t+="</span>",t+="</div>"},e._createEventHandler=function(){var e=this,t=e.getHtmlElement();t.on("click","span.frm-existing-reader-link",function(n){t.children(".mTip").hide(),e.showExistingReaderList(),n.stopPropagation()}),e._message.getType()!=Message.TYPE_PUBLIC&&TooltipView.getInstance().createMessageExistingReaderTooltip(t,e._getCachedMessageExistReaderInfo(),e._isToolTipOwner)},e._getCachedMessageExistReaderInfo=function(){var e=this;if(null==e._message)return null;var t=e._message;return null==t?null:t.getExistingReaderInfo()},e.showExistingReaderList=function(){function e(e){if(null!=e){for(var n=e.getExistingReaderItemList(),o=n.getCount(),i=o-1,a=new ArrayList,r=i;r>=0;r--){var s=n.get(r),l=s.getPerson();a.add(l)}var u=new DialogExistingPersonListView(t._itemId,a);ColumnManager.getInstance().showPersonListDialog(u)}}var t=this,n=(t.getHtmlElement(),t._itemId);CubeeController.getInstance().sendGetExistingReaderList(n,e)},e.onSetReadMessageReceive=function(){var e=this,t=e.getHtmlElement(),n=e._getCachedMessageExistReaderInfo(),o=n.getAllCount()+Resource.getMessage("existing_reader_label");t.find(".frm-existing-reader-link").html(o),TooltipView.getInstance().createMessageExistingReaderTooltip(t,n,e._isToolTipOwner)}}(),function(){ColumnMessageTooltip.prototype=$.extend({},TooltipView.prototype);TooltipView.prototype,ColumnMessageTooltip.prototype}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnOptionMenu.ELEMENT_CLASS_NAME="column_option_menu",ColumnOptionMenu.ELEMENT_MENU_FILTER_VAL_NAME="filter",ColumnOptionMenu.ELEMENT_MENU_CUSTOM_FILTER_VAL_NAME="custom_filter",ColumnOptionMenu.ELEMENT_MENU_NOTIFICATION_VAL_NAME="notificationicon_setting",ColumnOptionMenu.ELEMENT_MENU_THREAD_TITLE_LIST="thread_title",ColumnOptionMenu.ELEMENT_MENU_NOTE_ASSIGNED_LIST="assigned_note",ColumnOptionMenu.ELEMENT_MENU_READ_IN_BULK="read_in_bulk",ColumnOptionMenu.ELEMENT_MENU_SET_MURMUR_COLUMN_NAME="set_murmur_column_name",ColumnOptionMenu.getHtml=function(e){var t=(e.getDisplayName(),'<ul class="popup_list">');t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_filter")+"</a></li>",t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_CUSTOM_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_custom_filter")+"</a></li>";var n=e.getColumnType();return(n==ColumnInformation.TYPE_COLUMN_CHAT||n==ColumnInformation.TYPE_COLUMN_TIMELINE)&&(t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_THREAD_TITLE_LIST+'">'+Resource.getMessage("column_option_thread_title_list")+"</a></li>",t+=CodiMdViewUtils.getNoteListHtmlElementForColumn()),t+=ColumnOptionMenu.getNotificationSettingHtml(e),t+="</ul>"},ColumnOptionMenu.getNotificationSettingHtml=function(e){var t=e.getColumnType(),n=null;switch(t){case ColumnInformation.TYPE_COLUMN_MENTION:break;case ColumnInformation.TYPE_COLUMN_TOME:break;case ColumnInformation.TYPE_COLUMN_CHAT:n=e.getFilterCondition();break;case ColumnInformation.TYPE_COLUMN_TASK:break;case ColumnInformation.TYPE_COLUMN_INBOX:break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:n=e.getChatRoomInfomation().getRoomId();break;case ColumnInformation.TYPE_COLUMN_MAIL:break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:n=e.getCommunityInfomation().getRoomId();break;case ColumnInformation.TYPE_COLUMN_MURMUR:n=MurmurColumnInformation.getOwnJidFromSearchCondition(e);break;default:return""}var o=NotificationSettingManager.getInstance(),i="";return i=o.isSetting(t,n)?Resource.getMessage("column_option_notification_on"):Resource.getMessage("column_option_notification_off"),'<li value="'+ColumnOptionMenu.ELEMENT_MENU_NOTIFICATION_VAL_NAME+'"><a class="txt_btn" data-modal="'+ColumnOptionMenu.ELEMENT_MENU_NOTIFICATION_VAL_NAME+'">'+i+"</a></li>"};var e=ColumnOptionMenu.prototype;e._createEventHandler=function(){var e=this,t=e._htmlElement;if(null!==t){var n=t.find('li [value="'+ColumnOptionMenu.ELEMENT_MENU_FILTER_VAL_NAME+'"]');n.on("click",function(){var t=$(this).text(),n=new DialogSettingFilterView(t,e._columnInfo,e._ownerObj);n.showDialog()});var o=t.find('li [value="'+ColumnOptionMenu.ELEMENT_MENU_CUSTOM_FILTER_VAL_NAME+'"]');o.on("click",function(){var t=$(this).text();if(null!=e._columnInfo){var n=null,o=e._columnInfo.getColumnType();if(o==ColumnInformation.TYPE_COLUMN_TASK||o==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK||o==ColumnInformation.TYPE_COLUMN_FILTER&&(e._columnInfo.getSourceColumnType()==ColumnInformation.TYPE_COLUMN_TASK||e._columnInfo.getSourceColumnType()==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK)){var i=new DialogSettingFilterMyTaskView(t,e._columnInfo,e._ownerObj,null);i.showDialog()}else n=o==ColumnInformation.TYPE_COLUMN_INBOX||o==ColumnInformation.TYPE_COLUMN_FILTER&&e._columnInfo.getSourceColumnType()==ColumnInformation.TYPE_COLUMN_INBOX?new DialogSettingCustomFilterInboxView(t,e._columnInfo,e._ownerObj):new DialogSettingCustomFilterView(t,e._columnInfo,e._ownerObj);null!=n&&n.showDialog()}});var i=t.find('li [value="'+ColumnOptionMenu.ELEMENT_MENU_THREAD_TITLE_LIST+'"]');i.on("click",function(){var t=new DialogThreadTitleListView(e._columnInfo,e._ownerObj);t.showDialog()});var a=t.find('li [value="'+ColumnOptionMenu.ELEMENT_MENU_NOTE_ASSIGNED_LIST+'"]');a.on("click",function(){var t=new DialogNoteListView(e._columnInfo);t.showDialog()});var n=t.find('li[value="'+ColumnOptionMenu.ELEMENT_MENU_NOTIFICATION_VAL_NAME+'"]');n.on("click",function(){function t(){var e=NotificationSettingManager.getInstance();e.isSetting(i,a)?n.text(Resource.getMessage("column_option_notification_on")):n.text(Resource.getMessage("column_option_notification_off"));for(var t=ColumnManager.getInstance().getColumnList(),o=t.getCount(),r=0;o>r;r++){var s=t.get(r);if(s.getColumnType()==ColumnInformation.TYPE_COLUMN_RECENT){var l=ColumnFilterManager.getColumnFilter(ColumnInformation.TYPE_COLUMN_RECENT),u=s.getSearchCondition().getSortCondition(),c=new ColumnSearchCondition(l,u);s.setSearchCondition(c);break}}}var n=$(this).find("a"),o=e._columnInfo,i=o.getColumnType(),a=null;switch(i){case ColumnInformation.TYPE_COLUMN_MENTION:break;case ColumnInformation.TYPE_COLUMN_TOME:break;case ColumnInformation.TYPE_COLUMN_CHAT:a=o.getFilterCondition();break;case ColumnInformation.TYPE_COLUMN_TASK:break;case ColumnInformation.TYPE_COLUMN_INBOX:break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:a=o.getChatRoomInfomation().getRoomId();break;case ColumnInformation.TYPE_COLUMN_MAIL:break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:a=o.getCommunityInfomation().getRoomId();break;case ColumnInformation.TYPE_COLUMN_MURMUR:a=MurmurColumnInformation.getOwnJidFromSearchCondition(columnInfo);break;default:return!1}var r=NotificationSettingManager.getInstance();r.isSetting(i,a)?r.removeSetting(i,a,t):r.appendSetting(i,a,t)});var r=t.find('li [value="'+ColumnOptionMenu.ELEMENT_MENU_READ_IN_BULK+'"]');r.on("click",function(){var t=new DialogReadInBulkCheckView(e._columnInfo,$(this).closest(".card.col_card.chat_card"));t.showDialog()})}},e.cleanup=function(){var e=this,t=e._htmlElement;null!=t&&(t.off(),e._htmlElement=null),e.columnInfo&&(e.columnInfo=null),e.ownerObj&&(e.ownerObj=null)}}(),function(){GroupChatColumnOptionMenu.ELEMENT_MENU_CHANGE_AUTHORITY_MEMBER_VAL_NAME="change-authority-member",GroupChatColumnOptionMenu.ELEMENT_MENU_ADD_MEMBER_VAL_NAME="add-member",GroupChatColumnOptionMenu.ELEMENT_MENU_LEAVE_MEMBER_VAL_NAME="leave-member",GroupChatColumnOptionMenu.ELEMENT_MENU_LIST_MEMBER_VAL_NAME="list-member",GroupChatColumnOptionMenu.ELEMENT_MENU_UNSUBSCRIBE_VAL_NAME="unsubscribe",GroupChatColumnOptionMenu.ELEMENT_MENU_PUBLIC_GC_ROOM_UNSUBSCRIBE_VAL_NAME="public-gc-room-unsubscribe",GroupChatColumnOptionMenu.ELEMENT_MENU_UPDATE_ROOM_INFO_VAL_NAME="update-room-info",GroupChatColumnOptionMenu.prototype=$.extend({},ColumnOptionMenu.prototype);var e=ColumnOptionMenu.prototype,t=GroupChatColumnOptionMenu.prototype;GroupChatColumnOptionMenu.getHtml=function(e){var t=e.getChatRoomInfomation().getPrivacyType(),n=AuthorityInfo.getInstance().getWhichRightToGroupchatResource(e.getChatRoomInfomation().getRoomId());if(null==n)return"";var o='<ul class="popup_list">';return o+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_filter")+"</a></li>",o+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_CUSTOM_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_custom_filter")+"</a></li>",o+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_THREAD_TITLE_LIST+'">'+Resource.getMessage("column_option_thread_title_list")+"</a></li>",o+=CodiMdViewUtils.getNoteListHtmlElementForColumn(),n==AuthorityDef.AUTHORITY_ACTIONS.GC_MANAGE?(o+='  <li><a class="txt_btn" value="'+GroupChatColumnOptionMenu.ELEMENT_MENU_UPDATE_ROOM_INFO_VAL_NAME+'">'+Resource.getMessage("column_option_group_chat_update_room_info")+"</a></li>",o+='  <li><a class="txt_btn" value="'+GroupChatColumnOptionMenu.ELEMENT_MENU_ADD_MEMBER_VAL_NAME+'">'+Resource.getMessage("column_option_group_chat_add_member")+"</a></li>",o+='  <li><a class="txt_btn" value="'+GroupChatColumnOptionMenu.ELEMENT_MENU_CHANGE_AUTHORITY_MEMBER_VAL_NAME+'">'+Resource.getMessage("column_option_group_chat_change_authority_member")+"</a></li>",o+='  <li><a class="txt_btn" value="'+GroupChatColumnOptionMenu.ELEMENT_MENU_LEAVE_MEMBER_VAL_NAME+'">'+Resource.getMessage("column_option_group_chat_leave_member")+"</a></li>"):(o+='  <li><a class="txt_btn" value="'+GroupChatColumnOptionMenu.ELEMENT_MENU_LIST_MEMBER_VAL_NAME+'">'+Resource.getMessage("column_option_group_chat_list_member")+"</a></li>",t!=ChatRoomInformation.PRIVACY_TYPE_ITEM_OPEN&&(o+='  <li><a class="txt_btn" value="'+GroupChatColumnOptionMenu.ELEMENT_MENU_UNSUBSCRIBE_VAL_NAME+'">'+Resource.getMessage("column_option_group_chat_unsubscribe")+"</a></li>")),o+=ColumnOptionMenu.getNotificationSettingHtml(e),o+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_READ_IN_BULK+'">'+Resource.getMessage("read_in_bulk_control")+"</a></li>",t==ChatRoomInformation.PRIVACY_TYPE_ITEM_OPEN&&(o+='  <li><a class="txt_btn" value="'+GroupChatColumnOptionMenu.ELEMENT_MENU_PUBLIC_GC_ROOM_UNSUBSCRIBE_VAL_NAME+'">'+Resource.getMessage("column_option_public_group_chat_unsubscribe")+"</a></li>"),o+="</ul>"},t._createEventHandler=function(){e._createEventHandler.call(this);var t=this,n=t._htmlElement;if(null!=n){var o=n.find("li");o.on("click",function(){var e=$(this).text(),n=t._columnInfo.getChatRoomInfomation().getRoomId(),o=null,i=$(this).find("a").attr("value");switch(i){case GroupChatColumnOptionMenu.ELEMENT_MENU_ADD_MEMBER_VAL_NAME:o=new DialogSelectChatRoomAddMemberView(n);break;case GroupChatColumnOptionMenu.ELEMENT_MENU_CHANGE_AUTHORITY_MEMBER_VAL_NAME:o=new DialogSelectChatRoomChangeAuthorityMemberView(n);break;case GroupChatColumnOptionMenu.ELEMENT_MENU_LEAVE_MEMBER_VAL_NAME:o=new DialogSelectChatRoomForceLeaveMemberView(n);break;case GroupChatColumnOptionMenu.ELEMENT_MENU_UNSUBSCRIBE_VAL_NAME:o=new DialogUnsubscribeCheckView(n);break;case GroupChatColumnOptionMenu.ELEMENT_MENU_PUBLIC_GC_ROOM_UNSUBSCRIBE_VAL_NAME:o=new DialogGroupChatUnsubscribeCheckView(n);break;case GroupChatColumnOptionMenu.ELEMENT_MENU_LIST_MEMBER_VAL_NAME:o=new DialogSelectChatRoomConfirmAuthorityMemberView(n);break;case GroupChatColumnOptionMenu.ELEMENT_MENU_UPDATE_ROOM_INFO_VAL_NAME:o=new DialogChatRoomUpdateRoomInfoView(e,t._columnInfo.getChatRoomInfomation().getRoomId());break;default:return}if(o&&o.showDialog(),i!=GroupChatColumnOptionMenu.ELEMENT_MENU_UPDATE_ROOM_INFO_VAL_NAME){var a=$("textarea#add-member-account-input");ViewUtils.setCursorEndOfLineForText(a)}})}}}(),function(){TaskColumnOptionMenu.ELEMENT_MENU_FILTER_TASK_VAL_NAME="filter_task",TaskColumnOptionMenu.prototype=$.extend({},ColumnOptionMenu.prototype);var e=ColumnOptionMenu.prototype,t=TaskColumnOptionMenu.prototype;TaskColumnOptionMenu.getHtml=function(e){var t="";return t+='<ul id="'+ColumnOptionMenu.ELEMENT_ID_NAME+'" class="'+ColumnOptionMenu.ELEMENT_CLASS_NAME+' popup_list">',t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_filter")+"</a></li>",t+='  <li><a class="txt_btn" value="'+TaskColumnOptionMenu.ELEMENT_MENU_FILTER_TASK_VAL_NAME+'">'+Resource.getMessage("task_filter_dialog_title")+"</a></li>",t+=ColumnOptionMenu.getNotificationSettingHtml(e),t+="</ul>"},t._createEventHandler=function(){e._createEventHandler.call(this);var t=this,n=t._htmlElement;if(null!=n){var o=n.find('li [value="'+TaskColumnOptionMenu.ELEMENT_MENU_FILTER_TASK_VAL_NAME+'"]');o.on("click",function(){var e=$(this).text(),n=new DialogSettingFilterMyTaskView(e,t._columnInfo,t._ownerObj,null);n.showDialog()})}}}(),function(){CommunityFeedColumnOptionMenu.ELEMENT_MENU_ADD_COLUMN_TO_MYWORKPLACE_VAL_NAME="add-myworkplace",CommunityFeedColumnOptionMenu.prototype=$.extend({},ColumnOptionMenu.prototype);var e=ColumnOptionMenu.prototype,t=CommunityFeedColumnOptionMenu.prototype;CommunityFeedColumnOptionMenu.getHtml=function(e,t){var n='<ul class="popup_list">';return n+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_filter")+"</a></li>",n+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_CUSTOM_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_custom_filter")+"</a></li>",n+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_THREAD_TITLE_LIST+'">'+Resource.getMessage("column_option_thread_title_list")+"</a></li>",n+=CodiMdViewUtils.getNoteListHtmlElementForColumn(),t!=TabItemView.TYPE_MY_WORK_PLACE&&(n+='  <li><a class="txt_btn" value="'+CommunityFeedColumnOptionMenu.ELEMENT_MENU_ADD_COLUMN_TO_MYWORKPLACE_VAL_NAME+'">'+Resource.getMessage("column_option_add_myworkplace")+"</a></li>"),n+=ColumnOptionMenu.getNotificationSettingHtml(e),n+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_READ_IN_BULK+'">'+Resource.getMessage("read_in_bulk_control")+"</a></li>",
n+="</ul>"},t._createEventHandler=function(){e._createEventHandler.call(this);var t=this,n=t._htmlElement;if(null!=n&&t._tabType!=TabItemView.TYPE_MY_WORK_PLACE){var o=n.find('a[value="'+CommunityFeedColumnOptionMenu.ELEMENT_MENU_ADD_COLUMN_TO_MYWORKPLACE_VAL_NAME+'"]');o.on("click",function(){function e(e){e&&ColumnManager.getInstance().addCommunityFeedColumn(i,!0,!1)}var n=t._columnInfo;if(null!=n&&n.getColumnType()==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED){var o=n.getCommunityInfomation();if(null!=o){var i=o.getRoomId();null!=i&&""!=i&&(TabManager.getInstance().isActiveMyWorkplace()?e(!0):TabManager.getInstance().activeMyWorkplaceTab(e))}}})}}}(),function(){CommunityTaskColumnOptionMenu.ELEMENT_MENU_ADD_COLUMN_TO_MYWORKPLACE_VAL_NAME="add-myworkplace",CommunityTaskColumnOptionMenu.prototype=$.extend({},TaskColumnOptionMenu.prototype);var e=TaskColumnOptionMenu.prototype,t=CommunityTaskColumnOptionMenu.prototype;CommunityTaskColumnOptionMenu.getHtml=function(e,t){var n='<ul class="popup_list">';return n+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_filter")+"</a></li>",n+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_CUSTOM_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_custom_filter")+"</a></li>",t!=TabItemView.TYPE_MY_WORK_PLACE&&(n+='  <li><a class="txt_btn" value="'+CommunityFeedColumnOptionMenu.ELEMENT_MENU_ADD_COLUMN_TO_MYWORKPLACE_VAL_NAME+'">'+Resource.getMessage("column_option_add_myworkplace")+"</a></li>"),n+="</ul>"},t._createEventHandler=function(){e._createEventHandler.call(this);var t=this,n=t._htmlElement;if(null!=n&&t._tabType!=TabItemView.TYPE_MY_WORK_PLACE){var o=n.find('li [value="'+CommunityTaskColumnOptionMenu.ELEMENT_MENU_ADD_COLUMN_TO_MYWORKPLACE_VAL_NAME+'"]');o.on("click",function(){function e(e){e&&ColumnManager.getInstance().addCommunityTaskColumn(i,!0,!1)}var n=t._columnInfo;if(null!=n&&n.getColumnType()==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK){var o=n.getCommunityInfomation();if(null!=o){var i=o.getRoomId();null!=i&&""!=i&&(TabManager.getInstance().isActiveMyWorkplace()?e(!0):TabManager.getInstance().activeMyWorkplaceTab(e))}}})}}}(),function(){ToMeColumnOptionMenu.prototype=$.extend({},ColumnOptionMenu.prototype);var e=ColumnOptionMenu.prototype,t=ToMeColumnOptionMenu.prototype;ToMeColumnOptionMenu.getHtml=function(e){var t='<ul class="popup_list">';t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_filter")+"</a></li>",t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_CUSTOM_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_custom_filter")+"</a></li>";var n=e.getColumnType();return(n==ColumnInformation.TYPE_COLUMN_CHAT||n==ColumnInformation.TYPE_COLUMN_TIMELINE)&&(t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_THREAD_TITLE_LIST+'">'+Resource.getMessage("column_option_thread_title_list")+"</a></li>",t+=CodiMdViewUtils.getNoteListHtmlElementForColumn()),t+=ColumnOptionMenu.getNotificationSettingHtml(e),t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_READ_IN_BULK+'">'+Resource.getMessage("read_in_bulk_control")+"</a></li>",t+="</ul>"},t._createEventHandler=function(){var t=this;e._createEventHandler.call(t)}}(),function(){WithReadDoneColumnOptionMenu.prototype=$.extend({},ColumnOptionMenu.prototype);var e=ColumnOptionMenu.prototype,t=WithReadDoneColumnOptionMenu.prototype;WithReadDoneColumnOptionMenu.getHtml=function(e){var t='<ul class="popup_list">';t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_filter")+"</a></li>",t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_CUSTOM_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_custom_filter")+"</a></li>";var n=e.getColumnType();return(n==ColumnInformation.TYPE_COLUMN_CHAT||n==ColumnInformation.TYPE_COLUMN_TIMELINE)&&(t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_THREAD_TITLE_LIST+'">'+Resource.getMessage("column_option_thread_title_list")+"</a></li>",t+=CodiMdViewUtils.getNoteListHtmlElementForColumn()),t+=ColumnOptionMenu.getNotificationSettingHtml(e),t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_READ_IN_BULK+'">'+Resource.getMessage("read_in_bulk_control")+"</a></li>",t+="</ul>"},t._createEventHandler=function(){var t=this;e._createEventHandler.call(t)}}(),function(){ConversationColumnOptionMenu.prototype=$.extend({},ColumnOptionMenu.prototype);var e=ColumnOptionMenu.prototype,t=ConversationColumnOptionMenu.prototype;ConversationColumnOptionMenu.getHtml=function(e){var t='<ul class="popup_list">';return t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_READ_IN_BULK+'">'+Resource.getMessage("read_in_bulk_control")+"</a></li>",t+="</ul>"},t._createEventHandler=function(){var t=this;e._createEventHandler.call(t)}}(),function(){CustomFilterColumnOptionMenu.prototype=$.extend({},ColumnOptionMenu.prototype);var e=ColumnOptionMenu.prototype,t=CustomFilterColumnOptionMenu.prototype;CustomFilterColumnOptionMenu.getHtml=function(e){var t='<ul class="popup_list">';return t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_READ_IN_BULK+'">'+Resource.getMessage("read_in_bulk_control")+"</a></li>",t+="</ul>"},t._createEventHandler=function(){var t=this;e._createEventHandler.call(t)}}(),function(){FilterColumnOptionMenu.prototype=$.extend({},ColumnOptionMenu.prototype);var e=ColumnOptionMenu.prototype,t=FilterColumnOptionMenu.prototype;FilterColumnOptionMenu.getHtml=function(e){var t='<ul class="popup_list">';return t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_CUSTOM_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_custom_filter")+"</a></li>",t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_READ_IN_BULK+'">'+Resource.getMessage("read_in_bulk_control")+"</a></li>",t+="</ul>"},t._createEventHandler=function(){var t=this;e._createEventHandler.call(t)}}(),function(){RecentColumnOptionMenu.prototype=$.extend({},ColumnOptionMenu.prototype);var e=ColumnOptionMenu.prototype,t=RecentColumnOptionMenu.prototype;RecentColumnOptionMenu.getHtml=function(e){var t='<ul class="popup_list">';return t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_CUSTOM_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_custom_filter")+"</a></li>",t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_THREAD_TITLE_LIST+'">'+Resource.getMessage("column_option_thread_title_list")+"</a></li>",t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_READ_IN_BULK+'">'+Resource.getMessage("read_in_bulk_control")+"</a></li>",t+="</ul>"},t._createEventHandler=function(){var t=this;e._createEventHandler.call(t)}}(),function(){MurmurColumnOptionMenu.prototype=$.extend({},ColumnOptionMenu.prototype);var e=ColumnOptionMenu.prototype,t=MurmurColumnOptionMenu.prototype;MurmurColumnOptionMenu.getHtml=function(e){var t='<ul class="popup_list">';return t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_CUSTOM_FILTER_VAL_NAME+'">'+Resource.getMessage("column_option_custom_filter")+"</a></li>",t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_THREAD_TITLE_LIST+'">'+Resource.getMessage("column_option_thread_title_list")+"</a></li>",CodiMdViewUtils.judgeNoteEnable()&&(t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_NOTE_ASSIGNED_LIST+'">'+Resource.getMessage("dialog_label_get_note_list")+"</a></li>"),t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_READ_IN_BULK+'">'+Resource.getMessage("read_in_bulk_control")+"</a></li>",MurmurColumnInformation.getOwnJidFromSearchCondition(e)==LoginUser.getInstance().getJid()&&(t+='  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_SET_MURMUR_COLUMN_NAME+'">'+Resource.getMessage("set_murmur_column_name")+"</a></li>"),t+="</ul>"},t._createEventHandler=function(){var t=this;e._createEventHandler.call(t);var n=t._htmlElement,o=n.find('li [value="'+ColumnOptionMenu.ELEMENT_MENU_SET_MURMUR_COLUMN_NAME+'"]');o.on("click",function(){var e=new DialogMurmurColumnNameSetView(t._columnInfo);e.showDialog()})}}(),function(){ColumnButtonView.prototype=$.extend({},ViewCore.prototype);var e=ColumnButtonView.prototype;e.cleanup=function(){var e=this,t=e.getHtmlElement();t.off(),this._htmlElement=null,this._parent=null},ColumnButtonView.getHtml=function(e){var t="";switch(e){case ColumnInformation.TYPE_COLUMN_TIMELINE:case ColumnInformation.TYPE_COLUMN_MENTION:case ColumnInformation.TYPE_COLUMN_CHAT:case ColumnInformation.TYPE_COLUMN_TASK:case ColumnInformation.TYPE_COLUMN_INBOX:case ColumnInformation.TYPE_COLUMN_SEARCH:case ColumnInformation.TYPE_COLUMN_FILTER:case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:case ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER:case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:case ColumnInformation.TYPE_COLUMN_RECENT:case ColumnInformation.TYPE_COLUMN_TOME:case ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION:case ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE:case ColumnInformation.TYPE_COLUMN_MURMUR:t='<button type="button" title=""></button>';break;case ColumnInformation.TYPE_COLUMN_MAIL:break;default:throw"ColumnButtonView::getHtml _ invalid type:"+e}return t},e._createEventHandler=function(){var e=this,t=e.getHtmlElement();t&&(t.button(),t.on("mousedown",function(){e._clickEventCallback()}))},e._clickEventCallback=function(){throw"ColumnButtonView::_clickEventCallback _ need override"},e.updateNameHtml=function(e,t){var n=this;if(e&&"string"==typeof e){var o=n.getHtmlElement();o&&(o.attr("data-original-title",t?t:e),o.attr("data-toggle","tooltip"),o.attr("data-placement","bottom"),o.html(e))}}}(),function(){ColumnSubmitButtonView.getHtml=ColumnButtonView.getHtml,ColumnSubmitButtonView.prototype=$.extend({},ColumnButtonView.prototype);var e=(ColumnButtonView.prototype,ColumnSubmitButtonView.prototype);e._clickEventCallback=function(){var e=this;e._parent&&e._parent.clickSubFormButton()}}(),function(){ColumnReloadButtonView.getHtml=ColumnButtonView.getHtml,ColumnReloadButtonView.prototype=$.extend({},ColumnButtonView.prototype);var e=(ColumnButtonView.prototype,ColumnReloadButtonView.prototype);e._clickEventCallback=function(){var e=this;e._parent&&e._parent.clickReloadButton()}}(),function(){ColumnTextAreaView.prototype=$.extend({},ViewCore.prototype);var e=ColumnTextAreaView.prototype;e.cleanup=function(){var e=this,t=e.getHtmlElement();t.find("*").trigger("autosize.destroy").off().remove(),t.off(),this._htmlElement=null,this._parent=null},e.getType=function(){return this._type},ColumnTextAreaView.getHtml=function(e,t,n){var o="";if(null==e||"number"!=typeof e)return o;if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return o;var i="autocomplete",a="";switch(t.sourceColumnType){case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:i="autocomplete-for-chatroom",a='groupId="'+t.roomId+'"';break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:i="autocomplete-for-community",a='groupId="'+t.roomId+'"'}switch(e){case ColumnInformation.TYPE_COLUMN_TIMELINE:1!=n?o='<textarea class="ui-corner-all autoresize-textarea message-input-area '+i+'" '+a+' placeholder="" style="min-height: 60.5px; max-height: 300px;" disabled=true ></textarea>':(o='<textarea class="ui-corner-all autoresize-textarea message-input-area-title '+i+'" '+a+' placeholder="" style="min-height: 32px; height: 32px; max-height: 300px; padding-top: 6px;"></textarea>',o+=ColumnTextAreaView.getTitleCategorySelectorHtml(),o+='<p style="margin: 0px 0 1.5px;"></p>',o+='<textarea class="ui-corner-all autoresize-textarea message-input-area '+i+'" '+a+' placeholder="" style="min-height: 60.5px; max-height: 300px;"></textarea>');break;case ColumnInformation.TYPE_COLUMN_CHAT:o='<textarea class="ui-corner-all autoresize-textarea message-input-area-title '+i+'" '+a+' placeholder="" style="min-height: 32px; height: 32px; max-height: 300px; padding-top: 6px;"></textarea>',o+=ColumnTextAreaView.getTitleCategorySelectorHtml(),o+='<p style="margin: 0px 0 1.5px;"></p>',o+='<textarea class="ui-corner-all autoresize-textarea message-input-area '+i+'" '+a+' placeholder="" style="min-height: 60.5px; max-height: 300px;"></textarea>';break;case ColumnInformation.TYPE_COLUMN_MENTION:case ColumnInformation.TYPE_COLUMN_INBOX:o='<textarea class="ui-corner-all autoresize-textarea message-input-area '+i+'" '+a+' placeholder="" style="min-height: 60.5px; max-height: 300px;"></textarea>';break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:1!=n?o='<textarea class="ui-corner-all autoresize-textarea message-input-area  '+i+'" '+a+' placeholder="" style="min-height: 60.5px; max-height: 300px;" disabled=true ></textarea>':(o='<textarea class="ui-corner-all autoresize-textarea message-input-area-title '+i+'" '+a+' placeholder="" style="min-height: 32px; height: 32px; max-height: 300px; padding-top: 6px;"></textarea>',o+=ColumnTextAreaView.getTitleCategorySelectorHtml("",t.roomId),o+='<p style="margin: 0px 0 1.5px;"></p>',o+='<a class="menthion-dialog-btn fa fa-at" data-toggle="tooltip" data-original-title="'+Resource.getMessage("menthion_icon_title")+'"></a>',o+='<textarea class="ui-corner-all autoresize-textarea message-input-area '+i+'" '+a+' placeholder="" style="min-height: 60.5px; max-height: 300px;"></textarea>');break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:1!=n?o='<textarea class="ui-corner-all autoresize-textarea message-input-area  '+i+'" '+a+' placeholder="" style="min-height: 60.5px; max-height: 300px;" disabled=true ></textarea>':(o='<textarea class="ui-corner-all autoresize-textarea message-input-area-title '+i+'" '+a+' placeholder="" style="min-height: 32px; height: 32px; max-height: 300px; padding-top: 6px;"></textarea>',o+=ColumnTextAreaView.getTitleCategorySelectorHtml("",t.roomId),o+='<p style="margin: 0px 0 1.5px;"></p>',o+='<a class="menthion-dialog-btn fa fa-at" data-toggle="tooltip" data-original-title="'+Resource.getMessage("menthion_icon_title")+'"></a>',o+='<textarea class="ui-corner-all autoresize-textarea message-input-area '+i+'" '+a+' placeholder="" style="min-height: 60.5px; max-height: 300px;"></textarea>');break;case ColumnInformation.TYPE_COLUMN_TASK:case ColumnInformation.TYPE_COLUMN_MAIL:case ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER:case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:case ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION:break;case ColumnInformation.TYPE_COLUMN_SEARCH:case ColumnInformation.TYPE_COLUMN_FILTER:case ColumnInformation.TYPE_COLUMN_TOME:case ColumnInformation.TYPE_COLUMN_RECENT:o='<input type="text" class="ui-corner-all message-input-area '+i+'" '+a+'style="min-height: 3em; overflow-y:visible!important">';break;case ColumnInformation.TYPE_COLUMN_MURMUR:1!=n?o='<textarea class="ui-corner-all autoresize-textarea message-input-area '+i+'" '+a+' placeholder="" style="min-height: 60.5px; max-height: 300px;" disabled=true ></textarea>':(o='<textarea class="ui-corner-all autoresize-textarea message-input-area-title '+i+'" '+a+' placeholder="" style="min-height: 32px; height: 32px; max-height: 300px; padding-top: 6px;"></textarea>',o+=ColumnTextAreaView.getTitleCategorySelectorHtml("","",Message.TYPE_MURMUR),o+='<p style="margin: 0px 0 1.5px;"></p>',o+='<textarea class="ui-corner-all autoresize-textarea message-input-area '+i+'" '+a+' placeholder="" style="min-height: 60.5px; max-height: 300px;"></textarea>');break;default:throw"ColumnTextAreaView::getHtml _ invalid type:"+e}return o},ColumnTextAreaView.getCharCounterHtml=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,n="";if(null==e||"number"!=typeof e)return n;switch(e){case ColumnInformation.TYPE_COLUMN_INBOX:case ColumnInformation.TYPE_COLUMN_MENTION:n+=ViewUtils.getCharCounterHtml("char-counter-column");break;case ColumnInformation.TYPE_COLUMN_TIMELINE:case ColumnInformation.TYPE_COLUMN_CHAT:case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:case ColumnInformation.TYPE_COLUMN_MURMUR:(t||e==ColumnInformation.TYPE_COLUMN_CHAT)&&(n+=ViewUtils.getCharCounterHtml("char-counter-title-column"),n+='<span style="display: inline-block; font-size: 0.5rem; font-weight: bold; margin-right: 2px">,</span>'),n+=ViewUtils.getCharCounterHtml("char-counter-column");break;case ColumnInformation.TYPE_COLUMN_TASK:case ColumnInformation.TYPE_COLUMN_SEARCH:case ColumnInformation.TYPE_COLUMN_FILTER:case ColumnInformation.TYPE_COLUMN_MAIL:case ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER:case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:case ColumnInformation.TYPE_COLUMN_RECENT:case ColumnInformation.TYPE_COLUMN_TOME:case ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION:break;default:throw"ColumnTextAreaView::getCharCounterHtml _ invalid type:"+e}return n},e._createEventHandler=function(){var e=this,t=e.getHtmlElement();e._parent;t.autosize(),t.on("focus",function(){}),t.on("keydown",function(n){if(n.which&&13==n.which||n.keyCode&&13==n.keyCode){if(e._ctrlFlg){var o=$(this.parentNode).children("button");$(o).mousedown(),$(o).mouseup()}}else n.which&&17==n.which||n.keyCode&&17==n.keyCode?e._ctrlFlg=!0:9===n.keyCode||9===n.which?t.hasClass("message-input-area-title")?t.parent().find(".message-input-area").focus():t.parent().find(".message-input-area-title").focus():e._ctrlFlg=!1}),t.on("keyup",function(t){(t.which&&17==t.which||t.keyCode&&17==t.keyCode)&&(e._ctrlFlg=!1)}),ColumnTextAreaView.setTitleCategorySelectorEvent(t.parent(),".message-input-area-title")},e.getText=function(){var e=this,t=e.getHtmlElement();return t.val()},e.clearText=function(){var e=this,t=e.getHtmlElement();t.val(""),t.trigger("autosize.resize")},e.clearTextFromFlag=function(e){var t=this,n=t.getHtmlElement(),o=n.val();setTimeout(function(){0!=e||0==e&&""==o?(n.val(""),n.trigger("autosize.resize")):(n.val(o),n.trigger("autosize.resize"))},1)},ColumnTextAreaView.getTitleCategorySelectorHtml=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null==e&&(e="");var o=LoginUser.getInstance().getTenantInfo().threadTitleCategory;if(n==Message.TYPE_MURMUR){var i=LoginUser.getInstance().getTenantInfo().threadTitleCategoryForMurmur;i&&(o=i)}else if(t){var a=LoginUser.getInstance().getTenantInfo().threadTitleCategoryForRoom;a&&t in a&&(o=a[t])}var r='<div class="thread-title-category-select-btn popup_btn '+e+'"data-original-title="'+Resource.getMessage("title_select_category")+'" data-toggle="tooltip" data-placement="right"> <a  class="fa fa-caret-right"></a></div>',s='<ul class="thread-title-category-select-list popup_list '+e+'">';if(o&&0!=Object.keys(o).length)for(var l=Object.keys(o).sort(function(e,t){return o[e].id-o[t].id}),u=0;u<l.length;u++){var c=decodeURIComponent(l[u]),d=o[l[u]].bgColor;o[l[u]].color;s+=' <li class="thread-title-category-select-opt '+e+'" category="'+c+'"><a><span class="title-category-color fa fa-check-square" style="font-size:16px;vertical-align:-1px;margin-right:5px;color:'+d+'"></span>'+c+"</a></li>"}return s+="</ul>",r+s},ColumnTextAreaView.setTitleCategorySelectorEvent=function(e,t){var n=e.find(".thread-title-category-select-list");e.find(".thread-title-category-select-btn").off("click.thread-title-category-select-btn"),e.find(".thread-title-category-select-opt").off("click.thread-title-category-select-opt"),$(n).hide(),e.find(".thread-title-category-select-btn").on("click.thread-title-category-select-btn",function(o){if("block"==$(n).css("display"))$(n).css("z-index","1");else{var i=$(o.currentTarget).attr("class").split(" "),a="body";i.length>1&&"undefined"!=i[1]&&(a="#grouptitle_modal"),$(n).css("z-index","9999"),$('<div id="thread-title-category-select-back">').prependTo(a).on("click",function(e){$(n).css("display","none"),$(e.currentTarget).remove()});for(var r=$(o.currentTarget).parent().find("li.thread-title-category-select-opt"),s=e.find(t).val(),l={},u=0;u<r.length;u++)l[$(r[u]).attr("category")]=r[u],$(r[u]).find("a > span.title-category-color").removeClass("fa-check-square").addClass("fa-square");var c=new RegExp(/\[([^\]\s]+)\]/,"g"),d=!0,g=[];s.replace(c,function(e,t,n,o){return t&&d&&g.length<5&&(null!=l[t]||t.length<=2)&&(n>0&&"]"==o.substring(n-1,n)||0==n)?($(l[t]).find("a > span.title-category-color").removeClass("fa-square").addClass("fa-check-square"),g.push(t),""):(d=!1,e)})}});var o=function(o){for(var i=$(o.currentTarget).parent().find("li.thread-title-category-select-opt"),a=$(o.currentTarget).attr("category"),r=e.find(t).val(),s={},l=0;l<i.length;l++)s[$(i[l]).attr("category")]=i[l];var u=!0,c=0,d=[],g=new RegExp(/\[([^\]\s]+)\]/,"g");r.replace(g,function(e,t,n,o){return t&&d.length<5&&u&&(null!=s[t]||t.length<=2)&&(n>0&&"]"==o.substring(n-1,n)||0==n)?(null!=s[t]&&$(s[t]).find("a > span.title-category-color").removeClass("fa-square").addClass("fa-check-square"),c=n+e.length,d.push(t),""):(u=!1,e)});var m=!1,_=new RegExp("\\[("+a+")\\]");if(c>0&&(m=r.substring(0,c).match(_)),m||(m=d.length>=5),m){var f=new RegExp("\\[("+a+")\\]","g"),p=r.substring(c);r=r.substring(0,c).replace(f,""),r+=p,setTimeout(function(){$(o.currentTarget).parent().find('li.thread-title-category-select-opt[category="'+a+'"] > a > span.title-category-color').removeClass("fa-check-square").addClass("fa-square")},300)}else r=r.substring(0,c)+"["+a+"]"+r.substring(c),setTimeout(function(){$(o.currentTarget).parent().find('li.thread-title-category-select-opt[category="'+a+'"] > a > span.title-category-color').removeClass("fa-square").addClass("fa-check-square")},300);$(n).fadeOut(300),e.find(t).val(r),$("#thread-title-category-select-back").remove()};e.find(".thread-title-category-select-opt").on("click.thread-title-category-select-opt",o)}}(),function(){function e(){var e='<a class="ico_btn" id="fileupload_cancel_btn">';return e+='  <i class="fa fa-close" title="'+Resource.getMessage("dialog_cancel_title")+'"></i>',e+="</a>"}function t(){return ViewUtils.isIE89()?'<input type="file" name="uploadfile" class="file-ie" />':'<input type="file" name="upfile" class="file" />'}function n(){var e='<div class="file-inputs white-space-nowrap">';return e+=t(),e+='<div class="file-selected">',ViewUtils.isIE89()?(e+='<br class="clear-float" />',e+='<p class="file-name">&nbsp;</p>'):(e+='<a class="ico_btn" data-toggle="tooltip" title="" data-original-title="'+Resource.getMessage("file_up_title")+'" data-placement="right"><i class="fa fa-paperclip"></i></a>',e+='<p class="file-name">&nbsp;</p>',e+=ProgressBarView.getHtml("submit-message-progress"),e+='<br class="clear-float" />'),e+="</div>",e+="</div>"}ColumnFileUploadPartsView.MAX_FILE_UPLOAD_SIZE_MB=20,ColumnFileUploadPartsView.prototype=$.extend({},ViewCore.prototype);var o=ColumnFileUploadPartsView.prototype;o.cleanup=function(){var e=this,t=e.getHtmlElement();t.off(),e._htmlElement=null,e._parent=null},ColumnFileUploadPartsView.getHtml=function(e){var t="";if(null==e||"number"!=typeof e)return t;switch(e){case ColumnInformation.TYPE_COLUMN_TIMELINE:case ColumnInformation.TYPE_COLUMN_MENTION:case ColumnInformation.TYPE_COLUMN_CHAT:case ColumnInformation.TYPE_COLUMN_INBOX:case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:case ColumnInformation.TYPE_COLUMN_MURMUR:t=n();break;case ColumnInformation.TYPE_COLUMN_TASK:case ColumnInformation.TYPE_COLUMN_SEARCH:case ColumnInformation.TYPE_COLUMN_FILTER:case ColumnInformation.TYPE_COLUMN_MAIL:case ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER:case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:case ColumnInformation.TYPE_COLUMN_RECENT:case ColumnInformation.TYPE_COLUMN_TOME:case ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION:break;default:throw"ColumnFileUploadPartsView::getHtml _ invalid type:"+e}return t},ColumnFileUploadPartsView.getFormHtml=function(){return n()},o.clearFileUpload=function(){var e=this,n=e.getHtmlElement();n.find('input[type="file"]').replaceWith(t()),n.find("#fileupload_cancel_btn").remove();var o=n.find("p.file-name");o.text(""),o.attr("title","")},o._createEventHandler=function(){var n=this,o=n.getHtmlElement();o.on("click","div.file-selected > a.ico_btn .fa-paperclip",function(){o.find('input[type="file"]').click()}),ViewUtils.isIE89()?o.on("click","div.file-inputs > a.ico_btn .fa-close",function(){o.find('input[type="file"]').replaceWith(t()),$(this).remove(),ViewUtils.hideErrorMessageIE(n.getHtmlElement().parent().find("textarea.ui-corner-all"))}):o.on("click","div.file-selected > a.ico_btn .fa-close",function(){o.find('input[type="file"]').replaceWith(t()),$(this).remove();var e=o.find("p.file-name");e.removeClass("ui-state-error-text"),e.text(""),e.attr("title","")}),o.on("change",'input[type="file"]',function(){if(ViewUtils.isIE89()){try{var t=new ActiveXObject("Scripting.FileSystemObject");if(t.FileExists(this.value)){var i=t.getFile(this.value),a=0;if(i.size>1048576&&(a=Math.round(100*i.size/1048576)/100,a>ColumnFileUploadPartsView.MAX_FILE_UPLOAD_SIZE_MB)){n.clearFileUpload(),ViewUtils.showErrorMessageIE(n.getHtmlElement().parent().find("textarea.ui-corner-all"),Resource.getMessage("error_file_up_over_max_sixe"));var r=o.find('input[type="file"]');return void r.after(e())}}}catch(s){}var r=o.find('input[type="file"]');o.find("#fileupload_cancel_btn").remove(),r.after(e()),ViewUtils.hideErrorMessageIE(n.getHtmlElement().parent().find("textarea.ui-corner-all"))}else{var l=$(this).prop("files")[0];if(l){var u=o.find("p.file-name");u.removeClass("size_error");var a=0;if(l.size>1048576&&(a=Math.round(100*l.size/1048576)/100,a>ColumnFileUploadPartsView.MAX_FILE_UPLOAD_SIZE_MB))return n.clearFileUpload(),u=o.find("p.file-name"),u.addClass("size_error"),u.text(Resource.getMessage("error_file_up_over_max_sixe")),u.attr("title",Resource.getMessage("error_file_up_over_max_sixe")),void u.after(e());u.text(l.name),u.attr("title",l.name),o.find("#fileupload_cancel_btn").remove(),u.after(e())}else n.clearFileUpload()}})},o.getFilesObject=function(){var e=this,t=e.getHtmlElement(),n=t.find('input[type="file"]');return n.prop("files")},o.getFileForm=function(){var e=this,t=e.getHtmlElement(),n=t.find('input[type="file"]');return n[0]},$(function(){})}(),function(){ProgressBarView.MIN_VALUE=0,ProgressBarView.MAX_VALUE=100,ProgressBarView.prototype=$.extend({},ViewCore.prototype);var e=ProgressBarView.prototype;e.cleanup=function(){var e=this;e.getHtmlElement().progressbar("destroy"),e.getHtmlElement().remove,e._htmlElement=null},ProgressBarView.getHtml=function(e){var t="";return null==e||"string"!=typeof e?t:t='<div class="'+e+'"></div>'},e.setProgressValue=function(e){var t=this,n=t.getHtmlElement();n.progressbar("option","value",e)},e.progressComplete=function(){var e=this;e.setProgressValue(ProgressBarView.MAX_VALUE)},e.progressClear=function(){var e=this;e.hiddenProgressBar(),e.setProgressValue(ProgressBarView.MIN_VALUE)},e.visibleProgressBar=function(){var e=this;e.getHtmlElement().css("visibility","visible")},e.hiddenProgressBar=function(){var e=this;e.getHtmlElement().css("visibility","hidden")},e._createEventHandler=function(){var e=this,t=e.getHtmlElement();t.progressbar({complete:function(){e.progressClear()}})},$(function(){})}(),function(){function e(e){return Resource.getMessage("gorup_chat_member_label")+e+Resource.getMessage("group_chat_member_count_suffix")+":"}function t(e){function t(){i>=o||setTimeout(function(){var e=n.eq(i),o=e.data("mTip");if(o){var a=$("#"+o.tipID);a.length>0&&"none"!=a.css("display")&&TooltipView.getInstance().updateAvatarToolTip(e)}i++,t()},1)}if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var n=e,o=n.length,i=0;return t(),!0}function n(e,t){function n(){s>=r||setTimeout(function(){var e=a.eq(s),t=e.find(".button_presence").detach();e.children("span").remove(),e.prepend($(ViewUtils.getAvatarDataHtmlFromPerson(i)).children("span")),e.find("span.ico.ico_user").removeClass("ico ico_user").addClass(t.attr("class")),s++,n()},1)}if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return!1;var o=e.getJid(),i=ViewUtils.createPersonByProfile(o,e.getProfile()),a=t,r=a.length,s=0;return n(),!0}MemberAreaView.CSS_CLS_NAME="column-member-area",MemberAreaView.CSS_HEDER_CLS_NAME=MemberAreaView.CSS_CLS_NAME+"-header",MemberAreaView.CSS_BODY_CLS_NAME=MemberAreaView.CSS_CLS_NAME+"-body",MemberAreaView.CSS_MEMBER_COUNT_CLS_NAME="column-member-count";var o=MemberAreaView.prototype;o.cleanup=function(){var e=this,t=e._htmlElement;t.off(),e._htmlElement=null,e._readMoreButton=null,e._parent=null},MemberAreaView.getHtml=function(t){var n="";if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return n;var o=t.getMemberList(),i=t.getProfileMap(),a=o.getCount();n+='<div class="'+MemberAreaView.CSS_CLS_NAME+'">',n+='<div class="'+MemberAreaView.CSS_BODY_CLS_NAME+' hide-view cf">',n+='<div class="'+MemberAreaView.CSS_HEDER_CLS_NAME+'">',n+='<div class="'+MemberAreaView.CSS_MEMBER_COUNT_CLS_NAME+'">'+e(a)+"</div>",n+="</div>";for(var r=0;a>r;r++){var s=o.get(r),l=i.getByKey(s),u=ViewUtils.createPersonByProfile(s,l);n+=ViewUtils.getAvatarDataHtmlFromPerson(u)}return n+="</div>",n+="</div>"},o.changeMessage=function(){var e=this,t=(e._parent,e._htmlElement),n=t.find("."+MemberAreaView.CSS_BODY_CLS_NAME);n.is(":visible");t.removeClass("animation").toggleClass("open").find(".column-member-area-body").stop().slideToggle(200,function(){t.addClass("animation"),$(window).trigger("resize")})},MemberAreaView.updateMessageAvatarToolTip=function(e){if(null==e||"string"!=typeof e)return!1;var n=$("."+MemberAreaView.CSS_CLS_NAME).children("."+MemberAreaView.CSS_BODY_CLS_NAME).find(".block-avatar[jid='"+e+"']");return t(n)},o.updateMessageAvatarToolTip=function(e){if(null==e||"string"!=typeof e)return!1;var n=this,o=n._htmlElement.children("."+MemberAreaView.CSS_BODY_CLS_NAME).find(".block-avatar[jid='"+e+"']");return t(o)},o.addMessageAvatarToolTip=function(e){if(null==e||"string"!=typeof e)return!1;var t=this,n=t._htmlElement.children("."+MemberAreaView.CSS_BODY_CLS_NAME).find(".block-avatar[jid='"+e+"']");return TooltipView.getInstance().setAvatarToolTip(TooltipView.TYPE_USER_AVATAR,n.eq(0),!1)},MemberAreaView.updateMessageAvatarProfile=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=e.getJid();if(null==t||"string"!=typeof t)return!1;var o=$("."+MemberAreaView.CSS_CLS_NAME).children("."+MemberAreaView.CSS_BODY_CLS_NAME).find(".block-avatar[jid='"+t+"']");return $(o)[0]?n(e,o):!1},MemberAreaView.updateMessageAvatarPresenceIcon=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=e.getJid(),n=$("."+MemberAreaView.CSS_CLS_NAME).children("."+MemberAreaView.CSS_BODY_CLS_NAME).find(".block-avatar[jid='"+t+"']");return setTimeout(function(){ViewUtils.showPresenceIcon(n,e.getPresence(),ViewUtils.STATUS_PRESENCEICON_GROUPCHAT_MEMBERLIST)},1),!0},o.onAddMember=function(t){if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return!1;var n=this,o=t.getJid(),i=n._parent,a=ViewUtils.getAvatarDataHtmlFromPerson(t),r=i.getColumnInfo(),s=r.getChatRoomInfomation(),l=s.getMemberList(),u=l.getCount(),c=e(u),d=n._htmlElement.find("."+MemberAreaView.CSS_MEMBER_COUNT_CLS_NAME);d.text(c);var g=n._htmlElement.children("."+MemberAreaView.CSS_BODY_CLS_NAME);g.append(a);var m=CubeeController.getInstance().getPersonData(o),_=0;null!=m&&(_=m.getPresence());var f=g.find(".block-avatar[jid='"+o+"']");ViewUtils.showPresenceIcon(f,_,ViewUtils.STATUS_PRESENCEICON_GROUPCHAT_MEMBERLIST),n.addMessageAvatarToolTip(o)},o.onRemoveMember=function(t){if(null==t||"string"!=typeof t)return!1;
var n=this,o=n._parent,i=o.getColumnInfo(),a=i.getChatRoomInfomation(),r=a.getMemberList(),s=r.getCount(),l=e(s),u=n._htmlElement.find("."+MemberAreaView.CSS_MEMBER_COUNT_CLS_NAME);u.text(l);var c=$(n._htmlElement);c.find('div[jid="'+t+'"]').eq(0).remove()},o.updateAvatarPresenceByPersonData=function(e){function t(){r>=a||setTimeout(function(){var n=i.eq(r),o=n.find(".button_presence").detach();n.children("span").remove(),n.prepend($(ViewUtils.getAvatarDataHtmlFromPerson(e)).children("span")),n.find("span.ico.ico_user").removeClass("ico ico_user").addClass(o.attr("class")),r++,t()},1)}if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=this,o=e.getJid(),i=n._htmlElement.children("."+MemberAreaView.CSS_BODY_CLS_NAME).find(".block-avatar[jid='"+o+"']"),a=i.length,r=0;t()}}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){RegisterView.prototype=$.extend({},ViewCore.prototype);var e=RegisterView.prototype;e._createSubForms=function(e){},e._addEventHandler=function(){},e._removeEventHandler=function(){},e._clickRegisterButton=function(){},e._clickCancelButton=function(){},e._cleanup=function(){},e.appear=function(){},e._createRegisterForm=function(){},e._isValidationOk=function(){},e.isEmptyValue=function(e){var t=!1;return(null==e||"string"==typeof e&&""==e)&&(t=!0),t},e._updateMessageData=function(){}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t){"OPTION"==t.target.nodeName.toUpperCase()?setTimeout(function(){e.val($(t.target).val()),e.blur()},1):"SELECT"==t.target.nodeName.toUpperCase()&&e.blur()}TaskRegister.mode_add="TaskParameter.mode_add",TaskRegister.mode_edit="TaskParameter.mode_edit",TaskRegister.MAX_LENGTH_TASK_NAME=Conf.getVal("TASK_TITLE_MAX_LENGTH"),TaskRegister.MAX_LENGTH_TASK_BODY=Conf.getVal("MESSAGE_BODY_MAX_LENGTH"),TaskRegister.TASK_TYPE_MY_TASK=0,TaskRegister.TASK_TYPE_COMMUNITY_TASK=1;var t=TaskRegister.prototype;t.init=function(){var e=this,t=Utils.DISPLAY_STANDARD_DATE_FORMAT;e._taskTitle=e._messageData.getTitle?e._messageData.getTitle():"",e._romMessage=e._messageData.getMessage(),e._files=[],e._urlList=ViewUtils.extractAttachedFileUrls(e._romMessage);for(var n=0;n<e._urlList.getCount();n++)e._files.push(e._urlList.get(n));e._taskMessageBody=ViewUtils.removeAttachmentUrl(e._romMessage);var o=LoginUser.getInstance().getJid(),i=e._messageData.getOwnerJid?e._messageData.getOwnerJid():o,a=e._messageData.getClient?e._messageData.getClient():"";e._mode==TaskRegister.mode_add&&""==a?e._messageData.getType()!=Message.TYPE_MAIL&&(e._client=e._messageData.getFrom()):e._client=a,e._clientUsername="";var r=e._messageData.getProfileMap();if(r&&"object"==("undefined"==typeof r?"undefined":_typeof(r))){var s=r.getByKey(e._client);s&&"object"==("undefined"==typeof s?"undefined":_typeof(s))&&(e._clientUsername=s.getNickName())}e._owner=i,e._taskStartDate=e._messageData.getStartDate?e._messageData.getStartDate():"",e._taskStartDateStr=e._taskStartDate?Utils.getDate(e._taskStartDate.toString(),t):"",e._taskDueDate=e._messageData.getDueDate?e._messageData.getDueDate():e._messageData.getDueDate,e._taskDueDateStr=e._taskDueDate?Utils.getDate(e._taskDueDate.toString(),t):"",e._mode==TaskRegister.mode_add?(e._taskStatus=TaskMessage.STATUS_UNKNOWN,e._taskPriority=TaskMessage.PRIORITY_LOW):(e._taskStatus=e._messageData.getStatus(),e._taskPriority=e._messageData.getPriority())},t.getContactList=function(e){var t={list:[],hash:{}};if(e){var n=LoginUser.getInstance();t.list.push(n),t.hash[n.getJid()]=n}for(var o=ContactList.getInstance(),i=o.getCount(),a=0;i>a;a++){var r=o.get(a),s=r.getJid();t.list.push(r),t.hash[s]=r}return t},t.getPriorities=function(){return[{value:TaskMessage.PRIORITY_LOW,label:Resource.getMessage("task_priority_low")},{value:TaskMessage.PRIORITY_MEDIUM,label:Resource.getMessage("task_priority_medium")},{value:TaskMessage.PRIORITY_HIGH,label:Resource.getMessage("task_priority_high")},{value:TaskMessage.PRIORITY_TOP,label:Resource.getMessage("task_priority_top")}]},t.getRegisterForm=function(){var e,t,n,o=this,i=(o.getContactList(!0),LoginUser.getInstance().getJid());n=this._mode==TaskRegister.mode_add?!1:o._owner==i?!0:!1;var a="",r="unknown node!";switch(this._mode){case TaskRegister.mode_add:r=Resource.getMessage("task_title_registerTask");break;case TaskRegister.mode_edit:r=Resource.getMessage("task_title_editTask")}if(a+='<div id="taskregist_modal" class="card modal_card">',a+='  <div class="card_title">',a+="    <p>"+r+"</p>",a+="  </div>",a+='  <div class="modal_content_wrapper">',a+='    <div class="modal_content register-task-name">',a+='      <p class="modal_title">'+Resource.getMessage("task_name")+"</p>",a+='    <div class="register-task-name-char-counter">',a+=ViewUtils.getCharCounterHtml("char-counter-task-register"),a+="    </div>",a+='      <input type="text" name="task-name" class="field task-register-item ui-corner-all" value="'+Utils.convertEscapedTag(o._taskTitle)+'" placeholder="'+Resource.getMessage("task_register_name_placeholder")+'">',a+="    </div>",a+='    <div class="modal_content register-task-body">',a+='      <p class="modal_title">'+Resource.getMessage("task_body")+"</p>",a+='      <div class="register-task-body-char-counter">',a+=ViewUtils.getCharCounterHtml("char-counter-task-register"),a+="      </div>",a+='      <div class="textarea">',a+='        <textarea name="task-body" class="field task-register-item ui-corner-all autocomplete" rows="2" placeholder="'+Resource.getMessage("task_body_placeholder")+'">'+Utils.convertEscapedHtml(o._taskMessageBody)+"</textarea>",a+="      </div>",a+='     <div class="register-task-body attatch-file-anchor olient-horizontal file-inputs">',a+="     </div>",a+="    </div>",a+='    <div class="modal_content register-task-client">',a+='      <p class="modal_title">'+Resource.getMessage("task_client")+"</p>",n)a+='<input type="text" class="field task-register-item register-client-input ui-corner-all autocomplete" value="'+Utils.convertEscapedHtml(o._clientUsername)+'" placeholder="'+Resource.getMessage("dialog_placeholder_account")+'" disabled>';else{var s="",l=o._messageData.getProfileMap();if(l&&"object"==("undefined"==typeof l?"undefined":_typeof(l))){var u=l.getByKey(o._client);null!=u&&(s="@"+u.getLoginAccount())}""===s&&(s=ViewUtils.convertJidStrToAccountStr(i)),a+=o._mode==TaskRegister.mode_edit?'<input type="text" class="field task-register-item register-client-input ui-corner-all autocomplete" value="'+Utils.convertEscapedTag(null==s?"":s)+'" placeholder="'+Resource.getMessage("dialog_placeholder_account")+'" disabled>':'<input type="text" class="field task-register-item register-client-input ui-corner-all autocomplete" value="'+Utils.convertEscapedTag(null==s?"":s)+'" placeholder="'+Resource.getMessage("dialog_placeholder_account")+'">'}a+="    </div>",a+='    <div class="modal_content register-task-owner ">';var c=Resource.getMessage("task_multi_selection"),d="";o._mode==TaskRegister.mode_edit?(c=Resource.getMessage("task_non_multi_selection"),d=ViewUtils.convertJidStrToAccountStr(o._owner)+" "):d=ViewUtils.convertJidStrToAccountStr(i)+" ",a+='      <p class="modal_title">'+Resource.getMessage("task_owner")+" "+c+"</p>";var g=" ";(o._mode==TaskRegister.mode_edit&&o._getCommunityId()||o._mode==TaskRegister.mode_edit&&o._client!=i)&&(g="disabled"),a+='<textarea class="field task-register-item register-owner-input ui-corner-all autocomplete" placeholder="'+Resource.getMessage("dialog_placeholder_account")+'" '+g+">"+(null==d?"":d)+"</textarea>",a+="    </div>",a+='    <div class="modal_content w50 register-task-status">',a+='      <p class="modal_title">'+Resource.getMessage("task_status")+"</p>",a+='      <select class="field task-status task-register-item ui-corner-all">',a+='        <option value="3" selected="">'+Resource.getMessage("task_status_new")+"</option>",a+='        <option value="4">'+Resource.getMessage("task_status_do")+"</option>",a+='        <option value="7">'+Resource.getMessage("task_status_fin")+"</option>",a+='        <option value="8">'+Resource.getMessage("task_status_rej")+"</option>",a+="      </select>",a+="    </div>";var m=o.getPriorities();for(a+='    <div class="modal_content w50 register-task-priority">',a+='      <p class="modal_title">'+Resource.getMessage("task_priority_title")+"</p>",a+='      <select class="field task-priority task-register-item ui-corner-all">',e=0;e<m.length;e++){var _=m[e];t=o._taskPriority==_.value?"selected":"",a+='        <option value="'+_.value+'" '+t+">"+_.label+"</option>"}a+="      </select>",a+="    </div>",a+=o._getInputTaskTypeHtml(),a+='    <div class="modal_content w50 mb0 register-task-start-date">',a+='      <p class="modal_title">'+Resource.getMessage("task_start_date")+"</p>",a+='      <input type="text" class="field task-start-date date-time-picker task-register-item ui-corner-all" value="'+o._taskStartDateStr+'">',a+="    </div>",a+='    <div class="modal_content w50 mb0 register-task-due-date">',a+='      <p class="modal_title">'+Resource.getMessage("task_due_date")+"</p>",a+='      <input type="text" class="field task-due-date date-time-picker task-register-item ui-corner-all" value="'+o._taskDueDateStr+'">',a+="    </div>",a+="  </div>",a+='  <div class="btn_wrapper">',a+='    <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',a+='    <button class="modal_btn success_btn register-task-OK ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">OK</span></button>',a+="  </div>",a+='  <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',a+="</div>";var f=this._registerForm=$(a),p=$(f).find("div.register-task-name");ViewUtils.setCharCounter($(p).find('input[name="task-name"]'),$(p).find("."+ViewUtils.CHAR_COUNTER_CLASSNAME),ColumnTaskMessageView.MAX_LENGTH_TASK_NAME,!0);var h=$(f).find("div.register-task-body"),C=$(h).find("textarea");ViewUtils.setCharCounter($(C),$(h).find("."+ViewUtils.CHAR_COUNTER_CLASSNAME),ColumnTaskMessageView.MAX_LENGTH_TASK_BODY);var v=$(f).find("div.btn_wrapper"),y=$(v).find("button.modal_btn").button();$(y).on("click",function(){o._parentObject.onTaskRegist(o)});var T=$(f).find("div.attatch-file-anchor"),b=this._fileList=new AttachedFileList(T);if(b.cleanup(),o._files.length){for(;o._files.length;)b.add(o._files.shift());$(T).append(b.getHtml())}else T.remove();var I=$(f).find("input.date-time-picker");I.datetimepicker();var M=$(f).find("div.register-task-client > input.register-client-input"),E=$(f).find("div.register-task-owner > textarea.register-owner-input"),S=$(f).find("div.register-task-status > select.task-status"),w=$(f).find("div.register-task-type > select.task-type");$(M).on("change keyup focus",function(){o._onChangeOwnerClient()}),$(E).on("change keyup focus",function(){o._onChangeOwnerClient()}),$(w).on("change keyup focus",function(){o._onChangeOwnerClient()});var N=$(f).find("div.register-task-type > select.task-type");if(1==$(N).length){var A=o._getCommunityId();M.removeClass("autocomplete"),M.addClass("autocomplete-for-community"),M.attr("communityId",A),E.removeClass("autocomplete"),E.addClass("autocomplete-for-community"),E.attr("communityId",A)}o._onChangeOwnerClient(),$(S).val(o._taskStatus);var U=$(f).find("div.modal_content_wrapper");return $(U).on("keydown",function(e){e.which&&13==e.which||e.keyCode&&13==e.keyCode?o._ctrlFlg&&(o._parentObject.onTaskRegist(o),o._ctrlFlg=!1):e.which&&17==e.which||e.keyCode&&17==e.keyCode?o._ctrlFlg=!0:o._ctrlFlg=!1}),$(U).on("keyup",function(e){(e.which&&17==e.which||e.keyCode&&17==e.keyCode)&&(o._ctrlFlg=!1)}),f},t._getInputTaskTypeHtml=function(){var e=this,t="",n=e._messageData;if(null==n)return t;var o=n.getType(),i=null,a=null;return o==Message.TYPE_TASK&&""!=n.getCommunityId()?(i=n.getCommunityId(),a=n.getCommunityName()):o==Message.TYPE_COMMUNITY&&(i=n.getTo(),a=n.getRoomName()),null==i?t:(t+='  <div class="modal_content register-task-type">',t+='    <p class="modal_title register-task-label">'+Resource.getMessage("task_type")+"</p>",t+='    <select class="field task-type task-register-item ui-corner-all"'+(e._messageData._type===ColumnInformation.TYPE_COLUMN_TASK&&""!==e._messageData._communityId?" disabled":"")+">",t+='      <option value="" task-type="'+TaskRegister.TASK_TYPE_MY_TASK+'">'+Resource.getMessage("MyTask")+"</option>",t+='      <option value="'+i+'" task-type="'+TaskRegister.TASK_TYPE_COMMUNITY_TASK+'" selected>'+Utils.convertEscapedTag(a)+"</option>",t+="    </select>",t+="  </div>")},t._getCommunityId=function(){var e=this,t="",n=e._messageData;if(null==n)return t;var o=n.getType(),i=null;return o==Message.TYPE_TASK&&""!=n.getCommunityId()?i=n.getCommunityId():o==Message.TYPE_COMMUNITY&&(i=n.getTo()),null==i?t:t=i},t._addTextareaAutosize=function(e){var t=e.find("div.register-task-body"),n=$(t).find("textarea");$(n).autosize()},t._addSelectBoxControlEvent=function(t){if(t.parents("a").length>0){var n=t.find("select.task-register-item");n.each(function(){var t=$(this);t.on("mousedown",function(n){e(t,n)})})}},t._onChangeOwnerClient=function(){var e=this,t=this._registerForm;if(t){var n=ViewUtils.ACCOUNT_PREFIX+LoginUser.getInstance().getLoginAccount(),o=$(t).find("div.register-task-status > select.task-status"),i=o.val();o.children().remove();var a=e._getEditingClientId(),r=e._getEditingOwnerId(),s=ColumnTaskView.getStatusListHtml(r,a);e._mode==TaskRegister.mode_edit&&(s=a==n?ColumnTaskView.getStatusListHtml(r,a):ColumnTaskView.getStatusListHtml(r,r)),$(o).append(s).val(i)}},t._getEditingClientId=function(){var e=this,t="",n="div.register-task-client > input.register-client-input",o=$(this._registerForm).find(n);if($(o).is(":disabled")){var i=e._messageData.getProfileMap();if(i&&"object"==("undefined"==typeof i?"undefined":_typeof(i))){var a=i.getByKey(e._client);null!=a&&(t="@"+a.getLoginAccount())}}else t=$(o).val();var r=Utils.trimStringMulutiByteSpace(t);return r=this._editingClientId(r)},t._editingClientId=function(e){var t=e,n=ViewUtils.ACCOUNT_PREFIX+LoginUser.getInstance().getLoginAccount();return""!=this._getInputCommunityId()||null!==t&&""!==t||(t=n),t},t._getEditingOwnerId=function(){var e="",t="div.register-task-owner > textarea.register-owner-input",n=$(this._registerForm).find(t),e=Utils.trimStringMulutiByteSpace(n.val());return e=this._editingOwnertId(e)},t._editingOwnertId=function(e){var t=e,n=ViewUtils.ACCOUNT_PREFIX+LoginUser.getInstance().getLoginAccount();return(null===t||""===t)&&(t=n),t},t.getRegistedMessageData=function(){return this._registedMessageData},t.registTask=function(e){function t(t){if(!t)return void e(!1);var i=new TaskMessage;o._messageData.getType()==Message.TYPE_TASK?i.copy(o._messageData):(i.setMessage(o._messageData.getMessage()),i.setReferenceMessageItemId(o._messageData.getItemId()),i.getAttachedFileUrlList().copy(o._messageData.getAttachedFileUrlList())),o.getInputContent(i,n)}function n(t){t.setPreOwnerJid(o._messageData.getOwnerJid?o._messageData.getOwnerJid():""),t.setPreStatus(i);var n=!1;switch(o._mode){case TaskRegister.mode_add:n=i==TaskMessage.STATUS_INBOX?o.doUpdateTask(t):o.doRegistTask(t);break;case TaskRegister.mode_edit:if(o._messageData.getType()!=Message.TYPE_TASK)throw"TaskRegister::registTask _ message is not task.";if(!o.isChangeData(o._messageData,t)){n=!0;break}n=o.doUpdateTask(t);break;default:throw"unknown mode:"+o._mode}e(n)}var o=this;if(!o._registerForm)throw Resource.getMessage("register form is not defined.");var i=o._messageData.getStatus?o._messageData.getStatus():TaskMessage.STATUS_UNKNOWN;return o._isValidationOk(i,t)?void 0:void setTimeout(function(){e(!1)},1)},t.doRegistTask=function(e){var t=this,n=function(){console.log("TaskRegister::doRegistTask _ regist task.")};return CubeeController.getInstance().addTask(e,n)?(t._registedMessageData=e,!0):(console.log("TaskRegister::registTask _ failed to regist task."),!1)},t.doUpdateTask=function(e){var t=this,n=function(){console.log("TaskRegister::doUpdateTask _ update task.")};return CubeeController.getInstance().updateTask(e,n)?(t._registedMessageData=e,!0):(console.log("TaskRegister::registTask _ failed to update task."),!1)},t.isChangeData=function(e,t){var n,o;if(e.getStatus()!==t.getStatus())return!0;if(LoginUser.getInstance().getJid()!==t.getOwnerJid())return!0;if(e.getTitle()!==t.getTitle())return!0;if(e.getMessage()!==t.getMessage())return!0;if(e.getDueDate()!==t.getDueDate())return!0;if(e.getStartDate()!==t.getStartDate())return!0;if(e.getPriority()!==t.getPriority())return!0;if(e.getClient()!==t.getClient())return!0;var i={},a={},r=e.getAttachedFileUrlList(),s=t.getAttachedFileUrlList(),l=[i,a],u=[r,s];for(n=0;1>=n;n++){var c=l[n],d=u[n];for(o=0;o<d.getCount();o++)c[d.get(n)]=!0}for(n=0;1>=n;n++){var g=l[n],m=l[1-n];for(var _ in g)if(!m[_])return!0}return!1},t.getInputContent=function(e,t){function n(){function t(t){var n="";if(null!=t)for(var i=t.getCount(),a=0;i>a;a++)0!=a&&(n+=","),n+=t.get(a).getJid();e.setOwnerJid(n),o()}var n=$(r).find("div.register-task-owner > textarea.register-owner-input"),i=n.val();i=Utils.replaceAll(i,""," "),i=Utils.replaceAll(i,","," "),i=Utils.replaceAll(i,""," "),i=Utils.replaceAll(i,"\r\n"," "),i=Utils.replaceAll(i,"\r"," "),i=Utils.replaceAll(i,"\n"," ");for(var a=i.split(" "),s=new ArrayList,l=0;l<a.length;l++){var u=Utils.trimStringMulutiByteSpace(a[l]);if(null!=u&&""!=u){var c=u.indexOf(ViewUtils.ACCOUNT_PREFIX);if(0!=c)continue;u=u.substring(1,u.length),s.add(u)}}0==s.getCount()&&t(null),CubeeController.getInstance().getPersonDataByLoginAccountFromServer(s,t)}function o(){function t(t){var n="";null!=t&&(n=t),e.setClient(n),i()}a.getInputClient(t)}function i(){t&&"function"==typeof t&&setTimeout(function(){t(e)},1)}var a=this,r=this._registerForm;e.setTitle(Utils.excludeControleCharacters($(r).find('div.register-task-name > input[name="task-name"]').val())),e.setDueDate(new Date($(r).find("div.register-task-due-date > input.task-due-date").val())),e.setStartDate(new Date($(r).find("div.register-task-start-date > input.task-start-date").val())),e.setPriority(parseInt($(r).find("div.register-task-priority > select.task-priority").val()));var s=parseInt($(r).find("div.register-task-status > select.task-status").val());e.setStatus(s);var l=$(r).find("div.register-task-body > div.textarea > textarea").val();l=Utils.excludeControleCharacters(l),e.setMessage(l);var u=a._fileList,c=u._length;if(c>0)for(var d=0;c>d;d++){var g=u.get(d),m=g.getFlag(),_=g.getUrl();m==AttachedFileData.FILE_DELETE&&u.removeByUrl(_)}if(u.getCount()>0){c=u._length;for(var d=0;c>d;d++){var _=u.get(d).getUrl(),f=a._romMessage;ViewUtils.isAttachmentUrl(f,_)&&e.addAttachedFileUrl(_)}e.addAttachedFileMessage()}var p=$(r).find("div.register-task-type > select.task-type");if(1==p.length)var h=p.val();e.setCommunityId(h),n()},t._getInputCommunityId=function(){var e="",t=$(this._registerForm).find("div.register-task-type > select.task-type");return 1==t.length&&(e=t.val()),e},t.getInputClient=function(e){function t(t){var n="";null!=t&&(n=t),e&&"function"==typeof e&&setTimeout(function(){e(n)},1)}var n=this,o=this._registerForm,i=(LoginUser.getInstance().getJid(),$(o).find("div.register-task-client > input.register-client-input"));if($(i).length>0){var a=(LoginUser.getInstance().getJid(),Utils.trimStringMulutiByteSpace(i.val()));null!=a&&""!=a?ViewUtils.convertAccountStrToJidStrFromServer(a,t):t(null)}else t(n._client)},t._isValidationOk=function(e,t){function n(e){return null==e?void t(!1):void o(e)}function o(n){var o=$(r).find('div.register-task-name > input[name="task-name"]'),s=$(r).find("div.register-task-body > div.textarea > textarea");o.removeClass("input-error"),s.removeClass("input-error");var l=parseInt($(r).find("div.register-task-status > select.task-status").val());""==o.val()&&(this._mode==TaskRegister.mode_add||l!=TaskMessage.STATUS_FINISHED&&l!=TaskMessage.STATUS_REJECTED||e!=TaskMessage.STATUS_FINISHED&&e!=TaskMessage.STATUS_REJECTED)&&(o.addClass("input-error"),i=!1);var u=$(r).find("div.register-task-start-date > input.task-start-date"),c=u.val(),d=null;u.removeClass("input-error"),""!=c&&(Utils.isValidDate(c)?d=new Date(c):(u.addClass("input-error"),i=!1));var g=$(r).find("div.register-task-due-date > input.task-due-date"),m=g.val(),_=null;g.removeClass("input-error"),""!=m&&(Utils.isValidDate(m)?_=new Date(m):(g.addClass("input-error"),i=!1)),d&&_&&d.getTime()>_.getTime()&&(u.hasClass("input-error")||u.addClass("input-error"),g.hasClass("input-error")||g.addClass("input-error"),i=!1),o.val().length>TaskRegister.MAX_LENGTH_TASK_NAME&&(o.addClass("input-error"),i=!1);var f=ViewUtils.getCalculattionBody(s.val());f>TaskRegister.MAX_LENGTH_TASK_BODY&&(s.addClass("input-error"),i=!1);var p,h=$(r).find("div.register-task-client > input.register-client-input");$(r).find("div.register-task-owner > textarea.register-owner-input");if(p=a._mode==TaskRegister.mode_add?!1:a._owner==LoginUser.getInstance().getJid()?!0:!1,$(h).length>0&&!p){h.removeClass("input-error");var C=Utils.trimStringMulutiByteSpace(h.val());if(null!=C&&""!=C)if(null==n){var v=LoginUser.getInstance().getJid(),y=ViewUtils.convertAccountStrToJidStr(C);if(v!=y){var T=ContactList.getInstance().getByJid(y);null==T&&(h.addClass("input-error"),i=!1)}}else{var b=C.substring(1,C.length),T=n.getOwnerList().getByLoginAccount(b);null==T&&(T=n.getGeneralMemberList().getByLoginAccount(b)),null==T&&(h.addClass("input-error"),i=!1)}}a._isValidationOwnerOk(n)||(i=!1),t(i)}var i=!0,a=this,r=this._registerForm,s=$(r).find("div.register-task-type > select.task-type"),l="";if(1==s.length)l=Utils.trimStringMulutiByteSpace(s.val());else{var u=a._messageData;if(null!=u){var c=u.getType();c==Message.TYPE_TASK?l=u.getCommunityId():c==Message.TYPE_COMMUNITY&&(l=u.getTo())}}if(null==l||""==l)setTimeout(function(){o(null)},1);else if(!CubeeController.getInstance().getCommunityMemberInfo(l,n))return!1;return!0},t._isValidationOwnerOk=function(e){var t=!0,n=this,o=this._registerForm,i=$(o).find("div.register-task-owner > textarea.register-owner-input");i.removeClass("input-error");var a=i.val();a=Utils.replaceAll(a,""," "),a=Utils.replaceAll(a,","," "),a=Utils.replaceAll(a,""," "),a=Utils.replaceAll(a,"\r\n"," "),a=Utils.replaceAll(a,"\r"," "),a=Utils.replaceAll(a,"\n"," ");for(var r=a.split(" "),s=0,l=new StringMapedStringArrayList,u=0;u<r.length;u++){var c=Utils.trimStringMulutiByteSpace(r[u]);if(null!=c&&""!=c){if(s++,null==e){var d=LoginUser.getInstance().getJid(),g=ViewUtils.convertAccountStrToJidStr(c);if(d!=g){var m=ContactList.getInstance().getByJid(g);if(null==m){i.addClass("input-error"),t=!1;break}}}else{var _=c.substring(1,c.length),m=e.getOwnerList().getByLoginAccount(_);if(null==m&&(m=e.getGeneralMemberList().getByLoginAccount(_)),null==m){i.addClass("input-error"),t=!1;break}}if(null!=l.getByKey(c)){i.addClass("input-error"),t=!1;break}l.add(c,c)}}var f=!1;return null!=e&&(f=!0),n._isCheckOwnerCount(s,f)||(i.addClass("input-error"),t=!1),t},t._isCheckOwnerCount=function(e,t){var n=this,o=!1;return o=t?n._mode!=TaskRegister.mode_edit||1>=e:0!=e&&(n._mode!=TaskRegister.mode_edit||1==e)}}(),function(){InboxRegisterView.prototype=$.extend({},RegisterView.prototype);var e=(RegisterView.prototype,InboxRegisterView.prototype);e._createSubForms=function(e){if(null!=e){var t=this,n=t.getHtmlElement(),o=n.find(".task-register-header");o.find(".reg-task-title").text(e)}},e._addEventHandler=function(){var e=this,t=e.getHtmlElement();if(t){var n=t.find(".action-register-task > span.cancel");n.on("click",function(){e._clickCancelButton()});var o=t.find(".action-register-task > span.register");o.on("click",function(){e._clickRegisterButton()}),t.on("click","div.task-register > .task-register-header > .action-register-task > span.cancel",function(){e._clickCancelButton()}),t.on("click","div.task-register > .task-register-header > .action-register-task > span.register",function(){e._clickInboxRegisterButton()})}},e._removeEventHandler=function(){var e=this,t=e.getHtmlElement();if(t){var n=t.find(".action-register-task > span.cancel");n.off("click");var o=t.find(".action-register-task > span.register");o.off("click"),n.find("#cancel-register").attr("title","Cancel Add Inbox"),o.find("#execut-register").attr("title","Execute Add Inbox")}},e._getHtml=function(){var e="";return e+='<form class="register-area">',e+='<div class="register-task-body box-border olient-horizontal">',e+='<div class="task-body-textarea-area flex1">',e+='<textarea id="task-body" name="task-body" class="task-register-item ui-corner-all" placeholder="'+Resource.getMessage("task_body_placeholder")+'"></textarea>',e+="</div>",e+='<div class="register-task-body-char-counter">',e+=ViewUtils.getCharCounterHtml("char-counter-task-register"),e+="</div>",e+="</div>",e+="</form>"},e.appear=function(){var e=this,t=e.getHtmlElement(),n=t.find("div.task-register");if(t){var o=t.find(".register-area");0==o.length&&(n.append(e._getHtml()),e._createRegisterForm())}e._removeEventHandler(),e._addEventHandler(),n.slideToggle()},e._createRegisterForm=function(){var e=this,t=e.getHtmlElement(),n=t.find("div.task-register"),o=n.find(".register-area"),i=o.find(".register-task-body"),a=i.find("textarea");ViewUtils.setCharCounter(a,i.find("."+ViewUtils.CHAR_COUNTER_CLASSNAME),TaskRegisterView.MAX_LENGTH_TASK_BODY)},e._cleanup=function(){var e=this,t=e.getHtmlElement(),n=t.find("div.task-register"),o=n.find(".register-area");o.remove()},e._clickCancelButton=function(){var e=this;e.getHtmlElement().find("div.task-register").slideUp(),e._cleanup()},e._clickRegisterButton=function(){function e(e){console.log("add inbox : "+e)}var t=this;t._isValidationOk()&&(t._updateMessageData(),1==CubeeController.getInstance().addTask(t._taskMessage,e)?(t._cleanup(),t.getHtmlElement().find("div.task-register").slideUp()):console.log("faild to add inbox"))},e._isValidationOk=function(){var e=!0,t=this,n=t.getHtmlElement(),o=n.find("div.task-register"),i=o.find(".register-area"),a=i.find(".register-task-body"),r=a.find("textarea");r.removeClass("input-error");var s=/((https?)(:\/\/\S+))/gi,l=r.val().replace(s,"");return l>TaskRegisterView.MAX_LENGTH_TASK_BODY?(r.addClass("input-error"),e=!1):""==r.val()&&(r.addClass("input-error"),e=!1),e},e._updateMessageData=function(){var e=this,t=e._taskMessage,n=e.getHtmlElement(),o=n.find("div.task-register"),i=o.find(".register-area"),a=i.find(".register-task-body"),r=a.find("textarea");t.setMessage(r.val()),t.setStatus(TaskMessage.STATUS_INBOX),t.setOwnerJid(LoginUser.getInstance().getJid()),t.setClient(LoginUser.getInstance().getJid())}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};MessageObjectIndex.prototype={getMsgObj:function(){return this._msgObj},getChildren:function(){return this._children},getChildrenCount:function(){return this._children.getCount()},cleanup:function(){this._msgObj.cleanup(),this._children=null}},function(){function e(e){switch(e){case ColumnInformation.TYPE_COLUMN_TIMELINE:case ColumnInformation.TYPE_COLUMN_CHAT:case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:case ColumnInformation.TYPE_COLUMN_MURMUR:return!0;default:return!1}return!1}function t(e){if(e.getType()==ColumnInformation.TYPE_COLUMN_SEARCH||e.getType()==ColumnInformation.TYPE_COLUMN_RECENT||e.getType()==ColumnInformation.TYPE_COLUMN_TOME)return!0;if(e.getType()!=ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER)return!1;var t=e.getColumnInfo().getSourceColumnType(),n=null;return t==ColumnInformation.TYPE_COLUMN_FILTER&&(_begginingColumnType=e.getColumnInfo().getBeginningColumnType()),t==ColumnInformation.TYPE_COLUMN_SEARCH||t==ColumnInformation.TYPE_COLUMN_RECENT||t==ColumnInformation.TYPE_COLUMN_TOME||n==ColumnInformation.TYPE_COLUMN_TOME}function n(e){for(var t in e)if("string"==t){if(null==e[t]||"string"!=typeof e[t])return!1}else if("object"==t||"message"==t||"element"==t){if(null==e[t]||"object"!=_typeof(e[t]))return!1}else if("position"==t){if(null==e[t]||"number"!=typeof e[t])return!1}else if("positionFrom"==t||"positionTo"==t){if(null==e[t]||"number"!=typeof e[t]||e[t]<0)return!1}else if("function"==t&&(null==e[t]||"function"!=typeof e[t]))return!1;return!0}function o(e){var t=!1;return(e.hasClass(ColumnView.CLASS_SEL_TIMELINE)||e.hasClass(ColumnView.CLASS_SEL_MENTION)||e.hasClass(ColumnView.CLASS_SEL_QUESTIONNAIRE)||e.hasClass(ColumnView.CLASS_SEL_CHAT)||e.hasClass(ColumnView.CLASS_SEL_TASK)||e.hasClass(ColumnView.CLASS_SEL_INBOX)||e.hasClass(ColumnView.CLASS_SEL_SEARCH)||e.hasClass(ColumnView.CLASS_SEL_GROUP_CHAT)||e.hasClass(ColumnView.CLASS_SEL_MAIL)||e.hasClass(ColumnView.CLASS_SEL_COMMUNITY_FEED)||e.hasClass(ColumnView.CLASS_SEL_COMMUNITY_TASK)||e.hasClass(ColumnView.CLASS_SEL_RECENT)||e.hasClass(ColumnView.CLASS_SEL_TOME)||e.hasClass(ColumnView.CLASS_SEL_MURMUR))&&(t=!0),t}ColumnView.INSERT_MESSAGE_UNKNOWN=0,ColumnView.INSERT_MESSAGE_BEFORE=1,ColumnView.INSERT_MESSAGE_AFTER=2,ColumnView.INSERT_MESSAGE_APPEND=3,ColumnView.INSERT_MESSAGE_PREPEND=4,ColumnView.CLASS_SEL_COLUMN="column",ColumnView.CLASS_SEL_TIMELINE="column-timeline",ColumnView.CLASS_SEL_MENTION="column-mention",ColumnView.CLASS_SEL_TOME="column-tome",ColumnView.CLASS_SEL_CHAT="column-chat",ColumnView.CLASS_SEL_TASK="column-task",ColumnView.CLASS_SEL_INBOX="column-inbox",ColumnView.CLASS_SEL_SEARCH="column-search",ColumnView.CLASS_SEL_FILTER=ColumnView.CLASS_SEL_SEARCH,ColumnView.CLASS_SEL_GROUP_CHAT="column-group-chat",ColumnView.CLASS_SEL_MAIL="column-mail",ColumnView.CLASS_SEL_RECENT="column-recent",ColumnView.CLASS_SEL_COMMUNITY_FEED="column-community-feed",ColumnView.CLASS_SEL_COMMUNITY_TASK="column-community-task",ColumnView.CLASS_SEL_SHOW_CONVERSATION="column-show-conversation",ColumnView.CLASS_SEL_QUESTIONNAIRE="column-questionnaire",ColumnView.CLASS_SEL_MURMUR="column-murmur",ColumnView.RECENT_REPLY_SHOW_COUNT=1,ColumnView.HIDDEN_REPLY_CLS_NAME="target-hidden",ColumnView.TOGGLE_REPLY_CLS_NAME="toggle_reply",ColumnView.DISPLAY_NAME_TIMELINE=Resource.getMessage("MyFeed"),ColumnView.DISPLAY_NAME_CHAT=Resource.getMessage("Chat"),ColumnView.DISPLAY_NAME_MENTION=Resource.getMessage("Mention"),ColumnView.DISPLAY_NAME_TOME=Resource.getMessage("ToMe"),ColumnView.DISPLAY_NAME_TASK=Resource.getMessage("Task"),ColumnView.DISPLAY_NAME_MY_TASK=Resource.getMessage("MyTask"),ColumnView.DISPLAY_NAME_INBOX=Resource.getMessage("Inbox"),ColumnView.DISPLAY_NAME_SEARCH=Resource.getMessage("Search"),ColumnView.DISPLAY_NAME_GROUP_CHAT=Resource.getMessage("GroupChat"),ColumnView.DISPLAY_NAME_MAIL=Resource.getMessage("Mail"),ColumnView.DISPLAY_NAME_RECENT=Resource.getMessage("RecentPostedMessages"),ColumnView.DISPLAY_NAME_COMMUNITY_FEED=Resource.getMessage("CommunityFeed"),ColumnView.DISPLAY_NAME_COMMUNITY_TASK=Resource.getMessage("CommunityTask"),ColumnView.DISPLAY_NAME_SHOW_CONVERSATION=Resource.getMessage("ShowConversation"),ColumnView.DISPLAY_NAME_QUESTIONNAIRE=Resource.getMessage("MyQuestionnaire"),ColumnView.DISPLAY_NAME_MURMUR=Resource.getMessage("Murmur"),ColumnView.READ_MESSAGE_CONTROL_HREF_HEDER_STRING="#ancer_",ColumnView.TEXTAREA_MAX_LENGTH=Conf.getVal("MESSAGE_BODY_MAX_LENGTH"),ColumnView.THREAD_TITLE_MAX_LENGTH=Conf.getVal("THREAD_TITLE_BODY_MAX_LENGTH"),ColumnView.prototype=$.extend({},ViewCore.prototype);var i=ColumnView.prototype;i.createView=function(){var e=this,t=e.getColumnInfo();if(0!=n({object:t})){var o=e.getType();
t.setDisplayName(e._displayName);var i=ViewUtils.getSourceColumnTypeAndRoomIdFromColumnInfo(t,o),a="";switch(a+=ColumnTextAreaView.getHtml(o,i,e._SendMessageRight),o){case ColumnInformation.TYPE_COLUMN_TIMELINE:case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:case ColumnInformation.TYPE_COLUMN_MURMUR:1==e._ViewMessageRight&&(a+=e.createFormAreaHtml(o));break;default:a+=e.createFormAreaHtml(o)}e.createHtml(a)}},i.createFormAreaHtml=function(t){var n="";return e(t)?(n+='<div style="height: 32px; text-align: left; float: left; padding-left: 10px">',n+='<a class="ico_btn attach-toggle-btn" data-toggle="tooltip" data-placement="right"><i class="fa fa-ellipsis-h"></i></a>',n+="</div>",n+=ColumnTextAreaView.getCharCounterHtml(t,this._SendMessageRight),n+=ColumnSubmitButtonView.getHtml(t),n+='<div style="position:relative; display: inline-block;">',n+='<a class="list_add ico_btn emojibtn" data-container="body" data-toggle="tooltip" data-placement="bottom" title="" data-target="addgroup_modal" data-original-title="'+Resource.getMessage("stamp_name")+'" style="top: 0px;right: 0px;"><i class="fa fa-smile-o"></i></a>',n+="</div>",n+='<div class="message-attachment-area" style="display:none">',n+=ColumnFileUploadPartsView.getHtml(t),n+=CodiMdViewUtils.getAttachmentHtmlElement(),n+="</div>"):(n+=ColumnFileUploadPartsView.getHtml(t),n+=ColumnTextAreaView.getCharCounterHtml(t,this._SendMessageRight),n+=ColumnSubmitButtonView.getHtml(t)),n},i._createHtml=function(e){var t="",n=this,o=n._className,i=n._displayName,a=n._closable,r=e,s=n.getType();n.getColumnInfo();if(t+='<div class="card col_card chat_card '+o+'-wrapper">',t+='<div class="box-border olient-vertical ui-widget-content ',t+=ColumnView.CLASS_SEL_COLUMN+" "+o,t+='"',null!=n._idName&&""!=n._idName)t+=' roomid="'+n._idName+'"';else if(s==ColumnInformation.TYPE_COLUMN_MURMUR){var l=MurmurColumnInformation.getOwnJidFromSearchCondition(n._info);t+=' jid="'+l+'"'}switch(t+=">",t+='<div class="box-border olient-horizontal ui-widget-header column-header">',t+='<a class="column-toggle col_btn col_input_btn popup_btn ico_btn" data-toggle="tooltip" data-placement="bottom" data-original-title="'+Resource.getMessage("column_btn_message_area_open_close")+'"><i class="fa fa-caret-down"></i></a>',s==ColumnInformation.TYPE_COLUMN_GROUP_CHAT&&(t+='<a class="group-member-btn col_btn popup_btn ico_btn" data-toggle="tooltip" data-placement="bottom" data-original-title=""><i class="fa fa-users"></i></a>'),t+='<div class="flex1 text-overflow-ellipsis column-header-title" title="'+Utils.convertEscapedTag(i)+'"><img src="" class="tab-icon">',t+=Utils.convertEscapedHtml(i),t+="</div>",(s!=ColumnInformation.TYPE_COLUMN_TIMELINE||0!=n._ViewMessageRight)&&(t+='<div class="column-option popup_menu col_menu"'+(a?"":' style="right: 5px;"')+">",t+='<a class="col_btn col_menu_btn popup_btn ico_btn"><i class="fa fa-ellipsis-v"></i></a>',t+="</div>"),a&&(t+='<a class="col_btn col_close_btn ico_btn" data-toggle="tooltip" data-placement="bottom" data-original-title="'+Resource.getMessage("column_btn_close")+'"><i class="fa fa-close"></i></a>'),t+="</div>",s){case ColumnInformation.TYPE_COLUMN_TIMELINE:case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:t+=1==n._SendMessageRight?'<div class="box-border ui-widget-content wrap-frm-message">':'<div class="box-border ui-widget-content wrap-frm-message  display-none">';break;case ColumnInformation.TYPE_COLUMN_MURMUR:if(1==n._ViewMessageRight){var u=MurmurColumnInformation.getOwnJidFromSearchCondition(n._info);t+=LoginUser.getInstance().getJid()==u?'<div class="box-border ui-widget-content wrap-frm-message">':'<div class="box-border ui-widget-content wrap-frm-message" style="overflow: hidden; display:none; height:0px;">'}else t+='<div class="box-border ui-widget-content wrap-frm-message  display-none" >';break;default:t+='<div class="box-border ui-widget-content wrap-frm-message">'}return t+='<div class="flex1 frm-message '+o+'-frm-message">',t+=r,t+="</div>",t+="</div>",t+='<div class="box-border-for-abbreviation olient-vertical column-content scroll_content"></div> <!-- .flex1 -->',t+="</div>",t+="</div>"},i.createHtml=function(e){var t=this,n=t._createHtml(e);t._htmlElement=$(n),t.viewWillAppear()},i.viewWillAppear=function(){var e=this;if(e._createSubForms(),e._htmlElement){e._createEventHandler();var t=e._htmlElement.children("div").children("div.wrap-frm-message");e._inputAreaHeight=t.height()}e._LoadingIcon("div.wrap-frm-message"),e.getHistoryMessage(),e._startPergeMessageIntarval()},i._createSubForms=function(){var e=this,t=e.getHtmlElement();if(null!=t){var n=e.getType();if(n!=ColumnInformation.TYPE_COLUMN_UNKNOWN){var o=t.find("div.frm-message textarea.message-input-area");e._textarea=new ColumnTextAreaView(o,e,Resource.getMessage("default_placeholder"));var i=t.find("div.frm-message > textarea.message-input-area-title");i&&(e._textTitleArea=new ColumnTextAreaView(i,e,Resource.getMessage("title_placeholder"))),n==ColumnInformation.TYPE_COLUMN_TIMELINE&&(0==e._ViewMessageRight?e._textarea=new ColumnTextAreaView(o,e,Resource.getMessage("not_view_to_feed_err_placeholder")):0==e._SendMessageRight&&(e._textarea=new ColumnTextAreaView(o,e,Resource.getMessage("not_send_to_feed_err_placeholder")))),n==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED&&0==e._SendMessageRight&&(e._textarea=new ColumnTextAreaView(o,e,Resource.getMessage("not_send_to_community_err_placeholder"))),n==ColumnInformation.TYPE_COLUMN_GROUP_CHAT&&0==e._SendMessageRight&&(e._textarea=new ColumnTextAreaView(o,e,Resource.getMessage("not_send_to_groupchat_err_placeholder"))),n==ColumnInformation.TYPE_COLUMN_MURMUR&&0==e._ViewMessageRight&&(e._textarea=new ColumnTextAreaView(o,e,Resource.getMessage("not_view_to_murmur_err_placeholder")));var a=t.find("div.frm-message > button");e._button=new ColumnSubmitButtonView(a,e,Resource.getMessage("column_btn_submit"),Resource.getMessage("column_btn_submit-tooltip")),ViewUtils.setCharCounter(o,t.find(".char-counter-column"),ColumnView.TEXTAREA_MAX_LENGTH,void 0,!1),i&&ViewUtils.setCharCounter(i,t.find(".char-counter-title-column"),ColumnView.THREAD_TITLE_MAX_LENGTH,void 0,!0);var r=t.find("div.frm-message .file-inputs");e._fileUpload=new ColumnFileUploadPartsView(r,e);var s=t.find("div.frm-message").find(".submit-message-progress");e._progressBar=new ProgressBarView(s,!1)}}},i._createEventHandler=function(){var e=this,t=e.getHtmlElement();if(!t)return void console.log("ColumnView::_createEventHandler>>>"+t);var n="div.column-content",o="a.col_btn.col_input_btn",i="div.popup_menu.col_menu",a="a.col_btn.col_close_btn ",r=(t.find(n),t.find(o)),s=e.getType();r.on("click",function(){$(this).parents(".column").toggleClass("open").find(".frm-message").stop().slideToggle(200,function(){ViewUtils.rayout_resize(t.find(".column-content"))})});var l=t.find(i),u=t.find(a);if(9==s){var c=CubeeController.getInstance().getChatRoomInfoByRoomId(e._info._chatRoomInfomation._roomId);e._info.setChatRoomInfomation(c),e._setOptionMenu(l)}else e._setOptionMenu(l);u.on("click",function(){ColumnManager.getInstance().removeColumn(e)}),t.find('[data-toggle="tooltip"]').tooltip({trigger:"hover"}),e._setColumnTitleToolTip(),t.on("click",".attach-toggle-btn",function(){var t=e.getHtmlElement().find(".message-attachment-area");t.slideToggle(200,function(){$(window).trigger("resize")})}),t.find(".attach-note-btn").on("click",function(){var t=e.getHtmlElement().find(".attach-note-element"),n=new DialogAssignNoteOnSendMessageView(t);n.showDialog()}),t.find("a.menthion-dialog-btn").off("click.menthiondialogbtn"),t.find("a.menthion-dialog-btn").on("click.menthiondialogbtn",ColumnView.mentionIconEvent)},ColumnView.mentionIconEvent=function(e){for(var t=void 0,n=void 0,o=$("#columnInnerContainer").children(),i=0;i<o.length;i++)$(o[i]).is($(e.currentTarget).closest(".col_card"))&&(t=i,n=$(o[i]));if(!n&&$(e.currentTarget).closest("#side-bar-recent").length&&(n=$(e.currentTarget).closest("#side-bar-recent"),t=-1),"number"==typeof t){var a=void 0;t>=0?a=ColumnManager.getInstance().getColumnList().get(t):-1==t&&(a=SideMenuRecentView.getInstance().getColumnInfo());var r=a.getColumnType(),s=!1;if(r==ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION||r==ColumnInformation.TYPE_COLUMN_RECENT||r==ColumnInformation.TYPE_COLUMN_SEARCH||r==ColumnInformation.TYPE_COLUMN_FILTER||r==ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER){var l=$(e.currentTarget).closest("div.read-message").attr("itemid"),u=CubeeController.getInstance()._messageManager,c=u.getMessage(l).getType();if(null!=c)switch(c){case Message.TYPE_PUBLIC:r=ColumnInformation.TYPE_COLUMN_TIMELINE;break;case Message.TYPE_CHAT:r=ColumnInformation.TYPE_COLUMN_CHAT;break;case Message.TYPE_GROUP_CHAT:r=ColumnInformation.TYPE_COLUMN_GROUP_CHAT;break;case Message.TYPE_COMMUNITY:r=ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED;break;default:r=a.getColumnType()}s=!0}switch(r){case ColumnInformation.TYPE_COLUMN_TIMELINE:break;case ColumnInformation.TYPE_COLUMN_CHAT:break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:var d=void 0;d=s?$(e.currentTarget).parent().find("textarea.message-input-area.input-message-reply").attr("groupid"):$(n).find("div.column-group-chat").attr("roomid");var g=$(e.currentTarget).parent().find("textarea.message-input-area").val(),m=new DialogMenthionGroupChatPersonList(d,g,function(t){for(var n="",o=0;o<t.length;o++)g.indexOf(t[o])<0&&n.indexOf(t[o])<0&&(n+=t[o]+" ");$(e.currentTarget).parent().find("textarea.message-input-area").val(n+g)});m.showDialog();break;case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:var _=void 0;_=s?$(e.currentTarget).parent().find("textarea.message-input-area.input-message-reply").attr("groupid"):$(n).find("div.column-community-feed").attr("roomid");var f=$(e.currentTarget).parent().find("textarea.message-input-area").val(),p=new DialogMenthionCommunityPersonList(_,f,function(t){for(var n="",o=0;o<t.length;o++)f.indexOf(t[o])<0&&n.indexOf(t[o])<0&&(n+=t[o]+" ");$(e.currentTarget).parent().find("textarea.message-input-area").val(n+f)});p.showDialog()}}},i._setOptionMenu=function(e){var t=this,n=WithReadDoneColumnOptionMenu.getHtml(t._info),o=e.append(n);t._columnOptionMenu=new WithReadDoneColumnOptionMenu(o,t._info,t)},i._setColumnTitleToolTip=function(){var e=this,t=e._info,n=t.getDisplayName(),o=e.getHtmlElement();if(null!=o){var i=o.find("div.column-header > div"),a=i.eq(0);'<div class="tooltipColumnTitle"><h>'+Utils.convertEscapedHtml(n,!1)+"</h><div>";a.attr("title",n)}},i.getHistoryMessage=function(){},i.showUpdateMessage=function(e){},i.cleanup=function(){var e=this,t=e._getMsgObjHash();for(var n in t)t[n].cleanup(),delete t[n];e._button&&(e._button.cleanup(),e._button=null),e._textarea&&(e._textarea.cleanup(),e._textarea=null),delete e._button,delete e._textarea;var o=e.getHtmlElement();null!=o&&(o.find("*").off().trigger("autosize.destroy").remove(),o.off()),e._htmlElement=null,delete e._htmlElement,e._uploading=!1,e._columnOptionMenu&&e._columnOptionMenu.cleanup(),delete e._columnOptionMenu,e._className="",e._displayName="",e._closable=!0,e._msgObjHash={},e._msgObjIndexList=new ArrayList,e._width=0,e._currentLoadedItemId=0,e._allMessageReceived=!1,e._uploading=!1,e._inputAreaHeight=0,e._columnContentObj&&(e._columnContentObj=null),e._fileUpload&&(e._fileUpload.cleanup(),e._fileUpload=null,delete e._fileUpload),e._progressBar&&(e._progressBar.cleanup(),e._progressBar=null,delete e._progressBar),e._disableBottomEvent=!1,e._endPergeMessageIntarval()},i.getType=function(){return this._type},i.getColumnInfo=function(){return this._info},i._getMsgObjHash=function(){return this._msgObjHash},i.addMsgObjIndexToHash=function(e){if(0==n({object:e}))return!1;var t=this,o=e.getMsgObj().getMessage();if(0==n({object:o}))return!1;var i=o.getItemId();if(0==n({string:i}))return!1;var a=t._getMsgObjHash();return a[i]=e,!0},i.getMsgObjByItemId=function(e){if(0==n({string:e}))return null;var t,o=this,i=o._getMsgObjHash();return e in i&&(t=i[e])?t.getMsgObj():null},i.getMsgObjIndexByItemId=function(e){if(0==n({string:e}))return null;var t=this,o=t._getMsgObjHash();return e in o?o[e]:null},i.removeFromHash=function(e){if(0!=n({string:e})){var t=this,o=t._getMsgObjHash();e in o&&delete o[e]}},i._getMsgObjIndexList=function(){return this._msgObjIndexList},i.addMsgObjIndex=function(e){if(0==n({object:e}))return!1;var t=this;return t.addMsgObjIndexToHash(e),t._getMsgObjIndexList().add(e),!0},i.getMsgObjIndexPositionByItemId=function(e){if(0==n({string:e}))return null;for(var t=this,o=-1,i=t._getMsgObjIndexList(),a=i.getCount(),r=0;a>r;r++){var s=i.get(r),l=s.getMsgObj().getMessage().getItemId();if(l==e){o=r;break}}return o},i.insertMsgObjIndex=function(e,t){if(0==n({object:t,position:e}))return!1;var o=this,i=o._getMsgObjIndexList();return o.addMsgObjIndexToHash(t),i.insert(e,t)},i.removeMsgObjIndexByItemId=function(e){if(0==n({string:e}))return!1;var t=this,o=t._getMsgObjIndexList(),i=o.getCount();t.removeFromHash(e);for(var a=0;i>a;a++){var r=o.get(a),s=r.getMsgObj(),l=s.getMessage();if(l.getItemId()==e)return s.cleanup(),o.remove(a);for(var u=r.getChildren(),c=r.getChildrenCount(),d=0;c>d;d++){var g=u.get(d),s=g.getMsgObj(),l=s.getMessage();if(l.getItemId()==e)return s.cleanup(),u.remove(d)}}return!1},i.getParentMsgObjByPosition=function(e){if(0==n({position:e}))return null;var t=this,o=t._getMsgObjIndexList(),i=o.getCount();return e>=0||i>e?o.get(e).getMsgObj():null},i._LoadingIcon=function(e){var t=this,n=t.getHtmlElement();if(null!=n){var o=n.find(e);return o.size()>0&&ViewUtils.showLoadingIcon(o),o}},i._hideLoadingIconInSelf=function(){var e=this,t=e.getHtmlElement();if(null!=t){var n=t.children("div").children("div.column-content");ViewUtils.hideLoadingIconInChild(n);var o=t.find("div.wrap-frm-message");ViewUtils.hideLoadingIcon(o)}},i.clickSubFormButton=function(){console.log("ColumnView::clickSubFormButton _ must inherit method.")},i._uploadFileAndSendMessage=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=this;if(0==n({"function":t}))return!1;if(1==i._uploading)return!1;var a,r,s=i.getHtmlElement().find(".wrap-frm-message");if(ViewUtils.isValidInputTextLength(e)&&ViewUtils.getCalculattionTitle(o)<=ColumnView.THREAD_TITLE_MAX_LENGTH){var l=function(n){return"success"!=n.result?(i._uploading=!1,void(ViewUtils.isIE89()?(ViewUtils.hideLoadingIcon(i._textarea.getHtmlElement()),ViewUtils.showErrorMessageIE(i._textarea.getHtmlElement(),Resource.getMessage("error_file_up_request"))):(ViewUtils.switchAttachmentArea(s,!0),i._progressBar.progressClear()))):(e+="\n"+n.path,t(e),i._uploading=!1,void(ViewUtils.isIE89()?(ViewUtils.hideLoadingIcon(i._textarea.getHtmlElement()),ViewUtils.hideErrorMessageIE(i._textarea.getHtmlElement())):(ViewUtils.switchAttachmentArea(s,!0),i._progressBar.progressComplete())))},u=function(e){i._progressBar.setProgressValue(e)};if(null==i._fileUpload)return void t(e);if(ViewUtils.isIE89()){var r=i._fileUpload.getFileForm();if(null==r)return void t(e);if(""==r.value)return void t(e)}else{if(a=i._fileUpload.getFilesObject(),null==a)return void t(e);if(a.length<=0)return void t(e);i._progressBar.visibleProgressBar(),ViewUtils.switchAttachmentArea(s,!1)}if(i._uploading=!0,ViewUtils.isIE89())return ViewUtils.showLoadingIcon(i._textarea.getHtmlElement()),CubeeController.getInstance().uploadFileIE(r,l);var c=a[0];return CubeeController.getInstance().uploadFile(c,l,u)}return!1},i.createMessageObjectOnly=function(e){console.log("ColumnView::createMessageObjectOnly  must inherits method")},i._setMessageObject=function(e,t,o){var i=this;if(0!=n({element:t,position:o})){e.setHtmlElement(t);var a=new MessageObjectIndex(e),r=i._getMsgObjIndexList(),s=r.getCount();-1==o||0==s&&0==o?i.addMsgObjIndex(a)||console.log("ColumnView::_setMessageObject  addMsgObjIndex fail"):o>=s?console.log("ColumnView::_setMessageObject  pos is over _indexListCount>>>"+o+"/"+s):i.insertMsgObjIndex(o,a)||console.log("ColumnView::_setMessageObject  insertMsgObjIndex fail")}},i._getMessageElement=function(e){if(0==n({position:e}))return null;var t=this;if(!t._columnContentObj){var o=t.getHtmlElement();if(null==o)return}return t.getColumnContent().children("div").eq(e)},i.showMessage=function(e){var t=this;return 0==t._validation({object:e})?!1:void t._showMessageData(e)},i._showMessageData=function(e){if(0==n({object:e}))return!1;var t=this,o=e.getItemId();if(t.getMsgObjByItemId(o))return!0;var i,r=(e.getType(),t.getHtmlElement());if(null!=r){var s=t.getColumnContent(),l=t.createMessageObjectOnly(e);if(i=t.getColumnMessageHtml(l,!1),""==i)return!1;i=t.createDivMessageBorder(i),t._setMessageObject(l,i,0),s.prepend(i);var u=i.children();new MessageColumnLink($(u),e),a(t,e,i);var c=i.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(0);return t._setToolTipToMessageElem(c,e,l),l.onAddMessageReferCount(),1==e.getBodyType()&&ViewUtils.showStampMessage(u,t),t.afterCreateMessageHtml(u),!0}},i.getColumnMessageHtml=function(e,t){console.log("ColumnView::getColumnMessageHtml _ must inherit method.")},i.getActionToolTipType=function(e){var t=0;if(0==n({object:e}))return t;var o=e.getType(),i=null;o==Message.TYPE_PUBLIC&&(i=e.getReplyItemId());var a=LoginUser.getInstance().getJid(),r=e.getFrom();switch(o){case Message.TYPE_PUBLIC:case Message.TYPE_GROUP_CHAT:case Message.TYPE_COMMUNITY:case Message.TYPE_CHAT:case Message.TYPE_MURMUR:t=2==e.getDeleteFlag()||a!=r?TooltipView.TYPE_PUBLIC_REPLY:TooltipView.TYPE_PUBLIC_REPLY_CAN_DELETE;break;case Message.TYPE_MAIL:t=TooltipView.TYPE_CHAT;break;case Message.TYPE_TASK:t=TooltipView.TYPE_TASK;var s=e.getStatus(),l=e.getOwnerJid(),u=LoginUser.getInstance().getJid(),c=e.getParentItemId();if(s==TaskMessage.STATUS_INBOX)t=TooltipView.TYPE_INBOX;else if(l==u&&""!=c)t=s==TaskMessage.STATUS_ASSIGNING?TooltipView.TYPE_ASSIGNED_TASK:TooltipView.TYPE_CHILD_TASK;else if(l!=u&&""!=c)t=TooltipView.TYPE_CHILD_TASK;else{var d=CubeeController.getInstance().getChildrenTaskItemIds(e.getItemId());if(null!=d&&d.getCount()>0){var g=ViewUtils.getDemandTaskListByMessage(e);t=g.getCount()>0?TooltipView.TYPE_PARENT_TASK_CANCEL:TooltipView.TYPE_PARENT_TASK}}break;case Message.TYPE_SYSTEM:break;case Message.TYPE_QUESTIONNAIRE:t=TooltipView.TYPE_QUESTIONNAIRE;break;default:console.log("ColumnView::getActionToolTipType _ invalid type:"+o)}return t},i.getBottomToolTipType=function(e){var t=0;return 0==n({object:e})?t:t},i._showReadMore=function(){var e,t,i=this,a=!1,r=0,s=i.getHtmlElement();if(null!=s){var l=i.getColumnContent();return 0==n({object:l})?a:1==i._allMessageReceived?!1:(e=l.parents("div.ui-widget-content.column"),t=l.children("div:last"),t.hasClass(ViewUtils.LOADING_ICON_CLASS_NAME)?!1:(i._hideLoadingIconInSelf(),ViewUtils.showLoadingIcon(t),r=l.children("div").size(),0==r?(ViewUtils.hideLoadingIcon(t),!1):(o(e)&&(i.getHistoryMessage(),a=!0),a)))}},i.showHistoryMessage=function(e){if(0!=n({object:e})){var t=this;t._hideLoadingIconInSelf();var o=e.getId();(0==t._currentLoadedItemId||t._currentLoadedItemId>o)&&(t._currentLoadedItemId=o);var i=e.getType();i==Message.TYPE_TASK&&(t._currentLoadedItemId=o);var r=e.getItemId();if(!t.getMsgObjByItemId(r)){var s,i=e.getType(),l=t.getHtmlElement();if(null!=l){var u=t.getColumnContent(),c=t.createMessageObjectOnly(e);if(null!=c&&(s=t.getColumnMessageHtml(c,!1),""!=s)){s=t.createDivMessageBorder(s),t._setMessageObject(c,s,-1),u.append(s);var d=s.children();new MessageColumnLink($(d),e),a(t,e,s);var g=t._getToolTipBaseElement(s);t._setToolTipToMessageElem(g,e,c),c.onAddMessageReferCount(),1==e.getBodyType()&&ViewUtils.showStampMessage(d,t),t.afterCreateMessageHtml(d)}}}}},i._getToolTipBaseElement=function(e){return e.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(0)},i._getRootReplyItemId=function(e){var t=this,n="";if(0==t._validation({object:e}))return!1;var o=e.getReplyItemId();if(null==o||""==o)return n;var i=t.getMsgObjByItemId(o);if(null==i)return n;var a=i.getMessage();if(null==a)return n;var r=a.getItemId();if(null==r)return n;n=o;var s=t.getParentMsgObjByItemId(o);if(null==s)return n;var l=s.getMessage();if(null==l)return n;var u=l.getItemId();return null==u?n:n=u},i._getReplyPositionElement=function(e,t){var n={};if(n.insertElementFound=!1,null!=e&&""!=e)for(var o=t.children("div").length,i=0;o>i;i++){var a=t.children("div").eq(i);if(null==a)break;var r=a.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(0);if(null==r)break;var s=r.children("div.message-header").children("div.message-info");if(null==s)return;var l=s.attr("itemid");if(l==e){n.insertElementFound=!0,n.insertElement=a,n.replyInsertIndex=i;break}}return n},i.addMsgObjIndexChild=function(e,t){var n=this;if(0==n._validation({string:e,object:t}))return!1;var o=(n._getMsgObjIndexList(),n.getMsgObjIndexByItemId(e));return n.addMsgObjIndexToHash(t),o.getChildren().add(t),!0},i.getParentMsgObjByItemId=function(e){var t=this;if(0==t._validation({string:e}))return null;for(var n=t._getMsgObjIndexList(),o=n.getCount(),i=!1,a=0;o>a;a++){for(var r=n.get(a),s=r.getChildren(),l=r.getChildrenCount(),u=0;l>u;u++){var c=s.get(u),d=c.getMsgObj(),g=d.getMessage();if(g.getItemId()==e){i=!0;break}}if(i)return r.getMsgObj()}return null},i.strToggleReplyLinkHtml=function(e,t){var n=this;if(0!=n._validation({string:e})&&0!=n._validation({object:t})){var o=t.hasClass(ColumnMessageView.MESSAGE_READ_STATUS_READ_CSS_CLS)?ColumnMessageView.MESSAGE_READ_STATUS_READ_CSS_CLS:ColumnMessageView.MESSAGE_READ_STATUS_UNREAD_CSS_CLS,i='<div class="box-border '+ColumnView.TOGGLE_REPLY_CLS_NAME+" "+o+'">'+e+'</div><div class="comment_wrapper"></div>';return i}},i._showMessageDataWithThread=function(e){var t=this;if(0==t._validation({object:e}))return!1;var n=e.getItemId();if(t.getMsgObjByItemId(n))return!0;var o,i,r=(e.getType(),t.getHtmlElement());if(null!=r){var s=t.getColumnContent(),l=null,u=!1,c=null,d=-1,g=t._getRootReplyItemId(e);if(null!=g&&""!=g){var m=t.getMsgObjByItemId(g);null!=m&&(c=m.getHtmlElement(),u=!0,d=t.getMsgObjIndexPositionByItemId(g))}var _=t.createMessageObjectOnly(e);if(o=t.getColumnMessageHtml(_,u),""==o)return!1;if(u){c.append(o),i=c.children().eq(-1),_.setHtmlElement(i);var f=new MessageObjectIndex(_);t.addMsgObjIndexChild(g,f),c.detach(),s.prepend(c),t._getMsgObjIndexList().move(d,0),l=c}else o=t.createDivMessageBorder(o),t._setMessageObject(_,o,0),s.prepend(o),i=t._getMessageElement(0).children().eq(-1);var p=i;new MessageColumnLink($(p),e);var h,C=s.children("div").eq(0);if(h=u?C.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(-1).children("div").eq(1):C.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(-1),a(t,e,C),t._setToolTipToMessageElem(h,e,_),null!=l){var v=l.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).length-1,y=l.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(-1).prev();if(v>ColumnView.RECENT_REPLY_SHOW_COUNT)if(0==l.children("."+ColumnView.HIDDEN_REPLY_CLS_NAME).length){var T=y.attr("class");y.attr("class",T+" "+ColumnView.HIDDEN_REPLY_CLS_NAME),y.hide(),l.children("."+ColumnView.TOGGLE_REPLY_CLS_NAME).remove();var b=l.children("div.thread-message").length,I=Utils.stringFormat(Resource.getMessage("show_past_reply_txt"),b),M=l.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(0),E=t.strToggleReplyLinkHtml(I,M);l.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(0).after(E)}else if(l.children("."+ColumnView.HIDDEN_REPLY_CLS_NAME).is(":hidden")){var T=y.attr("class");y.attr("class",T+" "+ColumnView.HIDDEN_REPLY_CLS_NAME),y.hide();var b=l.children("div.thread-message").length,I=Utils.stringFormat(Resource.getMessage("show_past_reply_txt"),b);l.children("."+ColumnView.TOGGLE_REPLY_CLS_NAME).text(I)}}return _.onAddMessageReferCount(),1==e.getBodyType()&&ViewUtils.showStampMessage(p,t),t.afterCreateMessageHtml(p),!0}},i._showHistoryMessageWithThread=function(e){var t=this;if(0!=t._validation({object:e})){var n=e.getId();(0==t._currentLoadedItemId||t._currentLoadedItemId>n)&&(t._currentLoadedItemId=n);var o=e.getItemId();if(!t.getMsgObjByItemId(o)){var i=t.getHtmlElement();if(null!=i){var r=t.getColumnContent(),s=CubeeController.getInstance().getReplyReverseItemIds(o),l=!1,u=new ArrayList,c=!1,d=t.createMessageObjectOnly(e),g=t.getColumnMessageHtml(d,c);g=t.createDivMessageBorder(g);var m;if(null!=s){for(var _=s.getCount(),f=-1,p=0;_>p;p++){var h=s.get(p),C=t.getMsgObjIndexByItemId(h);if(null!=C){u.add(C);var v=t.getMsgObjIndexPositionByItemId(h);(-1==f||f>v)&&(f=v)}}var y=null;f>0&&(y=r.children("div").eq(f-1));for(var T=new Array,b=u.getCount(),p=0;b>p;p++){T[p]=new Array;var C=u.get(p),I=C.getChildren(),M=C.getChildrenCount();T[p][0]=C.getMsgObj().getMessage().getItemId();for(var E=0;M>E;E++){var S=I.get(E);T[p][E+1]=S.getMsgObj().getMessage().getItemId()}}for(var w=new Array,N=new Array,p=0;b>p;p++)N[p]=-1;for(var A=0;;){for(var U=-1,p=0;b>p;p++)if(N[p]+1<T[p].length){U=p;break}if(-1==U)break;for(var L=U,R=T[U][N[U]+1],O=CubeeController.getInstance().getMessage(R),P=new Date(O.getDate()),p=U+1;b>p;p++)if(!(N[p]+1>=T[p].length)){var k=T[p][N[p]+1],D=CubeeController.getInstance().getMessage(k);P.isAfter(D.getDate())&&(L=p,P=new Date(D.getDate()))}N[L]++,w[A]=T[L][N[L]],A++}if(f>=0){l=!0;var V=null;null!=y?(y.after(g),m=t._getMessageElement(f),t._setMessageObject(d,m,f),V=y.next()):(r.prepend(g),m=t._getMessageElement(0),t._setMessageObject(d,m,0),V=r.children("div").eq(0)),t._setToolTipToMessageElem(V.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(0),e,d);for(var b=u.getCount(),p=0;b>p;p++){var x=u.get(p).getMsgObj(),Y=x.getHtmlElement();Y.remove();var F=x.getMessage().getItemId(),H=t.getMsgObjIndexPositionByItemId(F);t.removeFromHash(F);var G=t._getMsgObjIndexList();G.remove(H)}t._addReplyMessageToColumn(V,o,w);for(var B=V.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).length-1,j=B-ColumnView.RECENT_REPLY_SHOW_COUNT,p=1;j>=p;p++){var J=V.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(p);J.hide();var q=J.attr("class");if(J.attr("class",q+" "+ColumnView.HIDDEN_REPLY_CLS_NAME),p==j){var K=V.children("div.thread-message").length,W=Utils.stringFormat(Resource.getMessage("show_past_reply_txt"),K),z=V.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(0),Q=t.strToggleReplyLinkHtml(W,z);V.children("."+ColumnView.TOGGLE_REPLY_CLS_NAME).remove(),V.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(0).after(Q)}}}}if(a(t,e,g),0==l){r.append(g);var m=t._getMessageElement(-1);t._setMessageObject(d,m,-1),t._setToolTipToMessageElem(m.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(0),e,d)}var X=m.children();new MessageColumnLink($(X),e),d.onAddMessageReferCount(),1==e.getBodyType()&&ViewUtils.showStampMessage(X,t),t.afterCreateMessageHtml(X)}}}},i._addReplyMessageToColumn=function(e,t,n){for(var o=this,i=n.length,a=0;i>a;a++){var r=CubeeController.getInstance().getMessage(n[a]),s=o.createMessageObjectOnly(r),l=o.getColumnMessageHtml(s,!0);e.append(l);var u=e.children().eq(-1);s.setHtmlElement(u);var c=new MessageObjectIndex(s);o.addMsgObjIndexChild(t,c);var d=e.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(-1).children("div").eq(1);o._setToolTipToMessageElem(d,r,s),1==r.getBodyType()&&ViewUtils.showStampMessage(u,o),o.afterCreateMessageHtml(u)}},i.afterCreateMessageHtml=function(e){},i.deleteMessageBase=function(e,t,n){var o=t?t:1,i=this,a=!1,r=i.getMsgObjByItemId(e),s="";if(null!=r)switch(o){case 1:r.getHtmlElement().remove(),a=i.removeMsgObjIndexByItemId(e);break;case 2:for(var l=$(".box-border[itemid="+e+"]"),u=0;u<l.size();u++){var c=r.getMessage(),d=void 0,g=void 0;c.getType()==Message.TYPE_QUESTIONNAIRE?(d=Resource.getMessage("deleted_questionnaire_body_by_admin"),g=Resource.getMessage("deleted_questionnaire_body")):(d=Resource.getMessage("deleted_message_body_by_admin"),g=Resource.getMessage("deleted_message_body")),s=n?"<pre>"+d+"</pre>":"<pre>"+g+"</pre>",l.eq(u).find(".message-body").html(s),l.eq(u).find(".thumbnail-area").remove(),l.eq(u).find(".frm-read-more").remove(),c.setDeleteFlag(o),i._setToolTipToMessageElem(l.eq(u),c,r),c.getType()==Message.TYPE_QUESTIONNAIRE&&l.eq(u).find(".showActionTooltip").remove()}}return a},i.deleteMessage=i.deleteMessageBase,i._getNotAvailableMessageHtmlIfMessageNothing=function(e){},i._setToolTipToMessageElem=function(e,n,o){var i=this,a=i.getActionToolTipType(n),r=i.getBottomToolTipType(n),s=e.children("div.message-info").eq(0),l=e.find("div.block-avatar").eq(0);if(a!=TooltipView.TYPE_UNKNOWN){var u=null;e=i._appendShowActionToolTipElement(e,n);var c=e.find(".showActionTooltip").eq(0);u=ViewUtils.isIE89()||n.getType()==Message.TYPE_TASK?e.find(".inbox-message-header").length>0?e.find("div.inbox-message-header").eq(0):e.find(".task-message-header").length>0?e.find("div.task-message-header").eq(0):e.children("div.message-header").eq(0):e.find("td.actionToolTipBase").eq(0);var d=!0;i.getType()==ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION&&(d=!1),TooltipView.getInstance().setActionToolTip(a,u,c,d)}o.setMessageInnerActionToolTip(),r!=TooltipView.TYPE_UNKNOWN&&TooltipView.getInstance().setActionToolTip(r,s),TooltipView.getInstance().setAvatarToolTip(TooltipView.TYPE_USER_AVATAR,l,!0);var g=o.getMessage().getQuotationItem();g&&g.getFrom()&&TooltipView.getInstance().setAvatarToolTip(TooltipView.TYPE_USER_AVATAR,o.getHtmlElement().find(".quote_in_message div.block-avatar"),!0),e.find('[data-toggle="tooltip"]').tooltip({trigger:"hover"}),n.getFrom()==LoginUser.getInstance().getJid()&&0==n.getDeleteFlag()||i.getActionToolTipType(n)==TooltipView.TYPE_TASK||i.getActionToolTipType(n)==TooltipView.TYPE_PARENT_TASK||i.getActionToolTipType(n)==TooltipView.TYPE_PARENT_TASK_CANCEL||e.find("a.action-delete-message").remove(),(n.getFrom()!=LoginUser.getInstance().getJid()||""==n.getThreadRootId())&&e.find("a.action-update-thread-title").remove(),(n.getFrom()!=LoginUser.getInstance().getJid()||0!=n.getDeleteFlag())&&e.find("a.action-update-message").remove(),0!=n.getDeleteFlag()&&e.find("a.action-quote-message").remove(),t(i)||e.find("a.action-move-message-room").remove(),n.getFrom()==LoginUser.getInstance().getJid()&&n.getThreadRootId()==n.getItemId()&&CodiMdViewUtils.judgeNoteEnable()||e.find("a.action-assign-note").remove();var m=0;e.find("td.actionToolBarBase ul > li > a").each(function(e,t){m++}),0==m?e.find("td.actionToolBarBase .msg_menu_btn").hide():e.find("td.actionToolBarBase .msg_menu_btn").show()},i._appendShowActionToolTipElement=function(e,t){function n(t,n){var o=$(t).clone(!1);n&&"number"==typeof n&&1==n&&(o.find("li > a.action-update-message").parent().remove(),o.find("li > a.action-quote-message").parent().remove(),o.find("li > a.action-add-inbox-task").parent().remove(),o.find("li > a.action-add-new-task").parent().remove());var i='<div class="actionToolBar box-border">'+o.html()+"</div>";e.find("td.actionToolBarBase").eq(0).append(i)}var o=e.find(".showActionTooltip").length,i=this;if(0==o){var a=function(){return e.find(".inbox-message-header").length>0?!0:!1},r=function(){return e.find(".task-message-header").length>0?!0:!1},s=function(){return 2==t.getDeleteFlag()||LoginUser.getInstance().getJid()!=t.getFrom()?!1:e.hasClass("questionnaire-message-header")?!0:e.parent().find(".questionnaire-message-header").length>0?!0:!1},l='<div class="showActionTooltip" >';if(l+='  <div class="actionToolBar box-border">',l+='    <div class="popup_menu msg_menu">',l+='      <a class="msg_btn msg_menu_btn popup_btn ico_btn">',l+='        <i class="fa fa-ellipsis-v"></i>',l+="      </a>",l+="</div></div></div>",ViewUtils.isIE89())if(a())l=l.replace('class="showActionTooltip"','class="showActionTooltip tooltipMenuPosIe89"'),e.find("div.message-header").eq(0).append(l);else{var u='<td class="actionToolTipArea">'+l+"</td>";e.find("div.message-header td:last").eq(0).after(u)}else if(a())e.find("div.inbox-message-header").eq(0).append(l);else if(r())e.find("div.task-message-header").eq(0).append(l);else if(s())e.hasClass("questionnaire-message-header")?e.append(l):e.find("div.questionnaire-message-header").eq(0).append(l);else switch(i._type){
case ColumnInformation.TYPE_COLUMN_TIMELINE:case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:0==i._SendMessageRight?n("#toolbarMessageActionNotSend",t.getBodyType()):n("#toolbarMessageAction",t.getBodyType());break;default:switch(t.getType()){case Message.TYPE_PUBLIC:if(!AuthorityInfo.getInstance().checkRights("sendMessageToFeed")){n("#toolbarMessageActionNotSend",t.getBodyType());break}n("#toolbarMessageAction",t.getBodyType());break;case Message.TYPE_GROUP_CHAT:if(AuthorityInfo.getInstance().checkRights("viewMessageInGroupchat",t.getTo())){n("#toolbarMessageActionNotSend",t.getBodyType());break}n("#toolbarMessageAction",t.getBodyType());break;case Message.TYPE_COMMUNITY:if(AuthorityInfo.getInstance().checkRights("viewMessageInCommunity",t.getTo())){n("#toolbarMessageActionNotSend",t.getBodyType());break}n("#toolbarMessageAction",t.getBodyType());break;default:n("#toolbarMessageAction",t.getBodyType())}}}return e},i.onGoodJobReceive=function(e){var t=this,n=t.getMsgObjByItemId(e);null!=n&&n.onGoodJobReceive()},i.onEmotionPointReceive=function(e){var t=this,n=t.getMsgObjByItemId(e);null!=n&&n.onEmotionPointReceive()},i.onMessageOptionReceive=function(e){if(0!=n({object:e})&&null!=e.getType){var t=e.getType();if(t==Notification_model.TYPE_MESSAGE_OPTION){var o=this,i=e.getItemId(),a=o.getMsgObjByItemId(i);null!=a&&a.onMessageOptionReceive(e)}}},i.onThreadTitleUpdateReceived=function(e,t){for(var n=this,o=n.getHtmlElement(),i=0;i<e.length;i++){var a=o.find("[itemid="+e[i]+"] .message-title");if(t.getThreadTitle()){var r=[],s=t.getThreadTitle(),l=s;l=ViewUtils.replaceTenantBaseTitleCategory(l,s,r),l=ViewUtils.replaceOrignalTitleCategory(l,s,r);for(var u=r.sort(function(e,t){return e.index-t.index}),c="",d=0;d<u.length;d++)c+=u[d].data;if(a[0])a.html(""+c+'<span style="font-weight:700;">'+Utils.convertEscapedHtml(l)+"</span>");else{var g='<pre class="message-title">'+c+'<span style="font-weight:700;">'+Utils.convertEscapedHtml(l)+"</span></pre>";o.find("[itemid="+e[i]+"] .message-body").prepend(g)}}else a.remove()}},i.onNoteAssignChangedReceived=function(e,t){for(var n=this,o=n.getHtmlElement(),i=0;i<e.length;i++)if(t.getType()==Notification_model.TYPE_ASSIGN_NOTE){var a=(o.find("[itemid="+e[i]+"] .message-title"),t.getThreadRootId()),r=t.getOldThreadRootId();if(a&&!r){var s=Utils.convertEscapedHtml(t.getNoteTitle()),l=t.getNoteUrl(),u='                        <div class="message-body-note">                            <a href="'+l+' " target="_brank" title="'+s+'">                                <i class="fa fa-pencil-square-o"></i>                                '+s+"                            </a>                        </div>                    ";o.find("[itemid="+e[i]+"] .message-body .message-body-note").length&&o.find("[itemid="+e[i]+"] .message-body .message-body-note").remove(),o.find("[itemid="+e[i]+"] .message-body .message-title").length?o.find("[itemid="+e[i]+"] .message-body .message-title").after(u):o.find("[itemid="+e[i]+"] .message-body").prepend(u)}else r&&!a&&o.find("[itemid="+e[i]+"] .message-body .message-body-note").remove()}else t.getType()==Notification_model.TYPE_DELETE_NOTE&&o.find("[itemid="+e[i]+"] .message-body .message-body-note").remove()},i.onMessageUpdateReceived=function(e){var t=this,n=e.getMessage().getItemId(),o=t.getMsgObjByItemId(n);if(!o){var i=t.getColumnInfo().getColumnType();if(i==ColumnInformation.TYPE_COLUMN_SEARCH||i==ColumnInformation.TYPE_COLUMN_RECENT||i==ColumnInformation.TYPE_COLUMN_MURMUR||i==ColumnInformation.TYPE_COLUMN_TOME||i==ColumnInformation.TYPE_COLUMN_FILTER||i==ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER){if(!t.showNewMatchUpdateMessage(e.getMessage()))return;o=t.getMsgObjByItemId(n)}}var a=o.getHtmlElement(),r=$(o.getMessageHeaderHtml()).find(".message-time");a.find("div[itemid="+n+"] .message-time").remove(),a.find("div[itemid="+n+"] .sender-name").after(r),r=$(o.getMessageBodyHtml()).find(".message-body").children(),a.find("div[itemid="+n+"] .message-body").children().remove(),a.find("div[itemid="+n+"] .message-body").append(r),t.getType()==ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION&&a.find("pre.message-title").remove();var s=a.find("img.image-thumbnail");if(s.length&&$(s).each(function(e,t){var o=$(t);if(!o.attr("src")){var i=o.attr("data-url");CubeeController.getInstance().downloadThumbnailImage(i,n,o)}}),ViewUtils.showOpenGraphProtocolImage(a),o.updateMessageReadStatus(!1),o.setMessage(e._message),e.getMessage().getType()==Message.TYPE_PUBLIC){var l=$(a).find("div[itemid="+n+"] a.read-more-link").eq(0);l.length&&t.getMsgObjByItemId(n)._setReadMoreEvent(l),o._columnMessageExistingReaderInfoView._message=e._message}else{var l=$(a).find("div[itemid="+n+"] a.read-more-link").eq(0);l.length&&t.getMsgObjByItemId(n)._setReadMoreEvent(l),o._columnMessageExistingReaderInfoView&&(o._columnMessageExistingReaderInfoView._message=e._message),a.find("div[itemid="+n+"] .frm-existing-reader").remove(),o._columnMessageExistingReaderInfoView&&(o._columnMessageExistingReaderInfoView.cleanup(),o._columnMessageExistingReaderInfoView=null)}var u=$(a).find("div[itemid="+n+"] a.hashtag");t.getMsgObjByItemId(n)._setHashtagEvent(u),t.afterCreateMessageHtml(a)},i.updateColumnTitle=function(e){var t=this,n=t._info,o=n.getDisplayName(),i=t.getHtmlElement();if(null!=i){var a=i.children("div").children("div.column-header").eq(0).children("div.column-header-title").eq(0);a.attr("title",o),a.text(o),ColumnManager.getInstance().updateColumnIconTitle(t),t._setColumnTitleToolTip(),e&&a.css({"border-bottom-color":e}),ColumnManager.getInstance().updateColumnIcon(t)}},i.createDivMessageBorder=function(e){return $('<div class="message-border"></div>').append(e)},i._createDisplayName=function(){var e="";return e},i.checkDemandTask=function(){return!1},i.onAddMember=function(e){},i._insertMessage=function(e,t){var n=this;if(null!=e&&null!=t&&"number"==typeof t){var o=n._getMsgObjIndexList(),i=o.getCount();(0>t||t>=i)&&(t=-1);var a=n.getHtmlElement();if(null!=a){var r=n.getColumnContent(),s=n.createMessageObjectOnly(e),l=n.getColumnMessageHtml(s,!1);if(""!=l){l=n.createDivMessageBorder(l),n._setMessageObject(s,l,t),0>t?r.append(l):r.children("*").eq(t).before(l);var u=l.children();new MessageColumnLink($(u),e);var c=l.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(0);n._setToolTipToMessageElem(c,e,s)}}}},i._startPergeMessageIntarval=function(){var e=this;Conf.getVal("PURGE_MESSAGE_FLAG")&&(e._pergeMessageTimerId=setInterval(function(){e._pergeMessage()},Conf.getVal("PURGE_MESSAGE_INTARVAL")))},i._endPergeMessageIntarval=function(){var e=this;e._pergeMessageTimerId&&(clearInterval(e._pergeMessageTimerId),e._pergeMessageTimerId=null)},i._pergeMessage=function(){function e(){if(i<Conf.getVal("PURGE_DEFAULT_BASE_THREAD_POS"))return void t();var a=o.get(i);if(null==a)return i--,void setTimeout(e,l);var u=a.getMsgObj();if(null!=u){var c=u.getHtmlElement(),d=c.position(),g=d.top-r.offset().top;if(s>=g)return void t();for(var m=a.getChildrenCount(),_=m-1,f=_;f>=0;f--){var p=o.get(i).getChildren(),h=p.get(f).getMsgObj(),C=h.getItemId();n.removeMsgObjIndexByItemId(C)}c.remove();var v=u.getItemId();n.removeMsgObjIndexByItemId(v)}i--,setTimeout(e,l)}function t(){var e=n._getMsgObjIndexList(),t=e.getCount()-1,o=e.get(t),i=o.getMsgObj(),a=i.getMessage(),r=a.getId(),s=o.getChildrenCount();if(s>0){var u=s-1,c=o.getChildren(),d=c.get(u).getMsgObj(),g=d.getMessage();r=g.getId()}n._currentLoadedItemId=r,setTimeout(function(){n._disableBottomEvent=!1,n._allMessageReceived=!1},l)}var n=this,o=n._getMsgObjIndexList();if(null!=o){var i=o.getCount()-1;if(!(i<Conf.getVal("PURGE_DEFAULT_BASE_THREAD_POS"))){var a=n.getHtmlElement();if(null!=a){var r=n.getColumnContent(),s=r.height(),l=10;n._disableBottomEvent=!0,setTimeout(e,l)}}}},i._validation=function(e){return n(e)},i._hasClass=function(e){return o(e)},i.removeMsgObjIndexByItemIdNoCleanupMessage=function(e){var t=this;if(0==t._validation({string:e}))return!1;var t=this,n=t._getMsgObjIndexList(),o=n.getCount();t.removeFromHash(e);for(var i=0;o>i;i++){var a=n.get(i),r=a.getMsgObj(),s=r.getMessage();if(s.getItemId()==e)return n.remove(i);for(var l=a.getChildren(),u=a.getChildrenCount(),c=0;u>c;c++){var d=l.get(c),r=d.getMsgObj(),s=r.getMessage();if(s.getItemId()==e)return l.remove(c)}}return!1},i.updateMessageReadStatus=function(e,t){var n=this,o=n.getMsgObjByItemId(e);null!=o&&o.updateMessageReadStatus(t)},i.getColumnContent=function(){var e=this,t=e.getHtmlElement().find("div.column-content").find(".mCSB_container");return t.length>0?t:e.getHtmlElement().find("div.column-content")},i.refreshScrollbar=function(){var e=this;if(e._htmlElement&&!e._htmlElement.find(".scroll_content.ps").length){var t=e._htmlElement.find(".scroll_content"),n=new PerfectScrollbar(t[0],{suppressScrollX:!0});$(t).on("ps-scroll-y",function(){$("emoji-picker").hasClass("open")&&$("emoji-picker").removeClass("open")}),col_scr.push(n),t.on("ps-y-reach-end",function(){e._disableBottomEvent||e._showReadMore(!0)})}},i.onUpdateQuestionnaireMessageReceive=function(e){var t=this;if(null!==e&&e.getType()===Message.TYPE_QUESTIONNAIRE){var n=e.getItemId(),o=t.getMsgObjByItemId(n);if(o){o.setMessage(e);var i=t.getColumnMessageHtml(o,!1);if(""!==i){var a=o.getHtmlElement();a.length>0&&(a.html(i),o.setHtmlElement(a));var r=a.children();new MessageColumnLink($(r),e);var s=a.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(0);return t._setToolTipToMessageElem(s,e,o),!0}}}};var a=function(e,t,n){var o=e,i=o.getColumnInfo();switch(i.getColumnType()){case ColumnInformation.TYPE_COLUMN_MURMUR:if(o.isSideMenu){var a=t.getProfileMap().getByKey(t.getTo()).getNickName(),r=Utils.avatarCreate({name:a,type:"user"}),s=String(parseInt(r.color.substring(1,3),16)),l=String(parseInt(r.color.substring(3,5),16)),u=String(parseInt(r.color.substring(5,7),16)),c=Resource.getMessage("Murmur"),d=t.getColumnName();"string"==typeof d&&d.length>0&&(c=d),n.children(".murmur-message").prepend($("<div>").addClass("side-murmur-thread-root-message").css({"border-left-color":r.color,"background-color":"rgba("+s+","+l+","+u+",0.05)"}).attr("msgto",t.getTo()).text(c))}}}}(),function(){var e=MessageColumnLink.prototype;e._getHtmlElement=function(){return this._htmlElement},e._getMessage=function(){return this._message},e._createEventHandler=function(){var e=this,t=e._getHtmlElement(),n=e._getMessage();null!=n&&t.click(function(){for(var e=ColumnManager.getInstance().getTargetColumnsInfoArrayList(n),o=e.getCount(),i=0;o>i;i++){var a=e.get(i);ColumnIconArea.getInstance().removeColumnNotificationIconByColumnInformation(a)}switch(NotificationIconManager.getInstance().removeColumnNotificationIconByMessage(n),n.getType()){case Message.TYPE_CHAT:var r=LoginUser.getInstance().getJid(),s=n.getFrom();r==s&&(s=n.getTo()),NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[jid="'+s+'"][columntype="3"].sortable-item .ico');break;case Message.TYPE_GROUP_CHAT:NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[msgto="'+n.getTo()+'"][columntype="'+ColumnInformation.TYPE_COLUMN_GROUP_CHAT+'"].sortable-item .ico_group');break;case Message.TYPE_COMMUNITY:NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[msgto="'+n.getTo()+'"][columntype="'+ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED+'"].sortable-item .ico_project');break;case Message.TYPE_QUESTIONNAIRE:var l=n.getRoomId();$(t).parent().parent().parent().parent().find(".column-group-chat[roomid="+l+"]").length>0?NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[msgto="'+l+'"][columntype="'+ColumnInformation.TYPE_COLUMN_GROUP_CHAT+'"].sortable-item .ico_group'):$(t).parent().parent().parent().parent().find(".column-community-feed[roomid="+l+"]").length>0?NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[msgto="'+l+'"][columntype="'+ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED+'"].sortable-item .ico_project'):$(t).parent().parent().parent().parent().find(".column-questionnaire").length>0&&NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon("li[columntype=17].sortable-item .ico_system");break;case Message.TYPE_MURMUR:NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[jid="'+n.getTo()+'"][columntype="18"].sortable-item .ico_user')}})}}(),function(){function e(e){var t,n=e.length,o=e.slice(-1);return t=","==o?e.slice(0,n-1):e}function t(e){for(var t in e)if("string"==t){if(null==e[t]||"string"!=typeof e[t])return!1}else if("number"==t&&(null==e[t]||"number"!=typeof e[t]||e[t]<0))return!1;return!0}var n=TaskFilterAndSortCondition.prototype;TaskFilterAndSortCondition.SORT_KEY_ITEM="item",TaskFilterAndSortCondition.SORT_KEY_ORDER="order",TaskFilterAndSortCondition.DB_COLOMN_STATUS="status",TaskFilterAndSortCondition.DB_COLOMN_DUE_DATE="due_date",TaskFilterAndSortCondition.DB_COLOMN_COMPLETE_DATE="complete_date",TaskFilterAndSortCondition.DB_COLUMN_PRIORITY="priority",TaskFilterAndSortCondition.DB_COLUMN_CLIENT="client",TaskFilterAndSortCondition.DB_COLUMN_UPDATE_AT="updated_at",TaskFilterAndSortCondition.DB_COLUMN_CREATED_AT="created_at",TaskFilterAndSortCondition.DB_COLUMN_DEMAND_STATUS="demand_status",TaskFilterAndSortCondition.DB_COLUMN_DEMAND_DATE="demand_date",TaskFilterAndSortCondition.SORT_COLUMN_IS_NULL="IS NULL",TaskFilterAndSortCondition.SORT_ORDER_ASC="1",TaskFilterAndSortCondition.SORT_ORDER_DES="2",TaskFilterAndSortCondition.FILTER_KEY_OWNER="owner",TaskFilterAndSortCondition.FILTER_KEY_STATUS="status",TaskFilterAndSortCondition.FILTER_KEY_GROUP="group",TaskFilterAndSortCondition.FILTER_KEY_START_DATE="start_date",TaskFilterAndSortCondition.FILTER_KEY_END_DATE="end_date",TaskFilterAndSortCondition.FILTER_KEY_CLIENT="client",TaskFilterAndSortCondition.FILTER_KEY_UPDATED_BY="updated_by",TaskFilterAndSortCondition.DELIMITER_STRING=",",n.getFilterConditionJSONString=function(){var t="";return t+="{",t+='"filter":{',t+=""==this.getFilterOwner()?"":'"'+TaskFilterAndSortCondition.FILTER_KEY_OWNER+'":"'+this.getFilterOwner()+'",',t+=""==this.getFilterStatus()?"":'"'+TaskFilterAndSortCondition.FILTER_KEY_STATUS+'":"'+this.getFilterStatus()+'",',t+=""==this.getFilterGroup()?"":'"'+TaskFilterAndSortCondition.FILTER_KEY_GROUP+'":"'+this.getFilterGroup()+'",',t+=""==this.getFilterStartDate()?"":'"'+TaskFilterAndSortCondition.FILTER_KEY_START_DATE+'":"'+this.getFilterStartDate()+'",',t+=""==this.getFilterEndDate()?"":'"'+TaskFilterAndSortCondition.FILTER_KEY_END_DATE+'":"'+this.getFilterEndDate()+'",',t+=""==this.getFilterClient()?"":'"'+TaskFilterAndSortCondition.FILTER_KEY_CLIENT+'":"'+this.getFilterClient()+'",',t+=""==this.getFilterUpdatedBy()?"":'"'+TaskFilterAndSortCondition.FILTER_KEY_UPDATED_BY+'":"'+this.getFilterUpdatedBy()+'",',t=e(t),t+="},",t+='"sort":{',t+=""==this.getSortItem()?"":'"item":"'+this.getSortItem()+'",',t+=""==this.getSortOrder()?"":'"order":"'+this.getSortOrder()+'",',t=e(t),t+="}",t+="}"},n.getFilterObject=function(e){if(0==t({string:e}))return null;var n=JSON.parse(e||null);return null==n?null:n.filter},n.getSortObject=function(e){if(0==t({string:e}))return null;var n=JSON.parse(e);return n.sort},n.getFilterOwner=function(){return this._filterOwner},n.getFilterStatus=function(){return this._filterStatus},n.getFilterGroup=function(){return this._filterGroup},n.getFilterStartDate=function(){return this._filterStartDate},n.getFilterEndDate=function(){return this._filterEndDate},n.getFilterClient=function(){return this._filterClient},n.getFilterUpdatedBy=function(){return this._filterUpdatedBy},n.getSortItem=function(){return this._sortItem},n.getSortOrder=function(){return this._sortOrder},n.setFilterOwner=function(e){0!=t({string:e})&&(this._filterOwner=e)},n.setFilterStatus=function(e){0!=t({string:e})&&(this._filterStatus=e)},n.setFilterGroup=function(e){0!=t({string:e})&&(this._filterGroup=e)},n.setFilterStartDate=function(e){0!=t({string:e})&&(this._filterStartDate=e)},n.setFilterEndDate=function(e){0!=t({string:e})&&(this._filterEndDate=e)},n.setFilterClient=function(e){0!=t({string:e})&&(this._filterClient=e)},n.setFilterUpdateBy=function(e){0!=t({string:e})&&(this._filterUpdatedBy=e)},n.setSortItem=function(e){0!=t({string:e})&&(this._sortItem=e)},n.setSortOrder=function(e){0!=t({string:e})&&(this._sortOrder=e)},n.getSortKey=function(e){var n="";if(0==t({number:e}))return n;var o=this._sortItem.split(TaskFilterAndSortCondition.DELIMITER_STRING);return o.length>e&&(n=o[e]),n},n.getSortOrderValue=function(e){var n="";if(0==t({number:e}))return n;var o=this._sortOrder.split(TaskFilterAndSortCondition.DELIMITER_STRING);return o.length>e&&(n=o[e]),n}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnChatView.cssClass="chat-message",ColumnChatView.prototype=$.extend({},ColumnView.prototype);var e=ColumnView.prototype,t=ColumnChatView.prototype;t.getHistoryMessage=function(){function e(e){if(t._hideLoadingIconInSelf(),e){for(var n=e.getCount(),i=0;n>i;i++){var a=e.get(i);if(null!=a){var r=a.getItemId();t.getMsgObjByItemId(r)||t.showHistoryMessage(a)}}o>n&&(t._allMessageReceived=!0),t._updateColumnTitleAndColumnIcon(t.partnerJid),t.refreshScrollbar()}}var t=this,n=t._info,o=20;CubeeController.getInstance().getChatMessages(t._currentLoadedItemId,o,n.getFilterCondition(),e)},t.clickSubFormButton=function(){function e(){o._textarea.clearText(),o._textTitleArea.clearText(),void 0!=o._fileUpload&&null!=o._fileUpload&&o._fileUpload.clearFileUpload(),o.getHtmlElement().find(".attach-note-element p").attr("value")&&(o.getHtmlElement().find(".attach-note-element p").remove(),o.getHtmlElement().find(".attach-note-element .note_cancel_btn").remove()),o.getHtmlElement().find(".message-attachment-area").is(":visible")&&o.getHtmlElement().find(".message-attachment-area").slideToggle(200,function(){$(window).trigger("resize")})}function t(t){var n=o.getHtmlElement().find(".attach-note-element p").attr("value");if(n)if(t.content&&t.content.result){if(t.content.items&&t.content.items.length)var i=function(){if(CubeeController.getInstance()._messageManager.getAllMessage().getByItemId(a.itemId))clearInterval(l),CodiMdController.getInstance().assignNoteOnThreadRootId(a.itemId,n).then(function(t){e()})["catch"](function(e){var t=Resource.getMessage("dialog_title_system_info"),n=Resource.getMessage("dialog_error_assign_note_after_try"),o=new DialogCloseView(t,n);o.showDialog()});else if(u+=1,r*u>s){clearInterval(l);var t=Resource.getMessage("dialog_title_system_info"),o=Resource.getMessage("dialog_error_assign_note_after_try"),i=new DialogCloseView(t,o);i.showDialog()}},a=t.content.items[0],r=200,s=1e4,l=setInterval(i,r),u=0}else{var c=Resource.getMessage("dialog_title_system_info"),d=Resource.getMessage("dialog_error_send_message"),g=new DialogCloseView(c,d);g.showDialog()}else e()}function n(e){var n=new ChatMessage;if(n.setFrom(LoginUser.getInstance().getJid()),n.setTo(i),n.setMessage(e),n.setDirection(ChatMessage.DIRECTION_SEND),n.setThreadTitle(a),0==CubeeController.getInstance().sendChatMessage(n,t)){var o=Resource.getMessage("dialog_title_system_info"),r=Resource.getMessage("dialog_error_send_message"),s=new DialogCloseView(o,r);s.showDialog()}}var o=this,i=o._info.getFilterCondition(),a=o._textTitleArea.getText().trim(),r=o._textarea.getText(),s=o._uploadFileAndSendMessage(r,n,a);o._textarea.clearTextFromFlag(s)},t.createMessageObjectOnly=function(e){var t=this;if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getType(),o=null;switch(n){case Message.TYPE_CHAT:o=new ColumnChatMessageView(t,e);break;default:console.log("ColumnChatView::createMessageObjectOnly _ invalid type:"+n)}return o}},t.getColumnMessageHtml=function(e){var t="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?t=e.getMessageHtml():ret},t._createDisplayName=function(e){var t=ColumnView.DISPLAY_NAME_CHAT;return e&&""!=e&&(t=e),t},t._updateColumnTitleAndColumnIcon=function(t){var n=this,o=function(o){if(o&&"object"==("undefined"==typeof o?"undefined":_typeof(o))){var i=o.getByKey(t),a=i.getUserName(),r=ViewUtils.getAvatarUrl(i);n._info.setDisplayName(n._createDisplayName(a)),n._info.setIconImage(r);var s=Utils.avatarCreate({name:a,type:"user"});e.updateColumnTitle.call(n,s.color),n._info.setDisplayName(a),ColumnManager.getInstance().updateColumnIcon(n),$(window).trigger("resize")}};CubeeController.getInstance().getPersonDataByJidFromServer(t,o)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnGroupChatView.cssClassGroupChat="groupchat-message",ViewUtils.isIE89()?ColumnGroupChatView.cssClassThread="thread-message thread-message-ie89":ColumnGroupChatView.cssClassThread="thread-message",ColumnGroupChatView.prototype=$.extend({},ColumnView.prototype);var e=ColumnView.prototype,t=ColumnGroupChatView.prototype;t.cleanup=function(){var t=this;e.cleanup.call(t),t._memberAreaView&&(t._memberAreaView.cleanup(),delete t._memberAreaView)},t._showMember=function(){function e(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getMemberList();t._prependMemberArea(n),t._info.setChatRoomInfomation(e),t.onChangeRoomName(e)}}var t=this,n=t._info.getChatRoomInfomation(),o=n.getRoomId();t._requestRoomInfo(o,e)},t._hasRightMessage=function(e){var t=e.getChatRoomInfomation().getRoomId(),n=AuthorityInfo.getInstance();switch(n.getWhichRightToGroupchatResource(t)){case AuthorityDef.AUTHORITY_ACTIONS.GC_MANAGE:case AuthorityDef.AUTHORITY_ACTIONS.GC_SEND:e.setRightToSendMessage(!0),e.setRightToViewMessage(!0);break;case AuthorityDef.AUTHORITY_ACTIONS.GC_VIEW:e.setRightToSendMessage(!1),e.setRightToViewMessage(!0);break;default:e.setRightToSendMessage(!1),e.setRightToViewMessage(!1)}},t._prependMemberArea=function(){var e=this,t=e._info.getChatRoomInfomation(),n=t.getMemberList(),o=MemberAreaView.getHtml(t),i=e.getHtmlElement();if(null!=i){var a=i.find(".wrap-frm-message");a.prepend(o);var r=a.children("."+MemberAreaView.CSS_CLS_NAME);e._memberAreaView=new MemberAreaView(r,e),e.resizeColumn();for(var s=n.getCount(),l=0;s>l;l++){var u=n.get(l);e._memberAreaView.addMessageAvatarToolTip(u);var c=CubeeController.getInstance().getPersonData(u),d=0;null!=c&&(d=c.getPresence());var g=r.children("."+MemberAreaView.CSS_BODY_CLS_NAME).find(".block-avatar[jid='"+u+"']");ViewUtils.showPresenceIcon(g,d,ViewUtils.STATUS_PRESENCEICON_GROUPCHAT_MEMBERLIST)}for(var l=0;s>l;l++){var u=n.get(l);if(LoginUser.getInstance().getJid()!=u){var m=CubeeController.getInstance().getContactListData(u);if(null==m){var _=function(t){if(t&&t.get(0)){var n=t.get(0);e._memberAreaView&&e._memberAreaView.updateAvatarPresenceByPersonData(n)}};CubeeController.getInstance().getPersonDataByJidFromServer(u,_)}}}}},t.resizeColumn=function(){var e=this,t=e._htmlElement.outerHeight(!0),n=parseInt(e._htmlElement.css("marginTop"))+parseInt(e._htmlElement.css("marginBottom")),o=parseInt(e._htmlElement.css("borderTopWidth"))+parseInt(e._htmlElement.css("borderBottomWidth")),i=parseInt(e._htmlElement.css("paddingTop"))+parseInt(e._htmlElement.css("paddingBottom")),a=e._htmlElement.find(".column-header").outerHeight(!0),r=e._htmlElement.find(".wrap-frm-message").outerHeight(!0),s=t-a-r,l=s-n-o-i;e._htmlElement.find(".column-content").css("height",l)},t._requestRoomInfo=function(e,t){function n(e){return null==e?void o._showNotReferableGroupChat():(o._updateRoomInfo(e),void t(e))}var o=this;if(null==e||"string"!=typeof e)return null;var i=o.getColumnInfo().getChatRoomInfomation();return i.getRoomId()==e&&-1!=i.getId()&&i.getMemberList()._length&&i.getProfileMap()._length?(o._updateRoomInfo(i),void t(i)):void CubeeController.getInstance().getRoomInfo(e,n)},t._updateRoomInfo=function(e){var t=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?null:void t._info.setChatRoomInfomation(e)},t._setOptionMenu=function(e){var t=this,n=GroupChatColumnOptionMenu.getHtml(t._info),o=TooltipView.getInstance().createColumnOptionMenuTooltip(e,n);t._columnOptionMenu=new GroupChatColumnOptionMenu(o,t._info,t)},t.getHistoryMessage=function(){function e(e){if(t._hideLoadingIconInSelf(),e){var n=e.messageDataList;if(n){var i=n.getCount();o>i&&(t._allMessageReceived=!0),t.onGetGroupChatHistoryMessage(n),$(window).trigger("resize"),t.refreshScrollbar()}}}var t=this,n=t._info.getSearchCondition(),o=20;CubeeController.getInstance().searchMessage(t._currentLoadedItemId,o,n,e)},t.onGetGroupChatHistoryMessage=function(e){var t=this;if(e)for(var n=e.getCount(),o=0;n>o;o++){var i=e.get(o);if(null!=i){var a=i.getItemId();t.getMsgObjByItemId(a)||t.showHistoryMessage(i)}}},t.createMessageObjectOnly=function(e){var t=this;if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getType(),o=null;switch(n){case Message.TYPE_GROUP_CHAT:o=new ColumnGroupChatMessageView(t,e);break;case Message.TYPE_QUESTIONNAIRE:o=new ColumnQuestionnaireMessageView(t,e);break;default:console.log("ColumnGroupChatView::createMessageObjectOnly _ invalid type:"+n)}return o}},t.getColumnMessageHtml=function(e,t){var n="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?(null==t&&(t=!1),n=e.getMessageHtml(t)):n},t._createDisplayName=function(){var e=this;return e.getColumnInfo().getChatRoomInfomation().getRoomName()},t.showHistoryMessage=function(e){var t=this;t._showHistoryMessageWithThread(e)},t.clickSubFormButton=function(){var e=this;e.sendGroupChatMessage()},t.sendGroupChatMessage=function(){function e(){o._textarea.clearText(),o._textTitleArea.clearText(),void 0!=o._fileUpload&&null!=o._fileUpload&&o._fileUpload.clearFileUpload(),o.getHtmlElement().find(".attach-note-element p").attr("value")&&(o.getHtmlElement().find(".attach-note-element p").remove(),o.getHtmlElement().find(".attach-note-element .note_cancel_btn").remove()),o.getHtmlElement().find(".message-attachment-area").is(":visible")&&o.getHtmlElement().find(".message-attachment-area").slideToggle(200,function(){$(window).trigger("resize")})}function t(t){var n=o.getHtmlElement().find(".attach-note-element p").attr("value");if(n){if(!t.content||!t.content.result){var i=Resource.getMessage("dialog_title_system_info"),a=Resource.getMessage("dialog_error_send_message"),r=new DialogCloseView(i,a);return void r.showDialog()}if(t.content.items&&t.content.items.length)var s=function(){if(CubeeController.getInstance()._messageManager.getAllMessage().getByItemId(l.itemId))clearInterval(d),CodiMdController.getInstance().assignNoteOnThreadRootId(l.itemId,n).then(function(t){e()})["catch"](function(e){var t=Resource.getMessage("dialog_title_system_info"),n=Resource.getMessage("dialog_error_assign_note_after_try"),o=new DialogCloseView(t,n);o.showDialog()});else if(g+=1,u*g>c){clearInterval(d);var t=Resource.getMessage("dialog_title_system_info"),o=Resource.getMessage("dialog_error_assign_note_after_try"),i=new DialogCloseView(t,o);i.showDialog()}},l=t.content.items[0],u=200,c=1e4,d=setInterval(s,u),g=0}else e()}function n(e){var n=new GroupChatMessage;n.setFrom(LoginUser.getInstance().getJid());var a=o._info.getChatRoomInfomation(),r=a.getRoomId();if(n.setTo(r),n.setMessage(e),n.setDirection(ChatMessage.DIRECTION_SEND),n.setThreadTitle(i),0==CubeeController.getInstance().sendGroupChatMessage(n,t)){console.log("faild to send Group Chat");var s=Resource.getMessage("dialog_title_system_info"),l=Resource.getMessage("dialog_error_send_message"),u=new DialogCloseView(s,l);u.showDialog()}}var o=this,i=o._textTitleArea.getText().trim(),a=o._textarea.getText(),r=o._uploadFileAndSendMessage(a,n,i);o._textarea.clearTextFromFlag(r)},t._showMessageData=function(e){var t=this;return t._showMessageDataWithThread(e)},t.onAddMember=function(e){var t=this;if(null!=t._memberAreaView){for(var n=t._info.getChatRoomInfomation(),o=n.getMemberList(),i=e.getCount(),a=n.getProfileMap(),r=CubeeController.getInstance().getChatRoomInfoByRoomId(n.getRoomId()),s=[],l=0;l<o._array.length;l++)s.push(o._array[l]);for(var u=0;i>u;u++){var c=e.get(u);if(!(s.indexOf(c)>=0)&&(s.push(c),o.add(c),r)){var d=r.getProfileMap().getByKey(c);d&&a.add(c,d);var g=ViewUtils.createPersonByProfile(c,d);t._memberAreaView.onAddMember(g)}}}},t.onRemoveMember=function(e){var t=this;if(null!==t._memberAreaView)for(var n=t._info.getChatRoomInfomation(),o=n.getMemberList(),i=o.getCount(),a=e.getCount(),r=n.getProfileMap(),s=0;a>s;s++){var l=e.get(s);r.removeByKey(l);for(var u=0;i>u;u++)if(l==o.get(u)){o.remove(u),t._memberAreaView.onRemoveMember(l);break}}},t.notifyRemoveMember=function(e){var t=this,n=e.getRemovedMemberList();if(null!=n){var o=LoginUser.getInstance().getJid(),i=!1,a=n.getCount();for(_j=0;_j<a;_j++)if(o==n.get(_j)){i=!0;break}if(i){var r=e.getRoomInfo().getRoomId(),s=t._info.getChatRoomInfomation(),l=s.getRoomId(),u=new ChatRoomInformation;u.setRoomName(Resource.getMessage("NotReferableColumnTitle")),l==r&&t._showNotReferableGroupChat()}}},t._showNotReferableGroupChat=function(){var e=this,t=e.getHtmlElement();if(t){var n=e._getMsgObjHash();for(var o in n)n[o].cleanup(),delete n[o];$("div.column-content",t).empty();var i=e.createDivMessageBorder(ColumnSystemMessageView.getNotReferableMessageHtml(Resource.getMessage("not_referable_groupchat")));$("div.column-header div.column-option",t).hide(),$("div.column-content",t).prepend(i)}},t.showChangedAuthorityMessage=function(){var e=this,t=e.getHtmlElement();t&&$("div.column-content",t).prepend(e.createDivMessageBorder(ColumnSystemMessageView.getNotReferableMessageHtml(Resource.getMessage("authchanged_force_reload_groupchat"))))},t.onChangeRoomName=function(t){var n=this,o=n._info.getChatRoomInfomation();o.setRoomName(t.getRoomName()),n._displayName=n._createDisplayName(),n._info.setDisplayName(n._displayName);var i=Utils.avatarCreate({name:t.getRoomName(),type:"group"});e.updateColumnTitle.call(n,i.color),ColumnManager.getInstance().saveColumnList()},t.onChangeGroupChatPrivacyType=function(e){var t=this,n=t._info.getChatRoomInfomation();n.setPrivacyType(e.getPrivacyType())},t.onAddMessageReceive=function(e){var t=this;null!=e&&e.getType()==Message.TYPE_QUESTIONNAIRE&&t.showMessage(e)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnTaskView.cssClass="task-message",ColumnTaskView.UNKNOWN_TASK=0,ColumnTaskView.UNFINISHED_TASK=1,ColumnTaskView.FINISHED_TASK=2,ColumnTaskView.prototype=$.extend({},ColumnView.prototype);var e=ColumnView.prototype,t=ColumnTaskView.prototype;t.createView=function(){var e=this,t=this.getColumnInfo();if(null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var n=e.getType(),o=ViewUtils.createDisplayName(t);t.setDisplayName(o);var i="";i+=ColumnSubmitButtonView.getHtml(n),this.createHtml(i)}},t._createSubForms=function(){var e=this,t=e.getHtmlElement();if(null!=t){t.find("div.frm-message > button").before(ColumnSubmitButtonView.getHtml(ColumnInformation.TYPE_COLUMN_TASK));var n=t.find("div.frm-message > button"),o=n.eq(0),i=n.eq(1);e._buttonList=new ArrayList,e._buttonList.add(new ColumnSubmitButtonView(i,e,Resource.getMessage("task_registerTask_btn"))),e._buttonList.add(new ColumnReloadButtonView(o,e,Resource.getMessage("task_reloadTask_btn")))}},t.getHistoryMessage=function(){function e(e,n){e.getCount()<20&&(t._allMessageReceived=!0),t._onGetTaskHistoryMessage(e,n),$(window).trigger("resize"),t.refreshScrollbar(),t._disableBottomEvent=!1}var t=this,n=t._info,o=new TaskFilterAndSortCondition,i=o.getFilterObject(n.getFilterCondition()),a=o.getSortObject(n.getFilterCondition());
t._disableBottomEvent=!0,CubeeController.getInstance().getTaskMessages(t._currentLoadedItemId,20,i,a,e)},t.cleanup=function(){var t=this;e.cleanup.call(t),t._buttonList&&(t._buttonList.removeAll(),delete t._buttonList)},t.getFinishType=function(e){var t=ColumnTaskView.UNKNOWN_TASK;if(null==e||"number"!=typeof e)return t;switch(e){case TaskMessage.STATUS_INBOX:case TaskMessage.STATUS_ASSIGNING:case TaskMessage.STATUS_NEW:case TaskMessage.STATUS_DOING:case TaskMessage.STATUS_SOLVED:case TaskMessage.STATUS_FEEDBACK:t=ColumnTaskView.UNFINISHED_TASK;break;case TaskMessage.STATUS_FINISHED:case TaskMessage.STATUS_REJECTED:t=ColumnTaskView.FINISHED_TASK}return t},ColumnTaskView.getStatusListHtml=function(e,t){var n="";return""==t||e==t?(n+='<option value="'+TaskMessage.STATUS_NEW+'">'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_NEW)+"</option>",n+='<option value="'+TaskMessage.STATUS_DOING+'">'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_DOING)+"</option>",n+='<option value="'+TaskMessage.STATUS_FINISHED+'">'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_FINISHED)+"</option>",n+='<option value="'+TaskMessage.STATUS_REJECTED+'">'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_REJECTED)+"</option>"):n+='<option value="'+TaskMessage.STATUS_ASSIGNING+'">'+ViewUtils.taskStatusNumToStr(TaskMessage.STATUS_ASSIGNING)+"</option>",n},t.clickSubFormButton=function(){var e=this,t=new TaskMessage,n=new TaskRegister(e,t,TaskRegister.mode_add),o=e.getHtmlElement();if(null!=o){var i=n.getRegisterForm(),a=$("#modal_area");a.html(i);var r=a.children();a.css("display","block"),a.prepend('<div class="overlay modal_exit"></div>'),r.addClass("on").css("display","block").animate({"margin-top":0,opacity:1},200),$(".overlay").animate({opacity:.3},200)}},t._endSubformEditMode=function(){var e=this,t=e.getHtmlElement();if(null!=t){var n=t.find("div.frm-message");e._hideTaskEditView(n),e._showSubForm(n),View.getInstance().resizeContent()}},t._showSubForm=function(e){$(e).css("height",""),$(e).children("button").removeClass("display-none")},t._hideTaskEditView=function(e){$(e).children("div.task-register-area").remove()},t.onTaskRegist=function(e){function t(t){t&&(ViewUtils.modal_allexit(),n.showUpdateMessage(e.getRegistedMessageData()))}var n=this;e.registTask(t)},t.onTaskEditCancel=function(){var e=this;e._endSubformEditMode()},t.clickReloadButton=function(){var t=this,n=t.getHtmlElement();if(null!=n){var o=t.getColumnContent().children("div").not("."+ViewUtils.LOADING_ICON_CLASS_NAME);t._currentLoadedItemId=0;var i=t._getMsgObjHash();for(var a in i)i[a].cleanup(),delete i[a];t._getMsgObjIndexList().removeAll(),t._demandTaskItemIds.removeAll(),o.remove(),t._hideLoadingIconInSelf(),t._allMessageReceived=!1,t._readAllUnfinishedTask=!1,t._unfinishedTaskCount=-1,t.updateColumnTitle(t._unfinishedTaskCount),e._LoadingIcon(t,"div.wrap-frm-message"),t.getHistoryMessage()}},t.onAddMessageReceive=function(e){var t=this;0!=t._validation({object:e})&&t.onAddTaskMessageReceive(e)},t.onUpdateMessageReceive=function(e){var t=this;0!=t._validation({object:e})&&t.onUpdateTaskMessageReceive(e)},t.onAddTaskMessageReceive=function(e){var t=this;if(null!=e){var n=!0;if(e.getType()==Message.TYPE_TASK&&t.isMuchFilterCondition(e)){var o=e.getItemId();if(t.getMsgObjByItemId(o))return;var i=e.getStatus();if(i>TaskMessage.STATUS_UNKNOWN&&i<TaskMessage.STATUS_FINISHED){t._unfinishedTaskCount++;var a=t.getType(),r=t.isAssigningTask(e);a==ColumnInformation.TYPE_COLUMN_TASK&&1==r&&(n=!1,t._unfinishedTaskCount--),t.updateColumnTitle(t._unfinishedTaskCount)}}n&&t.showMessage(e)}},t.onUpdateTaskMessageReceive=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getItemId();if(n){var o=e.getParentItemId();if(null!=o&&""!=o){var i=t.getMsgObjIndexPositionByItemId(o);if(i>-1){var a=CubeeController.getInstance().getMessage(o);null!=a&&(a.setPreStatus(a.getStatus()),a.setPreOwnerJid(a.getOwnerJid()),t.onUpdateTaskMessageReceive(a))}}var r=t.getMsgObjIndexPositionByItemId(n);if(-1==r)return void(1==t.isNeedShowTask(e)&&t.onAddTaskMessageReceive(e));r=t.getMsgObjIndexPositionByItemId(n);var s=t.getHtmlElement();if(null!=s){var l=(s.children("div.column-content"),t.getParentMsgObjByPosition(r)),u=l.getHtmlElement(),c=l.getMessage().getItemId();t.removeMsgObjIndexByItemIdNoCleanupMessage(c);var d=e.getPreStatus(),g=e.getStatus();t._removeTaskMessageElement(u,g),d>TaskMessage.STATUS_UNKNOWN&&d<TaskMessage.STATUS_FINISHED&&t._unfinishedTaskCount>0&&t._unfinishedTaskCount--,g>TaskMessage.STATUS_UNKNOWN&&g<TaskMessage.STATUS_FINISHED&&t._unfinishedTaskCount++,t.updateColumnTitle(t._unfinishedTaskCount),t._showMessageData(e)}}}},t._removeTaskMessageElement=function(e,t){function n(){e.remove()}null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"number"==typeof t&&n()},t.isNeedShowTask=function(e){var t=this,n=t._info,o=n.getFilterCondition(),i=new TaskFilterAndSortCondition,a=i.getFilterObject(o),r=CubeeController.getInstance().getMessage(e.getParentItemId()),s=[];s[0]=e,null!=r&&(s[1]=r);for(var l=s.length,u=0;l>u;u++){var c=!0;for(key in a)if(""!=a[key]){var d=s[u].getPropertyByFilterKey(key);if(""!=d){for(var g=!1,m=a[key].split(TaskFilterAndSortCondition.DELIMITER_STRING),_=m.length,f=0;_>f;f++)if(m[f]==d){g=!0;break}if(!g){c=!1;break}}}if(c)return!0}return!1},t.isMuchFilterCondition=function(e){var t=this,n=t._info,o=n.getFilterCondition(),i=new TaskFilterAndSortCondition,a=i.getFilterObject(o);for(key in a)if(""!=a[key]){for(var r=e.getPropertyByFilterKey(key),s=a[key].split(TaskFilterAndSortCondition.DELIMITER_STRING),l=s.length,u=!1,c=0;l>c;c++)if(s[c]==r){u=!0;break}if(!u)return!1}return!0},t.showChildMessage=function(e){var t=this,n=e.getParentItemId();if(n){var o=t.getMsgObjIndexPositionByItemId(n);if(-1!=o){var i=t.getHtmlElement();if(null!=i){var a=(i.children("div.column-content"),t.getParentMsgObjByPosition(o)),r=a.getHtmlElement();r.remove(),t.removeMsgObjIndexByItemIdNoCleanupMessage(n);var s=CubeeController.getInstance().getMessage(n);t.showMessage(s)}}}},t.showUpdateMessage=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getPreStatus();if(0==t.isMuchFilterCondition(e)){var o=e.getItemId();if(!o)return;_pos=t.getMsgObjIndexPositionByItemId(o);var i=t.getHtmlElement();if(null==i)return;var a=(i.children(".column-content"),t.getParentMsgObjByPosition(_pos)),r=a.getHtmlElement(),s=a.getMessage().getItemId();t.removeMsgObjIndexByItemIdNoCleanupMessage(s),r.remove(),n>TaskMessage.STATUS_UNKNOWN&&n<TaskMessage.STATUS_FINISHED&&(t._unfinishedTaskCount--,t.updateColumnTitle(t._unfinishedTaskCount))}}},t._onGetTaskHistoryMessage=function(e,t){var n=this;if(n._hideLoadingIconInSelf(),e){-1==n._unfinishedTaskCount&&(n._unfinishedTaskCount=t);for(var o=e.getCount(),i=0;o>i;i++){var a=e.get(i);if(null!=a){var r=a.getItemId(),s=n.getType(),l=n.isAssigningTask(a);s==ColumnInformation.TYPE_COLUMN_TASK&&1==l&&n._unfinishedTaskCount>0?n._unfinishedTaskCount--:n.getMsgObjByItemId(r)||(n.showHistoryMessage(a),a.getDemandStatus()==TaskMessage.DEMAND_ON&&n._demandTaskItemIds.add(r,a)),n._currentLoadedItemId=a.getId()}}n._readAll(e),(1==n._readAllUnfinishedTask||1==n._allMessageReceived)&&n.updateColumnTitle(n._unfinishedTaskCount)}},t._readAll=function(e){var t=this,n=t._info,o=new TaskFilterAndSortCondition(n.getFilterCondition()),i=e.getCount(),a=!1;if(0==t._readAllUnfinishedTask){var a=!1;o.getSortKey(0)==TaskFilterAndSortCondition.DB_COLOMN_STATUS||o.getSortKey(0)==TaskFilterAndSortCondition.DB_COLOMN_COMPLETE_DATE+" "+TaskFilterAndSortCondition.SORT_COLUMN_IS_NULL?a=!0:o.getSortKey(0)==TaskFilterAndSortCondition.DB_COLUMN_DEMAND_STATUS&&(o.getSortKey(1)==TaskFilterAndSortCondition.DB_COLOMN_STATUS||o.getSortKey(1)==TaskFilterAndSortCondition.DB_COLOMN_COMPLETE_DATE+" "+TaskFilterAndSortCondition.SORT_COLUMN_IS_NULL?a=!0:o.getSortKey(1)==TaskFilterAndSortCondition.DB_COLUMN_DEMAND_DATE&&(o.getSortKey(2)==TaskFilterAndSortCondition.DB_COLOMN_STATUS||o.getSortKey(2)==TaskFilterAndSortCondition.DB_COLOMN_COMPLETE_DATE+" "+TaskFilterAndSortCondition.SORT_COLUMN_IS_NULL)&&(a=!0)),0==t._allMessageReceived&&a&&null==e.get(i-1).getCompleteDate()&&t._unfinishedTaskCount>0?t._showReadMore(!1):t._readAllUnfinishedTask=!0}},t._showReadMore=function(t){var n=this;0==n._readAllUnfinishedTask?null!=t&&1==t&&e._showReadMore.call(n):e._showReadMore.call(n)},t.updateColumnTitle=function(t){var n=this,o=Resource.getMessage("task_unfinished_number");n.getType()==ColumnInformation.TYPE_COLUMN_INBOX&&(o=Resource.getMessage("inbox_item_number"));var i=0;null!=t&&"number"==typeof t&&(i=t);var a=n._info,r=ViewUtils.createDisplayName(a);a.setDisplayName(r),e.updateColumnTitle.call(n)},t.isAssigningTask=function(e){var t=!1,n=e.getParentItemId(),o=e.getStatus();return o==TaskMessage.STATUS_ASSIGNING&&""!=n&&(t=!0),t},t.deleteMessage=function(t){var n=this;if(e.deleteMessageBase.call(n,t)){var o=CubeeController.getInstance().getMessage(t),i=o.getStatus();i>TaskMessage.STATUS_INBOX&&i<TaskMessage.STATUS_FINISHED&&n._unfinishedTaskCount>0&&(n._unfinishedTaskCount--,n.updateColumnTitle(n._unfinishedTaskCount))}},t.createMessageObjectOnly=function(e){var t=this;if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getType(),o=null;switch(n){case Message.TYPE_TASK:var i=e.getCommunityId();o=null==i||""==i?new ColumnTaskMessageView(t,e):new ColumnCommunityTaskMessageView(t,e);break;default:console.log("ColumnTaskView::createMessageObjectOnly _ invalid type:"+n)}return o}},t.showMessage=function(e){var t=this;if(0==t._validation({object:e}))return!1;if(0==t.isMuchFilterCondition(e))return t.showChildMessage(e),!0;var n=e.getParentItemId();return null!=n&&""!=n&&t.showChildMessage(e),t._showMessageData(e),!0},t.getColumnMessageHtml=function(e){var t="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?t=e.getMessageHtml():t},t.setContentLayout=function(){var e=this,t=e.getHtmlElement();if(null!=t){var n=$(t).outerHeight(!0),o=$(t).children("div.column-header").outerHeight(!0),i=$(t).children("div.wrap-frm-message").css("height",""),a=$(i).hasClass("display-none")?0:$(i).outerHeight(!0),r=$(i).find("div.frm-message > div.task-register-area"),s=$(r).children("div.task-register-scroll-area").css("height",""),l=$(t).children("div.column-content");if(LayoutManager.isDesktop||n>=o+a)$(l).css("height",n-(o+a)+"px");else{$(l).css("height","0px");var u=n-o,c=$(r).children("div.task-register-header").outerHeight(!0),d=$(r).children("div.register-task-buttons").outerHeight(!0);$(s).css("height",u-(c+d)+"px"),$(i).css("height",u+"px")}}},t._createDisplayName=function(e){var t=e.getColumnType();switch(t){case ColumnInformation.TYPE_COLUMN_TASK:return ColumnView.DISPLAY_NAME_MY_TASK;case ColumnInformation.TYPE_COLUMN_INBOX:return ColumnView.DISPLAY_NAME_INBOX;default:return""}},t.onMessageOptionReceive=function(t){var n=this;if(0==n._validation({object:t}))return void e.onMessageOptionReceive.call(n,t);if(null==t.getType)return void e.onMessageOptionReceive.call(n,t);var o=t.getType();if(o!=Notification_model.TYPE_MESSAGE_OPTION)return void e.onMessageOptionReceive.call(n,t);var i=t.getContentType();if(i!=MessageOptionNotification.CONTENT_TYPE_DEMAND_TASK)return void e.onMessageOptionReceive.call(n,t);n._updateChildrenMessageOnDemand(t);var a=t.getItemId(),r=n.getMsgObjByItemId(a);if(null!=r){var s=r.getMessage(),l=t.getDemandStatus();l==TaskMessage.DEMAND_ON?n._demandTaskItemIds.add(a,s):l==TaskMessage.DEMAND_OFF&&n._demandTaskItemIds.removeByKey(a),n._updateMessageOnDemand(a,l)}},t.getDemandTaskCount=function(){var e=this;return e._demandTaskItemIds.getCount()},t._updateMessageOnDemand=function(e,t){var n=this,o=n.getMsgObjByItemId(e);if(null!=o){var i=o.getMessage(),a=!1;if(t==TaskMessage.DEMAND_ON){var r=n._info,s=new TaskFilterAndSortCondition(r.getFilterCondition());s.getSortKey(0)==TaskFilterAndSortCondition.DB_COLUMN_DEMAND_STATUS&&s.getSortOrderValue(0)==TaskFilterAndSortCondition.SORT_ORDER_DES&&s.getSortKey(1)==TaskFilterAndSortCondition.DB_COLUMN_DEMAND_DATE&&s.getSortOrderValue(1)==TaskFilterAndSortCondition.SORT_ORDER_ASC&&(a=!0)}var l=n.getMsgObjIndexPositionByItemId(e);null!=o&&o.getHtmlElement().remove(),n.removeMsgObjIndexByItemIdNoCleanupMessage(e);var u=l;if(a){for(var c=n._getMsgObjIndexList(),d=c.getCount(),g=!1,m=0;d>m;m++){var _=c.get(m),f=_.getMsgObj(),p=f.getMessage();if(p.getDemandStatus()==TaskMessage.DEMAND_OFF){g=!0,u=m;break}}g||(u=d)}n._insertMessage(i,u)}},t._updateChildrenMessageOnDemand=function(e){var t=this,n=e.getItemId(),o=CubeeController.getInstance().getMessage(n);if(null==o)return!1;var i=o.getParentItemId(),a=t.getMsgObjByItemId(i);return null==a?!1:(a.onMessageOptionReceive(e),!0)},t._updateActionToolTipToMessageElem=function(e,t){var n=e.getHtmlElement(),o=n.children().children("div.message-header").eq(0);TooltipView.getInstance().updateActionToolTip(o,t)},t._setOptionMenu=function(e){var t=this,n=TaskColumnOptionMenu.getHtml(t._info),o=e.append(n);t._columnOptionMenu=new TaskColumnOptionMenu(o,t._info,t)},t._getFrmMessageHeight=function(e){var t="",n=$(e).get(0),o=parseInt($(n).css("height")),i=$(e).find("div.task-register-area").get(0),a=$(i).outerHeight(!0);if(a>o){var r=parseInt(e.css("borderTopWidth"))+parseInt(e.css("borderBottomWidth")),s=parseInt(e.css("paddingTop"))+parseInt(e.css("paddingBottom"));t=a+r+s}return t}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnInboxView.cssClass="inbox-border-message",ColumnInboxView.prototype=$.extend({},ColumnTaskView.prototype);var e=ColumnTaskView.prototype,t=ColumnInboxView.prototype;t._createSubForms=function(){var e=this,t=e.getHtmlElement();if(null!=t){var n=t.find("div.frm-message > textarea");e._textarea=new ColumnTextAreaView(n,e,Resource.getMessage("inbox_placeholder"));var o=t.find("div.frm-message > button");e._button=new ColumnSubmitButtonView(o,e,Resource.getMessage("inbox_submit")),ViewUtils.setCharCounter(n,t.find("."+ViewUtils.CHAR_COUNTER_CLASSNAME),ColumnView.TEXTAREA_MAX_LENGTH);var i=t.find("div.frm-message > .file-inputs");e._fileUpload=new ColumnFileUploadPartsView(i,this);var a=t.find("div.frm-message").find(".submit-message-progress");e._progressBar=new ProgressBarView(a,!1)}},t.getHistoryMessage=function(){function e(e){var n=e.messageDataList,i=e.allItemCount;n.getCount()<o&&(t._allMessageReceived=!0),t._onGetInboxHistoryMessage(n,i),$(window).trigger("resize"),t.refreshScrollbar()}var t=this,n=t._info,o=20;CubeeController.getInstance().searchMessage(t._currentLoadedItemId,o,n.getSearchCondition(),e)},t.clickSubFormButton=function(){function e(e){function o(e){console.log("add inbox : "+e)}var i=new TaskMessage;if(i.setMessage(e),i.setStatus(TaskMessage.STATUS_INBOX),i.setOwnerJid(n),i.setClient(n),1!=CubeeController.getInstance().addTask(i,o))throw console.log("faild to add inbox"),"faild to send Inbox Message:";t._textarea.clearText(),t._textarea.getHtmlElement().focus(),void 0!=t._fileUpload&&null!=t._fileUpload&&t._fileUpload.clearFileUpload()}var t=this,n=LoginUser.getInstance().getJid(),o=t._textarea.getText(),i=t._uploadFileAndSendMessage(o,e);t._textarea.clearTextFromFlag(i)},t.createMessageObjectOnly=function(e){var t=this;if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getType(),o=null;switch(n){case Message.TYPE_TASK:o=new ColumnInboxMessageView(t,e);break;default:console.log("ColumnInboxView::createMessageObjectOnly _ invalid type:"+n)}return o}},t.getColumnMessageHtml=function(e){var t="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?t=e.getMessageHtml():t},t._onGetInboxHistoryMessage=function(e,t){var n=this;if(n._hideLoadingIconInSelf(),e){(null==n._unfinishedTaskCount||-1==n._unfinishedTaskCount)&&(n._unfinishedTaskCount=t);for(var o=e.getCount(),i=0;o>i;i++){var a=e.get(i);if(null!=a){var r=a.getItemId();n.getMsgObjByItemId(r)||n.showHistoryMessage(a),a.getDemandStatus()==TaskMessage.DEMAND_ON&&n._demandTaskItemIds.add(r,a)}}n._readAll(e),1==n._allMessageReceived&&n.updateColumnTitle(n._unfinishedTaskCount)}},t._readAll=function(e){var t=this;0==t._allMessageReceived&&t._showReadMore(!0)},t.deleteMessage=function(t){var n=this;e.deleteMessageBase.call(n,t)&&n._unfinishedTaskCount>0&&(n._unfinishedTaskCount--,n.updateColumnTitle(n._unfinishedTaskCount))},t._updateMessageOnDemand=function(e,t){var n=this,o=n.getMsgObjByItemId(e);if(null!=o){var i=o.getMessage(),a=!1;if(t==TaskMessage.DEMAND_ON){var r=n._info,s=r.getSearchCondition(),l=s.getSortCondition(),u=l.getItems(),c=l.getOrders();u.get(0)==TaskFilterAndSortCondition.DB_COLUMN_DEMAND_STATUS&&c.get(0)==ColumnSortCondition.SORT_ORDER_DESC&&u.get(1)==TaskFilterAndSortCondition.DB_COLUMN_DEMAND_DATE&&c.get(1)==ColumnSortCondition.SORT_ORDER_ASC&&(a=!0)}var d=n.getMsgObjIndexPositionByItemId(e),g=o.getHtmlElement();g.remove(),n.removeMsgObjIndexByItemIdNoCleanupMessage(e);var m=d;if(a){for(var _=n._getMsgObjIndexList(),f=_.getCount(),p=!1,h=0;f>h;h++){var C=_.get(h),v=C.getMsgObj(),y=v.getMessage();if(y.getDemandStatus()==TaskMessage.DEMAND_OFF){p=!0,m=h;break}}p||(m=f)}n._insertMessage(i,m)}},t._setOptionMenu=function(e){var t=this,n=ColumnOptionMenu.getHtml(t._info),o=TooltipView.getInstance().createColumnOptionMenuTooltip(e,n);t._columnOptionMenu=new ColumnOptionMenu(o,t._info,t)},t.onUpdateTaskMessageReceive=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getItemId();if(n){var o=e.getParentItemId();if(null!=o&&""!=o){var i=t.getMsgObjIndexPositionByItemId(o);if(i>-1){var a=CubeeController.getInstance().getMessage(o);null!=a&&(a.setPreStatus(a.getStatus()),a.setPreOwnerJid(a.getOwnerJid()),t.onUpdateTaskMessageReceive(a))}}var r=t.getMsgObjIndexPositionByItemId(n);if(-1==r)return void(1==t.isNeedShowTask(e)&&t.onAddTaskMessageReceive(e));r=t.getMsgObjIndexPositionByItemId(n);var s=t.getHtmlElement();if(null!=s){var l=(s.children("div.column-content"),t.getParentMsgObjByPosition(r)),u=l.getHtmlElement(),c=l.getMessage().getItemId();t.removeMsgObjIndexByItemId(c);var d=e.getPreStatus(),g=e.getStatus();if(t._removeTaskMessageElement(u,g),0==t.isNeedShowTask(e))return void(d>TaskMessage.STATUS_UNKNOWN&&d<TaskMessage.STATUS_FINISHED&&t._unfinishedTaskCount>0&&(t._unfinishedTaskCount--,t.updateColumnTitle(t._unfinishedTaskCount)));d>TaskMessage.STATUS_UNKNOWN&&d<TaskMessage.STATUS_FINISHED&&t._unfinishedTaskCount>0&&t._unfinishedTaskCount--,t.updateColumnTitle(t._unfinishedTaskCount),t.onAddTaskMessageReceive(e)}}}},t._showReadMore=function(){var t=this;e._showReadMore.call(t,!0)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t){var n="";if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return n;var o=e.getType();switch(o){case Message.TYPE_PUBLIC:n=ColumnTimelineView.cssClassTimeline;break;case Message.TYPE_CHAT:n=ColumnChatView.cssClass;break;case Message.TYPE_TASK:n=t?ColumnInboxView.cssClass:ColumnTaskView.cssClass+" "+ColumnTaskMessageView.getTaskMessageCLSName(e);break;case Message.TYPE_GROUP_CHAT:n=ColumnGroupChatView.cssClassGroupChat;break;case Message.TYPE_MAIL:n=ColumnMailView.cssClass;break;case Message.TYPE_COMMUNITY:n=ColumnCommunityFeedView.cssClassCommunityFeed;break;case Message.TYPE_MURMUR:n=ColumnMurmurView.cssClassMurmur}return n}ColumnFilterView.prototype=$.extend({},ColumnView.prototype);var t=ColumnView.prototype,n=ColumnFilterView.prototype;n._setOptionMenu=function(e){var t=this,n=FilterColumnOptionMenu.getHtml(t._info),o=TooltipView.getInstance().createColumnOptionMenuTooltip(e,n);t._columnOptionMenu=new FilterColumnOptionMenu(o,t._info,t)},n._createSubForms=function(){var e=this,t=e.getHtmlElement();if(null!=t){var n=t.find('div.frm-message > input[type="text"]');e._textarea=new ColumnTextAreaView(n,e,"");var o=t.find("div.frm-message > button");e._button=new ColumnSubmitButtonView(o,e,Resource.getMessage("column_btn_search"))}},n.getHistoryMessage=function(){function e(e){t._hideLoadingIconInSelf(),t._resultAllCount=e.allItemCount;var n=e.messageDataList;n.getCount()<o&&(t._allMessageReceived=!0);for(var i=n.getCount(),a=0;i>a;a++){var r=n.get(a);if(null!=r){var s=r.getItemId();t.getMsgObjByItemId(s)||t.showHistoryMessage(r)}}t._getNotAvailableMessageHtmlIfMessageNothing(t._getMsgObjIndexList().getCount()),$(window).trigger("resize"),t.refreshScrollbar(),t._disableBottomEvent=!1}var t=this,n=t._info,o=20;t._disableBottomEvent=!0,CubeeController.getInstance().searchMessage(t._currentLoadedItemId,o,n.getSearchCondition(),e)},n._getNotAvailableMessageHtmlIfMessageNothing=function(e){var t=this;if(t._deleteNotAvailableMessageHtml(),t._allMessageReceived&&0>=e){var n=t.getHtmlElement();if(null==n)return!1;var o=t.getColumnContent();if(_tailOfElm=o.children("div.column-search-message-none"),_tailOfElm.hasClass("column-search-message-none"))return!1;var i='<div class="column-search-message-none">'+Resource.getMessage("search_result_message_none")+"</div>";o.prepend(i)}},n._deleteNotAvailableMessageHtml=function(){var e=this,t=e.getHtmlElement();if(null==t)return!1;var n=e.getColumnContent();_tailOfElm=n.children("div.column-search-message-none"),0<_tailOfElm.length&&_tailOfElm.remove()},n.clickSubFormButton=function(){var e=this,n=Utils.trimStringMulutiByteSpace(e._htmlElement.find("div.frm-message").children("input").val()),o=e._isValidateOk(n);if(o){var i=e._getKeywordFilterCondition(n),a=e._createSearchCondition(i),r=e._info;r.setSearchCondition(a);var s=e.getHtmlElement();if(null!=s){var l=s.find("div.column-content .message-border"),u=e._getMsgObjHash();for(var c in u)delete u[c];e._getMsgObjIndexList().removeAll(),l.remove(),e._hideLoadingIconInSelf(),e._allMessageReceived=!1,e._currentLoadedItemId=0,r.setKeyword(n);var d=e._createDisplayName(r);r.setDisplayName(d),e.updateColumnTitle(),ColumnManager.getInstance().saveColumnList(),t._LoadingIcon(e,"div.wrap-frm-message"),e.getHistoryMessage()}}},n._isValidateOk=function(e){var t=this,n=t._htmlElement.find("div.frm-message").children("input");n.removeClass("input-error");var o=e;if(null==o||"string"!=typeof o||""==o||""==Utils.trimStringMulutiByteSpace(o))return!1;var i=ViewUtils.getKeywordListFromKeywordInputString(o);if(null==i)return!1;var a=i.getCount();if(1>a)return!1;for(var r=0;a>r;r++){var s=i.get(r),l=encodeURIComponent(s);if(l.length<=1)return n.addClass("input-error"),!1}return!0},n.createMessageObjectOnly=function(e){var t=this;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return null;var n=(e.getType(),ViewUtils.createMessageObject(t,e));return n},n.getColumnMessageHtml=function(e){var t=this,n="",o=t._info,i=o.getSourceColumnType(),a=null;if(i==ColumnInformation.TYPE_COLUMN_FILTER&&(a=o.getBeginningColumnType()),i==ColumnInformation.TYPE_COLUMN_SEARCH||i==ColumnInformation.TYPE_COLUMN_RECENT||i==ColumnInformation.TYPE_COLUMN_TOME||a==ColumnInformation.TYPE_COLUMN_TOME){var r=e.getMessage(),s=e.getItemId(),l=ColumnSearchView.getBorderHeaderHtml(r);n+='<div draggable="false" class="box-border olient-vertical search-message width-100" style="border-left: 0;"',n+=' itemId="'+s+'">',n+=l,n+='<div class="box-border olient-vertical message-info search-message-info">',n+=t.getColumnMessageHtmlInner(e),n+="</div>",n+='<div class="message-footer search-message-footer"></div>',n+="</div> <!-- .search-message -->"}else n+=t.getColumnMessageHtmlInner(e);return""!==n&&t._deleteNotAvailableMessageHtml(),n},n.getColumnMessageHtmlInner=function(e){var t="",n=e.getMessage(),o=this.isInbox(n);return t+=this.getFilterMessageHeaderHtml(n,o),o?t+=e.getHtml():(t+=e.getMessageHeaderHtml(),t+=e.getMessageBodyHtml(),t+=e.getMessageFooterHtml()),t+=this.getFilterMessageFooterHtml(n)},n._getKeywordFilterCondition=function(e){var t=Utils.trimStringMulutiByteSpace(e),n=ViewUtils.getKeywordFilterFromKeywordInputString(t);return n},n._createSearchCondition=function(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this,n=(t._info,new ColumnSortCondition),o=t._createFilterCondition(e),i=new ColumnSearchCondition(o,n);return i}},n._createFilterCondition=function(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this,n=t._info,o=n.getSourceColumnType(),i=n.getSubData(),a=ColumnFilterManager.getColumnFilter(o,i),r=new AndCondition;return r.addChildCondition(a),r.addChildCondition(e),r}},n.showHistoryMessage=function(e){var n=this;t.showHistoryMessage.call(n,e)},n.onUpdateMessageReceive=function(e){var t=this;t.onAddMessageReceive(e)},n.onAddMessageReceive=function(e){var t=this;setTimeout(function(){t.showMessage(e)},1e3)},n.showNewMatchUpdateMessage=function(e){var t=this;if(0==t._validation({object:e}))return!1;var n=e.getItemId(),o=t.getMsgObjByItemId(n);if(null!=o){var i=t.getMessageHtmlElement(o);i.remove(),t.removeMsgObjIndexByItemIdNoCleanupMessage(n)}if(!t._info.getSearchCondition().isMatch(e))return!1;for(var a=null,r=0,s=Date.parse(e.getDate()),l=0;l<t._msgObjIndexList._length;l++){var u=t._msgObjIndexList.get(l).getMsgObj().getMessage(),c=Date.parse(u.getDate());if(!c||!s)return!1;var d=new Date(s),g=new Date(c);if(!(d.getTime()<g.getTime())){r=l,a=u.getItemId();break}}var m=!1;if(!a){if(0==t._msgObjIndexList._length)return t.showMessage(e),!0;if(!t._allMessageReceived)return!1;r=-1,a=t._getMsgObjIndexList().get(t._getMsgObjIndexList()._length-1).getMsgObj().getItemId(),m=!0}var _=t.getMsgObjByItemId(a).getHtmlElement();if(0==_.length)return!1;var f=t.createMessageObjectOnly(e);if(null==f)return!1;if(_content=t.getColumnMessageHtml(f),""==_content)return!1;_content=t.createDivMessageBorder(_content),t._setMessageObject(f,_content,r);var p=_content.children();new MessageColumnLink($(p),e),t._deleteNotAvailableMessageHtml(),m?_.after(_content):_.before(_content);var h=t._getToolTipBaseElement(_content);return t._setToolTipToMessageElem(h,e,f),f.onAddMessageReferCount(),!0},n.showMessage=function(e){var t=this;if(0==t._validation({object:e}))return!1;var n,o,i=e.getType();if(i==Message.TYPE_TASK){var a=function(){return e.getCommunityId()&&e.getCommunityId().length>0};if(e.getOwnerJid()!=LoginUser.getInstance().getJid()&&!a())return!1;t.showChildMessage(e)}var r=e.getItemId(),s=t.getMsgObjByItemId(r);if(null!=s){var l=t.getMessageHtmlElement(s);l.remove(),t.removeMsgObjIndexByItemIdNoCleanupMessage(r)}if(!t._info.getSearchCondition().isMatch(e))return!1;var u=t.getHtmlElement();if(null==u)return!1;var c=t.getColumnContent(),d=t.createMessageObjectOnly(e);if(null==d)return!1;if(n=t.getColumnMessageHtml(d),""==n)return!1;n=t.createDivMessageBorder(n),t._setMessageObject(d,n,0);var g=n.children();new MessageColumnLink($(g),e),t._deleteNotAvailableMessageHtml(),c.prepend(n),o=t._getMessageElement(0);var m=t._getToolTipBaseElement(o);return t._setToolTipToMessageElem(m,e,d),d.onAddMessageReferCount(),1==e.getBodyType()&&ViewUtils.showStampMessage(g,t),t.afterCreateMessageHtml(g),!0},n._addClassInnerMessage=function(e){return e},n.getMessageHtmlElement=function(e){return null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?e.getHtmlElement():void 0},n.showChildMessage=function(e){var t=this,n=e.getParentItemId();if(n){var o=t.getMsgObjIndexPositionByItemId(n);if(-1!=o){var i=t.getHtmlElement();if(null!=i){var a=(i.children(".column-content"),t.getParentMsgObjByPosition(o)),r=t.getMessageHtmlElement(a);r.remove(),t.removeMsgObjIndexByItemIdNoCleanupMessage(n);var s=CubeeController.getInstance().getMessage(n);t.showMessage(s)}}}},n.isInbox=function(e){if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return"";var t=!1,n=!1,o=e.getType();if(o!=Message.TYPE_TASK)return t;var i=e.getStatus();return n=ColumnTaskView.prototype.isAssigningTask(e),(i==TaskMessage.STATUS_INBOX||1==n)&&(t=!0),t},n.getFilterMessageHeaderHtml=function(t,n){var o="",i=t.getItemId(),a=t.getType();switch(a){case Message.TYPE_PUBLIC:case Message.TYPE_CHAT:case Message.TYPE_GROUP_CHAT:case Message.TYPE_MAIL:case Message.TYPE_COMMUNITY:case Message.TYPE_MURMUR:o+="<div",o+=' class="box-border olient-vertical '+e(t,n)+'"',o+=' itemId="'+i+'"',o+=' href="'+ColumnView.READ_MESSAGE_CONTROL_HREF_HEDER_STRING+i+'">';break;case Message.TYPE_TASK:o+='<div class="box-border olient-vertical '+e(t,n)+'"',o+=' itemId="'+i+'">'}return o},n.getFilterMessageFooterHtml=function(e){var t="",n=(e.getItemId(),e.getType());switch(n){case Message.TYPE_PUBLIC:case Message.TYPE_CHAT:case Message.TYPE_GROUP_CHAT:case Message.TYPE_MAIL:case Message.TYPE_COMMUNITY:case Message.TYPE_MURMUR:t+=ViewUtils.isIE89()?"</div> <!-- .filter-message -->":"</a> <!-- .filter-message -->";break;case Message.TYPE_TASK:t+="</div> <!-- .filter-message -->"}return t},n._createDisplayName=function(e){var t=e.getColumnType();switch(t){case ColumnInformation.TYPE_COLUMN_FILTER:return e.getSourceColumnDisplayName()+" / "+e.getKeyword();case ColumnInformation.TYPE_COLUMN_SEARCH:return ColumnView.DISPLAY_NAME_SEARCH+" / "+e.getKeyword();case ColumnInformation.TYPE_COLUMN_RECENT:return ColumnView.DISPLAY_NAME_RECENT}},n.showUpdateMessage=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getItemId();if(n){_pos=t.getMsgObjIndexPositionByItemId(n);var o=t.getHtmlElement();if(null!=o){var i=(o.children(".column-content"),t.getParentMsgObjByPosition(_pos)),a=t.getMessageHtmlElement(i),r=i.getMessage().getItemId();t.removeMsgObjIndexByItemId(r),a.remove()}}}},n.onMessageOptionReceive=function(e){var n=this;if(0==n._validation({object:e}))return void t.onMessageOptionReceive.call(n,e);if(null==e.getType)return void t.onMessageOptionReceive.call(n,e);var o=e.getType();if(o!=Notification_model.TYPE_MESSAGE_OPTION)return void t.onMessageOptionReceive.call(n,e);var i=e.getContentType();if(i!=MessageOptionNotification.CONTENT_TYPE_DEMAND_TASK)return void t.onMessageOptionReceive.call(n,e);var a=e.getItemId(),r=n.getMsgObjByItemId(a);if(null!=r)return void t.onMessageOptionReceive.call(n,e);var s=CubeeController.getInstance().getMessage(a);if(null!=s&&s.getType()==Message.TYPE_TASK){var l=s.getParentItemId(),r=n.getMsgObjByItemId(l);null!=r&&r.onMessageOptionReceive(e)}},n._updateActionToolTipToMessageElem=function(e,t){var n=e.getHtmlElement();if(n){var o=n.children().children("div.message-info").children("div.task-message").children("div.message-header").eq(0);TooltipView.getInstance().updateActionToolTip(o,t)}},n._updateColumnTitle=function(){var e=this,t=e._info,n=t.getSourceColumnType(),o=t.getSourceColumnDisplayName();null==o&&(o="");var i=ViewUtils.getSubDataInColumnInfo(n,t.getSubData());ViewUtils.createDisplayNameWithSubData(n,i,o,function(n){null!=n&&""!=n&&"string"==typeof n&&t.setSourceColumnDisplayName(n);var o=e._createDisplayName(t);t.setDisplayName(o),e.updateColumnTitle(),ColumnManager.getInstance().saveColumnList()})}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnCustomFilterView.prototype=$.extend({},ColumnFilterView.prototype);var e=ColumnFilterView.prototype,t=ColumnCustomFilterView.prototype;t._createSubForms=function(){var e=this,t=e.getHtmlElement();if(null!=t){var n=t.find('div.frm-message > input[type="text"]');e._textarea=new ColumnTextAreaView(n,e,""),t.find("div.frm-message > button").before(ColumnSubmitButtonView.getHtml(ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER));var o=t.find("div.frm-message > button"),i=o.eq(0),a=o.eq(1);e._reloadButton=new ColumnReloadButtonView(i,e,Resource.getMessage("task_reloadTask_btn")),
e._button=new ColumnSubmitButtonView(a,e,Resource.getMessage("column_btn_filter"))}},t.clickSubFormButton=function(){var e=this,t=e._info,n=null;switch(t.getSourceColumnType()){case ColumnInformation.TYPE_COLUMN_TASK:case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:var o=Resource.getMessage("task_refilter_dialog_title");n=new DialogSettingFilterMyTaskView(o,e._info,e._ownerObj,e);break;case ColumnInformation.TYPE_COLUMN_INBOX:var o=Resource.getMessage("column_option_custom_filter");n=new DialogSettingCustomFilterInboxView(o,e._info,e._ownerObj,e);break;case ColumnInformation.TYPE_COLUMN_FILTER:var o=Resource.getMessage("column_option_custom_filter");t.getBeginningColumnType()==ColumnInformation.TYPE_COLUMN_TASK||t.getBeginningColumnType()==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK?(o=Resource.getMessage("task_refilter_dialog_title"),n=new DialogSettingFilterMyTaskView(o,e._info,e._ownerObj,e)):n=t.getBeginningColumnType()==ColumnInformation.TYPE_COLUMN_INBOX?new DialogSettingCustomFilterInboxView(o,e._info,e._ownerObj,e):new DialogSettingCustomFilterView(o,e._info,e._ownerObj,e);break;default:var o=Resource.getMessage("column_option_custom_filter");n=new DialogSettingCustomFilterView(o,e._info,e._ownerObj,e)}null!=n&&n.showDialog()},t.searchAgain=function(t){var n=this,o=n._info;o.setSearchCondition(t.getSearchCondition()),o.setSetting(t.getSetting());var i=n.getHtmlElement();if(null!=i){var a=i.find("div.column-content .message-border"),r=n._getMsgObjHash();for(var s in r)r[s].cleanup(),delete r[s];n._getMsgObjIndexList().removeAll(),a.remove(),n._hideLoadingIconInSelf(),n._allMessageReceived=!1,n._currentLoadedItemId=0,ColumnManager.getInstance().saveColumnList(),e._LoadingIcon(n,"div.wrap-frm-message"),n.getHistoryMessage()}},t._createDisplayName=function(e){var t=e.getColumnType();switch(t){case ColumnInformation.TYPE_COLUMN_FILTER:return e.getSourceColumnDisplayName()+" / "+e.getKeyword();case ColumnInformation.TYPE_COLUMN_SEARCH:return ColumnView.DISPLAY_NAME_SEARCH+" / "+e.getKeyword();case ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER:return e.getSourceColumnDisplayName()+" / "+Resource.getMessage("task_filter");default:return""}},t.clickReloadButton=function(){var e=this,t=e._info;e.searchAgain(t)},t.onUpdateMessageReceive=function(e){var t=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getItemId();if(n){var o=e.getType();if(o==Message.TYPE_TASK){var i=e.getParentItemId();if(t.getMsgObjByItemId(i)){var a=CubeeController.getInstance().getMessage(i);t.onUpdateMessageReceive(a)}}var r=t.getMsgObjByItemId(n);if(null==r)return void(t._info.getSearchCondition().isMatch(e)&&t._showMessageData(e));var s=t.getMessageHtmlElement(r);s.remove(),t.removeMsgObjIndexByItemId(n),t._showMessageData(e)}}},t._getToolTipBaseElement=function(t){var n=this,o=n._info,i=o.getSourceColumnType();return i==ColumnInformation.TYPE_COLUMN_SEARCH||i==ColumnInformation.TYPE_COLUMN_RECENT?t.children().children().children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(0):e._getToolTipBaseElement.call(n,t)},t._setOptionMenu=function(e){var t=this,n=CustomFilterColumnOptionMenu.getHtml(t._info),o=TooltipView.getInstance().createColumnOptionMenuTooltip(e,n);t._columnOptionMenu=new CustomFilterColumnOptionMenu(o,t._info,t)},t.cleanup=function(){var t=this;null!=t._reloadButton&&(t._reloadButton.cleanup(),delete t._reloadButton),e.cleanup.call(t)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){var t=String(parseInt(e.substring(1,3),16)),n=String(parseInt(e.substring(3,5),16)),o=String(parseInt(e.substring(5,7),16));return"background-color:rgba("+t+","+n+","+o+",0.05)"}ColumnSearchView.prototype=$.extend({},ColumnFilterView.prototype);var t=ColumnFilterView.prototype,n=ColumnSearchView.prototype;n.getColumnMessageHtml=function(n){var o,i,a=this,r="",s=n.getMessage(),l=n.getItemId(),u=s.getType();u==Message.TYPE_CHAT?(o=s.getTo(),i=s.getFrom()):u==Message.TYPE_MURMUR&&(o=s.getTo());var c=ColumnSearchView.getBorderHeaderHtml(s);if(u==Message.TYPE_MURMUR){var d=s._profileMap._array[0]._nickName,g=Utils.avatarCreate({name:d,type:"user"});r+='<div draggable="false" class="box-border olient-vertical search-message width-100" style="border-left: 0;'+e(g.color)+';"'}else r+='<div draggable="false" class="box-border olient-vertical search-message width-100" style="border-left: 0;"';return r+=' itemId="'+l+'"',r+=' msgtype="'+u+'"',null!=o&&(r+=' msgto="'+o+'"'),null!=i&&(r+=' msgfrom="'+i+'"'),r+=">",r+=c,r+='<div class="box-border olient-vertical message-info search-message-info">',r+=t.getColumnMessageHtml.call(a,n),r+="</div>",r+='<div class="message-footer search-message-footer"></div>',r+="</div> <!-- .search-message -->"},n._createFilterCondition=function(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this,n=t._info,o=n.getSourceColumnTypeList(),i=o.getCount(),a=null;if(i>0){var r=t._createSorceColumnFilterCondition(o);a=new AndCondition,a.addChildCondition(r),a.addChildCondition(e)}else a=e;return a}},n._createSorceColumnFilterCondition=function(e){var t=this,n=null,o=TabManager.getInstance().getCurrentTabInfo(),i=o.type;switch(i){case TabItemView.TYPE_MY_WORK_PLACE:n=ColumnFilterManager.getColumnFilterList(e);break;case TabItemView.TYPE_COMMUNITY:n=t._createSorceColumnFilterConditionForCommunity(e)}return n},n._createSorceColumnFilterConditionForCommunity=function(e){var t=this,n=t._info,o=n.getSubData(),i=ColumnFilterManager.getColumnFilterForCommunity(e,o);return i},ColumnSearchView.getBorderHeaderHtml=function(e){function n(e){var t=String(parseInt(e.substring(1,3),16)),n=String(parseInt(e.substring(3,5),16)),o=String(parseInt(e.substring(5,7),16));return"background-color:rgba("+t+","+n+","+o+",0.05)"}var o="",i=e.getType();if(e.getType()==Message.TYPE_QUESTIONNAIRE){if(!parseInt(e.getRoomType()))return o;i=parseInt(e.getRoomType())}var a="",r="message-border-header-";switch(i){case Message.TYPE_PUBLIC:a=ColumnView.DISPLAY_NAME_TIMELINE,r+='myfeed" style="border-left-color:#26a9d1;'+n("#26a9d1")+';"';break;case Message.TYPE_CHAT:var s=e.getFrom();s==LoginUser.getInstance().getJid()&&(s=e.getTo());var l="",u=e.getProfileMap();if(u&&"object"==("undefined"==typeof u?"undefined":_typeof(u))){var c=u.getByKey(s);c&&"object"==("undefined"==typeof c?"undefined":_typeof(c))&&(l=c.getNickName())}a=l;var d=Utils.avatarCreate({name:l,type:"user"});r+='chat" style="border-left-color:'+d.color+";"+n(d.color)+';"';break;case Message.TYPE_TASK:var g=t.isInbox(e),m=e.getCommunityName();if(g)a=ColumnView.DISPLAY_NAME_INBOX,r+='inbox" style="border-left-color:#32bea6;'+n("#32bea6")+';"';else if(null!=m&&""!=m){a=ColumnView.DISPLAY_NAME_COMMUNITY_TASK+"("+m+")";var _=SelectAndAddProjectView.getInstance()._communityList._array.filter(function(e){return e._roomName===m})[0],f=_&&_._memberEntryType?"#"+_._memberEntryType:"#0000FF";r+='community-task" style="border-left-color:'+f+";"+n(f)+';"'}else a=ColumnView.DISPLAY_NAME_MY_TASK,r+='task" style="border-left-color:#fabc3d;'+n("#fabc3d")+';"';break;case Message.TYPE_GROUP_CHAT:var p=e.getRoomName();a=p;var d=Utils.avatarCreate({name:p,type:"group"});r+='groupchat" style="border-left-color:'+d.color+";"+n(d.color)+';"';break;case Message.TYPE_MAIL:a=ColumnView.DISPLAY_NAME_MAIL,r+='mail" style="border-left-color:#000000;"';break;case Message.TYPE_COMMUNITY:var p=e.getRoomName();a=p;var _=SelectAndAddProjectView.getInstance()._communityList._array.filter(function(e){return e._roomName===p})[0],f=_&&_._memberEntryType?"#"+_._memberEntryType:"#0000FF";r+='community-feed" style="border-left-color:'+f+";"+n(f)+';"';break;case Message.TYPE_MURMUR:var s=e.getTo(),l="",u=e.getProfileMap();if(u&&"object"==("undefined"==typeof u?"undefined":_typeof(u))){var c=u.getByKey(s);c&&"object"==("undefined"==typeof c?"undefined":_typeof(c))&&(l=c.getNickName())}var h=e.getColumnName();if(("string"!=typeof h||0==h.length)&&(h=ColumnView.DISPLAY_NAME_MURMUR),null==l||""==l)null!=s&&CubeeController.getInstance().getPersonDataByJidFromServer(s,function(t){var o=t.getByKey(s),i=o.getUserName();$("#columnInnerContainer div div > div[itemid="+e.getItemId()+"][msgtype=11][msgto="+s+"] > div.message-header").text(h);var a=Utils.avatarCreate({name:i,type:"user"});$("#columnInnerContainer div div > div[itemid="+e.getItemId()+"][msgtype=11][msgto="+s+"] > div.message-header").attr("style","border-left-color:"+a.color+";"+n(a.color)+";")}),a=h,r+='murmur"';else{a=h;var d=Utils.avatarCreate({name:l,type:"user"});r+='murmur" style="border-left-color:'+d.color+";"+n(d.color)+';"'}}return o+='<div class="box-border-for-abbreviation text-overflow-ellipsis olient-horizontal message-header '+r+">"+Utils.convertEscapedHtml(a)+"</div>"},n.showUpdateMessage=function(e){var n=this;t.showUpdateMessage.call(n,e)},n._getToolTipBaseElement=function(e){return e.children().children().children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(0)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnTimelineView.cssClassTimeline="timeline-message",ViewUtils.isIE89()?ColumnTimelineView.cssClassThread="thread-message thread-message-ie89":ColumnTimelineView.cssClassThread="thread-message",ColumnTimelineView.prototype=$.extend({},ColumnView.prototype);var e;ColumnView.prototype;ColumnTimelineView.getInstance=function(){return e?e:null},ColumnTimelineView.setInstance=function(t){e=t};var t=ColumnTimelineView.prototype;t.createMessageObjectOnly=function(e){var t=this;if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getType(),o=null;switch(n){case Message.TYPE_PUBLIC:o=new ColumnPublicMessageView(t,e);break;case Message.TYPE_SYSTEM:o=new ColumnSystemMessageView(t,e);break;case Message.TYPE_QUESTIONNAIRE:o=new ColumnQuestionnaireMessageView(t,e);break;default:console.log("ColumnTimelineView::createMessageObjectOnly _ invalid type:"+n)}return o}},t.getHistoryMessage=function(){function e(e,a){t(e),i++,a&&n.onReceiveFinishedPublicMessage(o,i)}function t(e){n._hideLoadingIconInSelf(),n.showHistoryMessage(e)}var n=this,o=(n._info,20),i=0;CubeeController.getInstance().getPublicMessages(n._currentLoadedItemId,o,e)},t.getColumnMessageHtml=function(e,t){var o="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?(null==t&&(t=!1),o=e.getMessageHtml(t,n)):o},t.clickSubFormButton=function(){var e=this;e.sendPublicMessage()},t.sendPublicMessage=function(){function e(){o._textarea.clearText(),o._textTitleArea.clearText(),void 0!=o._fileUpload&&null!=o._fileUpload&&o._fileUpload.clearFileUpload(),o.getHtmlElement().find(".attach-note-element p").attr("value")&&(o.getHtmlElement().find(".attach-note-element p").remove(),o.getHtmlElement().find(".attach-note-element .note_cancel_btn").remove()),o.getHtmlElement().find(".message-attachment-area").is(":visible")&&o.getHtmlElement().find(".message-attachment-area").slideToggle(200,function(){$(window).trigger("resize")})}function t(t){var n=o.getHtmlElement().find(".attach-note-element p").attr("value");if(n){if(!t.content||!t.content.result){var i=Resource.getMessage("dialog_title_system_info"),a=Resource.getMessage("dialog_error_send_message"),r=new DialogCloseView(i,a);return void r.showDialog()}if(t.content.items&&t.content.items.length)var s=function(){if(CubeeController.getInstance()._messageManager.getAllMessage().getByItemId(l.itemId))clearInterval(d),CodiMdController.getInstance().assignNoteOnThreadRootId(l.itemId,n).then(function(t){e()})["catch"](function(e){var t=Resource.getMessage("dialog_title_system_info"),n=Resource.getMessage("dialog_error_assign_note_after_try"),o=new DialogCloseView(t,n);o.showDialog()});else if(g+=1,u*g>c){clearInterval(d);var t=Resource.getMessage("dialog_title_system_info"),o=Resource.getMessage("dialog_error_assign_note_after_try"),i=new DialogCloseView(t,o);i.showDialog()}},l=t.content.items[0],u=200,c=1e4,d=setInterval(s,u),g=0}else e()}function n(e){if(0==CubeeController.getInstance().sendPublicMessage(e,"",i,t)){var n=Resource.getMessage("dialog_title_system_info"),o=Resource.getMessage("dialog_error_send_message"),a=new DialogCloseView(n,o);a.showDialog()}}var o=this,i=o._textTitleArea.getText().trim(),a=o._textarea.getText(),r=o._uploadFileAndSendMessage(a,n,i);o._textarea.clearTextFromFlag(r)},t.onSystemMessageReceive=function(e){var t=this;null!=e&&e.getType()==Message.TYPE_SYSTEM&&t.showMessage(e)},t.onAddMessageReceive=function(e){var t=this;null!=e&&e.getType()==Message.TYPE_QUESTIONNAIRE&&t.showMessage(e)},t.notifyDisconnect=function(){var e=this,t=e.getHtmlElement();t&&$("div.column-content",t).prepend(e.createDivMessageBorder(ColumnSystemMessageView.getOfflineMessageHtml()))},t._showMessageData=function(e){var t=this;return t._showMessageDataWithThread(e)},t.showHistoryMessage=function(e){var t=this;t._showHistoryMessageWithThread(e)},t._createDisplayName=function(){var e="";e=ColumnView.DISPLAY_NAME_TIMELINE;var t=this.getColumnInfo().getFilterCondition();return null!=t&&""!=t&&(e+="("+t+")"),e};var n="";t._hasRightToSendMessage=function(e){var t="",o=AuthorityInfo.getInstance();t=o.checkRights(AuthorityDef.AUTHORITY_ACTIONS.FEED_SEND),e.setRightToSendMessage(t),t=o.checkRights(AuthorityDef.AUTHORITY_ACTIONS.FEED_VIEW),e.setRightToViewMessage(t),n=e.getRightToViewMessage()},t.onReceiveFinishedPublicMessage=function(e,t){var n=this;e>t&&(n._allMessageReceived=!0),n.refreshScrollbar()},$(document).on("click","."+ColumnView.TOGGLE_REPLY_CLS_NAME,function(){for(var e="div",t=$(this).parent().children(e+".thread-message"),n=($(this).parent().children(e+".thread-message").length-ColumnView.RECENT_REPLY_SHOW_COUNT,$(this).parent().children(e+".thread-message").length-1),o=n-ColumnView.RECENT_REPLY_SHOW_COUNT,i=0;o>=i;i++)t.eq(i).toggle();$(this).parent().children(".comment_wrapper").eq(0).toggle();var a=$(this).parent().children(e+".thread-message:visible").length;if(a>ColumnView.RECENT_REPLY_SHOW_COUNT)$(this).text(Resource.getMessage("hidden_past_reply_txt"));else{var r=t.length,s=Utils.stringFormat(Resource.getMessage("show_past_reply_txt"),r);$(this).text(s)}})}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnMailView.cssClass="mail-message",ColumnMailView.prototype=$.extend({},ColumnView.prototype);var e=ColumnView.prototype,t=ColumnMailView.prototype;t.getHistoryMessage=function(){function e(e){t._resultAllCount=e.allItemCount;var n=e.messageDataList;n.getCount()<o&&(t._allMessageReceived=!0),t._onGetHistoryMessage(n)}var t=this,n=t._info,o=20;CubeeController.getInstance().searchMessage(t._currentLoadedItemId,o,n.getSearchCondition(),e)},t._onGetHistoryMessage=function(t){var n=this;n._hideLoadingIconInSelf();for(var o=t.getCount(),i=0;o>i;i++){var a=t.get(i);if(null!=a){var r=a.getItemId();n.getMsgObjByItemId(r)||e.showHistoryMessage.call(n,a)}}n._readMoreHistoryMessageIfNoScrollBar()},t.onAddMessageReceive=function(e){var t=this,n=t._info.getSearchCondition();if(n.isMatch(e)){var o=e.getItemId();t.getMsgObjByItemId(o)||t.showMessage(e)}},t.createMessageObjectOnly=function(e){var t=this;if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getType(),o=null;switch(n){case Message.TYPE_MAIL:o=new ColumnMailMessageView(t,e);break;default:console.log("ColumnMailView::createMessageObjectOnly _ invalid type:"+n)}return o}},t.getColumnMessageHtml=function(e){var t="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?t=e.getMessageHtml():ret},t._createDisplayName=function(){var e=ColumnView.DISPLAY_NAME_MAIL;return e}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnMentionView.prototype=$.extend({},ColumnFilterView.prototype);var e=(ColumnFilterView.prototype,ColumnMentionView.prototype);e._setOptionMenu=function(e){var t=this,n=ColumnOptionMenu.getHtml(t._info),o=TooltipView.getInstance().createColumnOptionMenuTooltip(e,n);t._columnOptionMenu=new ColumnOptionMenu(o,t._info,t)},e._createSubForms=ColumnTimelineView.prototype._createSubForms,e.clickSubFormButton=ColumnTimelineView.prototype.clickSubFormButton,e.sendPublicMessage=ColumnTimelineView.prototype.sendPublicMessage,e.createMessageObjectOnly=function(e){var t=this;if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=null;return n=new ColumnPublicMessageView(t,e)}},e.getColumnMessageHtml=ColumnTimelineView.prototype.getColumnMessageHtml,e._createDisplayName=function(){var e=ColumnView.DISPLAY_NAME_MENTION;return e}}(),function(){ColumnToMeView.prototype=$.extend({},ColumnSearchView.prototype);var e=(ColumnSearchView.prototype,ColumnToMeView.prototype);e._createDisplayName=function(){var e=ColumnView.DISPLAY_NAME_TOME;return e},e._setOptionMenu=function(e){var t=this,n=ToMeColumnOptionMenu.getHtml(t._info),o=TooltipView.getInstance().createColumnOptionMenuTooltip(e,n);t._columnOptionMenu=new ToMeColumnOptionMenu(o,t._info,t)}}(),function(){function e(e,t){var n={attached_file:!1,having_url:!1,sender:"",term:0,unread:!1,tome:!1,search:encodeURIComponent(t)};return e.find("#quick-filter-tome").prop("checked")&&(n.tome=!0),e.find("#quick-filter-read").prop("checked")&&(n.unread=!0),e.find("#quick-filter-file").prop("checked")&&(n.attached_file=!0),n}ColumnRecentView.prototype=$.extend({},ColumnSearchView.prototype);var t=ColumnSearchView.prototype,n=ColumnRecentView.prototype;n._initColumnSearchCondition=function(){var e=LoginUser.getInstance().getExtras();if(e&&"recentFilter"in e){var t=e.recentFilter,n=t.search?Utils.urldecode(t.search):"",o=this.getColumnSearchCondition(t,n);this._info.setSearchCondition(o)}},n._createDisplayName=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=ColumnView.DISPLAY_NAME_RECENT+" /";return e&&(n+=" "+e+","),t.tome&&(n+=" "+Resource.getMessage("ToMe")+","),t.unread&&(n+=" "+Resource.getMessage("custom_filter_label_unread_message")+","),t.attached_file&&(n+=" "+Resource.getMessage("custom_filter_label_having_attached_file")),(","==n.slice(-1)||"/"==n.slice(-1))&&(n=n.slice(0,-1)),n},n._setOptionMenu=function(e){var t=this,n=RecentColumnOptionMenu.getHtml(t._info),o=TooltipView.getInstance().createColumnOptionMenuTooltip(e,n);t._columnOptionMenu=new RecentColumnOptionMenu(o,t._info,t)},n._setRecentColumnEvent=function(){var e=this,t=e.getHtmlElement();t.on("change","#quick-filter-tome,#quick-filter-read,#quick-filter-file",function(t){e.clickSubFormButton()}),t.on("click","button.all_read",function(){var t=new DialogReadInBulkCheckView(e._info,e.getHtmlElement());t.showDialog()}),t.find(".column-recent-frm-message .message-input-area").keypress(function(t){13==t.which&&e.clickSubFormButton()}),t.on("click","#quickfilter_btn",function(){e.clickSubFormButton()})},n.clickSubFormButton=function(){var n=this,o=n.getHtmlElement();if(null!=o){var i=o.find("div.column-content .message-border"),a=n._getMsgObjHash();for(var r in a)delete a[r];n._getMsgObjIndexList().removeAll(),i.remove(),n._hideLoadingIconInSelf(),n._allMessageReceived=!1,n._currentLoadedItemId=0;var s=Utils.trimStringMulutiByteSpace(n._htmlElement.find("div.frm-message").children("input").val()),l=n._isValidateOk(s);if(l||""==s){var u=e(o,s),c=n.getColumnSearchCondition(u,s),d=n._info;d.setSearchCondition(c),d.setKeyword(s);var g=n._createDisplayName(s,u);d.setDisplayName(g),n.updateColumnTitle(),t._LoadingIcon(n,"div.wrap-frm-message"),o.find(".column-recent-frm-message").find(":input").attr("disabled",!0),n.getHistoryMessage();var m=LoginUser.getInstance().getExtras(),_={};_.Logged=m.Logged,_.recentFilter=u,CubeeServerConnector.getInstance().setLoginUserExtras(_).then(function(e){var t=e.content.extras;if(t)try{t=JSON.parse(t),LoginUser.getInstance().setExtras(t)}catch(n){t={}}})}}},n.getHistoryMessage=function(){function e(e){t._hideLoadingIconInSelf(),t._resultAllCount=e.allItemCount;var n=e.messageDataList;n.getCount()<o&&(t._allMessageReceived=!0);for(var i=n.getCount(),a=0;i>a;a++){var r=n.get(a);if(null!=r){var s=r.getItemId();t.getMsgObjByItemId(s)||t.showHistoryMessage(r)}}t._getNotAvailableMessageHtmlIfMessageNothing(t._getMsgObjIndexList().getCount()),$(window).trigger("resize"),t.refreshScrollbar(),t.getHtmlElement().find(".column-recent-frm-message").find(":input").attr("disabled",!1),t._disableBottomEvent=!1}var t=this,n=t._info,o=20;t._disableBottomEvent=!0,CubeeController.getInstance().searchMessage(t._currentLoadedItemId,o,n.getSearchCondition(),e)},n.getColumnSearchCondition=function(e,t){var n=this,o=null;""!=t&&(o=n._getKeywordFilterCondition(t));var i=ColumnFilterManager.getColumnFilter(ColumnInformation.TYPE_COLUMN_RECENT);e.tome&&(i=ColumnFilterManager.getColumnFilter(ColumnInformation.TYPE_COLUMN_TOME));var a=CustomFilterSetting.createSettingFilterCondition(e);null!=a||null!=o?(_columnFilter=new AndCondition,_columnFilter.addChildCondition(i),null!=a&&_columnFilter.addChildCondition(a),null!=o&&_columnFilter.addChildCondition(o)):_columnFilter=i;var r=new ColumnSortCondition,s=new ColumnSearchCondition(_columnFilter,r);return s},n._createSubForms=function(){var e=this,t=e.getHtmlElement();if(null!=t){var n=t.find('div.frm-message > input[type="text"]');e._textarea=new ColumnTextAreaView(n,e,Resource.getMessage("dialog_context_search_title"));var o=t.find("div.frm-message > button");o.attr({name:"search","data-toggle":"tooltip","data-placement":"bottom",id:"quickfilter_btn","data-original-title":"",title:""}),o.append('<i class="fa fa-search"></i>');var i="<pre></pre>";t.find(".column-recent-frm-message").prepend(i);var a='<div class="quick_filter_buttons">            <label class="modal_btn unread_filter right_button">                <div class="quickfileter_toggles" title="'+Resource.getMessage("RecentQuickFilterOnlyToMe")+'">                    <span>'+Resource.getMessage("RecentQuickFilterOnlyToMe")+'</span>                </div>                <div class="quickfileter_toggles_check">                    <div class="onoffswitch">                      <input id="quick-filter-tome" name="quick-filter-tome" type="checkbox" class="onoffswitch-checkbox">                      <label class="onoffswitch-label" for="quick-filter-tome"></label>                    </div>                </div>            </label>            <label class="modal_btn unread_filter left_button">                <div class="quickfileter_toggles" title="'+Resource.getMessage("RecentQuickFilterUnread")+'">                    <span>'+Resource.getMessage("RecentQuickFilterUnread")+'</span>                </div>                <div class="quickfileter_toggles_check">                    <div class="onoffswitch">                      <input id="quick-filter-read" name="quick-filter-read" type="checkbox" class="onoffswitch-checkbox">                      <label class="onoffswitch-label" for="quick-filter-read"></label>                    </div>                </div>            </label>            <label class="modal_btn unread_filter right_button">                <div class="quickfileter_toggles" title="'+Resource.getMessage("RecentQuickFilterFile")+'">                    <span>'+Resource.getMessage("RecentQuickFilterFile")+'</span>                </div>                <div class="quickfileter_toggles_check">                    <div class="onoffswitch">                      <input id="quick-filter-file" name="quick-filter-file" type="checkbox" class="onoffswitch-checkbox">                      <label class="onoffswitch-label" for="quick-filter-file"></label>                    </div>                </div>            </label>            <button class="all_read" type="button" title="" data-original-title="'+Resource.getMessage("RecentQuickFilterAllRead")+'" data-toggle="tooltip" data-placement="bottom">'+Resource.getMessage("RecentQuickFilterAllRead")+"</button>        </div>";t.find(".column-recent-frm-message").append(a);var r=LoginUser.getInstance().getExtras();if(r&&"recentFilter"in r){var s=r.recentFilter,l=s.search?Utils.urldecode(s.search):"";l&&t.find('div.frm-message > input[type="text"]').val(l),s.tome&&(t.find("#quick-filter-tome").prop("checked",!0),t.find("#quick-filter-tome").closest(".unread_filter").find(".quickfileter_toggles").addClass("filter-enable")),s.unread&&(t.find("#quick-filter-read").prop("checked",!0),t.find("#quick-filter-read").closest(".unread_filter").find(".quickfileter_toggles").addClass("filter-enable")),s.attached_file&&(t.find("#quick-filter-file").prop("checked",!0),t.find("#quick-filter-file").closest(".unread_filter").find(".quickfileter_toggles").addClass("filter-enable"));var u=e._info;u.setKeyword(l);var c=e._createDisplayName(l,s);u.setDisplayName(c),e.updateColumnTitle()}}}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnCommunityFeedView.cssClassCommunityFeed="community-feed-message",ViewUtils.isIE89()?ColumnCommunityFeedView.cssClassThread="thread-message thread-message-ie89":ColumnCommunityFeedView.cssClassThread="thread-message",ColumnCommunityFeedView.prototype=$.extend({},ColumnView.prototype);var e=ColumnView.prototype,t=ColumnCommunityFeedView.prototype;t.cleanup=function(){var t=this;e.cleanup.call(t)},t._showTitleAndSetColor=function(){function t(t){if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return void n._showNotReferableCommunity();n._displayName=n._createDisplayName(),n._info.setDisplayName(n._displayName);var i=o.getLogoUrl();n._info.setIconImage(i),e.updateColumnTitle.call(n,"#"+t.getMemberEntryType())}var n=this,o=n._info.getCommunityInfomation(),i=o.getRoomId();n._requestCommunityInfo(i,t)},t._showNotReferableCommunity=function(){var e=this,t=e.getHtmlElement();t&&$("div.column-content",t).prepend(e.createDivMessageBorder(ColumnSystemMessageView.getNotReferableMessageHtml(Resource.getMessage("not_referable_community"))))},t.showChangedAuthorityMessage=function(){var e=this,t=e.getHtmlElement();t&&$("div.column-content",t).prepend(e.createDivMessageBorder(ColumnSystemMessageView.getNotReferableMessageHtml(Resource.getMessage("authchanged_force_reload_community"))))},t._hasRightMessage=function(e){var t=e.getCommunityInfomation().getRoomId(),n=AuthorityInfo.getInstance();switch(n.getWhichRightToCommunityResource(t)){case AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_MANAGE:case AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_SEND:e.setRightToSendMessage(!0),e.setRightToViewMessage(!0);break;case AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_VIEW:e.setRightToSendMessage(!1),e.setRightToViewMessage(!0);break;default:e.setRightToSendMessage(!1),e.setRightToViewMessage(!1)}},t._requestCommunityInfo=function(e,t){function n(e){null!=e&&o._updateCommunityInfo(e),t(e)}var o=this;return null==e||"string"!=typeof e?null:void CubeeController.getInstance().getCommunityInfo(e,n)},t.onCommunityInfoUpdateNotication=function(t){var n=this,o=t.getUpdatedCommunityInfo(),i=o.getRoomId(),a=n._info.getCommunityInfomation(),r=a.getRoomId();if(r==i){n._updateCommunityInfo(o),n._displayName=n._createDisplayName(),n._info.setDisplayName(n._displayName);var s=o.getLogoUrl();n._info.setIconImage(s),e.updateColumnTitle.call(n)}},t._updateCommunityInfo=function(e){var t=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?null:void t._info.setCommunityInfomation(e)},t.resizeColumn=function(){var e=this,t=e._htmlElement.outerHeight(!0),n=parseInt(e._htmlElement.css("marginTop"))+parseInt(e._htmlElement.css("marginBottom")),o=parseInt(e._htmlElement.css("borderTopWidth"))+parseInt(e._htmlElement.css("borderBottomWidth")),i=parseInt(e._htmlElement.css("paddingTop"))+parseInt(e._htmlElement.css("paddingBottom")),a=e._htmlElement.find(".column-header").outerHeight(!0),r=e._htmlElement.find(".wrap-frm-message").outerHeight(!0),s=t-a-r,l=s-n-o-i;e._htmlElement.find(".column-content").css("height",l)},t._setOptionMenu=function(e){var t=this,n=t._tabType,o=CommunityFeedColumnOptionMenu.getHtml(t._info,n),i=TooltipView.getInstance().createColumnOptionMenuTooltip(e,o);t._columnOptionMenu=new CommunityFeedColumnOptionMenu(i,t._info,t,n)},t.getHistoryMessage=function(){function e(e){if(t._hideLoadingIconInSelf(),e){var n=e.messageDataList;if(n){var o=n.getCount();i>o&&(t._allMessageReceived=!0),t.onGetHistoryMessage(n),t._updateColumnTitleAndColumnIcon(a.getRoomId()),t.refreshScrollbar()}}}var t=this,n=t._info,o=n.getSearchCondition(),i=20,a=t._info.getCommunityInfomation();CubeeController.getInstance().searchMessage(t._currentLoadedItemId,i,o,e)},t.onGetHistoryMessage=function(e){var t=this;if(e)for(var n=e.getCount(),o=0;n>o;o++){var i=e.get(o);if(null!=i){var a=i.getItemId();t.getMsgObjByItemId(a)||t.showHistoryMessage(i)}}},t.createMessageObjectOnly=function(e){var t=this;if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getType(),o=null;switch(n){case Message.TYPE_COMMUNITY:o=new ColumnCommunityMessageView(t,e);break;case Message.TYPE_QUESTIONNAIRE:o=new ColumnQuestionnaireMessageView(t,e);break;default:console.log("ColumnGroupChatView::createMessageObjectOnly _ invalid type:"+n)}return o}},t.getColumnMessageHtml=function(e,t){var n="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?(null==t&&(t=!1),n=e.getMessageHtml(t)):n},t._createDisplayName=function(){var e=this,t=e._info.getCommunityInfomation(),n="";if(null!=t){var n=t.getRoomName();null==n&&(n="")}var o=ViewUtils.createDisplayName(e._info);return TabManager.getInstance().isActiveMyWorkplace()&&""!=n&&(o=n),o},t.showHistoryMessage=function(e){var t=this;t._showHistoryMessageWithThread(e)},t.clickSubFormButton=function(){var e=this;e.sendCommunityMessage()},t.sendCommunityMessage=function(){function e(){n._textarea.clearText(),n._textTitleArea.clearText(),void 0!=n._fileUpload&&null!=n._fileUpload&&n._fileUpload.clearFileUpload(),n.getHtmlElement().find(".attach-note-element p").attr("value")&&(n.getHtmlElement().find(".attach-note-element p").remove(),n.getHtmlElement().find(".attach-note-element .note_cancel_btn").remove()),n.getHtmlElement().find(".message-attachment-area").is(":visible")&&n.getHtmlElement().find(".message-attachment-area").slideToggle(200,function(){$(window).trigger("resize")})}function t(t){function i(t){if(null==t){console.log("faild to save Community Message:");var o=Resource.getMessage("dialog_title_system_info"),i=Resource.getMessage("dialog_error_send_message"),a=new DialogCloseView(o,i);return void a.showDialog()}var r=n.getHtmlElement().find(".attach-note-element p").attr("value");if(r)var s=function(){if(CubeeController.getInstance()._messageManager.getAllMessage().getByItemId(t.getItemId()))clearInterval(c),CodiMdController.getInstance().assignNoteOnThreadRootId(t.getItemId(),r).then(function(t){e()})["catch"](function(e){var t=Resource.getMessage("dialog_title_system_info"),n=Resource.getMessage("dialog_error_assign_note_after_try"),o=new DialogCloseView(t,n);o.showDialog()});else if(d+=1,l*d>u){clearInterval(c);var n=Resource.getMessage("dialog_title_system_info"),o=Resource.getMessage("dialog_error_assign_note_after_try"),i=new DialogCloseView(n,o);i.showDialog()}},l=200,u=1e4,c=setInterval(s,l),d=0;else e()}var a=new CommunityMessage;a.setFrom(LoginUser.getInstance().getJid());var r=n._info.getCommunityInfomation(),s=r.getRoomId();
if(a.setTo(s),a.setMessage(t),a.setDirection(ChatMessage.DIRECTION_SEND),a.setThreadTitle(o),0==CubeeController.getInstance().sendCommunityMessage(a,i)){console.log("faild to send Community Message:");var l=Resource.getMessage("dialog_title_system_info"),u=Resource.getMessage("dialog_error_send_message"),c=new DialogCloseView(l,u);return void c.showDialog()}}var n=this,o=n._textTitleArea.getText().trim(),i=n._textarea.getText(),a=n._uploadFileAndSendMessage(i,t,o);n._textarea.clearTextFromFlag(a)},t._showMessageData=function(e){var t=this;return t._showMessageDataWithThread(e)},t.notifyDisconnect=function(){var e=this,t=e.getHtmlElement();t&&$("div.column-content",t).prepend(e.createDivMessageBorder(ColumnSystemMessageView.getOfflineMessageHtml()))},t.notifyRemoveMember=function(e){var t=this,n=e.getRoomId(),o=t._info.getCommunityInfomation(),i=o.getRoomId();i==n&&t._showNotReferableCommunity()},t._updateColumnTitleAndColumnIcon=function(e){function t(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=e.getLogoUrl();n._info.setIconImage(t),ColumnManager.getInstance().updateColumnIcon(n),$(window).trigger("resize")}}var n=this;CubeeController.getInstance().getCommunityInfo(e,t)},t.onAddMessageReceive=function(e){var t=this;null!=e&&e.getType()==Message.TYPE_QUESTIONNAIRE&&t.showMessage(e)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnCommunityTaskView.prototype=$.extend({},ColumnTaskView.prototype);var e=(ColumnTaskView.prototype,ColumnCommunityTaskView.prototype);e._showTitle=function(){function e(e){t.updateColumnTitle(t._unfinishedTaskCount,"#"+e.getMemberEntryType())}var t=this,n=t._info.getCommunityInfomation(),o=n.getRoomId();t._requestCommunityInfo(o,e)},e._requestCommunityInfo=function(e,t){function n(e){null!=e&&o._updateCommunityInfo(e),t(e)}var o=this;return null==e||"string"!=typeof e?null:void CubeeController.getInstance().getCommunityInfo(e,n)},e.onCommunityInfoUpdateNotication=function(e){var t=this,n=e.getUpdatedCommunityInfo(),o=n.getRoomId(),i=t._info.getCommunityInfomation(),a=i.getRoomId();a==o&&(t._updateCommunityInfo(n),t.updateColumnTitle(t._unfinishedTaskCount))},e._updateCommunityInfo=function(e){var t=this;return null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))?null:void t._info.setCommunityInfomation(e)},e._setOptionMenu=function(e){var t=this,n=t._tabType,o=CommunityTaskColumnOptionMenu.getHtml(t._info,n),i=TooltipView.getInstance().createColumnOptionMenuTooltip(e,o);t._columnOptionMenu=new CommunityTaskColumnOptionMenu(i,t._info,t,n)},e.getHistoryMessage=function(){function e(e){var n=e.messageDataList,i=e.allItemCount;n.getCount()<o&&(t._allMessageReceived=!0),t._onGetTaskHistoryMessage(n,i),$(window).trigger("resize"),t.refreshScrollbar()}var t=this,n=t._info,o=(n.getSearchCondition(),20);CubeeController.getInstance().searchMessage(t._currentLoadedItemId,o,n.getSearchCondition(),e)},e.clickSubFormButton=function(){function e(e){if(null!=e){t._info.setCommunityInfomation(e);var n=e.getRoomName(),o=new TaskMessage;o.setCommunityId(i),o.setCommunityName(n);var a=new TaskRegister(t,o,TaskRegister.mode_add),r=t.getHtmlElement();if(null!=r){var s=a.getRegisterForm(),l=$("#modal_area");l.html(s);var u=l.children();l.css("display","block"),l.prepend('<div class="overlay modal_exit"></div>'),u.addClass("on").css("display","block").animate({"margin-top":0,opacity:1},200),$(".overlay").animate({opacity:.3},200)}}}var t=this,n=t._info,o=n.getCommunityInfomation(),i=o.getRoomId();CubeeController.getInstance().getCommunityInfo(i,e)},e.isMuchFilterCondition=function(e){var t=this,n=t._info,o=n.getSearchCondition();return o.isMatch(e)},e._createDisplayName=function(){var e=this,t=e._info.getCommunityInfomation(),n="";if(null!=t)var n=t.getRoomName();var o=ViewUtils.createDisplayName(e._info)+(""==n?"":"("+n+")");return o},e.updateColumnTitle=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this,o=(Resource.getMessage("task_unfinished_number"),0);null!=e&&"number"==typeof e&&(o=e);var i=n._info,a=n._createDisplayName();this._tabType==TabItemView.TYPE_COMMUNITY&&(this._displayName=Resource.getMessage("ContextSearchCommunityTask"),a=this._displayName),i.setDisplayName(a),ColumnView.prototype.updateColumnTitle.call(n,t)},e._setToolTipToMessageElem=function(e,t,n){var o=this,i=o.getActionToolTipType(t),a=o.getBottomToolTipType(t),r=e.children("div.message-info").eq(0),s=e.find("div.block-avatar").eq(0);if(i!=TooltipView.TYPE_UNKNOWN){var l=function(a){var r=LoginUser.getInstance().getJid(),s=!1,l=!1;if(s=a.hasOwner(r),l=n.hasTaskClient(r),s||l){var u=null;e=o._appendShowActionToolTipElement(e,t);var c=e.find(".showActionTooltip").eq(0);u=ViewUtils.isIE89()||t.getType()==Message.TYPE_TASK?e.children("div.message-header").eq(0):e.find("td.actionToolTipBase").eq(0),TooltipView.getInstance().setActionToolTip(i,u,c)}},u=o._info.getCommunityInfomation(),c=o._info,u=c.getCommunityInfomation(),d=u.getRoomId();CubeeController.getInstance().getCommunityMemberInfo(d,l)}n.setMessageInnerActionToolTip(),a!=TooltipView.TYPE_UNKNOWN&&TooltipView.getInstance().setActionToolTip(a,r),TooltipView.getInstance().setAvatarToolTip(TooltipView.TYPE_USER_AVATAR,s,!0)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnShowConversationView.prototype=$.extend({},ColumnView.prototype);var e=ColumnView.prototype,t=ColumnShowConversationView.prototype;t.makeIndentThreadData=function(e){function t(e){for(var t=[],o=0;o<e.length;o++){var i=e[o],a=i.getType();if(a==Message.TYPE_PUBLIC||a==Message.TYPE_GROUP_CHAT||a==Message.TYPE_COMMUNITY||a==Message.TYPE_CHAT||a==Message.TYPE_MURMUR){var r=i.getItemId(),s=i.getReplyItemId();if(s){if(!n._msgNestHash[s])throw Error("notFoundParentMessage");var l=n._msgNestHash[s].depth;t.push({id:r,data:i,nest:l+1}),n._msgNestHash[r]={depth:l+1,lastChild:""}}else t.splice(0,0,{id:r,data:i,nest:0}),n._msgNestHash[r]={depth:0,lastChild:""}}}return t}var n=this;e.sort(function(e,t){var n=new Date(e.getDate()).getTime(),o=new Date(t.getDate()).getTime();return n-o});var o=t(e);return o},t.getHistoryMessage=function(){function e(e){function n(){if(t.getHtmlElement().find('[itemid="'+t.getColumnInfo().getItemId()+'"]').offset()){var e=t.getHtmlElement().find('[itemid="'+t.getColumnInfo().getItemId()+'"]').offset().top,n=t.getHtmlElement().find(".scroll_content").offset().top,o=t.getHtmlElement().find(".scroll_content").height()/2,i=t.getHtmlElement().find('[itemid="'+t.getColumnInfo().getItemId()+'"]').height()/2,a=e-n-o+i;t.getHtmlElement().find(".scroll_content").animate({scrollTop:a},function(){var e=500;t.getHtmlElement().find('[itemid="'+t.getColumnInfo().getItemId()+'"]').fadeOut(e).fadeIn(e).fadeOut(e).fadeIn(e)}),t.getHtmlElement().find(".message-border").children('[itemid="'+t.getColumnInfo().getItemId()+'"]').addClass("target-show-conversation")}}t._hideLoadingIconInSelf(),t._parentItemId=e.get(0).getItemId();var o=function(e){for(var n=[],o=e.getCount(),i=0;o>i;i++)n.push(e.get(i));return t.makeIndentThreadData(n)},i=void 0,a="";try{i=o(e),a=t.makeIndentThreadData(t._waitMsgList)}catch(r){return t.displayErrorMessage(r),void $(window).trigger("resize")}for(var s=0;s<i.length;s++){var l=i[s],u=l.data.getType();(u==Message.TYPE_PUBLIC||u==Message.TYPE_GROUP_CHAT||u==Message.TYPE_COMMUNITY||u==Message.TYPE_CHAT||u==Message.TYPE_MURMUR)&&(t._itemIdList.push(l.data.getItemId()),t.showHistoryMessage(l.data,l.nest))}for(var c=0;c<a.length;c++){var d=a[c],g=d.data.getType();if(g==Message.TYPE_PUBLIC||g==Message.TYPE_GROUP_CHAT||g==Message.TYPE_COMMUNITY||g==Message.TYPE_CHAT||g==Message.TYPE_MURMUR){var m=d.data.getItemId();if(t.getMsgObjByItemId(m))continue;t._itemIdList.push(d.data.getItemId()),t.showHistoryMessage(d.data,d.nest)}}if(t._threadRootMessage=i[0].data,t._threadRootMessage.getThreadTitle()){var _=t.getHtmlElement(),f=$(ColumnSearchView.getBorderHeaderHtml(t._threadRootMessage)),p=[],h=t._threadRootMessage.getThreadTitle(),C=h;C=ViewUtils.replaceTenantBaseTitleCategory(C,h,p,{"class":"in-conversation-colum"}),C=ViewUtils.replaceOrignalTitleCategory(C,h,p,{"class":"in-conversation-colum"});for(var v=p.sort(function(e,t){return e.index-t.index}),y="",T=0;T<v.length;T++)y+=v[T].data;f.html(""+y+'<span style="font-weight:700;">'+Utils.convertEscapedHtml(C)+"</span>"),f.attr("title",t._threadRootMessage.getThreadTitle()),t._titleElement=f,_.find("div.box-border.ui-widget-content.wrap-frm-message").append(f),_.find(".message-title").remove()}t._allMessageReceived=!0,$(window).trigger("resize"),t.refreshScrollbar(),ColumnManager.getInstance().bringColumnIntoView(ColumnManager.getInstance()._getColumnIndex(t.getColumnInfo()),n)}var t=this;CubeeController.getInstance().getThreadMessage(t._parentItemId,e)},t.getMaxNestSize=function(){var e=this,t=0;for(var n in e._msgNestHash)t=e._msgNestHash[n].depth>t?e._msgNestHash[n].depth:t;return t},t.getMaxColumnSize=function(){return this.windowSize-this.sidebarSize},t.setConversationColumnSize=function(e){var t=this;min_width=t.columnMinSize,e+t.messageBodyMinSize>min_width&&(min_width=e+t.messageBodyMinSize);var n=t.getMaxColumnSize(),o=$(".column-show-conversation-wrapper");min_width>=n?o.css("min-width",n+"px"):o.width()<min_width?o.css({"min-width":min_width+"px",width:min_width+"px"}):o.css({"min-width":min_width+"px",width:o.width()+"px"})},t.getInsertMessageId=function(e){var t=this,n=t._msgNestHash[e].lastChild;if(!n)return e;for(;n;){var o=t._msgNestHash[n].lastChild;if(!o)return n;n=o}},t.showHistoryMessage=function(e,t,n){var o=this,i=o.getHtmlElement();if(null!=i){var a=o.getColumnContent(),r=!1;e.getReplyItemId()&&(r=!0);var s=o.createMessageObjectOnly(e),l=o.getColumnMessageHtml(s,r);if(""!=l){var u=e.getType(),c=t*o.indentSize,d=o.getMaxColumnSize()-o.messageBodyMinSize;c=c>d?d:c;var g=$(l);u==Message.TYPE_CHAT?($(g).attr("style","padding-left:"+c+"px"),$(g).attr("msgto",e.getTo()),$(g).attr("msgfrom",e.getFrom())):$("div.thread-padding",g).attr("style","width:"+c+"px"),$(g).attr("msgtype",u),l=$(g);var m,_=void 0;if(u==Message.TYPE_CHAT)if(l=o.createDivMessageBorder(l),o._setMessageObject(s,l,-1),n&&n.length>0){var f=o.getInsertMessageId(n);o._msgNestHash[e.getReplyItemId()].lastChild=e.getItemId();var p="div.box-border.olient-vertical.chat-message";$(p+"[itemid="+f+"]",a).parent().after(l);var h=$(l).attr("itemid");m=$(p+"[itemid="+h+"]",a),_=$(p+"[itemid="+f+"]",a).parent().next()}else if(e.getReplyItemId()){var f=o.getInsertMessageId(e.getReplyItemId());o._msgNestHash[e.getReplyItemId()].lastChild=e.getItemId(),$("div.box-border.olient-vertical.chat-message[itemid="+f+"]",a).parent().after(l),_=$("div.box-border.olient-vertical.chat-message[itemid="+f+"]",a).parent().next()}else a.append(l),m=o._getMessageElement(0).children().eq(-1),_=m;else if(r){var C=o.getMsgObjByItemId(o._parentItemId),v=C.getHtmlElement(),f=o.getInsertMessageId(e.getReplyItemId());if(o._msgNestHash[e.getReplyItemId()].lastChild=e.getItemId(),n&&n.length>0){var y="div.box-border.olient-horizontal.thread-message",T="div.box-border.olient-horizontal.thread-message";$(y+"[itemid="+f+"]",v)[0]||(T="div.box-border.olient-vertical.read-message"),$(T+"[itemid="+f+"]",v).after(l);var b=$(l).attr("itemid");m=$(y+"[itemid="+b+"]",v)}else $("div.box-border[itemid="+f+"]:not(.flex1)",v).after(l),m=$("div.box-border.olient-horizontal.thread-message[itemid="+e.getItemId()+"]",v);s.setHtmlElement(m);var I=new MessageObjectIndex(s);o.addMsgObjIndexChild(o._parentItemId,I),v.detach(),a.prepend(v);var M=o.getMsgObjIndexPositionByItemId(o._parentItemId);o._getMsgObjIndexList().move(M,0)}else l=o.createDivMessageBorder(l),o._setMessageObject(s,l,-1),a.prepend(l),m=o._getMessageElement(0).children().eq(-1);var E=m;new MessageColumnLink($(E),e);var S;u==Message.TYPE_CHAT?S=l.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(0):r?S=$("div.box-border.flex1[itemid="+$(l).attr("itemid")+"]",a):(_insertedElement=a.children("div").eq(0),S=_insertedElement.children().not("."+ColumnView.TOGGLE_REPLY_CLS_NAME).eq(-1));var w=o.getMaxNestSize()*o.indentSize;o.setConversationColumnSize(w),o._setToolTipToMessageElem(S,e,s);var N=E;1==e.getBodyType()&&(u==Message.TYPE_CHAT?(N=_,ViewUtils.showStampMessage(_,o)):ViewUtils.showStampMessage(E,o)),o.afterCreateMessageHtml(N)}}},t.getColumnMessageHtml=function(e,t){var n="";return n=e.getMessageHtml(t)},t.createMessageObjectOnly=function(e){var t=this;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return null;var n=ViewUtils.createMessageObject(t,e);return n},t._showMessageData=function(e){var t=this,n=t._itemIdList.length,o=e.getItemId();if(0==n){for(var i=0;i<t._waitMsgList.length;i++){var a=t._waitMsgList[i];if(a==o)return!1}return t._waitMsgList.push(e),!1}for(var r=0;n>r;r++){var s=e.getReplyItemId?e.getReplyItemId():null,l=t._itemIdList[r];if(l==o)return!1;if(null!=s&&l==s){var u=1;return t._msgNestHash[s].depth>0&&(u=t._msgNestHash[s].depth+1),t._msgNestHash[e.getItemId()]={depth:u,lastChild:""},t._itemIdList.push(e.getItemId()),t.showHistoryMessage(e,u,s),t.getHtmlElement().find(".message-title").remove(),!0}}return!1},t._createDisplayName=function(e){return Resource.getMessage("ShowConversation")+" / "+e.getSourceColumnDisplayName()},t.onGoodJobNotificationReceive=function(e){var t=this,n=e.getItemId(),o=t.getMsgObjByItemId(n);if(null!=o){var i=CubeeController.getInstance().getMessage(n);if(null==i){var a=o.getMessage();if(null!=a){var r=e.getFromJid(),s=a.getGoodJobList(),l=s.getByJid(r);if(null==l){l=new GoodJobData,l.setJid(r);var u=new Date(e.getDate());l.setDate(u),s.add(l)}o.onGoodJobReceive()}}}},t.onMessageOptionNotificationReceive=function(e){function t(){var t=CubeeController.getInstance().getMessage(i);if(null==t){var n=a.getMessage();if(null!=n){var o=e.getExistingReaderItem();if(LoginUser.getInstance().getJid()!=o.getPerson().getJid()||n.getReadFlag()!=Message.READ_STATUS_READ){var r=n.getExistingReaderInfo();if(null==r)return r=new MessageExistingReaderInfo,r.setAllCount(1),r.getExistingReaderItemList().add(o),void n.setExistingReaderInfo(r);var s=r.getAllCount();r.setAllCount(s+1),r.getExistingReaderItemList().removeAll(),r.getExistingReaderItemList().add(o)}}}}var n=this,o=e.getContentType();if(o==MessageOptionNotification.CONTENT_TYPE_SET_READ_MESSAGE){var i=e.getItemId(),a=n.getMsgObjByItemId(i);null!=a&&(t(),a.onMessageOptionReceive(e))}},t.onThreadTitleUpdateReceived=function(e,t){var n=this;if(n._titleElement&&n._titleElement[0])if(t.getThreadTitle()){var o=[],i=t.getThreadTitle(),a=i;a=ViewUtils.replaceTenantBaseTitleCategory(a,i,o,{"class":"in-conversation-colum"}),a=ViewUtils.replaceOrignalTitleCategory(a,i,o,{"class":"in-conversation-colum"});for(var r=o.sort(function(e,t){return e.index-t.index}),s="",l=0;l<r.length;l++)s+=r[l].data;n._titleElement.html(""+s+'<span style="font-weight:700;">'+Utils.convertEscapedHtml(a)+"</span>"),n._titleElement.attr("title",Utils.convertEscapedHtml(t.getThreadTitle()))}else n._titleElement.remove(),n._titleElement=null,$(window).trigger("resize"),n.refreshScrollbar();else{var u=$(ColumnSearchView.getBorderHeaderHtml(n._threadRootMessage)),c=[],d=t.getThreadTitle(),g=d;g=ViewUtils.replaceTenantBaseTitleCategory(g,d,c,{"class":"in-conversation-colum"}),g=ViewUtils.replaceOrignalTitleCategory(g,d,c,{"class":"in-conversation-colum"});for(var m=c.sort(function(e,t){return e.index-t.index}),_="",f=0;f<m.length;f++)_+=m[f].data;u.html(""+_+'<span style="font-weight:700;">'+Utils.convertEscapedHtml(g)+"</span>"),u.attr("title",Utils.convertEscapedHtml(t.getThreadTitle())),n._titleElement=u,n.getHtmlElement().find("div.box-border.ui-widget-content.wrap-frm-message").append(u),$(window).trigger("resize"),n.refreshScrollbar()}},t.isShowableMessage=function(e){var t=!1,n=this,o=n._itemIdList;if(null==o)return t;var i=e.getItemId(),a=e.getReplyItemId?e.getReplyItemId():null;if(null==i)return t;for(var r=0;r<o.length;r++){var s=o[r];if(null!=s&&null!=s){if(i==s){t=!0;break}if(null!=a&&a==s){t=!0;break}}}return t},t.displayErrorMessage=function(e){var t=this,n=t.getColumnContent(),o='<div class="column-error-message">'+Resource.getMessage("column_unexpected_error")+"</div>";n.append(o)},t._setOptionMenu=function(e){var t=this,n=ConversationColumnOptionMenu.getHtml(t._info),o=TooltipView.getInstance().createColumnOptionMenuTooltip(e,n);t._columnOptionMenu=new ConversationColumnOptionMenu(o,t._info,t)},t.cleanup=function(){e.cleanup.call(this),this._className=null,this._displayName=null,this._parentItemId=null,this._itemIdList=[],this._waitMsgList=[],this._msgNestHash={},this.indentSize=null,this.messageBodyMinSize=null,this.sidebarSize=null,this.columnMinSize=null,this.windowSize=null,this._htmlElement=null}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnMurmurView.cssClassMurmur="murmur-message",ViewUtils.isIE89()?ColumnMurmurView.cssClassThread="thread-message thread-message-ie89":ColumnMurmurView.cssClassThread="thread-message",ColumnMurmurView.prototype=$.extend({},ColumnView.prototype);var e=ColumnView.prototype,t=ColumnMurmurView.prototype;t._setOptionMenu=function(e){var t=this,n=MurmurColumnOptionMenu.getHtml(t._info),o=TooltipView.getInstance().createColumnOptionMenuTooltip(e,n);t._columnOptionMenu=new MurmurColumnOptionMenu(o,t._info,t)},t.getHistoryMessage=function(){function e(e){if(t._hideLoadingIconInSelf(),e){var n=e.messageDataList;if(n){var o=n.getCount();i>o&&(t._allMessageReceived=!0),t.onGetMurmurHistoryMessage(n),$(window).trigger("resize"),t.refreshScrollbar(),t._disableBottomEvent=!1}}}var t=this,n=t._info,o=n.getSearchCondition(),i=20;t._disableBottomEvent=!0,CubeeController.getInstance().searchMessage(t._currentLoadedItemId,i,o,e)},t.onGetMurmurHistoryMessage=function(e){var t=this;if(e)for(var n=e.getCount(),o=0;n>o;o++){var i=e.get(o);if(null!=i){var a=i.getItemId();t.getMsgObjByItemId(a)||t.showHistoryMessage(i)}}},t.createMessageObjectOnly=function(e){var t=this;if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=e.getType(),o=null;switch(n){case Message.TYPE_MURMUR:o=new ColumnMurmurMessageView(t,e);break;default:console.log("ColumnMurmurView::createMessageObjectOnly _ invalid type:"+n)}return o}},t.getColumnMessageHtml=function(e,t){var n="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?(null==t&&(t=!1),n=e.getMessageHtml(t)):n},t._createDisplayName=function(e){var t=this,n=ColumnView.DISPLAY_NAME_MURMUR;return"string"==typeof t._info._columnName&&t._info._columnName.length>0&&(n=t._info._columnName),"string"==typeof e&&""!=e&&(n+=" ("+e+")"),n},t.showHistoryMessage=function(t){var n=this;n.isSideMenu?e.showHistoryMessage.call(n,t):n._showHistoryMessageWithThread(t)},t.clickSubFormButton=function(){var e=this;e.sendMurmurMessage()},t.sendMurmurMessage=function(){function e(){o._textarea.clearText(),o._textTitleArea.clearText(),void 0!=o._fileUpload&&null!=o._fileUpload&&o._fileUpload.clearFileUpload(),o.getHtmlElement().find(".attach-note-element p").attr("value")&&(o.getHtmlElement().find(".attach-note-element p").remove(),o.getHtmlElement().find(".attach-note-element .note_cancel_btn").remove()),o.getHtmlElement().find(".message-attachment-area").is(":visible")&&o.getHtmlElement().find(".message-attachment-area").slideToggle(200,function(){$(window).trigger("resize")})}function t(t){var n=o.getHtmlElement().find(".attach-note-element p").attr("value");if(n){if(null==t||!t.content||!t.content.result){var i=Resource.getMessage("dialog_title_system_info"),a=Resource.getMessage("dialog_error_send_message"),r=new DialogCloseView(i,a);return void r.showDialog()}if(t.content.items&&t.content.items.length)var s=function(){if(CubeeController.getInstance()._messageManager.getAllMessage().getByItemId(l.itemId))clearInterval(d),CodiMdController.getInstance().assignNoteOnThreadRootId(l.itemId,n).then(function(t){e()})["catch"](function(e){var t=Resource.getMessage("dialog_title_system_info"),n=Resource.getMessage("dialog_error_assign_note_after_try"),o=new DialogCloseView(t,n);o.showDialog()});else if(g+=1,u*g>c){clearInterval(d);var t=Resource.getMessage("dialog_title_system_info"),o=Resource.getMessage("dialog_error_assign_note_after_try"),i=new DialogCloseView(t,o);i.showDialog()}},l=t.content.items[0],u=200,c=1e4,d=setInterval(s,u),g=0}else e()}function n(e){var n=new MurmurMessage;if(n.setFrom(LoginUser.getInstance().getJid()),n.setTo(LoginUser.getInstance().getJid()),n.setMessage(e),n.setDirection(ChatMessage.DIRECTION_SEND),n.setThreadTitle(i),0==CubeeController.getInstance().sendMurmurMessage(n,t)){console.log("faild to send Murmur");var o=Resource.getMessage("dialog_title_system_info"),a=Resource.getMessage("dialog_error_send_message"),r=new DialogCloseView(o,a);r.showDialog()}}var o=this,i=o._textTitleArea.getText().trim(),a=o._textarea.getText(),r=o._uploadFileAndSendMessage(a,n,i);o._textarea.clearTextFromFlag(r)},t._showMessageData=function(t){var n=this;return n.isSideMenu?e._showMessageData.call(n,t):n._showMessageDataWithThread(t)},t._hasRightMessage=function(e){var t="",n=AuthorityInfo.getInstance();t=n.checkRights(AuthorityDef.AUTHORITY_ACTIONS.MURMUR_SEND),e.setRightToSendMessage(t),t=n.checkRights(AuthorityDef.AUTHORITY_ACTIONS.MURMUR_VIEW),e.setRightToViewMessage(t),_sendMessageRight=e.getRightToViewMessage()}}(),function(){QuestionnaireNotificationIconView.prototype=$.extend({},NotificationIconView.prototype);var e=(NotificationIconView.prototype,QuestionnaireNotificationIconView.prototype);e._init=function(e){},e._addEventHandler=function(){var e=this,t=e._htmlElement;t.on("click",function(){if(console.log("QuestionnaireNotificationIconView::_addEventHandler  click!"),TabManager.getInstance().isActiveMyWorkplace())ColumnManager.getInstance().addQuestionnaireColumn(!0,!0),NotificationIconManager.getInstance().removeNotificationIcon(e);else{var t=function(e){e&&ColumnManager.getInstance().addQuestionnaireColumn(!0,!0)};TabManager.getInstance().activeMyWorkplaceTab(t)}})},e._getIconPath=function(){return"images/notice_questionnaire.png"},e._setType=function(){var e=this;e._type=ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE},e.onAddColumn=function(e){var t=this;NotificationIconManager.getInstance().removeNotificationIcon(t)},e.onColumnClicked=function(e){var t=this,n=e.getColumnType();t.getType()==n&&NotificationIconManager.getInstance().removeNotificationIcon(t)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){var t=!1,n=e.getStartDate();if(n&&n.length>0){var o=new Date,i=o.format(Utils.DISPLAY_STANDARD_DATE_FORMAT);n>i&&(t=!0)}return t}function t(e){var t=!1,n=e.getDueDate();if(n&&n.length>0){var o=new Date,i=o.format(Utils.DISPLAY_STANDARD_DATE_FORMAT);i>n&&(t=!0)}return t}function n(e){var t="",n=e,a=n.getItemId(),r=n.getId(),s=n.getFrom(),l=n.getProfileByJid(s),u=new Person;u.setJid(s),u._profile=l;var c=u.getUserName();(null==c||""==c)&&(c=ViewUtils.getUserName(s));var d=u.getLoginAccount();(null==d||""==d)&&(d=ViewUtils.getCubeeAccountName(s));var g=null!=u?u.getStatus():Person.PROFILE_STATUS_ACTIVE,m=Utils.getDate(n.getDate(),Utils.DISPLAY_STANDARD_DATE_FORMAT),_=ViewUtils.getAvatarDataHtmlFromPerson(u);return t+='<div class="box-border olient-horizontal message-header questionnaire-message-header">',t+='<div class="message-info" messageid="'+(null==r?"":r)+'" itemid="'+a+'" />',ViewUtils.isIE89()&&(t+="<table><tr><td>"),t+=_,ViewUtils.isIE89()&&(t+='</td><td width="100%">'),t+='<div class="flex1 block-info">',t+='<div class="sender-name text-overflow-ellipsis-nosize box-border-for-abbreviation"',t+=' title="'+Utils.convertEscapedTag(c),t+=ViewUtils.getUserStatusString(g),t+=" @"+Utils.convertEscapedTag(d)+'">',t+=Utils.convertEscapedHtml(c),t+=ViewUtils.getUserStatusString(g),t+='<span class="sender-account">@'+Utils.convertEscapedHtml(d)+"</span></div>",t+='<div class="questionnaire-message-header-time">',t+='<div class="message-time">'+m+"</div>",t+="</div>",t+='<div class="message-time end-date">'+o(n)+"</div>",t+='<div class="message-time end-date">'+i(n)+"</div>",t+="</div>",ViewUtils.isIE89()&&(t+="</td></tr></table>"),t+="</div>"}function o(e){var t=e.getStartDate(),n="";return t&&(n+=Utils.getDate(t,Utils.DISPLAY_VOTE_END_DATE_FORMAT),n+=Resource.getMessage("vote_startdate_status_text")),n}function i(e){var t=e.getDueDate(),n="";e.getStartDate();return t&&(n+=Utils.getDate(t,Utils.DISPLAY_VOTE_END_DATE_FORMAT),n+=Resource.getMessage("vote_enddate_status_text")),n}function a(e){if(2==e.getDeleteFlag())return"";var t=r(e);return e.getVoteFlag()?e.getResultVisible()==QuestionnaireMessage.INFORMATION_PUBLIC||t?u(e):l(e,!0):t?l(e)+u(e):l(e)}function r(e){return e.getFrom()==LoginUser.getInstance().getJid()}function s(){var e="";return e='        <a class="questionnaire-toggle col_btn col_input_btn         popup_btn ico_btn" data-toggle="tooltip" data-placement="bottom" data-container="body"        data-original-title="'+Resource.getMessage("vote_toggle_display")+'">            <i class="fa fa-caret-down"></i>        </a>'}function l(e,t){var n=e.getOptionItems(),o="",i="";r(e)&&(o+=s(),i="display-none"),t&&(i+="disable-vote-action");var a=e.getInputType(),l="";a===QuestionnaireMessage.INPUTTYPE_RADIO&&(l="radio"),o+='<div class="questionnaire-vote-area '+i+'">',o+="<div>";for(var u=e.getOptionCount(),c=0;u>c;c++){var d=n.get(c);o+='<div class="questionnaire-option-item" option-id="'+d.optionId.toString()+'">';var g=Utils.convertEscapedHtml(d.option.toString());o+='<div class="questionnaire-option-item-text" title="'+g+'">'+g+"</div>",t||(o+='<div class="questionnaire-option-item-mark '+l+'"></div>'),o+="</div>"}return o+="</div>",t||(o+='  <div class="questionnaire-vote-buttons">',o+='    <button class="questionnaire-vote-button" >'+Resource.getMessage("vote_button_name")+"</button>",o+="  </div>"),o+="  </div>"}function u(e){var t="";t+='<div class="questionnaire-result">';var n=e.getGraphType();return t+=n===QuestionnaireMessage.GRAPHTYPE_PIE?d(e):c(e),t+="</div>"}function c(e){var t=e.getOptionItems(),n=e.getOptionCount(),o=0,i=0,a=null,r=0;for(i=0;n>i;i++)a=t.get(i),r=parseInt(a.optionValue,10),isNaN(r)||(o+=r);var s="";for(i=0;n>i;i++){a=t.get(i);var l=0;r=parseInt(a.optionValue,10),isNaN(r)&&(r=0),o>0&&(l=100*r/o);var u=Utils.convertEscapedHtml(a.option.toString());s+='<div class="questionnaire-result-bar-item">',s+='<div class="questionnaire-result-bar-item-name" title="'+u+'">'+u+"</div>",s+='<div class="questionnaire-result-bar-item-graph">',s+='<div class="questionnaire-result-bar-item-progress">',s+='<div style="width: '+l+'%;"></div>',s+="</div>",s+='<div class="questionnaire-result-bar-item-number">'+l.toFixed(0)+"%("+r+")</div>",s+="</div>",s+="</div>"}return s}function d(e){function t(e){return 0===d?"#dbdbdb":r(e)}var n=90,o=n/2,i=d3.layout.pie(),a=d3.svg.arc().innerRadius(0).outerRadius(o),r=d3.scale.category20(),s="translate("+o+","+o+")",l=[],u=e.getOptionItems(),c=e.getOptionCount(),d=0,g=0,m=0;for(g=0;c>g;g++){var _=u.get(g);m=parseInt(_.optionValue,10),isNaN(m)&&(m=0),l.push(m),d+=m}var f="";for(f+='<div class="questionnaire-result-sample">',g=0;c>g;g++){var _=u.get(g),p=0;m=parseInt(_.optionValue,10),isNaN(m)&&(m=0),m>0&&(p=100*m/d);var h=Utils.convertEscapedHtml(_.option.toString());f+='<div class="questionnaire-result-sample-item">',f+='<div class="questionnaire-result-sample-item-color" style="background-color:'+r(g)+'">&nbsp;</div>',f+='<div class="questionnaire-result-sample-item-name" title="'+h+'">'+h+"</div>",f+='<div class="questionnaire-result-sample-item-number">'+p.toFixed(0)+"%("+m+")</div>",f+="</div>"}f+="</div>",f+='<div class="questionnaire-result-graph-pie">',f+='<svg width="'+n+'" height="'+n+'">',0===d&&(l=[1]);for(var C=i(l),v=0;v<l.length;v++){var y=t(v),T=a(C[v]);f+='<g transform="'+s+'">',f+='<path fill="'+y+'" d="'+T+'">',f+="</path>",f+="</g>"}return f+="</svg>",f+="</div>"}function g(e){var t="<div></div>";return t}function m(e){var t=e.getMessage(),n=e.getDeleteFlag();2==n&&(t=t.replace("deleted_by_admin",Resource.getMessage("deleted_questionnaire_body_by_admin")),t=t.replace("deleted",Resource.getMessage("deleted_questionnaire_body")));var o=Utils.convertEscapedHtml(t,!1),i=Utils.convertEscapedTag(t),r=ViewUtils.replaceHashtagElement(o),s="";return s+='<div class="box-border olient-vertical message-info">',s+='<div class="message-body box-border-for-abbreviation olient-vertical">',s+='<pre class="" title="'+i+'">'+r+"</pre>",s+=a(e),s+="</div>",s+="</div>"}ColumnQuestionnaireMessageView.QUESTIONNAIRE_MESSAGE_ICON_CLS_NAME="Questionnaire-message-icon",ColumnQuestionnaireMessageView.prototype=$.extend({},ColumnMessageView.prototype);var _=ColumnMessageView.prototype,f=ColumnQuestionnaireMessageView.prototype;f.cleanup=function(){var e=this;_.cleanup.call(e)},f.getMessageHtml=function(){var e=this,t="",n=this.getMessage(),o=this.getItemId();return t+='<div draggable="false" class="box-border olient-vertical '+ColumnQuestionnaireView.cssClass+' "',t+=' itemId="'+o+'"',t+=">",e.getParent().getType()==ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE&&(t+=ColumnSearchView.getBorderHeaderHtml(n)),t+=e.getMessageHeaderHtml(),t+=e.getMessageBodyHtml(),t+="</div> <!-- questionnaire-message -->"},f.setHtmlElement=function(e){var t=this;t.getMessage();t._htmlElement=e,t._htmlElement&&(t.setOptionSelectEvent(),t.setVoteEvent(),t.setToggleEvent()),t._htmlElement.find(".questionnaire-toggle").length&&(t._htmlElement.find(".message-body").addClass("toggle-questionnaire-on"),t._htmlElement.find(".questionnaire-toggle").click(function(){t._htmlElement.find(".message-body").toggleClass("open").find(".questionnaire-vote-area").stop().slideToggle(200)}));var n=t._htmlElement.find("a.hashtag");t._setHashtagEvent(n)},f._setHashtagEvent=function(e){var t=this;e&&e.on("click",function(){ContextSearchView.getInstance().search($(this).text(),t.getParent(),!0)})},f.setToggleEvent=function(){var e=this;if(r(e.getMessage())){var t=e.getHtmlElement(),n=t.find("div.questionnaire-vote-toggle button"),o="ui-icon-minusthick",i="ui-icon-plusthick";n.button({icons:{primary:i},text:!1}).click(function(){var e=$(this),t=e.find("span.ui-icon");t.toggleClass(i).toggleClass(o),t.hasClass(i)?e.attr("title",Resource.getMessage("vote_toggle_display")):e.attr("title",Resource.getMessage("vote_toggle_hide")),e.parents("div.message-body").children("div.questionnaire-vote-area").slideToggle(function(){$(this).toggleClass("display-none"),View.getInstance().resizeContent()})})}},f.setOptionSelectEvent=function(){var e=this,t=e.getHtmlElement(),n=t.find("div.questionnaire-option-item");n.on("click",function(){e._inputType==QuestionnaireMessage.INPUTTYPE_CHECKBOX?$(this).toggleClass("selected"):(n.removeClass("selected"),$(this).addClass("selected"))})},f.setVoteEvent=function(){var n=this,o=n.getHtmlElement(),i=o.find("button.questionnaire-vote-button").eq(0);i=i.button(),i.on("click",function(){i.off(),n.voteAction()});var a=n.getMessage();switch(parseInt(a.getRoomType())){case Message.TYPE_PUBLIC:AuthorityInfo.getInstance().checkRights("sendMessageToFeed")||(i.prop("disabled",!0),i.text(Resource.getMessage("vote_status_label_authority_err")));break;case Message.TYPE_GROUP_CHAT:AuthorityInfo.getInstance().checkRights("viewMessageInGroupchat",a.getRoomId())&&(i.prop("disabled",!0),
i.text(Resource.getMessage("vote_status_label_authority_err")));break;case Message.TYPE_COMMUNITY:AuthorityInfo.getInstance().checkRights("viewMessageInCommunity",a.getRoomId())&&(i.prop("disabled",!0),i.text(Resource.getMessage("vote_status_label_authority_err")))}e(a)&&(i.prop("disabled",!0),i.text(Resource.getMessage("vote_status_label_before"))),t(a)&&(i.prop("disabled",!0),i.text(Resource.getMessage("vote_status_label_after")))},f.voteAction=function(){function e(e){console.log("vote completed. Result is "+e)}var t=this,n=t.getItemId(),o=new ArrayList,i=t.getHtmlElement(),a=i.find("div.questionnaire-option-item.selected");if(a.each(function(e,t){var n=$(t).attr("option-id"),i={optionValue:1,optionId:n};o.add(i)}),a.length<=0)return void t.setVoteEvent();var r="",s=t.getMessage();s&&(r=s.getRoomId()),CubeeController.getInstance().sendVoteMessage(e,r,n,o)},f.getMessageHeaderHtml=function(){var e=this,t="",o=e.getMessage();return t=n(o)},ColumnQuestionnaireMessageView.getMessageHeaderHtml=function(e){var t="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?t=n(e):t},f.getMessageFooterHtml=function(){var e=this,t="",n=e.getMessage();return t=g(n)},ColumnQuestionnaireMessageView.getMessageFooterHtml=function(e){var t="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?t=g(e):t},f.getMessageBodyHtml=function(){var e=this,t="",n=e.getMessage();return t=m(n)},ColumnQuestionnaireMessageView.getMessageBodyHtml=function(e){var t="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?t=m(e):t},f._setReadMessage=function(){},f._setMessageReadFlgView=function(){}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnQuestionnaireView.cssClass="questionnaire-message",ColumnQuestionnaireView.prototype=$.extend({},ColumnView.prototype);var e=ColumnView.prototype,t=ColumnQuestionnaireView.prototype;t.createView=function(){var e=this,t=this.getColumnInfo();if(null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var n=e.getType(),o=ViewUtils.createDisplayName(t);t.setDisplayName(o);var i="";i+=ColumnSubmitButtonView.getHtml(n),this.createHtml(i)}},t._createSubForms=function(){var e=this,t=e.getHtmlElement();if(null!=t){t.find("div.frm-message > button").before(ColumnSubmitButtonView.getHtml(ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE));var n=t.find("div.frm-message > button"),o=n.eq(0),i=n.eq(1);e._buttonList=new ArrayList,e._buttonList.add(new ColumnSubmitButtonView(i,e,Resource.getMessage("questionnaire_registerQuestionnaire_btn"))),e._buttonList.add(new ColumnReloadButtonView(o,e,Resource.getMessage("questionnaire_reloadQuestionnaire_btn")))}},t.getHistoryMessage=function(){function e(e){e.getCount()<20&&(t._allMessageReceived=!0),t.onGetHistoryMessage(e),$(window).trigger("resize"),t.refreshScrollbar()}var t=this,n=t.getColumnInfo(),o=n.getFilterCondition(),i=(new TaskFilterAndSortCondition).getSortObject(o);CubeeController.getInstance().getQuestionnaireMessages(t._currentLoadedItemId,20,i,e)},t.onGetHistoryMessage=function(e){var t=this;if(t._hideLoadingIconInSelf(),e)for(var n=e.getCount(),o=0;n>o;o++){var i=e.get(o),a=i.getItemId();t.getMsgObjByItemId(a)||t.showHistoryMessage(i)}},t.cleanup=function(){var t=this;e.cleanup.call(t),t._buttonList&&(t._buttonList.removeAll(),delete t._buttonList)},t.clickSubFormButton=function(){var e=this,t=new QuestionnaireMessage,n=new QuestionnaireRegister(e,t),o=e.getHtmlElement();if(null!=o){var i=o.find("div.frm-message");i.children().hide(),e._showQuestionnaireEditView(i,n),$(i).css("height",e._getFrmMessageHeight(i)),$(window).trigger("resize")}},t._endSubformEditMode=function(){var e=this,t=e.getHtmlElement();if(null!=t){var n=t.find("div.frm-message");e._hideQuestionnaireEditView(n),n.children().show(),$(window).trigger("resize")}},t._hideSubForm=function(e){$(e).children("button").addClass("display-none")},t._showSubForm=function(e){$(e).css("height",""),$(e).children("button").removeClass("display-none")},t._showQuestionnaireEditView=function(e,t){$(e).append(t.getCreateQuestionnaireForm()),t._addTextareaAutosize($(e).find("div.questionnaire-register-area"))},t._hideQuestionnaireEditView=function(e){$(e).children("div.questionnaire-register-area").remove()},t.onQuestionnaireRegist=function(e){function t(t){t&&(n._endSubformEditMode(),n.showUpdateMessage(e.getRegistedMessageData()))}var n=this;e.registQuestionnaire(t)},t.onQuestionnaireEditCancel=function(){var e=this;e._endSubformEditMode()},t.clickReloadButton=function(){var e=this,t=e.getHtmlElement();if(null!=t){var n=t.find("div.column-content .message-border").not("."+ViewUtils.LOADING_ICON_CLASS_NAME);e._currentLoadedItemId=0;var o=e._getMsgObjHash();for(var i in o)o[i].cleanup(),delete o[i];e._getMsgObjIndexList().removeAll(),n.remove(),e._hideLoadingIconInSelf(),e._allMessageReceived=!1,e._LoadingIcon("div.wrap-frm-message"),e.getHistoryMessage()}},t.onAddMessageReceive=function(e){var t=this;0!=t._validation({object:e})&&t.onAddQuestionnaireMessageReceive(e)},t.onAddQuestionnaireMessageReceive=function(e){var t=this;if(null!=e){if(e.getType()==Message.TYPE_QUESTIONNAIRE){var n=e.getItemId();if(t.getMsgObjByItemId(n))return}t.showMessage(e)}},t.createMessageObjectOnly=function(e){var t=this;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return null;var n=e.getType(),o=null;switch(n){case Message.TYPE_QUESTIONNAIRE:o=new ColumnQuestionnaireMessageView(t,e);break;default:console.log("ColumnQuestionnaireView::createMessageObjectOnly _ invalid type:"+n)}return o},t.showMessage=function(e){var t=this;return 0==t._validation({object:e})?!1:(t._showMessageData(e),!0)},t.getColumnMessageHtml=function(e){var t="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?t=e.getMessageHtml():t},t.setContentLayout=function(){var e=this,t=e.getHtmlElement();if(null!=t){var n=$(t).outerHeight(!0),o=$(t).children("div.column-header").outerHeight(!0),i=$(t).children("div.wrap-frm-message").css("height",""),a=$(i).hasClass("display-none")?0:$(i).outerHeight(!0),r=$(i).find("div.frm-message > div.task-register-area"),s=$(r).children("div.task-register-scroll-area").css("height",""),l=$(t).children("div.column-content");if(LayoutManager.isDesktop||n>=o+a)$(l).css("height",n-(o+a)+"px");else{$(l).css("height","0px");var u=n-o,c=$(r).children("div.task-register-header").outerHeight(!0),d=$(r).children("div.register-task-buttons").outerHeight(!0);$(s).css("height",u-(c+d)+"px"),$(i).css("height",u+"px")}}},t._getFrmMessageHeight=function(e){var t="",n=$(e).get(0),o=parseInt($(n).css("height")),i=$(e).find("div.task-register-area").get(0),a=$(i).outerHeight(!0);if(a>o){var r=parseInt(e.css("borderTopWidth"))+parseInt(e.css("borderBottomWidth")),s=parseInt(e.css("paddingTop"))+parseInt(e.css("paddingBottom"));t=a+r+s}return t}}(),function(){function e(e){var t="";return t+='  <div class="layout-grouping">',t+='  <div class="register-questionnaire-optionItems register-questionnaire-option olient-horizontal width-100">',t+='    <div class="register-questionnaire-label box-border olient-vertical">'+Resource.getMessage("questionnaire_item_option")+e+"</div>",t+='    <div class="register-questionnaire-item">',t+='  <input style="height: 27px;" type="text" class="questionnaire-register-item register-option-input ui-corner-all autocomplete width-100" placeholder="'+Resource.getMessage("questionnaire_option_text")+'">',t+="    </div>",t+='    <div style="display: table; text-align: center; width: 35px;">',t+='      <span style="display: table-cell; vertical-align: middle;" class="img_option_delete"><a class="col_btn col_question_close_btn ico_btn"><i class="fa fa-close"></i></a></span>',t+="    </div>",t+='    <div style="height: 33px; width: 20px;" class="register-questionnaire-name-char-counter">',t+=ViewUtils.getCharCounterHtml("char-counter-questionnaire-register"),t+="    </div>",t+="  </div>",t+="  </div>"}QuestionnaireRegister.MAX_LENGTH_QUESTIONNAIRE_OPTION=Conf.getVal("QUESTIONNAIRE_OPTION_MAX_LENGTH"),QuestionnaireRegister.OPTION_MAX_COUNT=10,QuestionnaireRegister.OPTION_MIN_COUNT=2,QuestionnaireRegister.OPTION_DEFAUL_COUNT=3,QuestionnaireRegister.OPTION_REMAIN_COUNT=QuestionnaireRegister.OPTION_MAX_COUNT-QuestionnaireRegister.OPTION_DEFAUL_COUNT,QuestionnaireRegister.ROOM_TYPE_FEED=1,QuestionnaireRegister.ROOM_TYPE_GROUPCHAT=3,QuestionnaireRegister.ROOM_TYPE_COMMUNITY=5,QuestionnaireRegister.COUNT=20;var t=QuestionnaireRegister.prototype,n=0;t.init=function(){var e=this;e._questionnaireInputType=e._messageData.getInputType(),e._questionnaireResultVisible=e._messageData.getResultVisible(),e._questionnaireGraphType=e._messageData.getGraphType(),e._questionnaireStartDate=e._messageData.getStartDate?e._messageData.getStartDate():"",e._questionnaireStartDateStr=e._questionnaireStartDate?Utils.getDate(e._questionnaireStartDate.toString(),FORMAT):"",e._questionnaireDueDate=e._messageData.getDueDate?e._messageData.getDueDate():e._messageData.getDueDate,e._questionnaireDueDateStr=e._questionnaireDueDate?Utils.getDate(e._questionnaireDueDate.toString(),FORMAT):""},t.getInputType=function(){return[{value:QuestionnaireMessage.INPUTTYPE_RADIO,label:Resource.getMessage("questionnaire_inputType_radiobox")},{value:QuestionnaireMessage.INPUTTYPE_CHECKBOX,label:Resource.getMessage("questionnaire_inputType_checkbox")}]},t.getResultVisible=function(){return[{value:QuestionnaireMessage.INFORMATION_PUBLIC,label:Resource.getMessage("questionnaire_resultVisible_public")},{value:QuestionnaireMessage.INFORMATION_PRIVATE,label:Resource.getMessage("questionnaire_resultVisible_private")}]},t.getGraphType=function(){return[{value:QuestionnaireMessage.GRAPHTYPE_BAR,label:Resource.getMessage("questionnaire_graphType_bar")},{value:QuestionnaireMessage.GRAPHTYPE_PIE,label:Resource.getMessage("questionnaire_graphType_pie")}]},t.getCreateQuestionnaireForm=function(){var t,o,i=this,a="";n=0,a+='<div class="questionnaire-register-area olient-vertical">',a+='  <div class="questionnaire-register-header box-border olient-horizontal">',a+='    <span class="reg-questionnaire-title">'+Resource.getMessage("questionnaire_title_createQuestionnaire")+"</span>",a+="  </div>",a+='  <div class="questionnaire-register-scroll-area">',a+='  <div class="layout-grouping">',a+='  <div class="register-questionnaire-body olient-horizontal">',a+='    <div class="questionnaire-body-textarea-area flex1">',a+='      <textarea name="questionnaire-body" class="questionnaire-register-item ui-corner-all autocomplete" placeholder="'+Resource.getMessage("questionnaire_body_placeholder")+'" style="min-height: 4em;"></textarea>',a+="    </div>",a+='    <div class="register-questionnaire-body-char-counter">',a+=ViewUtils.getCharCounterHtml("char-counter-questionnaire-register"),a+="    </div>",a+="  </div>",a+="  </div>",a+='  <div class="layout-grouping">',a+='  <div class="register-questionnaire-table register-questionnaire-Range box-border olient-horizontal">',a+='    <div class="register-questionnaire-label">'+Resource.getMessage("questionnaire_range_title")+"</div>",a+='    <div class="register-questionnaire-item">',a+='      <select  id = "rangeId" class="questionnaire-Range questionnaire-register-item ui-corner-all width-100">',a+='        <option value="-1,-1">'+Resource.getMessage("questionnaire_range_value_no_select")+"</option>",a+="      </select>",a+="    </div>",a+="  </div>";var r=i.getResultVisible();for(a+='  <div class="register-questionnaire-table register-questionnaire-resultVisible box-border olient-horizontal">',a+='    <div class="register-questionnaire-label">'+Resource.getMessage("questionnaire_resultVisible_title")+"</div>",a+='    <div class="register-questionnaire-item">',a+='      <select class="questionnaire-resultVisible questionnaire-register-item ui-corner-all width-100">',t=0;t<r.length;t++){var s=r[t];o=i._questionnaireResultVisible==s.value?"selected":"",a+='        <option value="'+s.value+'" '+o+">"+s.label+"</option>"}a+="      </select>",a+="    </div>",a+="  </div>",a+="  </div>",a+='  <div class="layout-grouping">';var l=i.getInputType();for(a+='  <div class="register-questionnaire-table register-questionnaire-inputType box-border olient-horizontal">',a+='    <div class="register-questionnaire-label">'+Resource.getMessage("questionnaire_inputtype_title")+"</div>",a+='    <div class="register-questionnaire-item">',a+='      <select class="questionnaire-inputType questionnaire-register-item ui-corner-all width-100">',t=0;t<l.length;t++){var u=l[t];o=i._questionnaireInputType==u.value?"selected":"",a+='        <option value="'+u.value+'" '+o+">"+u.label+"</option>"}a+="      </select>",a+="    </div>",a+="  </div>";var c=i.getGraphType();for(a+='  <div class="register-questionnaire-table register-questionnaire-graphType box-border olient-horizontal">',a+='    <div class="register-questionnaire-label">'+Resource.getMessage("questionnaire_graphType_title")+"</div>",a+='    <div class="register-questionnaire-item">',a+='      <select class="questionnaire-graphType questionnaire-register-item ui-corner-all width-100">',t=0;t<c.length;t++){var d=c[t];o=i._questionnaireGraphType==d.value?"selected":"",a+='        <option value="'+d.value+'" '+o+">"+d.label+"</option>"}for(a+="      </select>",a+="    </div>",a+="  </div>",a+="  </div>",a+='  <div class="layout-grouping">',a+='  <div class="register-questionnaire-table register-questionnaire-start-date box-border olient-horizontal box-align-center">',a+='    <div class="register-questionnaire-label">'+Resource.getMessage("questionnaire_start_date")+"</div>",a+='    <div class="register-questionnaire-item" style = "display: flex">',a+='      <div style="flex:1;"><input class="questionnaire-start-date date-time-picker-start questionnaire-register-item ui-corner-all" value="'+i._questionnaireStartDateStr+'"></div>',a+="    </div>",a+="  </div>",a+='  <div class="register-questionnaire-table register-questionnaire-due-date box-border olient-horizontal box-align-center">',a+='    <div class="register-questionnaire-label">'+Resource.getMessage("questionnaire_due_date")+"</div>",a+='    <div class="register-questionnaire-item" style = "display: flex">',a+='      <div style="flex:1;"><input class="questionnaire-due-date date-time-picker-due questionnaire-register-item ui-corner-all" value="'+i._questionnaireDueDateStr+'"></div>',a+="    </div>",a+="  </div>",a+="  </div>",a+='  <div class="layout-grouping">',a+='  <div class="register-questionnaire-buttons olient-horizontal">',a+='    <button id = "AddOption" class="register-questionnaire-add" >'+Resource.getMessage("questionnaire_item_add")+"</button>",a+='    <label id = "optionCount" class="register-optionCount-label">'+QuestionnaireRegister.OPTION_REMAIN_COUNT+"</label>",a+="  </div>",a+="  </div>",a+='  <div class="layout-grouping-option" id = "insert">',t=1;4>t;t++)a+=e(t),n++;a+="  </div>",a+="  </div>",a+='  <div class="register-questionnaire-buttons">',a+='    <button class="register-questionnaire-OK">'+Resource.getMessage("dialog_label_ok2")+"</button>",a+='    <button class="register-questionnaire-Cancel">'+Resource.getMessage("dialog_label_cancel")+"</button>",a+="  </div>",a+="</div>";var g=i._registerForm=$(a),m=$(g).find("div#insert");m.on("click","span.img_option_delete",function(){var e=document.getElementById("optionCount").innerText;if(e<QuestionnaireRegister.OPTION_MAX_COUNT-QuestionnaireRegister.OPTION_MIN_COUNT){var t=$(this).parent();t=t.parent(),t=t.parent(),t.remove(),m.children().each(function(e,t){var n=$(t);n.find("div.register-questionnaire-label").text(Resource.getMessage("QuestionnaireOption")+(e+1))}),e++,document.getElementById("optionCount").innerText=e,e>0&&$(g).find("#AddOption").attr("disabled",!1),n--}i.ps.update()});var _=$(g).find("select#rangeId");_.on("click",function(){var e=Resource.getMessage("questionnaire_dialog_range_title"),t=null,n=$("select#rangeId").find("option:selected");t=new DialogSelectQuestinnaireRangeView(e,n),t&&t.showDialog()}),ViewUtils.setCharCounter(g.find("textarea"),g.find(".register-questionnaire-body-char-counter .char-counter-questionnaire-register"),ColumnView.TEXTAREA_MAX_LENGTH,!1);var f=m.children();for(t=0;t<f.length;t++){var p=$(f[t]),h=p.find("input"),C=p.find("."+ViewUtils.CHAR_COUNTER_CLASSNAME);ViewUtils.setCharCounter(h,C,QuestionnaireRegister.MAX_LENGTH_QUESTIONNAIRE_OPTION,!0)}var v=new Date,y=new Date;y.setDate(y.getDate()+1);var T=$(g).find("input.date-time-picker-start"),b=$(g).find("input.date-time-picker-due");$(T).datetimepicker({showOn:"focus",dateFormat:Utils.DISPLAY_DATEPICKER_DATE_FORMAT,defaultDate:v}).next("img.date-time-pickers-icon-calender").on("click",function(){$(this).prev("input.date-time-picker-start").eq(0).focus()}),$(b).datetimepicker({showOn:"focus",dateFormat:Utils.DISPLAY_DATEPICKER_DATE_FORMAT,defaultDate:y}).next("img.date-time-pickers-icon-calender").on("click",function(){$(this).prev("input.date-time-picker-due").eq(0).focus()});var I=$(g).find("div.register-questionnaire-buttons"),M=$(I).find("button.register-questionnaire-OK").button(),E=$(I).find("button.register-questionnaire-Cancel").button(),S=$(I).find("button.register-questionnaire-add").button();return $(M).on("click",function(){i._parentObject.onQuestionnaireRegist(i)}),$(E).on("click",function(){i._parentObject.onQuestionnaireEditCancel()}),$(S).on("click",function(){n++;var t=e(n);i.onQuestionnaireEditAdd(t)}),i.ps=new PerfectScrollbar($(g).find(".questionnaire-register-scroll-area")[0],{suppressScrollX:!0}),col_scr.push(i.ps),g},t.onQuestionnaireEditAdd=function(e){var t=this,n=t._registerForm,o=$(e);n.find("div#insert").append(o);var i=o.find("input"),a=o.find("."+ViewUtils.CHAR_COUNTER_CLASSNAME);ViewUtils.setCharCounter(i,a,QuestionnaireRegister.MAX_LENGTH_QUESTIONNAIRE_OPTION,!0);var r=document.getElementById("optionCount").innerText;r--,document.getElementById("optionCount").innerText=r,0==r&&n.find("#AddOption").attr("disabled",!0),t.ps.update()},t._addTextareaAutosize=function(e){var t=e.find("div.questionnaire-body-textarea-area"),n=$(t).find("textarea");$(n).autosize()},t.getRegistedMessageData=function(){return this._registedMessageData},t.registQuestionnaire=function(e){function t(t){if(!t)return void e(!1);var i=new QuestionnaireMessage;o._messageData.getType()==Message.TYPE_QUESTIONNAIRE&&i.copy(o._messageData),o.getInputContent(i,n)}function n(t){var n=new DialogQuestionnaireConfirmView(t,e);n.showDialog()}var o=this;if(!o._registerForm)throw Resource.getMessage("register form is not defined.");return o._isValidationOk(t)?void 0:void setTimeout(function(){e(!1)},1)},t.getInputContent=function(e,t){function n(){t&&"function"==typeof t&&setTimeout(function(){t(e)},1)}var o=this._registerForm;e.setInputType(parseInt($(o).find("div.register-questionnaire-inputType > div.register-questionnaire-item > select.questionnaire-inputType").val())),e.setResultVisible(parseInt($(o).find("div.register-questionnaire-resultVisible > div.register-questionnaire-item > select.questionnaire-resultVisible").val())),e.setGraphType(parseInt($(o).find("div.register-questionnaire-graphType > div.register-questionnaire-item > select.questionnaire-graphType").val()));var i=Utils.excludeControleCharacters($(o).find("div.register-questionnaire-Range > div.register-questionnaire-item > select.questionnaire-Range").val()),a=i.split(",");0==a[0]?e.setRoomId(""):e.setRoomId(a[0]),e.setRoomType(a[1]);for(var r=new ArrayList,s=$(o).find("div#insert"),l=s.children(),u=0;u<l.length;u++){var c=$(l[u]),d=Utils.excludeControleCharacters(c.find("input").val());null!=d&&0!=d.length&&r.add(d)}e.setRoomName($(o).find("select#rangeId option").text()),e.setOptionItems(r),e.setOptionCount(r._length),e.setDueDate($(o).find("div.register-questionnaire-due-date > div.register-questionnaire-item > div > input.questionnaire-due-date").val()),e.setStartDate($(o).find("div.register-questionnaire-start-date > div.register-questionnaire-item > div > input.questionnaire-start-date").val());var g=$(o).find("div.register-questionnaire-body > div.questionnaire-body-textarea-area > textarea").val();g=Utils.excludeControleCharacters(g),e.setMessage(g),n()},t._isValidationOk=function(e){function t(t){var i=$(o).find("div.register-questionnaire-body > div.questionnaire-body-textarea-area > textarea");i.removeClass("input-error");var a=i.val();ViewUtils.isValidInputTextLength(a)||(i.addClass("input-error"),n=!1);var r=$(o).find("#rangeId");r.removeClass("input-error"),"-1"==r.val().split(",")[0]&&(r.addClass("input-error"),n=!1);var s=$(o).find("div.register-questionnaire-start-date > div.register-questionnaire-item > div > input.questionnaire-start-date"),l=s.val(),u=null;s.removeClass("input-error"),""!=l&&(Utils.isValidDate(l)?u=new Date(l):(s.addClass("input-error"),n=!1));var c=$(o).find("div.register-questionnaire-due-date > div.register-questionnaire-item > div > input.questionnaire-due-date"),d=c.val(),g=null;if(c.removeClass("input-error"),""!=d&&(Utils.isValidDate(d)?g=new Date(d):(c.addClass("input-error"),n=!1)),u&&g&&u.getTime()>g.getTime()&&(s.hasClass("input-error")||s.addClass("input-error"),c.hasClass("input-error")||c.addClass("input-error"),n=!1),g){var m=new Date;m>g&&(c.hasClass("input-error")||c.addClass("input-error"),n=!1)}for(var _=$(o).find("div#insert"),f=_.children(),p=0;p<f.length;p++){var h=$(f[p]);h.find("input").removeClass("input-error");var C=Utils.trimString(h.find("input").val());if(0==C.length||C.length>QuestionnaireRegister.MAX_LENGTH_QUESTIONNAIRE_OPTION){h.find("input").addClass("input-error"),n=!1;break}for(var v=0;p>v;v++){var y=$(f[v]),T=Utils.trimString(y.find("input").val());if(T==C){h.find("input").addClass("input-error"),y.find("input").addClass("input-error"),n=!1;break}}if(0==n)break}e(n)}var n=!0,o=this._registerForm;return setTimeout(function(){t(null)},1),!0}}(),function(){function e(e){var t=e._dialogInnerElement.find("input.field").val();e._dialogInnerElement.find("#dialog-error").text(""),$("#showList_for_range").children().remove();var o=[];g.filter(function(e){var n=e.getRoomName();0<=n.indexOf(t)&&o.add(e)});var i=parseInt($("select#range-type").val());return o.length&&i?(i==QuestionnaireRegister.ROOM_TYPE_COMMUNITY?$("#showList_for_range").append(n(o)):i==QuestionnaireRegister.ROOM_TYPE_GROUPCHAT&&$("#showList_for_range").append(r(o)),void e._dialogInnerElement.find(".scroll_content").scrollTop(0)):void e._dialogInnerElement.find("#dialog-error").text(Resource.getMessage("dialog_search_room_nothing"))}function t(e){var o=0,i=new ColumnSortCondition;if(i.getItems().removeAll(),i.getItems().add("updated_at"),i.getOrders().removeAll(),i.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC),null!=e){for(o=0;e&&o<e.getCount();o++)g.add(e.get(o));if(e.getCount()<QuestionnaireRegister.COUNT)$("#showList_for_range").children().remove(),$("#showList_for_range").append(n(g)),$("#questionnaire_range_modal .scroll_content").scrollTop(0);else{var a=e.get(e.getCount()-1)._id;CubeeController.getInstance().getJoinedCommunityInfoList(a,QuestionnaireRegister.COUNT,i,t)}}}function n(e){var t=e.length;if(0==t)return void $("#questionnaire_range_modal #dialog-error").text(Resource.getMessage("project_list_zero"));for(var n="",o=0;t>o;o++){var i=e[o];if(_avaterDate=i.getLogoUrl(),projectname=i.getRoomName(),n+='<li class="cf"><label><span class="ico ico_project">',null==_avaterDate||""==_avaterDate){var a=Utils.avatarCreate({name:projectname,type:DialogProjectListView.AvaterType});n+='<div class="no_img" style="background-color:'+a.color+'"><div class="no_img_inner">'+a.name+"</div></div></span>"}else n+='<img src="'+_avaterDate+'" alt=""></span>';var r=i.getRoomId()+","+QuestionnaireRegister.ROOM_TYPE_COMMUNITY;n+='<div class="name">'+Utils.convertEscapedHtml(projectname,!1)+"</span>",n+='<label class="radio"><input type="radio" name="column-info" value="'+r+'" id="range-member"><span></span></label>',n+="</label></li>"}return n}function o(e){u=new ArrayList,c=e._optionItem.val(),g=[];var n=new ColumnSortCondition;n.getItems().removeAll(),n.getItems().add("updated_at"),n.getOrders().removeAll(),n.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC),CubeeController.getInstance().getJoinedCommunityInfoList(0,QuestionnaireRegister.COUNT,n,t)}function a(e){var t=0,n=new ColumnSortCondition;if(n.getItems().removeAll(),n.getItems().add("updated_at"),n.getOrders().removeAll(),n.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC),null!=e){for(t=0;t<e.getCount();t++)g.add(e.get(t));if(e.getCount()<QuestionnaireRegister.COUNT)$("#showList_for_range").children().remove(),$("#showList_for_range").append(r(g)),$("#questionnaire_range_modal .scroll_content").scrollTop(0);else{var o=e.get(e.getCount()-1)._id,i=new ArrayList;i.add(new CommunityInfo),CubeeController.getInstance().getRoomInfoList(o,QuestionnaireRegister.COUNT,i,n,a)}}}function r(e){var t=e.length;if(0==t)return void $("#questionnaire_range_modal #dialog-error").text(Resource.getMessage("dialog_error_no_groupchat"));for(var n="",o=0;t>o;o++){var i=e[o],a=Utils.convertEscapedHtml(i.getRoomName()),r=Utils.avatarCreate({type:"group",name:i.getRoomName()}),s=i.getRoomId()+","+QuestionnaireRegister.ROOM_TYPE_GROUPCHAT;n+="<li>",n+="<label>",n+='  <span class="ico ico_group">',n+='    <div class="no_img" style="background-color:'+r.color+'">',n+='      <div class="no_img_inner">'+r.name+"</div>",n+="    </div></span>",n+='  <div class="name">'+a+"</span>",n+='<label class="radio"><input type="radio" name="column-info" value="'+s+'" id="range-member"><span></span></label>',n+="</label>",n+="</li>"}return n}function s(e){u=new ArrayList,c=e._optionItem.val(),g=[];var t=new ColumnSortCondition;t.getItems().removeAll(),t.getItems().add("updated_at"),t.getOrders().removeAll(),t.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC);var n=new ArrayList;n.add(new CommunityInfo),CubeeController.getInstance().getRoomInfoList(0,QuestionnaireRegister.COUNT,n,t,a)}function l(e,t){e._dialogInnerElement;e._dialogInnerElement.find("#dialog-error").text(""),t==QuestionnaireRegister.ROOM_TYPE_FEED?($("#showList_for_range").children().remove(),$("#questionnaire_range_modal .select_menu").hide(),$("#showList_for_range").hide()):t==QuestionnaireRegister.ROOM_TYPE_COMMUNITY?($("#questionnaire_range_modal .select_menu").show(),$("#showList_for_range").show(),o(e)):t==QuestionnaireRegister.ROOM_TYPE_GROUPCHAT&&($("#questionnaire_range_modal .select_menu").show(),$("#showList_for_range").show(),s(e))}DialogSelectQuestinnaireRangeView.prototype=$.extend({},DialogOkCancelView.prototype);var u,c,d=(DialogOkCancelView.prototype,DialogSelectQuestinnaireRangeView.prototype),g=[];d._init=function(){var e=this;e.frame=e.getInnerHtml(),e._dialogAreaElement.html(e.frame),e._dialogInnerElement=e._dialogAreaElement.children();var t=e._optionItem.val(),n=t.split(","),o=n[1];-1==o&&(o=5),$("select#range-type").val(o),l(e,o),e._createEventHandler()},d._createEventHandler=function(){var t=this;$("select#range-type").change(function(){var e=$("select#range-type").val();l(t,e)}),t._dialogInnerElement.find(".success_btn").on("click",function(){t.submit()}),t.ps=new PerfectScrollbar(t._dialogInnerElement.find(".scroll_content")[0],{suppressScrollX:!0}),t._dialogInnerElement.find(".title_search_btn").off("click"),t._dialogInnerElement.find(".title_search_btn").on("click",function(){e(t)}),t._dialogInnerElement.find("input.field").keypress(function(n){return(n.which&&13===n.which||n.keyCode&&13===n.keyCode)&&e(t),13!==n.which})},d.getRange=function(){return[{value:QuestionnaireRegister.ROOM_TYPE_COMMUNITY,label:Resource.getMessage("questionnaire_dialog_range_community")},{value:QuestionnaireRegister.ROOM_TYPE_GROUPCHAT,label:Resource.getMessage("questionnaire_dialog_range_group")},{value:QuestionnaireRegister.ROOM_TYPE_FEED,label:Resource.getMessage("questionnaire_dialog_range_feed")}]},d.getInnerHtml=function(){var e=this,t="",n=e.getRange();for(t='            <div id="questionnaire_range_modal" class="card modal_card">                <div class="card_title">                    <p>'+e._title+'</p>                </div>                <div class="modal_content_wrapper">                    <div class="modal_content">                        <div class="dialog-questionnaire-label">'+Resource.getMessage("questionnaire_range_title")+'</div>                        <select class="dialog-questionnaire-select-type" id = "range-type">',i=0;i<n.length;i++){var o=n[i];t+='          <option value="'+o.value+'">'+o.label+"</option>"}return t+="                        </select>                    </div>",t+='  <div class="select_menu">                        <form action="#" method="get" class="search_form">                            <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("dialog_search_room_name")+'">                            <button type="button" name="search" class="title_search_btn ico_btn"><i class="fa fa-search"></i></button>                        </form>                    </div>',t+='  <div class="list_wrapper scroll_content" id="quote_dest_list">                        <ul class="modal_list select_list" id="showList_for_range">                        </ul>                    </div>',t+='  <div class="btn_wrapper">                        <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>                        <button id="password_button" type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("config_submit_buttom")+'</span></button>                    </div>                </div>                <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>            </div>        '},d.submit=function(){var e=this;e._getSelectedRangeOption()},d._getSelectedRangeOption=function(){var e=this,t=e._dialogInnerElement;e._dialogInnerElement.find("#dialog-error").text("");var n=t.find('input[name="column-info"]').filter(":checked"),o=parseInt(t.find("#range-type").val());if(!n.length&&1!=o)return e._dialogInnerElement.find("#dialog-error").text(Resource.getMessage("questionnaire_dialog_error_no_select_range")),!1;var i=Utils.convertEscapedHtml(n.closest("div.name").text()),a=n.val();return $("select#rangeId").empty(),0!=i.length&&null!=a?(optionItem="<option value="+a+">"+i+"</option>",$("select#rangeId").prepend(optionItem)):(optionItem="<option value=0,1>"+Resource.getMessage("questionnaire_range_value")+"</option>",$("select#rangeId").prepend(optionItem)),$("select#range-type").die(),t.dialog("close"),ViewUtils.modal_allexit(),!0}}(),function(){DialogQuestionnaireConfirmView.prototype=$.extend({},DialogView.prototype);var e=(DialogView.prototype,DialogQuestionnaireConfirmView.prototype);e._init=function(e){var t=this,n="",o=Utils.convertEscapedHtml(e.getRoomName()),i="";switch(parseInt(e.getRoomType())){case QuestionnaireRegister.ROOM_TYPE_FEED:i=Resource.getMessage("MyFeed")+"";break;case QuestionnaireRegister.ROOM_TYPE_COMMUNITY:i=o+"("+Resource.getMessage("Community")+") ";break;case QuestionnaireRegister.ROOM_TYPE_GROUPCHAT:i=o+"("+Resource.getMessage("GroupChat")+") "}n+='<div id="questionnaire_confirm_modal" class="card modal_card">',n+='  <div class="card_title">',n+="    <p>"+Resource.getMessage("dialog_confirmation_title")+"</p>",n+="  </div>",n+='  <div class="modal_content_wrapper">',n+='    <p class="txt">'+i+"</p>",n+="  </div>",n+='  <div class="btn_wrapper">',n+='    <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',n+='    <button type="button" id="delete_cancel_btn" class="modal_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_cancel")+"</span></button>",
n+='    <button type="button" id="msg_ok_btn" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+"</span></button>",n+="  </div>",n+='  <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',n+="</div>",t._dialogAreaElement.html(n),t._dialogInnerElement=this._dialogAreaElement.children(),this._dialogInnerElement.find("#msg_ok_btn").on("click",function(){t.doRegistQuestionnaire()}),this._dialogInnerElement.find("#delete_cancel_btn").on("click",function(){ViewUtils.modal_allexit(),t._dialogInnerElement=null,t._callback(!1)})},e.doRegistQuestionnaire=function(){var e=this,t=function(t){t.content&&t.content.result?(ViewUtils.modal_allexit(),e._dialogInnerElement=null,e._callback(!0)):(403e3==t.content.reason?e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("authority_err")):e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("questionnaire_dialog_error_send")),e._dialogInnerElement.find("#msg_ok_btn").hide(),e._callback(!1))};CubeeController.getInstance().addQuestionnaire(e._message,t)},e.showDialog=function(){$("#modal_area").css("display","block"),$("#modal_area").prepend('<div class="overlay modal_exit"></div>'),this._dialogInnerElement.addClass("on").css("display","block").animate({"margin-top":0,opacity:1},200),$(".overlay").animate({opacity:.3},200),document.activeElement.blur()}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){for(var t=e.getCount(),n=0;t>n;n++){var o=e.get(n),i=o.getType();if(i==ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION)return o}return null}function t(e){for(var t in e)if("columnInfo"==t||"beforeColumn"==t||"message"==t||"array"==t||"notification"==t||"columnObject"==t||"chatRoomInfo"==t){if(null==e[t]||"object"!=_typeof(e[t]))return!1}else if("filterCondition"==t||"htmlString"==t||"mode"==t){if(null==e[t]||"string"!=typeof e[t])return!1}else if("index"==t&&(null==e[t]||"number"!=typeof e[t]||e[t]<0))return!1;return!0}ColumnManager.prototype=$.extend({},ViewCore.prototype);var n=[];n[ColumnInformation.TYPE_COLUMN_TIMELINE]=ColumnTimelineView,n[ColumnInformation.TYPE_COLUMN_MENTION]=ColumnMentionView,n[ColumnInformation.TYPE_COLUMN_TOME]=ColumnToMeView,n[ColumnInformation.TYPE_COLUMN_INBOX]=ColumnInboxView,n[ColumnInformation.TYPE_COLUMN_TASK]=ColumnTaskView,n[ColumnInformation.TYPE_COLUMN_CHAT]=ColumnChatView,n[ColumnInformation.TYPE_COLUMN_SEARCH]=ColumnSearchView,n[ColumnInformation.TYPE_COLUMN_FILTER]=ColumnFilterView,n[ColumnInformation.TYPE_COLUMN_GROUP_CHAT]=ColumnGroupChatView,n[ColumnInformation.TYPE_COLUMN_MAIL]=ColumnMailView,n[ColumnInformation.TYPE_COLUMN_RECENT]=ColumnRecentView,n[ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER]=ColumnCustomFilterView,n[ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED]=ColumnCommunityFeedView,n[ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK]=ColumnCommunityTaskView,n[ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION]=ColumnShowConversationView,n[ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE]=ColumnQuestionnaireView,n[ColumnInformation.TYPE_COLUMN_MURMUR]=ColumnMurmurView;var o=290,i=new ColumnManager;ColumnManager.getInstance=function(){return i};var a=ColumnManager.prototype;a.getColumnList=function(){return this._columnList},a.getColumnObjList=function(){return this._columnObjList},a.getImageMaxWidth=function(){return this._imageMaxWidth},a._getColumnContainer=function(){return this._columnContainer},a._getColumnInnerContainer=function(){return this._columnInnerContainer},a._getPersonListDialogObj=function(){return this._personListDialogObj},a._setPersonListDialogObj=function(e){return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?this._personListDialogObj=e:void 0},a.disconnected=function(){var e=this;e._columnObjList.removeAll(),e._columnList.removeAll()},a.refresh=function(e,t,n){function o(){function o(){if(s>=r)return null!=n&&"function"==typeof n&&n(!0),i._isRefreshing=!1,void setTimeout(function(){$(".scroll_content").trigger("resize")},0);var o=t.get(s);return 0!=e.indexOf("columnList_"+location.hostname+"_"+LoginUser.getInstance().getJid())&&o._colmnType==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED&&-1==e.indexOf(o.getCommunityInfomation().getRoomId()+"_")?void a():void i.addColumn(o,!1,!1,!1,a)}function a(){s++,o()}i._isCleaningUp=!1,i._columnListId=e;var r=t.getCount(),s=0,l=Conf.getVal("ADD_COLUMN_DELAY");setTimeout(o,l)}var i=this;return null==e||"string"!=typeof e?void setTimeout(function(){n(!1)},1):null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t))?void setTimeout(function(){n(!1)},1):i._isRefreshing?void setTimeout(function(){n(!1)},1):i._isCleaningUp?void setTimeout(function(){n(!1)},1):(i._isRefreshing=!0,i._isCleaningUp=!0,void i.cleanup(o))},a.cleanup=function(e){function t(){ColumnIconArea.getInstance().cleanup(),n._columnInnerContainer.find("*").off();for(var t=i;t>=0;t--){var o=n.getColumnObjList().get(t);o.cleanup(),r.eq(t).remove()}n._columnObjList.removeAll(),n._columnList.removeAll(),n._columnInnerContainer.find("*").remove(),null!=e&&"function"==typeof e&&(i>0?setTimeout(function(){e(),$("#columnInnerContainer").toggle("drop",200)},a):e())}var n=this,o=n.getColumnObjList().getCount(),i=o-1,a=0,r=n._columnInnerContainer.children();i>0?($("#columnInnerContainer").toggle("drop",200),setTimeout(function(){t()},250),a=100):t()},a.addColumn=function(e,t,n,o,i,a){function r(t){if(1==o&&t>=0){var n=e.getColumnType(),a=null;switch(n){case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:a=e.getCommunityInfomation().getRoomId();break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:a=e.getChatRoomInfomation().getRoomId();break;case ColumnInformation.TYPE_COLUMN_CHAT:a=e.getFilterCondition()}var r=NotificationSettingManager.getInstance();r.isSetting(n,a)||ColumnIconArea.getInstance().receiveMessage(t)}null!=i&&"function"==typeof i&&i()}var s=this;0!=t&&(t=!0);var l=s.getColumnList().getCount()-1,u=null;l>=0&&(u=s.getColumnList().get(l));var c=u;null!=a&&"object"==("undefined"==typeof a?"undefined":_typeof(a))&&(c=a),s.insertAfterColumn(e,c,t,n,r)},a.addColumnInfo=function(e,t,n,o){var i=this,a=new FilterColumnInfomation;a.setColumnType(e),a.setFilterCondition("");var r=ColumnFilterManager.getColumnFilter(e,null);if(null==r)return!1;var s=new ColumnSearchCondition(r,new ColumnSortCondition);return a.setSearchCondition(s,t),i.addColumn(a,!0,t,n,void 0,o),!0},a.addInboxColumn=function(e,t){var n=this,o=ViewUtils.createIndexColumnInfo();return n.addColumn(o,!0,e,t),!0},a.addQuestionnaireColumn=function(e,t){var n=this,o=ViewUtils.createQuestionnaireColumnInfo();return n.addColumn(o,!0,e,t),!0},a.addTaskColumn=function(e,t,n){var o=this,i=new ColumnInformation;i.setColumnType(ColumnInformation.TYPE_COLUMN_TASK);var a=LoginUser.getInstance().getJid(),r=ViewUtils.getTaskFilterAndSortCondition(a);return i.setFilterCondition(r.getFilterConditionJSONString()),o.addColumn(i,!0,t,n),!0},a.addChatColumn=function(e,t,n,o){var i=this;if(!e)return!1;if(e==LoginUser.getInstance().getJid())return!1;var a=new ColumnInformation,r=!1;return a.setColumnType(ColumnInformation.TYPE_COLUMN_CHAT),a.setFilterCondition(e),0!=$("#left_sidebar .contact_list").find('li[jid="'+e+'"]').find(".new_message_notice").size()&&(r=!0),t&&NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[jid="'+e+'"][columntype="3"].sortable-item .ico'),SideListView.getInstance().addChatMember(e,r),i.addColumn(a,!0,t,n,void 0,o),!0},a.addMailColumn=function(e,t){var n=this,o=ViewUtils.getMailColumnInfomation();return n.addColumn(o,!0,e,t),!0},a.addRecentColumn=function(e,t){var n=this,o=new RecentColumnInfomation;o.setFilterCondition("");var i=ColumnFilterManager.getColumnFilter(ColumnInformation.TYPE_COLUMN_RECENT,null);if(null==i)return!1;var a=new ColumnSearchCondition(i,new ColumnSortCondition);return o.setSearchCondition(a,e),n.addColumn(o,!0,e,t),!0},a.addGroupChatColumn=function(e,t,n,o){function i(i){return null==i?!1:(r=ViewUtils.getGroupChatColumnInfo(i),a.addColumn(r,!0,t,n,void 0,o),t&&NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[msgto="'+e+'"][columntype="'+ColumnInformation.TYPE_COLUMN_GROUP_CHAT+'"].sortable-item .ico_group'),!0)}var a=this;if(!e)return!1;var r=new ColumnInformation;CubeeController.getInstance().getRoomInfo(e,i)},a.addCommunityFeedColumn=function(e,t,n,o){var i=this;if(!e)return!1;var a=new CommunityInfo;a.setRoomId(e);var r=ViewUtils.getCommunityFeedColumnInfo(a);return i.addColumn(r,!0,t,n,void 0,o),t&&NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[msgto="'+e+'"][columntype="'+ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED+'"].sortable-item .ico_project'),!0},a.addCommunityTaskColumn=function(e,t,n){var o=this;if(!e)return!1;var i=new CommunityInfo;i.setRoomId(e);var a=ViewUtils.getCommunityTaskColumnInfo(i);return o.addColumn(a,!0,t,n),t&&NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[msgto="'+e+'"][columntype="'+ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK+'"].sortable-item .ico_system'),!0},a.addMurmurColumn=function(e,t,n,o){var i=this;if(!e)return!1;var a=ViewUtils.getMurmurColumnInfo(e);return t&&NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[jid="'+e+'"][columntype=18].sortable-item .ico_user'),CubeeServerConnector.getInstance().getMurmurColumnName(e).then(function(e){if("object"==_typeof(e.content)&&"boolean"==typeof e.content.result&&e.content.result&&"string"==typeof e.content.columnName){var r=decodeURIComponent(e.content.columnName);a._columnName=r,i.addColumn(a,!0,t,n,void 0,o)}}),!0},a.insertAfterColumn=function(e,o,i,a,r){function s(e){null!=r&&"function"==typeof r&&setTimeout(function(){r(e)},1)}function l(){s(A)}var u=this,c=!1;if(0==t({columnInfo:e}))return c;if(o&&0==t({beforeColumn:o}))return c;0!=i&&(i=!0);var d=u._getColumnIndex(e);if(console.log("_alreadyExistColumnIndex:"+d),d>=0){var g=!0,m=e.getColumnType();if(m==ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION){var _=u.getColumnList().get(d),f=_.getParentItemId();if(e.getParentItemId()!=f){var p=u.getColumnObjList().get(d);u.removeColumn(p,!0),g=!1}}if(g)return i&&(LayoutManager.switchToColumn(),u.bringColumnIntoView(d)),u.attentionColumn(d,a),s(d),!0}var m=e.getColumnType(),h=Utils.getSafeValue(n,m,ColumnView);if(void 0==h)return console.log("[insertAfterColumn] invalid columnType"+m),c;var C=null,v=TabManager.getInstance().getCurrentTabInfo(),y=v.type,T=e.getDisplayName(),b=e.getIconImage();if(C=new h(e,y),""!=T&&m==ColumnInformation.TYPE_COLUMN_CHAT&&(e.setDisplayName(T),""!=b&&e.setIconImage(b)),m==ColumnInformation.TYPE_COLUMN_TIMELINE&&ColumnTimelineView.setInstance(C),null==C)return c;var I=C._htmlElement,M=u._getColumnInnerContainer(),E=u.getColumnObjList(),S=E.getCount(),w=-2;if(null!=o){for(var N=0;S>N;N++)if(E.get(N)==o){w=N;break}}else w=-1;-1==w?(M.prepend(I),w+=1):-2==w?(M.append(I),w=M.children().length-1):(M.children().eq(w).after(I),w+=1);var A=w;return u.getColumnList().insert(A,e),u.getColumnObjList().insert(A,C),LayoutManager.switchToColumn(),ColumnIconArea.getInstance().insertIcon(A,e),i&&u.bringColumnIntoView(A),u.saveColumnList(l),u.attentionColumn(A,a),c=!0,ViewUtils.isIE89()&&SideListView.getInstance().resizeContents(),c},a.saveColumnList=function(e){function t(){null!=e&&"function"==typeof e&&e()}var n=this,o=n._columnListId,i=n.getColumnList();TabColumnStateStore.getInstance().setColumnList(o,i,t)},a._getColumnIndex=function(e){var n=this,o=-1,i=e.getColumnType(),a=e.getFilterCondition();if(0==t({filterCondition:a}))return o;for(var r=n.getColumnList().getCount(),s=0;r>s;s++){var l=n.getColumnList().get(s);if(l.getColumnType()==i){if(null==a){o=s;break}if(l.getFilterCondition()==a&&1==n._booleanColumnType(i)){o=s;break}if(i==ColumnInformation.TYPE_COLUMN_GROUP_CHAT&&l.getChatRoomInfomation().getRoomId()==e.getChatRoomInfomation().getRoomId()){o=s;break}if(i==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED&&l.getCommunityInfomation().getRoomId()==e.getCommunityInfomation().getRoomId()){o=s;break}if(i==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK&&l.getCommunityInfomation().getRoomId()==e.getCommunityInfomation().getRoomId()){o=s;break}if(i==ColumnInformation.TYPE_COLUMN_MURMUR&&null!=MurmurColumnInformation.getOwnJidFromSearchCondition(l)&&null!=MurmurColumnInformation.getOwnJidFromSearchCondition(e)&&MurmurColumnInformation.getOwnJidFromSearchCondition(l)==MurmurColumnInformation.getOwnJidFromSearchCondition(e)){o=s;break}}}return o},a._booleanColumnType=function(e){var t;switch(e){case ColumnInformation.TYPE_COLUMN_TIMELINE:case ColumnInformation.TYPE_COLUMN_CHAT:case ColumnInformation.TYPE_COLUMN_TASK:case ColumnInformation.TYPE_COLUMN_INBOX:case ColumnInformation.TYPE_COLUMN_MENTION:case ColumnInformation.TYPE_COLUMN_MAIL:case ColumnInformation.TYPE_COLUMN_RECENT:case ColumnInformation.TYPE_COLUMN_TOME:case ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION:case ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE:t=!0;break;default:t=!1}return t},a._getColumnElement=function(e){if(0==t({index:e}))return null;var n=this,o=n._getColumnInnerContainer();return o.children().eq(e)},a._resizeAllColumnWidth=function(){var e=this,t=$("body").outerWidth(!0),n=t,i=$("#listContainer"),a=$("#listInnerContainer"),r=$(i).outerWidth(!0);$(a).is(":hidden")&&(r=$("#toggler").outerWidth(!0)),LayoutManager.isMobile&&(r=0);var s=n-r;ViewUtils.isIE89()&&(s-=1);var l=$("#columnContainer"),u=$("#columnInnerContainer"),c=$(".column",l),d=c.length-$(".column[style*=display]",l).length;ViewUtils.isIE89()&&(c=$(".column",u),d=c.length-$(".column[style*=display]",u).length);var g=o;LayoutManager.isMobile&&(g=n);var m=d,_=Math.floor(s/g);d>_&&(m=_);var f=Math.floor((s-2)/m);d>_&&(f=g);var p=(c.outerWidth(!0),parseInt(c.css("marginLeft"))+parseInt(c.css("marginRight"))),h=f-p;if(c.css("width",h),l.css("width",s),ViewUtils.isIE89()){var C=38,v=76,y=$("#mainHeader").outerHeight(!0),T=$("#menubar").outerWidth(!0),b=($("#actionbar").outerWidth(!0),$("#menuoptionalfunction").outerWidth(!0));LayoutManager.isMobile?y!=C&&$("#mainHeader").css("height",C):T+b>t?y!=v&&$("#mainHeader").css("height",v):y!=C&&$("#mainHeader").css("height",C)}var I=$("body").outerHeight(!0),M=Conf.getVal("HEADER_CONTAINER_HEIGHT"),E=$("#mainHeader").outerHeight(!0),S=I-M-E,w=$("#mainContainer"),N=parseInt(w.css("marginTop"))+parseInt(w.css("marginBottom")),A=parseInt(w.css("borderTopWidth"))+parseInt(w.css("borderBottomWidth")),U=parseInt(w.css("paddingTop"))+parseInt(w.css("paddingBottom")),L=S-N-A-U;w.css("height",L),i.css("height",L),i.css("max-height",L),i.css("min-height",L),a.css("height",L),a.css("max-height",L),a.css("min-height",L),l.css("height",L),l.css("max-height",L),l.css("min-height",L);var R=e.getColumnObjList(),O=R.getCount();if(ViewUtils.isIE()){if(i.css("max-height",""),i.css("min-height",""),a.css("height",""),a.css("max-height",""),a.css("min-height",""),l.css("height",""),l.css("max-height",""),l.css("min-height",""),LayoutManager.isMobile)a.css("width",n),a.css("min-width",n),a.css("max-width",n);else if($(a).is(":hidden"));else{var P=r-$("#toggler").outerWidth(!0)-1;a.css("width",P),a.css("min-width",P),a.css("max-width",P)}i.css("height",L),a.css("height",L),l.css("height",L);var k=f*O+2;u.css("width",k),k>s?c.css("height",L-17):c.css("height",L)}LayoutManager.isMobile&&$(a).css("height",L),this._imageMaxWidth=h-85,$(".image-thumbnail").css("max-width",this._imageMaxWidth)},a.getTargetColumnsInfoArrayList=function(e){var t=this,n=new ArrayList,o=t._getTargetColumnsIndex(e);if(null==o)return n;for(var i=o.getCount(),a=0;i>a;a++){var r=o.get(a);if(null!=r){var s=t.getColumnList().get(r);null!=s&&n.add(s)}}return n},a._getTargetColumnsIndex=function(e){var n=this,o=null;if(0==t({message:e}))return o;var i=e.getType();switch(i){case Message.TYPE_PUBLIC:o=n._getPublicMessageTargetColumnsIndex(e);break;case Message.TYPE_CHAT:o=n._getChatMessageTargetColumnsIndex(e);break;case Message.TYPE_GROUP_CHAT:o=n._getGroupChatMessageTargetColumnsIndex(e);break;case Message.TYPE_TASK:o=n._getTaskMessageTargetColumnsIndex(e);break;case Message.TYPE_COMMUNITY:o=n._getCommunityMessageTargetColumnsIndex(e);break;case Message.TYPE_SYSTEM:o=n._getSystemMessageTargetColumnsIndex(e);break;case Message.TYPE_MAIL:o=n._getMailMessageTargetColumnsIndex(e);break;case Message.TYPE_QUESTIONNAIRE:o=n._getQuestionnaireMessageTargetColumnsIndex(e);break;case Message.TYPE_MURMUR:o=n._getMurmurMessageTargetColumnsIndex(e);break;default:console.log("ColumnManager::_getTargetColumnsIndex invalid _type:"+i)}return null==o&&(o=new ArrayList),n._getMessageTargetColumnsIndex(e,o),o},a._getMessageTargetColumnsIndex=function(e,n){if(0!=t({message:e,array:n}))for(var o=this,i=n,a=o.getColumnList().getCount(),r=null,s=0;a>s;s++){var l=o.getColumnList().get(s);if(r=l.getColumnType(),r==ColumnInformation.TYPE_COLUMN_SEARCH||r==ColumnInformation.TYPE_COLUMN_RECENT||r==ColumnInformation.TYPE_COLUMN_TOME||r==ColumnInformation.TYPE_COLUMN_FILTER||r==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK||r==ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER||r==ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION||r==ColumnInformation.TYPE_COLUMN_CUSTOM_MENTION){if(r!=ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION){if(l.getSearchCondition().isColmunChangeable(e)){i.add(s);continue}}else{var u=o.getColumnObjList().get(s);1==u.isShowableMessage(e)&&i.add(s)}if(e.getType()==Message.TYPE_TASK){var c=e.getParentItemId();if(null!=c&&""!=c){var d=CubeeController.getInstance().getMessage(c);if(null!=d&&l.getSearchCondition().isColmunChangeable(d)){i.add(s);continue}}}}}},a._getPublicMessageTargetColumnsIndex=function(e){var n=this,o=new ArrayList;if(0==t({message:e}))return o;var i=e.getType();if(i!=Message.TYPE_PUBLIC)return o;for(var a=n.getColumnList().getCount(),r=0;a>r;r++){var s=n.getColumnList().get(r),l=s.getColumnType();if(l==ColumnInformation.TYPE_COLUMN_TIMELINE)o.add(r);else if(l==ColumnInformation.TYPE_COLUMN_MENTION){var u=ViewUtils.isMentionMessage(e);u&&o.add(r)}}return o},a._getChatMessageTargetColumnsIndex=function(e){var n=this,o=new ArrayList;if(0==t({message:e}))return o;var i=e.getType();if(i!=Message.TYPE_CHAT)return o;var a=e.getDirection(),r=e.getFrom();a==ChatMessage.DIRECTION_SEND&&(r=e.getTo());for(var s=n.getColumnList().getCount(),l=0;s>l;l++){var u=n.getColumnList().get(l);if(u.getColumnType()==ColumnInformation.TYPE_COLUMN_CHAT){u.getFilterCondition();u.getFilterCondition()==r&&o.add(l)}}return o},a._getQuestionnaireMessageTargetColumnsIndex=function(e){var n=this,o=new ArrayList;if(0==t({message:e}))return o;var i=e.getType();if(i!=Message.TYPE_QUESTIONNAIRE)return o;for(var a=n.getColumnList().getCount(),r=e.getRoomType(),s=e.getRoomId(),l=0;a>l;l++){var u=n.getColumnList().get(l),c=u.getColumnType();if(c==ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE)o.add(l);else if(c==ColumnInformation.TYPE_COLUMN_TIMELINE)r==QuestionnaireRegister.ROOM_TYPE_FEED&&o.add(l);else if(c==ColumnInformation.TYPE_COLUMN_GROUP_CHAT){var d=u.getChatRoomInfomation(),g=d.getRoomId();r==QuestionnaireRegister.ROOM_TYPE_GROUPCHAT&&g==s&&o.add(l)}else if(c==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED){var m=u.getCommunityInfomation(),_=m.getRoomId();r==QuestionnaireRegister.ROOM_TYPE_COMMUNITY&&_==s&&o.add(l)}}return o},a._getTaskMessageTargetColumnsIndex=function(e){var n=this,o=new ArrayList;if(0==t({message:e}))return o;var i=e.getType();if(i!=Message.TYPE_TASK)return o;var a=CubeeController.getInstance().getMessage(e.getParentItemId()),r=[];r[0]=e,null!=a&&(r[1]=a);for(var s=n.getColumnList().getCount(),l=0;s>l;l++){var u=n.getColumnList().get(l);if(u.getColumnType()==ColumnInformation.TYPE_COLUMN_TASK||u.getColumnType()==ColumnInformation.TYPE_COLUMN_INBOX){if(u.getColumnType()==ColumnInformation.TYPE_COLUMN_INBOX){var c=e.getParentItemId(),d=e.getStatus(),g=e.getPreStatus();if((null==c||""==c)&&d!=TaskMessage.STATUS_INBOX&&g!=TaskMessage.STATUS_INBOX&&g!=TaskMessage.STATUS_UNKNOWN)continue;if((null==c||""==c)&&d!=TaskMessage.STATUS_INBOX&&g==TaskMessage.STATUS_UNKNOWN)continue}else if(u.getColumnType()==ColumnInformation.TYPE_COLUMN_TASK){var c=e.getParentItemId(),d=e.getStatus(),m=e.getOwnerJid(),_=LoginUser.getInstance().getJid();if(m==_&&(d==TaskMessage.STATUS_INBOX||null!=c&&""!=c&&d==TaskMessage.STATUS_ASSIGNING))continue}for(var f=u.getFilterCondition(),p=new TaskFilterAndSortCondition,h=p.getFilterObject(f),C=r.length,v=0;C>v;v++){var y=!1;for(key in h)if(""!=h[key]){var T=r[v].getPropertyByFilterKey(key);if(""!=T){for(var b=h[key].split(TaskFilterAndSortCondition.DELIMITER_STRING),y=!1,I=b.length,M=0;I>M;M++){if(b[M]==T){o.add(l),y=!0;break}if(key==TaskFilterAndSortCondition.FILTER_KEY_OWNER){if(b[M]==r[v].getPreOwnerJid()){o.add(l),y=!0;break}}else if(key==TaskFilterAndSortCondition.FILTER_KEY_STATUS&&b[M]==r[v].getPreStatus()){o.add(l),y=!0;break}}if(1==y)break}}if(1==y)break}}}return o},a._getSystemMessageTargetColumnsIndex=function(e){var n=this,o=new ArrayList;if(0==t({message:e}))return o;var i=e.getType();if(i!=Message.TYPE_SYSTEM)return o;for(var a=n.getColumnList().getCount(),r=0;a>r;r++){var s=n.getColumnList().get(r);s.getColumnType()==ColumnInformation.TYPE_COLUMN_TIMELINE&&""==s.getFilterCondition()&&o.add(r)}return o},a._getInboxMessageTargetColumnsIndex=function(e){var n=this,o=new ArrayList;if(0==t({message:e}))return o;var i=e.getType();if(i!=Message.TYPE_TASK)return o;var a=(CubeeController.getInstance().getMessage(e.getParentItemId()),[]);a[0]=e;for(var r=n.getColumnList().getCount(),s=0;r>s;s++){var l=n.getColumnList().get(s);if(l.getColumnType()==ColumnInformation.TYPE_COLUMN_INBOX)for(var u=l.getFilterCondition(),c=new TaskFilterAndSortCondition,d=c.getFilterObject(u),g=a.length,m=0;g>m;m++){var _=!1,f=a[m].getItemId(),p=CubeeController.getInstance().getChildrenTaskItemIds(f);if(null!=p)return o;for(key in d)if(""!=d[key]){var h=a[m].getPropertyByFilterKey(key);if(""!=h){for(var C=d[key].split(TaskFilterAndSortCondition.DELIMITER_STRING),_=!1,v=C.length,y=0;v>y;y++){if(C[y]==h){o.add(s),_=!0;break}if(key==TaskFilterAndSortCondition.FILTER_KEY_OWNER&&C[y]==a[m].getPreOwnerJid()){o.add(s),_=!0;break}}if(1==_)break}}if(1==_)break}}return o},a._getGroupChatMessageTargetColumnsIndex=function(e){var n=this,o=new ArrayList;if(0==t({message:e}))return o;for(var i=n.getColumnList().getCount(),a=null,r=0;i>r;r++){var s=n.getColumnList().get(r);a=s.getColumnType(),a==ColumnInformation.TYPE_COLUMN_GROUP_CHAT&&s.getSearchCondition().isColmunChangeable(e)&&o.add(r)}return o},a._getMailMessageTargetColumnsIndex=function(e){var t=this,n=new ArrayList;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return n;var o=e.getType();if(o!=Message.TYPE_MAIL)return n;for(var i=t._columnList.getCount(),a=0;i>a;a++){var r=t._columnList.get(a);r.getColumnType()==ColumnInformation.TYPE_COLUMN_MAIL&&n.add(a)}return n},a._getCommunityMessageTargetColumnsIndex=function(e){var n=this,o=new ArrayList;if(0==t({message:e}))return o;for(var i=n.getColumnList().getCount(),a=null,r=0;i>r;r++){var s=n.getColumnList().get(r);a=s.getColumnType(),a==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED&&s.getSearchCondition().isColmunChangeable(e)&&o.add(r)}return o},a._getMurmurMessageTargetColumnsIndex=function(e){var n=this,o=new ArrayList;if(0==t({message:e}))return o;for(var i=n.getColumnList().getCount(),a=null,r=0;i>r;r++){var s=n.getColumnList().get(r);a=s.getColumnType(),a==ColumnInformation.TYPE_COLUMN_MURMUR&&s.getSearchCondition().isColmunChangeable(e)&&o.add(r)}return o},a.showMessage=function(e){if(0==t({message:e}))return!1;var n=e.getType(),o=!1;switch(n){case Message.TYPE_PUBLIC:o=this._showMessage(e,"message");break;case Message.TYPE_CHAT:o=this._showMessage(e,"chat");break;case Message.TYPE_GROUP_CAHT:break;case Message.TYPE_TASK:break;case Message.TYPE_COMMUNITY:break;case Message.TYPE_SYSTEM:o=this._showMessage(e,"message");break;default:console.log("msg::type>>>"+n)}return o},a._showMessage=function(e,n){if(0==t({message:e,mode:n}))return!1;var o=this,i=!1,a=o._getTargetColumnsIndex(e);if(null==a)return i;for(var r=a.getCount(),s=NotificationSettingManager.getInstance(),l=-2;r>l;l++){var u,c,d,g;if(-1==l)u=null,c=null,d=null,g=SideMenuRecentView.getInstance();else if(-2==l){if(e.getType()!=Message.TYPE_MURMUR)continue;u=null,c=null,d=null,g=SideMenuMurmurView.getInstance()}else u=a.get(l),c=o.getColumnList().get(u),d=o.getColumnObjList(),g=d.get(u);switch(n){case"history":g.showHistoryMessage(e),i=!0;break;case"message":g.showMessage(e);var m=g.getType();(m==ColumnInformation.TYPE_COLUMN_MENTION||m==ColumnInformation.TYPE_COLUMN_TOME)&&(s.isSetting(m)||ColumnIconArea.getInstance().receiveMessage(u)),i=!0;break;case"chat":g.showMessage(e);var _=LoginUser.getInstance().getJid(),f=e.getFrom();if(_!=f){var m=g.getType();m!=ColumnInformation.TYPE_COLUMN_FILTER&&m!=ColumnInformation.TYPE_COLUMN_SEARCH&&m!=ColumnInformation.TYPE_COLUMN_RECENT&&m!=ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER&&(m==ColumnInformation.TYPE_COLUMN_TOME&&(f=null),s.isSetting(m,f)||ColumnIconArea.getInstance().receiveMessage(u))}else ColumnIconArea.getInstance().removeColumnNotificationIcon(u);i=!0;break;case"group-chat":break;case"mytask":break;case"community":break;case"system":break;default:console.log("ColumnManager::_showMessage invalid mode:"+n)}}return i},a.onNotification=function(n){var o=this,i=LoginUser.getInstance().getJid();if(0!=t({notification:n})){var a="",r=n.getType();switch(r){case Notification_model.TYPE_GOOD_JOB:var s=n;a=s.getItemId();var l=e(o.getColumnObjList());null!=l&&l.onGoodJobNotificationReceive(n);break;case Notification_model.TYPE_TASK:var u=n;a=u.getTaskMessage().getItemId();break;case Notification_model.TYPE_QUESTIONNAIRE:var c=n;a=c.getQuestionnaireMessage().getItemId();break;case Notification_model.TYPE_SYSTEM:var d=n;a=d.getSystemMessage().getItemId();break;case Notification_model.TYPE_MESSAGE_OPTION:var g=n,m=g.getContentType();if(a=g.getItemId(),m==MessageOptionNotification.CONTENT_TYPE_DEMAND_TASK)return void o.onDemandTaskNotification(g);var l=e(o.getColumnObjList());null!=l&&l.onMessageOptionNotificationReceive(n);break;case Notification_model.TYPE_DELETE_MESSAGE:var _=n;a=_.getItemId();break;case Notification_model.TYPE_GROUP_CHAT:var f=n,p=f.getSubType();if(p!=GroupChatNotification.SUB_TYPE_MESSAGE)break;a=f.getGroupChatMessage().getItemId();break;case Notification_model.TYPE_MAIL:var h=n;a=h.getMailMessage().getItemId();break;case Notification_model.TYPE_COMMUNITY:var C=n;a=C.getCommunityMessage().getItemId();break;case Notification_model.TYPE_MURMUR:var v=n,p=v.getSubType();p==MurmurNotification.SUB_TYPE_MESSAGE?a=v.getMurmurMessage().getItemId():p==MurmurNotification.SUB_TYPE_SET_COLUMN_NAME;break;case Notification_model.TYPE_THREAD_TITLE:var y=n;a=y.getThreadRootId();break;case Notification_model.TYPE_MESSAGE_UPDATE:a=n.getMessage().getItemId();for(var T=o.getColumnObjList(),b=0;b<T.getCount();b++){var I=T.get(b),M=I.getType(),E=o.getColumnList().get(b);(M==ColumnInformation.TYPE_COLUMN_SEARCH||M==ColumnInformation.TYPE_COLUMN_RECENT||M==ColumnInformation.TYPE_COLUMN_TOME||M==ColumnInformation.TYPE_COLUMN_FILTER||M==ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER)&&I.getMsgObjByItemId(n._message.getItemId())&&!E.getSearchCondition().isColmunChangeable(n.getMessage())&&(I.showUpdateMessage(n.getMessage()),I._getNotAvailableMessageHtmlIfMessageNothing(I._getMsgObjIndexList().getCount()))}break;case Notification_model.TYPE_EMOTION_POINT:a=n.getItemId();break;case Notification_model.TYPE_ASSIGN_NOTE:n.getThreadRootId()?a=n.getThreadRootId():n.getOldThreadRootId()&&(a=n.getOldThreadRootId());break;case Notification_model.TYPE_DELETE_NOTE:a=n.getThreadRootId()}if(null!=a&&""!=a){var S=CubeeController.getInstance().getMessage(a),w=[],N=new ArrayList;if(r==Notification_model.TYPE_THREAD_TITLE||r==Notification_model.TYPE_ASSIGN_NOTE||r==Notification_model.TYPE_DELETE_NOTE){for(var A=CubeeController.getInstance().getAllMessage(),U=[],b=0;b<A._length;b++){var L=A.get(b);L.getThreadRootId()==a&&(w.push(L.getItemId()),U.push(L))}r==Notification_model.TYPE_THREAD_TITLE&&(S=S?S:CubeeController.getInstance().getMessage(n.getItemId()),S=S?S:CubeeController.getInstance().getMessage(w[0]));for(var R=[],b=0;b<U.length;b++)R=R.concat(o._getTargetColumnsIndex(U[b])._array);R=R.filter(function(e,t,n){return n.indexOf(e)===t});for(var b=0;b<R.length;b++)N.insert(b,R[b])}var O=o._getTargetColumnsIndex(S);if(N._length&&(O=N),null!=O&&O.getCount()>=0)for(var P=O.getCount(),k=NotificationSettingManager.getInstance(),D=-2;P>D;D++){var V,x,Y;if(-1==D){if(V=null,x=null,Y=SideMenuRecentView.getInstance(),!Y.isGotHistory())continue}else if(-2==D){if(!(r==Notification_model.TYPE_MURMUR||"function"==typeof n.getMessage&&"function"==typeof n.getMessage().getType&&n.getMessage().getType()==Message.TYPE_MURMUR&&r==Notification_model.TYPE_MESSAGE_UPDATE||"function"==typeof n.getItemId&&0==n.getItemId().indexOf("murmur_")&&(r==Notification_model.TYPE_DELETE_MESSAGE||r==Notification_model.TYPE_MESSAGE_OPTION)||"function"==typeof n.getThreadTitle&&"function"==typeof n.getThreadRootId&&0==n.getThreadRootId().indexOf("murmur_")&&r==Notification_model.TYPE_THREAD_TITLE||"function"==typeof n.getThreadRootId&&0==n.getThreadRootId().indexOf("murmur_")&&r==Notification_model.TYPE_ASSIGN_NOTE||"function"==typeof n.getOldThreadRootId&&0==n.getOldThreadRootId().indexOf("murmur_")&&(r==Notification_model.TYPE_ASSIGN_NOTE||r==Notification_model.TYPE_DELETE_NOTE)||!("function"!=typeof n.getMsgType||n.getMsgType()!=Message.TYPE_UNKNOWN&&n.getMsgType()!=Message.TYPE_MURMUR||"function"!=typeof n.getItemId||0!=n.getItemId().indexOf("murmur_")||r!=Notification_model.TYPE_GOOD_JOB&&r!=Notification_model.TYPE_EMOTION_POINT)))continue;if(V=null,x=null,Y=SideMenuMurmurView.getInstance(),!Y.getColumnInfo().getSearchCondition().isColmunChangeable(S))continue}else V=O.get(D),x=o.getColumnObjList(),Y=x.get(V);var M=Y.getType();switch(r){case Notification_model.TYPE_GOOD_JOB:Y.onGoodJobReceive(a);break;case Notification_model.TYPE_EMOTION_POINT:Y.onEmotionPointReceive(a);break;case Notification_model.TYPE_TASK:var F=!0,H=u.getActionType();if(H==TaskNotification.ACTION_TYPE_ADD?Y.onAddMessageReceive(S):H==TaskNotification.ACTION_TYPE_UPDATE?Y.onUpdateMessageReceive(S):F=!1,M==ColumnInformation.TYPE_COLUMN_INBOX&&S.getOwnerJid()!=i&&(F=!1),M==ColumnInformation.TYPE_COLUMN_TASK){var G=Y.isAssigningTask(S);G&&(F=!1)}if((M==ColumnInformation.TYPE_COLUMN_FILTER||M==ColumnInformation.TYPE_COLUMN_SEARCH||M==ColumnInformation.TYPE_COLUMN_RECENT||M==ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION||M==ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER)&&(F=!1),F){var B=S.getUpdatedBy(),j=S.getOwnerJid(),$=S.getClient();i==B||j!=i&&$!=i||(View.getInstance().validBlinkTitleBar(800,View.getInstance().getTitle(),View.getInstance().getBlinkTitle()),k.isSetting(M)||ColumnIconArea.getInstance().receiveMessage(V))}break;case Notification_model.TYPE_SYSTEM:Y.onSystemMessageReceive(S);break;case Notification_model.TYPE_MESSAGE_OPTION:Y.onMessageOptionReceive(n);break;case Notification_model.TYPE_DELETE_MESSAGE:var J=_.getDeleteFlag(),q=_.getAdminDeleted();Y.deleteMessage(a,J,q);break;case Notification_model.TYPE_GROUP_CHAT:if(M!=ColumnInformation.TYPE_COLUMN_FILTER&&M!=ColumnInformation.TYPE_COLUMN_SEARCH&&M!=ColumnInformation.TYPE_COLUMN_RECENT&&M!=ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION&&M!=ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER&&i!=S.getFrom()){var K=null;M!=ColumnInformation.TYPE_COLUMN_TOME&&(K=Y.getColumnInfo().getChatRoomInfomation().getRoomId()),k.isSetting(M,K)||ColumnIconArea.getInstance().receiveMessage(V);
}Y.showMessage(S);break;case Notification_model.TYPE_MAIL:M!=ColumnInformation.TYPE_COLUMN_FILTER&&M!=ColumnInformation.TYPE_COLUMN_SEARCH&&M!=ColumnInformation.TYPE_COLUMN_RECENT&&M!=ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION&&M!=ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER&&(k.isSetting(M)||ColumnIconArea.getInstance().receiveMessage(V)),Y.onAddMessageReceive(S);break;case Notification_model.TYPE_COMMUNITY:if(M!=ColumnInformation.TYPE_COLUMN_FILTER&&M!=ColumnInformation.TYPE_COLUMN_SEARCH&&M!=ColumnInformation.TYPE_COLUMN_RECENT&&M!=ColumnInformation.TYPE_COLUMN_SHOW_CONVERSATION&&M!=ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER&&i!=S.getFrom()){var K=null;M!=ColumnInformation.TYPE_COLUMN_TOME&&Y.getColumnInfo()&&(K=Y.getColumnInfo().getCommunityInfomation().getRoomId()),k.isSetting(M,K)||ColumnIconArea.getInstance().receiveMessage(V)}Y.showMessage(S);break;case Notification_model.TYPE_MURMUR:Y.showMessage(S);break;case Notification_model.TYPE_THREAD_TITLE:Y.onThreadTitleUpdateReceived(w,n);break;case Notification_model.TYPE_MESSAGE_UPDATE:Y.onMessageUpdateReceived(n);break;case Notification_model.TYPE_ASSIGN_NOTE:case Notification_model.TYPE_DELETE_NOTE:Y.onNoteAssignChangedReceived(w,n);break;case Notification_model.TYPE_QUESTIONNAIRE:var F=!0,H=c.getActionType();H==QuestionnaireNotification.ACTION_TYPE_ADD?Y.onAddMessageReceive(S):H==QuestionnaireNotification.ACTION_TYPE_UPDATE?Y.onUpdateQuestionnaireMessageReceive(S):F=!1}}if(r==Notification_model.TYPE_MESSAGE_OPTION){var g=n,m=g.getContentType();if(m==MessageOptionNotification.CONTENT_TYPE_SET_READ_MESSAGE){var W=g.getExistingReaderItem();if(null!=W){var z=W.getPerson();if(null!=z){var Q=z.getJid();if(Q==LoginUser.getInstance().getJid()){if(null!=S){for(var X=o.getTargetColumnsInfoArrayList(S),Z=X.getCount(),D=0;Z>D;D++){var ee=X.get(D);ColumnIconArea.getInstance().removeColumnNotificationIconByColumnInformation(ee)}NotificationIconManager.getInstance().removeColumnNotificationIconByMessage(S)}o.updateMessageReadStatus(a,Message.READ_STATUS_READ)}}}}}var te=o._getPersonListDialogObj();null!=te&&te.onNotification(n)}}},a.onLoginUserRemoveGroupChatMemberNotification=function(e){var n=this;LoginUser.getInstance().getJid();if(0!=t({notification:e})){var o=e.getType();if(o==Notification_model.TYPE_GROUP_CHAT){var i=e.getSubType();if(i==GroupChatNotification.SUB_TYPE_REMOVE_MEMBER)for(var a=e.getRoomInfo().getRoomId(),r=n.getColumnList().getCount(),s=0;r>s;s++){var l=n.getColumnList().get(s),u=l.getColumnType();if(u==ColumnInformation.TYPE_COLUMN_GROUP_CHAT&&l.getChatRoomInfomation().getRoomId()==a){var c=n.getColumnObjList().get(s);c.notifyRemoveMember(e)}}}}},a.onGroupChatAuthorityChangedNotication=function(e){var n=this;LoginUser.getInstance().getJid();if(0!=t({notification:e})){var o=e.getType();if(o==Notification_model.TYPE_GROUP_CHAT){var i=e.getSubType();if(i==GroupChatNotification.SUB_TYPE_AUTHORITY_CHANGED)for(var a=e.getRoomInfo().getRoomId(),r=n.getColumnList().getCount(),s=0;r>s;s++){var l=n.getColumnList().get(s),u=l.getColumnType();if(u==ColumnInformation.TYPE_COLUMN_GROUP_CHAT&&l.getChatRoomInfomation().getRoomId()==a){var c=n.getColumnObjList().get(s);c.showChangedAuthorityMessage()}}}}},a.onLoginUserRemoveCommunityMemberNotification=function(e){var n=this;LoginUser.getInstance().getJid();if(0!=t({notification:e})){var o=e.getType();if(o==Notification_model.TYPE_COMMUNITY){var i=e.getSubType();if(i==CommunityNotification.SUB_TYPE_REMOVE_MEMBER)for(var a=e.getRoomId(),r=n.getColumnList().getCount(),s=0;r>s;s++){var l=n.getColumnList().get(s),u=l.getColumnType();if(u==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED&&l.getCommunityInfomation().getRoomId()==a){var c=n.getColumnObjList().get(s);c.notifyRemoveMember(e)}}}}},a.onCommunityInfoUpdateNotication=function(e){var n=this;LoginUser.getInstance().getJid();if(0!=t({notification:e})){var o=e.getType();if(o==Notification_model.TYPE_COMMUNITY){var i=e.getSubType();if(i==CommunityNotification.SUB_TYPE_UPDATE_ROOM_INFO)for(var a=e.getUpdatedCommunityInfo(),r=a.getRoomId(),s=n.getColumnList().getCount(),l=0;s>l;l++){var u=n.getColumnList().get(l),c=u.getColumnType();if((c==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED||c==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK)&&u.getCommunityInfomation().getRoomId()==r){var d=n.getColumnObjList().get(l);d.onCommunityInfoUpdateNotication(e)}}}}},a.onCommunityAuthorityChangedNotication=function(e){var n=this;LoginUser.getInstance().getJid();if(0!=t({notification:e})){var o=e.getType();if(o==Notification_model.TYPE_COMMUNITY){var i=e.getSubType();if(i==CommunityNotification.SUB_TYPE_AUTHORITY_CHANGED){for(var a=e.getRoomId(),r=n.getColumnList().getCount(),s=0;r>s;s++){var l=n.getColumnList().get(s),u=l.getColumnType();if(u==ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED&&l.getCommunityInfomation().getRoomId()==a){var c=n.getColumnObjList().get(s);c.showChangedAuthorityMessage()}u==ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK&&l.getCommunityInfomation().getRoomId()==a&&$("#columnInnerContainer").children("div").eq(s).find(".column-community-task-frm-message").children("button").eq(0).trigger("mousedown")}$(".project_btn").attr("data_value")==a&&TabManager.getInstance().isCreateGroupchat(a)}}}},a.onDemandTaskNotification=function(e){function n(e,t){var n=null;if(null==e)return n;if(null==t)return n;for(var i=t.getCount(),a=0;i>a;a++){var r=t.get(a);o(e,r)||e.add(r)}return n=e}function o(e,t){for(var n=0;n<e.getCount();n++)if(t==e.get(n))return!0;return!1}var i=this;if(0!=t({notification:e})){var a="",r=e.getType();if(r==Notification_model.TYPE_MESSAGE_OPTION){var s=e,l=s.getContentType();if(l==MessageOptionNotification.CONTENT_TYPE_DEMAND_TASK){var u;a=s.getItemId();var c=CubeeController.getInstance().getMessage(a),d=c.getParentItemId(),g=CubeeController.getInstance().getMessage(a),m=i._getTargetColumnsIndex(g);if(null!=m&&0!=m.getCount()){var _=null;""!=d&&(_=CubeeController.getInstance().getMessage(d));var f=i._getTargetColumnsIndex(_);if(u=null==f||0==f.getCount()?m:n(m,f),null!=u&&0!=u.getCount())for(var p=u.getCount(),h=0;p>h;h++){var C=u.get(h),v=i.getColumnObjList(),y=v.get(C);y.onMessageOptionReceive(e)}}}}}},a.onAddMember=function(e,n){if(0!=t({columnInfo:e,array:n})){var o=this,i=e.getColumnType(),a=-1;switch(i){case ColumnInformation.TYPE_COLUMN_TIMELINE:case ColumnInformation.TYPE_COLUMN_CHAT:case ColumnInformation.TYPE_COLUMN_MENTION:case ColumnInformation.TYPE_COLUMN_TASK:case ColumnInformation.TYPE_COLUMN_INBOX:case ColumnInformation.TYPE_COLUMN_SEARCH:case ColumnInformation.TYPE_COLUMN_MAIL:case ColumnInformation.TYPE_COLUMN_RECENT:break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:if(a=o._getColumnIndex(e),0>a)break;var r=o._columnObjList.get(a);r.onAddMember(n);break;default:return void console.log("[onAddMember] invalid columnType"+i)}}},a.onRemoveMember=function(e,n){if(0!=t({columnInfo:e,array:n})){var o=this,i=e.getColumnType(),a=-1;switch(i){case ColumnInformation.TYPE_COLUMN_TIMELINE:case ColumnInformation.TYPE_COLUMN_CHAT:case ColumnInformation.TYPE_COLUMN_MENTION:case ColumnInformation.TYPE_COLUMN_TASK:case ColumnInformation.TYPE_COLUMN_INBOX:case ColumnInformation.TYPE_COLUMN_SEARCH:case ColumnInformation.TYPE_COLUMN_FILTER:case ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER:case ColumnInformation.TYPE_COLUMN_MAIL:case ColumnInformation.TYPE_COLUMN_RECENT:case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:if(a=o._getColumnIndex(e),0>a)break;var r=o._columnObjList.get(a);r.onRemoveMember(n);break;default:return void console.log("[onRemoveMember] invalid columnType"+i)}}},a.onChangeRoomName=function(e,n){if(0!=t({columnInfo:e,chatRoomInfo:n})){var o=this,i=e.getColumnType(),a=-1;switch(i){case ColumnInformation.TYPE_COLUMN_TIMELINE:case ColumnInformation.TYPE_COLUMN_CHAT:case ColumnInformation.TYPE_COLUMN_MENTION:case ColumnInformation.TYPE_COLUMN_TASK:case ColumnInformation.TYPE_COLUMN_INBOX:case ColumnInformation.TYPE_COLUMN_SEARCH:case ColumnInformation.TYPE_COLUMN_FILTER:case ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER:case ColumnInformation.TYPE_COLUMN_MAIL:case ColumnInformation.TYPE_COLUMN_RECENT:case ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED:case ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK:break;case ColumnInformation.TYPE_COLUMN_GROUP_CHAT:if(a=o._getColumnIndex(e),0>a)break;var r=o._columnObjList.get(a);r.onChangeRoomName(n);break;default:return void console.log("[onChangeRoomName] invalid columnType"+i)}}},a.onChangeGroupChatPrivacyType=function(e,n){if(0!=t({columnInfo:e,chatRoomInfo:n})){var o=this;if(_idx=o._getColumnIndex(e),!(_idx<0)){var i=o._columnObjList.get(_idx);i.onChangeGroupChatPrivacyType(n)}}},a.removeColumn=function(e,n){function o(){for(var t=i.getColumnObjList(),n=t.getCount(),o=0;n>o;o++)if(t.get(o)==e){e.cleanup(),r=o,t.remove(o),i.getColumnList().remove(o);break}ColumnIconArea.getInstance().removeIcon(r),null!=a&&(a.find("*").off(),a.off(),a.find("*").remove(),a.remove()),i.saveColumnList(),ViewUtils.isIE89()&&SideListView.getInstance().resizeContents()}var i=this;if(0!=t({columnObject:e})){var a=e.getHtmlElement();if(null!=a){var r=0;null!=n&&0!=n||null==a?(o(),a=null):a.hide("clip","fast",function(){o(),$(this).off(),e=null,a=null})}}},a.hasShowableColumnByMessage=function(e){var t=this,n=t._getTargetColumnsIndex(e);if(null==n||0==n.getCount())return!1;for(var o=!1,i=n.getCount(),a=ViewUtils.isMentionMessage(e),r=0;i>r;r++){var s=n.get(r),l=t._columnObjList.get(s),u=l.getType();if(a){if(u!=ColumnInformation.TYPE_COLUMN_TIMELINE&&u!=ColumnInformation.TYPE_COLUMN_FILTER&&u!=ColumnInformation.TYPE_COLUMN_SEARCH&&u!=ColumnInformation.TYPE_COLUMN_RECENT&&u!=ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER){o=!0;break}}else if(u!=ColumnInformation.TYPE_COLUMN_FILTER&&u!=ColumnInformation.TYPE_COLUMN_SEARCH&&u!=ColumnInformation.TYPE_COLUMN_RECENT&&u!=ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER){o=!0;break}}return o},a.isDisplayedByItemId=function(e){var t=this,n=!1,o=CubeeController.getInstance().getMessage(e);if(null==o)return n;for(var i=t.getColumnObjList(),a=t.getColumnList().getCount(),r=null,s=0;a>s;s++){var l=i.get(s);if(r=l.getType(),r!=ColumnInformation.TYPE_COLUMN_FILTER&&r!=ColumnInformation.TYPE_COLUMN_SEARCH&&r!=ColumnInformation.TYPE_COLUMN_RECENT&&r!=ColumnInformation.TYPE_COLUMN_MENTION&&r!=ColumnInformation.TYPE_COLUMN_CUSTOM_FILTER){var u=l.getMsgObjByItemId(e);if(null!=u){n=!0;break}}}return n},a.getDemandTaskCount=function(e){var n=this;if(0==t({columnInfo:e}))return!1;var o=n._getColumnIndex(e);if(0>o)return!1;var i=n._columnObjList.get(o);return i.getDemandTaskCount()},a.bringColumnIntoView=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=this;if(0!=t({index:e})){var i=o.getColumnObjList(),a=i.get(e);if(null!=a){var r=a.getHtmlElement();if(null!=r){LayoutManager.resetScreenLayout(),LayoutManager.iconAreaScrollToShow(e);var s;s=$("#left_sidebar").offset().left<0?0:parseInt($("#left_sidebar").width());var l=r.offset().left;l-=s+parseInt($("#columnInnerContainer").css("padding-left"));var u=parseInt(r.width())+parseInt($("#columnInnerContainer").children("div").eq(0).css("margin-right")),c=-Math.floor(-r.offset().left+$("#columnInnerContainer").children("div").eq(0).offset().left),d=o._getColumnContainer();if(l>0){var g=l+u,m=parseInt(d.width());if(!(g>m))return void n();c=c-m+u+40}else c=c;0>c&&(c=0),d.animate({scrollLeft:c},"slow",n),d=null}}}},a.bringLeftMostColumn=function(){var e=this,t=e._columnObjList.get(0);if(null!=t){var n=t.getHtmlElement();if(null!=n){var o=n.offset().left,i=e._getColumnContainer();i.animate({scrollLeft:o},50)}}},a.updateColumnIconTitle=function(e){for(var t=this,n=-1,o=t.getColumnObjList(),i=o.getCount(),a=0;i>a;a++)if(o.get(a)==e){n=a;break}return 0>n?void console.log("ColumnManager::updateColumnIcon : index is not found"):void ColumnIconArea.getInstance().updateIconTitle(n)},a.updateColumnIcon=function(e){for(var t=this,n=-1,o=t.getColumnObjList(),i=o.getCount(),a=0;i>a;a++)if(o.get(a)==e){n=a;break}0>n||ColumnIconArea.getInstance().updateColumnIcon(n)},a.showPersonListDialog=function(e){var t=this;null!=e&&(e.showDialog(),t._setPersonListDialogObj(e))},a.closePersonListDialog=function(){var e=this;e._personListDialogObj=null},a.sortColumn=function(e,n,o){var i=this,a=!1;if(0==t(_defineProperty({index:e},"index",n)))return a;0!=o&&(o=!0);var r=i.getColumnObjList(),s=r.get(e);if(null==s)return a;if(o){var l=s.getHtmlElement();if(null==l)return a;var u=null,c=0;if(0==n)u=i._getColumnElement(n),l.detach(),u.before(l),c=n;else{var d=-1;if(d=n>e?n:n-1,u=i._getColumnElement(d),null==u)return a;l.detach(),u.after(l),c=d+1}}return i.getColumnList().move(e,n),i.getColumnObjList().move(e,n),i.saveColumnList(),a=!0},a.sortColumnByColumnView=function(e,t){var n=this;return _ret=n.sortColumn(e,t,!1),_ret},a.attentionColumn=function(e,n){if(n){var o=this;if(0==t({index:e}))return;var i=o.getColumnObjList(),a=i.get(e);if(null==a)return;var r=a.getHtmlElement();if(null==r)return;if(ViewUtils.isIE89())var s="div.column-header-title";else var s="div.column-header > div[title]";$(s,r).fadeOut(this._attentionColumnBlinkTime).fadeIn(this._attentionColumnBlinkTime).fadeOut(this._attentionColumnBlinkTime).fadeIn(this._attentionColumnBlinkTime).fadeOut(this._attentionColumnBlinkTime).fadeIn(this._attentionColumnBlinkTime).fadeOut(this._attentionColumnBlinkTime).fadeIn(this._attentionColumnBlinkTime)}},a.updateMessageReadStatus=function(e,t){function n(){function s(){a++,setTimeout(n,r)}if(!(a>=i)){var l;if(l=-1==a?SideMenuRecentView.getInstance():-2==a?SideMenuMurmurView.getInstance():o.getColumnObjList().get(a),null==l)return void s();l.updateMessageReadStatus(e,t),s()}}var o=this,i=o.getColumnObjList().getCount(),a=-2,r=1;setTimeout(n,r)},a._getChatroomInformationFromColumnObjByRoomId=function(e){for(var t=this,n=null,o=t.getColumnObjList(),i=o.getCount(),a=0;i>a;a++)if(o.get(a).getType()==ColumnInformation.TYPE_COLUMN_GROUP_CHAT){var r=o.get(a),s=r._info;if(s){var l=s.getChatRoomInfomation();if(l&&l.getRoomId()==e){n=l;break}}}return n}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,n,o,i){var a="";return a+='<div draggable="false" class="box-border olient-vertical system-message read-message">',a+='<div class="box-border olient-horizontal message-header">',a+='<div class="message-info"/>',ViewUtils.isIE89()&&(a+="<table><tr><td>"),a+='<div class="block-avatar"><img class="avatar" alt="'+Conf.getVal("PRODUCT_NAME")+'" src="images/cubee.png"></div>',ViewUtils.isIE89()&&(a+="</td><td>"),a+='<div class="flex1 block-info">',a+='<div class="sender-name">'+Conf.getVal("PRODUCT_NAME")+"</div>",a+='<div class="message-time">'+n+"</div>",a+="</div></div>",ViewUtils.isIE89()&&(a+="</td></tr></table>"),a+='<div class="box-border olient-vertical message-info">',a+='<div class="message-body">'+e+"</div>",a+=o,null!=i&&"string"==typeof i&&""!=i&&(a+='<div class="box-border pack-end good-job">',a+=i,a+="</div>"),a+="</div>",a+=t.getMessageFooterHtml(),a+="</div><!-- .system-message -->"}ColumnSystemMessageView.prototype=$.extend({},ColumnMessageView.prototype);var t=ColumnMessageView.prototype,n=ColumnSystemMessageView.prototype;n.getMessageHtml=function(){var t="",n=this.getMessage(),o=Utils.getDate(n.getDate(),Utils.DISPLAY_STANDARD_DATE_FORMAT),i=n.getMessage(),a=ViewUtils.removeAttachmentUrl(i),r=ViewUtils.urlAutoLink(n.getUIShortenUrls(),a,!0,null,!1,n.getItemId()),s=this.getMessageBodyThumbnailImageHtml(n),l=ColumnMessageGoodJobButton.getHtml(n.getGoodJobList());return t+=e(r,o,s,l)},ColumnSystemMessageView.getOfflineMessageHtml=function(){var t="",n=Utils.getDate(Utils.DISPLAY_STANDARD_DATE_FORMAT),o=Resource.getMessage("system_message_server_disconnected"),i="",a="";return t+=e(o,n,i,a)},ColumnSystemMessageView.getNotReferableMessageHtml=function(t){var n="",o=Utils.getDate(Utils.DISPLAY_STANDARD_DATE_FORMAT),i=t,a="",r="";return n+=e(i,o,a,r)},n._setReadMessage=function(){}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){var n="",o=e.getId(),i=e.getItemId(),a=e.getTitle(),r=Utils.convertEscapedHtml(a,!1),s=Utils.convertEscapedTag(a),l=e.getClient(),u=e.getOwnerJid(),c=null==e.getStartDate()?"":Utils.getDate(e.getStartDate(),Utils.DISPLAY_STANDARD_DATE_FORMAT),d="";e.getDemandStatus();d=e.getStatus()>=TaskMessage.STATUS_FINISHED&&null!=e.getCompleteDate()?Utils.getDate(e.getCompleteDate(),Utils.DISPLAY_STANDARD_DATE_FORMAT):null==e.getDueDate()?"":Utils.getDate(e.getDueDate(),Utils.DISPLAY_STANDARD_DATE_FORMAT);var g="",m="";if(e.getStatus()>=TaskMessage.STATUS_ASSIGNING){var _=e.getCommunityName();null!=_&&""!=_&&(g=Utils.convertEscapedHtml(" <"+_+">",!1),m=Utils.convertEscapedTag(" <"+_+">"))}n+='<div class="box-border olient-horizontal message-header task-message-header">',n+='<div class="message-info" messageid="'+(null==o?"":o)+'" itemid="'+i+'" />',ViewUtils.isIE89()&&(n+='<table class="width-100" style="table-layout: fixed;"><tr><td style="width:30px;">');var f=e.getProfileMap(),p=null,h=new Person;return l?(p=f.getByKey(l),h=ViewUtils.createPersonByProfile(l,p),n+=ViewUtils.getAvatarDataHtmlFromPerson(h,"avatar "+ColumnTaskMessageView.TASK_MESSAGE_ICON_CLS_NAME)):u?(p=f.getByKey(u),h=ViewUtils.createPersonByProfile(u,p),n+=ViewUtils.getAvatarDataHtmlFromPerson(h,"avatar "+ColumnTaskMessageView.TASK_MESSAGE_ICON_CLS_NAME)):n+=t(),ViewUtils.isIE89()&&(n+="</td><td>"),n+='<div class="flex1 block-info">',n+='<div class="task-name">',n+='<div class="text-overflow-ellipsis-nosize box-border-for-abbreviation" title="'+s+m+'">'+r+g+"</div>",n+="</div>",n+='<div class="message-time message-time-task">',n+="<div>"+Resource.getMessage("task_startdate_label")+Resource.getMessage("label_separator")+c+"</div>",n+="<div>"+Resource.getMessage("task_enddate_label")+Resource.getMessage("label_separator")+d+"</div>",n+="</div></div>",ViewUtils.isIE89()&&(n+="</td></tr></table>"),n+="</div>"}function t(){var e="";return e+="<div>",e+='<img class="avatar '+ColumnTaskMessageView.TASK_MESSAGE_ICON_CLS_NAME+'" src="images/blank.png">',e+="</div>"}function n(e){var t="",n=e.getClient(),o=e.getOwnerJid(),i=CubeeController.getInstance().getChildrenTaskItemIds(e.getItemId()),s=c(e),l=!1;null!=i&&(l=!0);var u=ViewUtils.requestTaskStatusNumToStr(s,l),_=d(s),f=new ArrayList,p=0;if(null!=i){p=i.getCount();for(var h=0;p>h;h++){var C=CubeeController.getInstance().getMessage(i.get(h));null!=C&&f.add(C)}}p=f.getCount();var v=!1;t+='<div class="message-footer">',t+='<div class="olient-horizontal box-border width-100 task-footer-contents cf">';var y=e.getSiblingTaskDataList(),T=y.getCount();ViewUtils.isIE89()&&(t+='<table class="width-100"><tr><td class="width-100">'),t+='<div class="task-assign box-border-only-ms-webkit flex1">';var b=Utils.convertEscapedHtml(r(e,n)),I=Utils.convertEscapedHtml(r(e,o)),M=Utils.convertEscapedTag(r(e,n)),E=Utils.convertEscapedTag(r(e,o));if(n!=o)t+='<div class="task-client box-border-for-abbreviation" title="'+M+'">'+b+"</div>",t+='<div class="task-assign-separator box-border">'+Resource.getMessage("task_user_arrow")+"</div>",t+='<div class="task-owner box-border-for-abbreviation" title="'+E+'">'+I+"</div>";else if(p>0){var S=!1;if(e.getStatus()>=TaskMessage.STATUS_ASSIGNING){var w=e.getCommunityName();null!=w&&""!=w&&(S=!0)}if(S||1!=p)v=!0,t+='<div class="task-client box-border-for-abbreviation" title="'+M+'">'+b+"</div>",t+='<div class="task-assign-separator box-border">'+Resource.getMessage("task_user_arrow")+"</div>",t+='<div class="task-owner box-border">'+p+Resource.getMessage("task_user_count")+"</div>";else{t+='<div class="task-client box-border-for-abbreviation" title="'+E+'">'+I+"</div>",t+='<div class="task-assign-separator box-border">'+Resource.getMessage("task_user_arrow")+"</div>";var C=f.get(0),N=Utils.convertEscapedHtml(r(C,C.getOwnerJid())),A=Utils.convertEscapedTag(r(C,C.getOwnerJid()));t+='<div class="task-owner box-border-for-abbreviation',(null===e.getMessage()||""===e.getMessage())&&(t+=" flex1"),t+='" title="'+A+'">'+N+"</div>"}}else t+='<div class="task-client-owner box-border-for-abbreviation" title="'+M+'">'+Resource.getMessage("task_owner")+b+"</div>";var U=e.getMessage();if((null!=U&&""!=U||!S&&p>1||S&&p>0)&&(t+='<a class="task_toggle_btn ico_btn"><i class="fa fa-caret-down"></i></a>'),T>0&&(t+='<div class="task-sibling-area box-border">('+Resource.getMessage("task_user_other")+T+Resource.getMessage("task_user_count")+")</div>"),t+="</div>",ViewUtils.isIE89()&&(t+="</td><td>"),v){var L=g(f);t+='<div class="multi-owner-task-status-view task-status-view">';for(var h=0;h<L.length;h++)t+=m(h,L[h]);t+="</div>"}else s!=TaskMessage.STATUS_INBOX&&(t+='<div class="task-status-view '+_+'">'+u+"</div>");if(t+="</div>",ViewUtils.isIE89()&&(t+="</td></tr></table>"),v){t+='<div class="children-task-assign-area box-border width-100">',t+='<div class="children-task-padding"/>',t+='<div class="children-task-assign box-border olient-vertical flex1">';for(var h=0;p>h;h++){var C=f.get(h);null!=C&&(t+=a(C,e,l))}t+="</div>",t+="</div>"}return t+="</div>"}function o(e,t){function n(e,t){if(null==e){if(null!=t)return!1}else{if(null==t)return!1;if(e.getTime()!=t.getTime())return!1}return!0}var o=0;e.getTitle()!=t.getTitle()&&(o|=ColumnTaskMessageView.ChangedTitle),e.getMessage()!=t.getMessage()&&(o|=ColumnTaskMessageView.ChangedMessage),e.getPriority()!=t.getPriority()&&(o|=ColumnTaskMessageView.ChangedPriority);var i=e.getStartDate(),a=t.getStartDate();0==n(i,a)&&(o|=ColumnTaskMessageView.ChangedStartDate),i=e.getDueDate(),a=t.getDueDate(),0==n(i,a)&&(o|=ColumnTaskMessageView.ChangedDueDate);var r=e.getStatus();return(r==TaskMessage.STATUS_FINISHED||r==TaskMessage.STATUS_REJECTED)&&null!=e.getCompleteDate()&&(o&=~ColumnTaskMessageView.ChangedDueDate,o|=ColumnTaskMessageView.ChangedCompleteDate),o}function i(e,t,n){var o="";if(0!=n){if(o+='<div class="flex1 block-info">',n&ColumnTaskMessageView.ChangedTitle){o+='<div class="task-name">';var i=Utils.convertEscapedHtml(e.getTitle(),!1),a=Utils.convertEscapedTag(e.getTitle());o+='<div class="box-border-for-abbreviation" title="'+a+'">',o+="["+Resource.getMessage("task_name")+"]",o+=i+"</div>",o+="</div>"}if(n&(ColumnTaskMessageView.ChangedStartDate|ColumnTaskMessageView.ChangedDueDate|ColumnTaskMessageView.ChangedCompleteDate)){var r;o+='<div class="message-time message-time-task">',n&ColumnTaskMessageView.ChangedStartDate&&(r=e.getStartDate(),r=null==r?"":Utils.getDate(r,Utils.DISPLAY_STANDARD_DATE_FORMAT),o+="<div>"+Resource.getMessage("task_startdate_label")+Resource.getMessage("label_separator")+r+"</div>"),n&ColumnTaskMessageView.ChangedDueDate&&(r=e.getDueDate(),r=null==r?"":Utils.getDate(r,Utils.DISPLAY_STANDARD_DATE_FORMAT),o+="<div>"+Resource.getMessage("task_enddate_label")+Resource.getMessage("label_separator")+r+"</div>"),n&ColumnTaskMessageView.ChangedCompleteDate&&(r=e.getCompleteDate(),r=null==r?"":Utils.getDate(r,Utils.DISPLAY_STANDARD_DATE_FORMAT),o+="<div>"+Resource.getMessage("task_enddate_label")+Resource.getMessage("label_separator")+r+"</div>"),o+="</div>"}if(n&ColumnTaskMessageView.ChangedPriority){switch(o+='<div class="task-priority-string">['+Resource.getMessage("task_priority_title")+"]",e.getPriority()){case TaskMessage.PRIORITY_LOW:o+=Resource.getMessage("task_priority_low");break;case TaskMessage.PRIORITY_MEDIUM:o+=Resource.getMessage("task_priority_medium");break;case TaskMessage.PRIORITY_HIGH:o+=Resource.getMessage("task_priority_high");break;case TaskMessage.PRIORITY_TOP:o+=Resource.getMessage("task_priority_top")}o+="</div>"}n&ColumnTaskMessageView.ChangedMessage&&(o+='<div class="task-content">',o+="<pre>",o+="["+Resource.getMessage("task_body_placeholder")+"]",o+=e.getMessage(),o+="</pre>",o+="</div>"),o+="</div>"}return o}function a(e,t,n){var a="";a+='<div class="olient-vertical">';var s=e.getOwnerJid(),l=e.getItemId();a+='<div class="child-task-owner-jid olient-horizontal box-border width-100" ownerjid="'+s+'" itemid="'+l+'">';var u=Utils.convertEscapedHtml(r(e,s)),c=Utils.convertEscapedTag(r(e,s)),g=e.getProfileMap().getByKey(s),m=ViewUtils.getAvatarUrl(g);a+='<div class="child-task-owner box-border-for-abbreviation flex1" title="'+c+'">';var _="images/user_noimage.png";if(m==_){var f=new Person;f.setJid(s),f._profile=g,a+='<span class="ico ico_user child-task-avatar">'+ViewUtils.getDefaultAvatarHtml(f)+"</span>"+u,f._profile=null}else a+='<img class="child-task-avatar" src="'+m+'" />'+u;a+="</div>";var p=e.getStatus(),h=ViewUtils.requestTaskStatusNumToStr(p,n),C=d(p);p!=TaskMessage.STATUS_INBOX&&(a+='<div class="child-task-status-view task-status-view '+C+'">'+h+"</div>"),ViewUtils.isIE89()&&(a+="</td></tr></table>"),a+="</div>";var v=o(e,t);return a+=i(e,t,v),a+="</div>"}function r(e,t){var n="";if(!e||!t)return n;var o=e.getProfileMap().getByKey(t);if(!o||"object"!=("undefined"==typeof o?"undefined":_typeof(o)))return n;var i=o.getNickName();(null==i||""==i)&&(i=ViewUtils.getUserName(t));var a=s(o);return i+a}function s(e){var t="",n=Profile.STATUS_UNKNOWN;return null!=e&&(n=e.getStatus()),t=ViewUtils.getUserStatusString(n)}function l(e){var t="",n=e.getItemId(),o=e.getClient();return t+='<form class="edit-area display-none">',t+='<img class="action-update-task action-button-base" src="images/add_send.png">',t+='<div class="width-100">',t+='  <div class="edit-task-client edit-task-label">'+Resource.getMessage("task_client")+'<span class="edit-task-label-margin">&nbsp;</span>'+Utils.convertEscapedHtml(ViewUtils.getUserName(o))+"</div>",t+='  <div class="edit-task-priority box-border olient-horizontal">',t+='    <div class="edit-task-label">'+Resource.getMessage("task_priority_title")+'<span class="edit-task-label-margin">&nbsp;</span></div>',t+='    <select id="task-priority" class="ui-corner-all flex1">',t+='      <option value="'+TaskMessage.PRIORITY_LOW+'">'+Resource.getMessage("task_priority_low")+"</option>",t+='      <option value="'+TaskMessage.PRIORITY_MEDIUM+'">'+Resource.getMessage("task_priority_medium")+"</option>",t+='      <option value="'+TaskMessage.PRIORITY_HIGH+'">'+Resource.getMessage("task_priority_high")+"</option>",t+='      <option value="'+TaskMessage.PRIORITY_TOP+'">'+Resource.getMessage("task_priority_top")+"</option>",t+="    </select>",t+="  </div>",t+="</div>",t+='<div class="edit-task-date">',t+='  <div class="edit-task-start-date olient-horizontal">',t+='    <div class="task-date-input">',t+='      <input id="task-start-date-'+n+'" name="task-start-date" class="task-start-date date-time-picker ui-corner-all" placeholder="'+Resource.getMessage("task_start_date")+'">',t+="    </div>",t+="  </div>",t+='  <div class="edit-task-due-date olient-horizontal">',t+='    <div class="task-date-input">',t+='      <input id="task-due-date'+n+'" name="task-due-date" class="task-due-date date-time-picker ui-corner-all" placeholder="'+Resource.getMessage("task_due_date")+'">',t+="    </div>",t+="  </div>",t+="</div>",t+='<div class="edit-task-name box-border olient-horizontal">',t+='<div class="flex1">',t+='<input class="ui-corner-all" name="task-name" placeholder="'+Resource.getMessage("task_name_placeholder")+'">',t+="</div>",t+="<div>",t+=ViewUtils.getCharCounterHtml("char-counter-task-add-dialog"),t+="</div>",t+="</div>",t+='<div class="edit-task-body box-border olient-horizontal">',t+='<div class="task-body-textarea-area flex1">',t+='<textarea id="task-body" name="task-body" class="ui-corner-all autoresize-textarea" placeholder="'+Resource.getMessage("task_body_placeholder")+'"></textarea>',t+="</div>",t+='<div class="task-body-char-counter">',t+=ViewUtils.getCharCounterHtml("char-counter-task-add-dialog"),t+="</div>",t+="</div>",t+='<div class="edit-attached-files">',t+="</div>",t+='<div class="edit-task-client-owner box-border olient-horizontal width-100">',t+='<div class="edit-task-label">'+Resource.getMessage("task_owner_edit")+'<span class="edit-task-label-margin">&nbsp;</span></div>',t+='<div class="edit-task-owner">',t+='<select id="task-owner" class="ui-corner-all">',t+="</select>",t+="</div>",t+="</div>",t+='<div class="width-100">',t+='<div class="edit-task-status box-border olient-horizontal width-100">',t+='<div class="edit-task-label">'+Resource.getMessage("task_status")+"</div>",t+='<select id="task-status" class="ui-corner-all">',t+="</select>",t+='<div class="edit-task-space" />',t+="</div>",t+="</div>",t+="</form>"}function u(e){if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e))||e.getType()!=Message.TYPE_TASK)return"";var t="",n=e.getStatus();if(n>=TaskMessage.STATUS_FINISHED)t=ColumnTaskMessageView.TASK_FINISHED_CLS_NAME;else{var o=e.getPriority();switch(o){case TaskMessage.PRIORITY_MEDIUM:t=ColumnTaskMessageView.TASK_PRIORITY_MEDIUM_CLS_NAME;break;case TaskMessage.PRIORITY_HIGH:t=ColumnTaskMessageView.TASK_PRIORITY_HIGH_CLS_NAME;break;case TaskMessage.PRIORITY_TOP:t=ColumnTaskMessageView.TASK_PRIORITY_TOP_CLS_NAME}var i="task-alert-normal",a=e.getDueDate();if(null!=a){var r=new Date,s=r.clone().rewind({day:-1},!0),l=r.clone().rewind({day:-4},!0);l=l.addSeconds(-1),r.isAfter(a)?i="task-alert-caution":a.isToday()?i="task-alert-warning":a.isBetween(s,l,1)&&(i="task-alert-info")}""!=t&&(t+=" "),t+=i}return t}function c(e){var t=-1,n=CubeeController.getInstance().getChildrenTaskItemIds(e.getItemId());if(null!=n&&n.getCount()>0)for(var o=n.getCount(),i=0;o>i;i++){var a=CubeeController.getInstance().getMessage(n.get(i));if(null!=a){var r=a.getStatus();(-1==t||t>r)&&(t=r)}}return-1==t&&(t=e.getStatus()),t}function d(e){var t="";switch(e){case TaskMessage.STATUS_ASSIGNING:t="task-status-view-assigning";break;case TaskMessage.STATUS_NEW:t="task-status-view-new";break;case TaskMessage.STATUS_DOING:t="task-status-view-doing";break;case TaskMessage.STATUS_FINISHED:t="task-status-view-finished";break;case TaskMessage.STATUS_REJECTED:t="task-status-view-rejected"}return t}function g(e){var t=new Array;if(t[TaskMessage.STATUS_UNKNOWN]=0,t[TaskMessage.STATUS_INBOX]=0,t[TaskMessage.STATUS_ASSIGNING]=0,t[TaskMessage.STATUS_NEW]=0,t[TaskMessage.STATUS_DOING]=0,t[TaskMessage.STATUS_SOLVED]=0,t[TaskMessage.STATUS_FEEDBACK]=0,t[TaskMessage.STATUS_FINISHED]=0,t[TaskMessage.STATUS_REJECTED]=0,t[TaskMessage.STATUS_UNKNOWN]=0,null==e)return t;for(var n=e.getCount(),o=0;n>o;o++){var i=e.get(o);if(null!=i){var a=i.getStatus();void 0==t[a]&&(t[a]=0),t[a]++}}return t}function m(e,t){var n="";if(0==_({status:e,count:t}))return n;if(1>t)return n;switch(e){case TaskMessage.STATUS_INBOX:n='&nbsp;<span class="task-status-view-count-status-inbox">'+Resource.getMessage("task_to_inbox_omit")+"</span>:"+t+"&nbsp;";break;case TaskMessage.STATUS_ASSIGNING:n='&nbsp;<span class="task-status-view-count-status-assigning">'+Resource.getMessage("task_status_assign_omit")+"</span>:"+t+"&nbsp;";break;case TaskMessage.STATUS_NEW:n='&nbsp;<span class="task-status-view-count-status-new">'+Resource.getMessage("task_status_new_omit")+"</span>:"+t+"&nbsp;";break;case TaskMessage.STATUS_DOING:n='&nbsp;<span class="task-status-view-count-status-doing">'+Resource.getMessage("task_status_do_omit")+"</span>:"+t+"&nbsp;";break;case TaskMessage.STATUS_FINISHED:n='&nbsp;<span class="task-status-view-count-status-finished">'+Resource.getMessage("task_status_fin_omit")+"</span>:"+t+"&nbsp;";break;case TaskMessage.STATUS_REJECTED:n='&nbsp;<span class="task-status-view-count-status-rejected">'+Resource.getMessage("task_status_rej_omit")+"</span>:"+t+"&nbsp;"}return n}function _(e){for(var t in e)if("message"==t){if(!e[t]||"object"!=_typeof(e[t])||e[t].getType()!=Message.TYPE_TASK)return!1;
}else if(!("status"!=t&&"count"!=t||null!=e[t]&&"number"==typeof e[t]))return!1;return!0}function f(e){var t=ColumnMessageView.getMessageBodyHtml(e);return t}ColumnTaskMessageView.TASK_PRIORITY_MEDIUM_CLS_NAME="task-priority-medium",ColumnTaskMessageView.TASK_PRIORITY_HIGH_CLS_NAME="task-priority-high",ColumnTaskMessageView.TASK_PRIORITY_TOP_CLS_NAME="task-priority-top",ColumnTaskMessageView.TASK_MESSAGE_ICON_CLS_NAME="task-message-icon",ColumnTaskMessageView.TASK_FINISHED_CLS_NAME="task-finished",ColumnTaskMessageView.DEMAND_TASK_ICON_HTML='<img src="images/demand_red.png">',ColumnTaskMessageView.DEMAND_TASK_BLINK_DELAY=1500,ColumnTaskMessageView.MAX_LENGTH_TASK_NAME=Conf.getVal("TASK_TITLE_MAX_LENGTH"),ColumnTaskMessageView.MAX_LENGTH_TASK_BODY=Conf.getVal("MESSAGE_BODY_MAX_LENGTH"),ColumnTaskMessageView.prototype=$.extend({},ColumnMessageView.prototype);var p=ColumnMessageView.prototype,h=ColumnTaskMessageView.prototype;h.cleanup=function(){var e=this,t=e._msg,n=t.getItemId(),o=t.getParentItemId(),i=t.getSiblingTaskDataList();p.cleanup.call(e);for(var a=e._statusAreaTimerBlinkIDList,r=a.getCount(),s=0;r>s;s++){var l=a.get(s);clearInterval(l.timerId)}e._statusAreaTimerBlinkIDList.removeAll(),e._attachedFileListObj=null,e._statusAreaTimerBlinkIDList=null,null!=o&&""!=o&&CubeeController.getInstance().onRemoveParentMessageRefarence(o);var u=CubeeController.getInstance().getChildrenTaskItemIds(n);if(null!=u)for(var c=u.getCount(),s=0;c>s;s++){var d=u.get(s);CubeeController.getInstance().onRemoveMessageView(d)}for(var i=t.getSiblingTaskDataList(),g=i.getCount(),s=0;g>s;s++){var m=i.get(s),_=m.getSiblingItemId();CubeeController.getInstance().onRemoveMessageView(_)}},h.getMessageHtml=function(){var e=this,t="",n=this.getMessage(),o=this.getItemId();return t+='<div draggable="false" class="box-border olient-vertical '+ColumnTaskView.cssClass+" "+u(n)+'"',t+=' itemId="'+o+'"',t+=">",t+=e.getMessageHeaderHtml(),t+=e.getMessageBodyHtml(),t+=e.getMessageFooterHtml(),t+="</div> <!-- task-message -->"},h.setHtmlElement=function(e){var t=function(e){var t=e._htmlElement.find("div.children-task-assign-area");t.addClass("hide-view"),e._htmlElement.on("click",".task_toggle_btn",function(t){e.onToggleMultiOwner(this)})},n=this,o=n.getMessage(),i=!1;if(n._htmlElement=e,n._htmlElement){var a=CubeeController.getInstance().getChildrenTaskItemIds(o.getItemId());if(null!=a&&a.getCount()>0){n._isMultiOwner=!0,n._isRequestTask=!0;var r=!1;if(o.getStatus()>=TaskMessage.STATUS_ASSIGNING){var s=o.getCommunityName();null!=s&&""!=s&&(r=!0)}(r||a.getCount()>1)&&(t(n),i=!0)}var l=o.getMessage();i||null===l||""===l||t(n);var u=n._htmlElement.find("div.task-sibling-area");if(TooltipView.getInstance().createSiblingTaskTooltip(u,o.getSiblingTaskDataList()),""!=o.getParentItemId()||n._isRequestTask){var c=n._htmlElement.find("#task-owner");if(c.attr("disabled","disabled"),n._isRequestTask){var d=n._htmlElement.find("#task-status");d.attr("disabled","disabled")}}n._execBlinkAllDemandTask();var g=n._htmlElement.find("div.task-assign"),m=n._htmlElement.find("div.multi-owner-task-status-view"),_=n._htmlElement.css("width"),f=m.css("width");g.css("width",_-f-4),n._htmlElement.find(".pack-end").remove();var p=n._htmlElement.find("img.image-thumbnail"),h=ColumnManager.getInstance().getImageMaxWidth();p.each(function(e,t){var o=$(t);if(!o.attr("src")){var i=n._msg.getItemId(),a=o.attr("data-url");CubeeController.getInstance().downloadThumbnailImage(a,i,o)}o.css("max-width",h)}),ViewUtils.showOpenGraphProtocolImage(n._htmlElement)}var C=n._htmlElement.find("a.hashtag");n._setHashtagEvent(C)},h._setHashtagEvent=function(e){var t=this;e&&e.on("click",function(){ContextSearchView.getInstance().search($(this).text(),t.getParent(),!0)})},h._execBlinkAllDemandTask=function(){for(var e=this,t=e.getMessage(),n=(t.getItemId(),ViewUtils.getDemandTaskListByMessage(t)),o=n.getCount(),i=0;o>i;i++){var a=n.get(i);if(null!=a){var r=a.getOwnerJid(),s=a.getStatus();e._execBlinkDemandTaskOnly(r,s)}}},h._execBlinkDemandTaskOnly=function(e,t){var n,o=this,i=o.getMessage(),a=(i.getItemId(),o._htmlElement),r=o._isParent(),s=ColumnTaskMessageView.getStatusAreaBaseDisplayHtml(t,r,o._isMultiOwner),l=ColumnTaskMessageView.getStatusAreaDemandTaskDisplayHtml(o._isMultiOwner),u=o._statusAreaTimerBlinkIDList.getByKey(e);null!=u&&(n=u.timerId),n&&(ViewUtils.invalidBlinkTaskStatusElement(n,a,s,o._isMultiOwner,e),o._statusAreaTimerBlinkIDList.removeByKey(e)),n=ViewUtils.validBlinkTaskStatusElement(a,ColumnTaskMessageView.DEMAND_TASK_BLINK_DELAY,s,l,o._isMultiOwner,e);var u={timerId:n},c=o._statusAreaTimerBlinkIDList.setByKey(e,u);if(!c)var c=o._statusAreaTimerBlinkIDList.add(e,u)},h._invalidBlinkDemandTaskOnly=function(e,t){var n,o=this,i=o.getMessage(),a=(i.getItemId(),o._htmlElement),r=o._isParent(),s=ColumnTaskMessageView.getStatusAreaBaseDisplayHtml(t,r,o._isMultiOwner),l=o._statusAreaTimerBlinkIDList.getByKey(e);null!=l&&(n=l.timerId),n&&(ViewUtils.invalidBlinkTaskStatusElement(n,a,s,o._isMultiOwner,e),o._statusAreaTimerBlinkIDList.removeByKey(e))},h._isParent=function(){var e=!1,t=this,n=t.getMessage(),o=n.getItemId(),i=CubeeController.getInstance().getChildrenTaskItemIds(o);return null!=i&&(e=!0),e},ColumnTaskMessageView.getStatusAreaBaseDisplayHtml=function(e,t,n){var o="",i=ViewUtils.requestTaskStatusNumToStr(e,t),a=d(e),r="task-status-view ";return n&&(r+="child-task-status-view "),o='<div class="'+r+" "+a+'">'+i+"</div>"},ColumnTaskMessageView.getStatusAreaDemandTaskDisplayHtml=function(e){var t="",n="task-status-view ";return e&&(n+="child-task-status-view "),t='<div class="'+n+' task-status-view-demand">'+Resource.getMessage("task_demand")+"</div>"},h.onToggleMultiOwner=function(e){$(e).parents(".message-border").toggleClass("open").find(".message-body,.thumbnail-area").stop().slideToggle(200).end().find(".children-task-assign-area").stop().slideToggle(200)},h.onTaskRegist=function(e){function t(t){t&&(n._editEnd(void 0),n._parent.showUpdateMessage(e.getRegistedMessageData()))}var n=this;e.registTask(t)},h.onMessageOptionReceive=function(e){var t=this;p.onMessageOptionReceive.call(t,e);var n=e.getContentType();switch(n){case MessageOptionNotification.CONTENT_TYPE_SIBLING_TASK:var o=t._htmlElement.find("div.task-sibling-area");TooltipView.getInstance().createSiblingTaskTooltip(o,t.getMessage().getSiblingTaskDataList());break;case MessageOptionNotification.CONTENT_TYPE_DEMAND_TASK:var i=(t._htmlElement.find("div.demand-task"),e.getDemandStatus()),a=e.getOwner(),r=e.getStatus();i==TaskMessage.DEMAND_ON?t._execBlinkDemandTaskOnly(a,r):t._invalidBlinkDemandTaskOnly(a,r),t._isParent()&&t._updateParentTaskActionToolTip()}},h._updateParentTaskActionToolTip=function(){var e=this,t=e.getMessage(),n=ViewUtils.getDemandTaskListByMessage(t),o=TooltipView.TYPE_PARENT_TASK;null!=n&&n.getCount()>0&&(o=TooltipView.TYPE_PARENT_TASK_CANCEL),e._parent._updateActionToolTipToMessageElem(e,o)},h.getMessageHeaderHtml=function(){var t=this,n="",o=t.getMessage();return n=e(o)},ColumnTaskMessageView.getMessageHeaderHtml=function(t){var n="";return t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))?n=e(t):n},h.getMessageFooterHtml=function(){var e=this,t="",o=e.getMessage();return t=n(o)},h.onAddMessageReferCount=function(){var e=this;p.onAddMessageReferCount.call(e);var t=e.getMessage();if(null!=t){var n=t.getParentItemId();null!=n&&""!=n&&CubeeController.getInstance().onAddParentMessageRefarence(n);var o=t.getItemId(),i=CubeeController.getInstance().getChildrenTaskItemIds(o);if(null!=i)for(var a=i.getCount(),r=0;a>r;r++){var s=i.get(r);CubeeController.getInstance().onAddMessageView(s)}for(var l=t.getSiblingTaskDataList(),u=l.getCount(),r=0;u>r;r++){var c=l.get(r),d=c.getSiblingItemId();CubeeController.getInstance().onAddMessageView(d)}}},ColumnTaskMessageView.getMessageFooterHtml=function(e){var t="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?t=n(e):t},ColumnTaskMessageView.ChangedTitle=1,ColumnTaskMessageView.ChangedMessage=2,ColumnTaskMessageView.ChangedPriority=4,ColumnTaskMessageView.ChangedStartDate=8,ColumnTaskMessageView.ChangedDueDate=16,ColumnTaskMessageView.ChangedCompleteDate=32,h.setMessageInnerActionToolTip=function(){},ColumnTaskMessageView.getMessageEditAreaHtml=function(e){return 0==_({message:e})?"":l(e)},ColumnTaskMessageView.getTaskMessageCLSName=function(e){return 0==_({message:e})?"":u(e)},ColumnTaskMessageView.getTaskStatusCLSName=function(e){return 0==_({message:e})?"":d(e.getStatus())},h.getMessageBodyHtml=function(){var e=this,t="",n=e.getMessage();return t=f(n)},ColumnTaskMessageView.getMessageBodyHtml=function(e){var t="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?t=f(e):t},h._setReadMessage=function(){},h._setMessageReadFlgView=function(){}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){var t=Message.TYPE_TASK,n=Utils.convertStringToArray(e,"_");if(n.length>0)switch(n[0]){case"mail":t=Message.TYPE_MAIL}return t}function t(e){var t="inbox-message",n=ColumnTaskView.cssClass;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var o=(e.getType(),e.getStatus());return o!=TaskMessage.STATUS_INBOX&&(t=n+" "+ColumnTaskMessageView.getTaskMessageCLSName(e)),t}function n(e){var t="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?t=e.getClient():t}ColumnInboxMessageView.prototype=$.extend({},ColumnMessageView.prototype);var o=ColumnMessageView.prototype,i=ColumnInboxMessageView.prototype;i.cleanup=function(){var e=this,t=e._msg,n=(t.getItemId(),t.getParentItemId()),i=t.getSiblingTaskDataList();o.cleanup.call(e),null!=n&&""!=n&&CubeeController.getInstance().onRemoveParentMessageRefarence(n);for(var i=t.getSiblingTaskDataList(),a=i.getCount(),r=0;a>r;r++){var s=i.get(r),l=s.getSiblingItemId();CubeeController.getInstance().onRemoveMessageView(l)}},i._createEventHandler=function(){var t=this;o._createEventHandler.call(t);var n=t._htmlElement,i=t.getMessage(),a=(t.getItemId(),i.getReferenceMessageItemId()),r=e(a);if(r==Message.TYPE_MAIL){var s=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=e.getBody();return l(t),!1},l=function(e){var t;return t=LayoutManager.isMobile?window.open("","","scrollbars=1"):window.open("","","width="+ColumnMailMessageView.MAIL_BODY_WINDOW_WIDTH+", height="+ColumnMailMessageView.MAIL_BODY_WINDOW_HEIGHT+", scrollbars=1"),t.document.write(Utils.convertEscapedHtml(e,!0)),!1},u=n.find("div.mail-body").children();u.on("click",function(){CubeeController.getInstance().getMailBody(a,s)})}if(i.getStatus()==TaskMessage.STATUS_ASSIGNING){var c=i.getSiblingTaskDataList(),d=c.getCount();if(d>0){var g=n.find("div.task-sibling-area");TooltipView.getInstance().createSiblingTaskTooltip(g,c)}var m=i.getDemandStatus();m==TaskMessage.DEMAND_ON&&t._execBlinkDemandTaskOnly()}},i.getMessageHtml=function(){var e="",t=this.getItemId();return e+='<div draggable="false" class="box-border olient-vertical '+ColumnInboxView.cssClass+'"',e+=' itemId="'+t+'"',e+=">",e+=this.getHtml(),e+="</div> <!-- .inbox-border-message -->"},i.getHtml=function(){var e=this,n="",i=this.getMessage(),a=this.getItemId(),r=(i.getId(),Utils.getDate(i.getDate(),Utils.DISPLAY_STANDARD_DATE_FORMAT));return n+='<div class="box-border olient-horizontal message-header inbox-message-header">',n+='<div class="flex1 message-created-date">'+Resource.getMessage("inbox_add_date")+r+"</div>",n+="</div>",n+='<div class="box-border olient-vertical message-info message-info-inbox-ex">',n+='<div class="box-border olient-horizontal inbox-inner-message">',n+='<div class="inner-message-padding"></div>',n+='<div class="inner-message-body flex1">',n+='<div draggable="false" class="box-border flex1 olient-vertical '+t(i)+'"',n+=' itemId="'+a+'"',n+=">",n+=e.getMessageHeaderHtml(),n+=e.getMessageBodyHtml(),n+=e.getMessageFooterHtml(),n+="</div>",n+="</div>",n+='<div class="inner-message-padding"></div>',n+="</div>",n+="</div>",n+=o.getMessageFooterHtml.call(e)},i.getMessageHeaderHtml=function(){var t="",o=this.getMessage(),i=o.getStatus();if(i==TaskMessage.STATUS_ASSIGNING)t+=ColumnTaskMessageView.getMessageHeaderHtml(o);else{var a=o.getReferenceMessageItemId(),r=e(a);if(r==Message.TYPE_MAIL)t+=ColumnMailMessageView.getMessageHeaderHtml(o);else{var s=o.getId(),l=this.getItemId(),u=n(o),c=o.getProfileMap().getByKey(u),d=ViewUtils.createPersonByProfile(u,c),g=ViewUtils.getUserNameByPerson(d),m=ViewUtils.getCubeeAccountNameByPerson(d),_="";t+='<div class="box-border olient-horizontal message-header">',t+='<div class="message-info" messageid="'+(null==s?"":s)+'" itemid="'+l+'" />',t+="<table><tr><td>",t+=ViewUtils.getAvatarDataHtmlFromPerson(d),t+="</td><td>",t+='<div class="flex1 block-info">',t+='<div class="sender-name text-overflow-ellipsis-nosize box-border-for-abbreviation" title="'+Utils.convertEscapedTag(g)+" @"+Utils.convertEscapedTag(m)+'">'+Utils.convertEscapedHtml(g),t+='<span class="sender-account">@'+Utils.convertEscapedHtml(m)+"</span></div>",t+='<div class="message-time">',t+=_,t+="</div></div>",t+="</td></tr></table>",t+="</div>"}}return t},i.getMessageBodyHtml=function(){var t=this,n="",i=this.getMessage(),a=i.getStatus();if(a==TaskMessage.STATUS_ASSIGNING)n+=ColumnTaskMessageView.getMessageBodyHtml(i);else{var r=i.getReferenceMessageItemId(),s=e(r);n+=s==Message.TYPE_MAIL?ColumnMailMessageView.getMessageBodyHtml(i):o.getMessageBodyHtml.call(t)}return n},i.getMessageFooterHtml=function(){var e=this,t="",n=this.getMessage(),i=n.getStatus();return t+=i==TaskMessage.STATUS_ASSIGNING?ColumnTaskMessageView.getMessageFooterHtml(n):o.getMessageFooterHtml.call(e)},i.onMessageOptionReceive=function(e){var t=this;o.onMessageOptionReceive.call(t,e);var n=t._htmlElement,i=t.getMessage(),a=e.getContentType();switch(a){case MessageOptionNotification.CONTENT_TYPE_SIBLING_TASK:if(i.getStatus()==TaskMessage.STATUS_ASSIGNING){var r=i.getSiblingTaskDataList(),s=r.getCount();if(s>0){var l=n.find("div.task-sibling-area");TooltipView.getInstance().createSiblingTaskTooltip(l,r)}}break;case MessageOptionNotification.CONTENT_TYPE_DEMAND_TASK:var u=n.find("div.demand-task");if(0==u.length)break;var c=e.getDemandStatus();c==TaskMessage.DEMAND_ON?t._execBlinkDemandTaskOnly():t._invalidBlinkDemandTaskOnly()}},i._execBlinkDemandTaskOnly=function(){var e=this,t=e.getMessage(),n=t.getOwnerJid(),o=t.getStatus(),i=e._htmlElement,a=!1,r=!1,s=ColumnTaskMessageView.getStatusAreaBaseDisplayHtml(o,a,r),l=ColumnTaskMessageView.getStatusAreaDemandTaskDisplayHtml(r),u=e._timerId;u&&(ViewUtils.invalidBlinkTaskStatusElement(u,i,s,r,n),e._timerId=null),e._timerId=ViewUtils.validBlinkTaskStatusElement(i,ColumnTaskMessageView.DEMAND_TASK_BLINK_DELAY,s,l,e._isMultiOwner,n)},i._invalidBlinkDemandTaskOnly=function(){var e=this,t=e.getMessage(),n=t.getOwnerJid(),o=t.getStatus(),i=e._htmlElement,a=!1,r=!1,s=ColumnTaskMessageView.getStatusAreaBaseDisplayHtml(o,a,r),l=(ColumnTaskMessageView.getStatusAreaDemandTaskDisplayHtml(r),e._timerId);l&&(ViewUtils.invalidBlinkTaskStatusElement(l,i,s,r,n),e._timerId=null)},i.onAddMessageReferCount=function(){var e=this;o.onAddMessageReferCount.call(e);var t=e.getMessage();if(null!=t){var n=t.getParentItemId();null!=n&&""!=n&&CubeeController.getInstance().onAddParentMessageRefarence(n);for(var i=t.getSiblingTaskDataList(),a=i.getCount(),r=0;a>r;r++){var s=i.get(r),l=s.getSiblingItemId();CubeeController.getInstance().onAddMessageView(l)}}},i.setHtmlElement=function(e,t){var n=this;if(o.setHtmlElement.call(n,e,t),null!=n._htmlElement){n._htmlElement.find(".pack-end").remove();var i=n._htmlElement.find("img.image-thumbnail"),a=ColumnManager.getInstance().getImageMaxWidth();i.each(function(e,t){var o=$(t);if(!o.attr("src")){var i=n._msg.getItemId(),r=o.attr("data-url");CubeeController.getInstance().downloadThumbnailImage(r,i,o)}o.css("max-width",a)})}var r=n.getMessage();r&&r.getStatus()==TaskMessage.STATUS_ASSIGNING&&e.on("click",".task_toggle_btn",function(){n.onToggleMessageBody(e)})},i.onToggleMessageBody=function(e){$(e).toggleClass("open").find(".message-body,.thumbnail-area").stop().slideToggle(200).end().find(".children-task-assign-area").stop().slideToggle(200)},i._setMessageReadFlgView=function(){},i._setReadMessage=function(){}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnChatMessageView.prototype=$.extend({},ColumnMessageView.prototype);var e=(ColumnMessageView.prototype,ColumnChatMessageView.prototype);e.getMessageHtml=function(){var e="",t=this,n=(t.getMessage(),t.getItemId());return e+="<div",e+=' class="box-border olient-vertical '+ColumnChatView.cssClass+'"',e+=' itemId="'+n+'"',e+=">",e+=this.getMessageHeaderHtml(),e+=this.getMessageBodyHtml(),e+=this.getMessageFooterHtml(),e+="</div> <!-- .chat-message -->"}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnPublicMessageView.prototype=$.extend({},ColumnMessageView.prototype);var e=(ColumnMessageView.prototype,ColumnPublicMessageView.prototype),t="";e.getMessageHtml=function(e,n){var o="";return t=n,null==e&&(e=!1),o=e?this._getPublicReplyMessageHtml():this._getPublicOriginalMessageHtml()},e._getPublicOriginalMessageHtml=function(){var e="",t=(this.getMessage(),this.getItemId());return e+="<div",e+=' class="box-border olient-vertical '+ColumnTimelineView.cssClassTimeline+'"',e+=' itemId="'+t+'"',e+=">",e+=this._getPublicMessageBodyHtml(),e+="</div> <!-- .timeline-message -->"},e._getPublicReplyMessageHtml=function(){var e="",t=(this.getMessage(),this.getItemId());return e+="<div",e+=' class="box-border olient-horizontal '+ColumnTimelineView.cssClassThread+'"',e+=' itemId="'+t+'"',e+=">",e+='<div class="thread-padding"></div>',e+='<div class="box-border flex1 olient-vertical '+ColumnTimelineView.cssClassTimeline+'"',e+=' itemId="'+t+'"',e+=">",e+=this._getPublicMessageBodyHtml(),e+="</div>",e+="</div> <!-- .thread-message -->"},e._getPublicMessageBodyHtml=function(){var e="",n=this.getMessage();return 0==t&&n._type!=Message.TYPE_SYSTEM?e:(e+=this.getMessageHeaderHtml(),e+=this.getMessageBodyHtml(),e+=this.getMessageFooterHtml())}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnGroupChatMessageView.prototype=$.extend({},ColumnMessageView.prototype);var e=(ColumnMessageView.prototype,ColumnGroupChatMessageView.prototype);e.getMessageHtml=function(e){var t="";return null==e&&(e=!1),t=e?this._getGroupChatReplyMessageHtml():this._getGroupChatOriginalMessageHtml()},e._getGroupChatOriginalMessageHtml=function(){var e=this,t="",n=e.getItemId();return t+="<div",t+=' class="box-border olient-vertical '+ColumnGroupChatView.cssClassGroupChat+'"',t+=' itemId="'+n+'"',t+=">",t+=e._getGroupChatMessageBodyHtml(),t+="</div> <!-- .groupchat-message -->"},e._getGroupChatReplyMessageHtml=function(){var e=this,t="",n=e.getItemId();return t+="<div",t+=' class="box-border olient-horizontal '+ColumnGroupChatView.cssClassThread+'"',t+=' itemId="'+n+'"',t+=">",t+='<div class="thread-padding"></div>',t+='<div class="box-border flex1 olient-vertical '+ColumnGroupChatView.cssClassGroupChat+'"',t+=' itemId="'+n+'"',t+=">",t+=e._getGroupChatMessageBodyHtml(),t+="</div>",t+="</div> <!-- .thread-message -->"},e._getGroupChatMessageBodyHtml=function(){var e=this,t="";return t+=e.getMessageHeaderHtml(),t+=e.getMessageBodyHtml(),t+=e.getMessageFooterHtml()}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){var t="",n=e.getItemId(),o=e.getId(),i=LoginUser.getInstance().getSettings().getMailCooperationList().get(0).getServerName();""==i&&(i=ViewUtils.getCooperationServerName());var a="images/new_email.png",r=Utils.convertStringToArray(e.getMessage(),"\n"),s=r[2];return t+='<div class="box-border olient-horizontal message-header">',t+='<div class="message-info" messageid="'+(null==o?"":o)+'" itemid="'+n+'" />',ViewUtils.isIE89()&&(t+="<table><tr><td>"),t+='<div class="block-avatar">',t+='<img class="avatar '+ColumnMailMessageView.MAIL_MESSAGE_ICON_CLS_NAME+'" src="'+a+'">',t+="</div>",ViewUtils.isIE89()&&(t+='</td><td width="100%">'),t+='<div class="flex1 block-info">',t+='<div class="sender-name text-overflow-ellipsis-nosize box-border-for-abbreviation" title="'+Utils.convertEscapedTag(i)+'">',t+=Utils.convertEscapedHtml(i)+"</div>",t+='<div class="message-time">'+s+"</div>",t+="</div>",ViewUtils.isIE89()&&(t+="</td></tr></table>"),t+="</div>"}function t(e){var t="",o=Utils.convertStringToArray(e.getMessage(),"\n");t+='<div class="box-border olient-vertical message-info">',t+='<div class="message-body box-border-for-abbreviation olient-vertical">';for(var i=0;i<o.length-1;i++){var a=Utils.convertEscapedTag(o[i]),r=Utils.convertEscapedHtml(o[i]);t+='<div class="mail-message-header-items" title="'+a+'">'+r+"</div>"}return t+="</div>",t+=n(e),t+="</div>"}function n(e){var t="";return t+='<div class="box-border olient-vertical mail-body">',t+='<span><img src="'+ColumnMailMessageView.MAIL_BODY_ICON+'"></span>',t+="</div>"}ColumnMailMessageView.prototype=$.extend({},ColumnMessageView.prototype);var o=ColumnMessageView.prototype,i=ColumnMailMessageView.prototype;ColumnMailMessageView.MAIL_BODY_WINDOW_HEIGHT=700,ColumnMailMessageView.MAIL_BODY_WINDOW_WIDTH=700,ColumnMailMessageView.MAIL_BODY_ICON="images/page_white_text.png",ColumnMailMessageView.MAIL_MESSAGE_ICON_CLS_NAME="mail-message-icon",ColumnMailMessageView.MAIL_PRIORITY_HIGH_CLS_NAME="mail-priority-high",i._setMailMessageSubjectToolTip=function(){var e=this,t=e.getHtmlElement(),n=t.find("div.mail-message-header-items"),o=n.eq(0);'<div class="tooltipMailMessageSubject"><h>'+o.text()+"</h><div>";o.attr("title",o.text())},i._createEventHandler=function(){function e(){var e=CubeeController.getInstance().getMessage(r),o=e.getBodyInfo(),i=o.getBody();return n._msg.setBodyInfo(o),t(i),!1}function t(e){var t;return t=LayoutManager.isMobile?window.open("","","scrollbars=1"):window.open("","","width="+ColumnMailMessageView.MAIL_BODY_WINDOW_WIDTH+", height="+ColumnMailMessageView.MAIL_BODY_WINDOW_HEIGHT+", scrollbars=1"),t.document.write(Utils.convertEscapedHtml(e,!0)),!1}var n=this;o._createEventHandler.call(n);var i=n._htmlElement,a=n.getMessage(),r=n.getItemId(),s=i.find("div.mail-body").children();s.on("click",function(){var n=a.getBodyInfo();if(null!=n){var o=n.getBody();return t(o),!1}CubeeController.getInstance().getMailBody(r,e)}),n._setMailMessageSubjectToolTip()},i.getMessageHtml=function(){var e="",t=this,n=t.getItemId();return e+="<div",e+=' class="box-border olient-vertical '+ColumnMailView.cssClass+'"',e+=' itemId="'+n+'"',e+=">",e+=t.getMessageHeaderHtml(),e+=t.getMessageBodyHtml(),e+=t.getMessageFooterHtml(),e+="</div> <!-- .mail-message -->"},i.getMessageHeaderHtml=function(){var t=this,n="",o=t.getMessage();return n=e(o)},ColumnMailMessageView.getMessageHeaderHtml=function(t){var n="";return t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))?n=e(t):n},i.getMessageBodyHtml=function(){var e=this,n="",o=e.getMessage();return n=t(o)},ColumnMailMessageView.getMessageBodyHtml=function(e){var n="";return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?n=t(e):n}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ColumnCommunityMessageView.prototype=$.extend({},ColumnMessageView.prototype);var e=(ColumnMessageView.prototype,ColumnCommunityMessageView.prototype);e.getMessageHtml=function(e){var t="";return null==e&&(e=!1),t=e?this._getCommunityReplyMessageHtml():this._getCommunityOriginalMessageHtml()},e._getCommunityOriginalMessageHtml=function(){var e=this,t="",n=e.getItemId();return t+="<div",t+=' class="box-border olient-vertical '+ColumnCommunityFeedView.cssClassCommunityFeed+'"',t+=' itemId="'+n+'"',t+=">",t+=e._getCommunityMessageBodyHtml(),t+="</div> <!-- .community-message -->"},e._getCommunityReplyMessageHtml=function(){var e=this,t="",n=e.getItemId();return t+="<div",t+=' class="box-border olient-horizontal '+ColumnCommunityFeedView.cssClassThread+'"',t+=' itemId="'+n+'"',t+=">",t+='<div class="thread-padding"></div>',t+='<div class="box-border flex1 olient-vertical '+ColumnCommunityFeedView.cssClassCommunityFeed+'"',t+=' itemId="'+n+'"',t+=">",t+=e._getCommunityMessageBodyHtml(),t+="</div>",t+="</div> <!-- .thread-message -->"},e._getCommunityMessageBodyHtml=function(){var e=this,t="";return t+=e.getMessageHeaderHtml(),t+=e.getMessageBodyHtml(),t+=e.getMessageFooterHtml()}}(),function(){ColumnCommunityTaskMessageView.prototype=$.extend({},ColumnTaskMessageView.prototype);var e=(ColumnTaskMessageView.prototype,ColumnCommunityTaskMessageView.prototype);e.hasTaskClient=function(e){var t=this,n=t.getMessage(),o=n.getClient();return e===o?!0:!1},e.hasTaskContractor=function(e){var t=this,n=t.getHtmlElement(),o=t.getMessage(),i=CubeeController.getInstance().getChildrenTaskItemIds(o.getItemId());if(null==i)return!1;var a=i.getCount();if(0>=a)return!1;var r=n.find(".children-task-assign");if(r.length<=0)return!1;for(var s=r.find("div.child-task-owner-jid"),l=0;l<s.length;l++){var u=s.eq(l),c=u.attr("ownerjid");if(e===c)return!0}return!1},e.setMessageInnerActionToolTip=function(){function e(e){if(e){var n=LoginUser.getInstance().getJid(),o=!1,i=!1,a=!1;if(o=e.hasOwner(n),i=t.hasTaskClient(n),a=t.hasTaskContractor(n),o||i||a)for(var s=r.find("div.child-task-owner-jid"),l=0;l<s.length;l++){var u=s.eq(l),c=u.find(".childTaskActionToolTip").length;if(0==c){var d=u.attr("itemid");if(null==d||""==d)continue;var g=CubeeController.getInstance().getMessage(d);if(null==g)continue;var m=u.attr("ownerjid"),_=TooltipView.TYPE_UNKNOWN,f=g.getStatus();if(f==TaskMessage.STATUS_ASSIGNING)if(o)_=TooltipView.TYPE_INNER_MESSAGE_CHILD_ASSIGNED_MY_TASK_ACTION;else if(i)_=n===m?TooltipView.TYPE_INNER_MESSAGE_CHILD_ASSIGNED_MY_TASK_ACTION:TooltipView.TYPE_INNER_MESSAGE_CHILD_ASSIGNED_TASK_ACTION;else{if(n!==m)continue;_=TooltipView.TYPE_INNER_MESSAGE_CHILD_ASSIGNED_MY_TASK_ACTION}else{if(!(f>TaskMessage.STATUS_ASSIGNING))continue;if(o)_=TooltipView.TYPE_INNER_MESSAGE_CHILD_TASK_ACTION;else if(i)_=n===m?TooltipView.TYPE_INNER_MESSAGE_CHILD_TASK_ACTION:TooltipView.TYPE_INNER_MESSAGE_CHILD_ASSIGNED_TASK_ACTION;else{if(n!==m)continue;_=TooltipView.TYPE_INNER_MESSAGE_CHILD_TASK_ACTION}}var p='<div class="childTaskActionToolTip" ><span title="'+Resource.getMessage("show_Action_ToolTip_button")+'" class="showActionTooltipButton ui-icon ui-icon-circle-triangle-w"/></div>';if(ViewUtils.isIE89()){var h="<td>"+p+"</td>";u.find("td:last").eq(0).before(h)}else u.children("div.child-task-status-view").eq(0).before(p);var C=(u.find(".childTaskActionToolTip span").eq(0),{childTask:g});TooltipView.getInstance().setActionToolTip(_,u,$('<div class="popup_menu msg_menu inner_task"><a class="msg_btn msg_menu_btn popup_btn ico_btn"><i class="fa fa-ellipsis-v"></i></a></div>'),!1),TooltipView.getInstance().setActionToolTipEvent(C,u.find(".inner_task"))}}}}var t=this,n=t.getHtmlElement(),o=t.getMessage();if(null!=n&&null!=o){var i=CubeeController.getInstance().getChildrenTaskItemIds(o.getItemId());if(null!=i){var a=i.getCount();if(!(0>=a)){var r=n.find(".children-task-assign");if(!(r.length<=0)){var s=o.getCommunityId();s&&CubeeController.getInstance().getCommunityMemberInfo(s,e)}}}}}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){var t=String(parseInt(e.substring(1,3),16)),n=String(parseInt(e.substring(3,5),16)),o=String(parseInt(e.substring(5,7),16));return"background-color:rgba("+t+","+n+","+o+",0.05)"}ColumnMurmurMessageView.prototype=$.extend({},ColumnMessageView.prototype);var t=(ColumnMessageView.prototype,ColumnMurmurMessageView.prototype);t.getMessageHtml=function(e){var t="";return null==e&&(e=!1),t=e?this._getMurmurReplyMessageHtml():this._getMurmurOriginalMessageHtml()},t._getMurmurOriginalMessageHtml=function(){var t=this,n="",o=t.getItemId(),i=t._msg._profileMap._array[0]._nickName,a=Utils.avatarCreate({name:i,type:"user"});return n+="<div",n+=' message-border" style="'+e(a.color)+'"',n+=' class="box-border olient-vertical '+ColumnMurmurView.cssClassMurmur+'"',n+=' itemId="'+o+'"',n+=">",n+=t._getMurmurMessageBodyHtml(),n+="</div> <!-- .murmur-message -->"},t._getMurmurReplyMessageHtml=function(){var e=this,t="",n=e.getItemId();return t+="<div",t+=' class="box-border olient-horizontal '+ColumnMurmurView.cssClassThread+'"',t+=' itemId="'+n+'"',t+=">",t+='<div class="thread-padding"></div>',t+='<div class="box-border flex1 olient-vertical '+ColumnMurmurView.cssClassMurmur+'"',t+=' itemId="'+n+'"',t+=">",t+=e._getMurmurMessageBodyHtml(),t+="</div>",t+="</div> <!-- .thread-message -->"},t._getMurmurMessageBodyHtml=function(){var e=this,t="";return t+=e.getMessageHeaderHtml(),t+=e.getMessageBodyHtml(),t+=e.getMessageFooterHtml()}}(),function(){AttachedFileData.FILE_ATTACHED=0,AttachedFileData.FILE_DELETE=1,AttachedFileData.FILE_ATTACHE_NEW=2,AttachedFileData.prototype=$.extend({},ViewCore.prototype);var e=AttachedFileData.prototype;e.getUrl=function(){return this._url},e.setUrl=function(e){null!=e&&"string"==typeof e&&""!=e&&(this._url=e)},e.getFlag=function(){return this._controlflag},e.setFlag=function(e){null!=e&&"number"==typeof e&&(this._controlflag=e)},e.getFileName=function(){return this._fileName},e.setFileName=function(e){null!=e&&"string"==typeof e&&""!=e&&(this._fileName=e)},e._createEventHandler=function(){var e=this,t=e.getHtmlElement();t&&t.on("click","div.attached-files > div.file-selected > a.cancel-file-upload",function(){e._clickCancelAttachedFile($(this))})},e._clickCancelAttachedFile=function(e){var t=this;e.parent();t.getHtmlElement().find("div.attached-files").remove(),t.setFlag(AttachedFileData.FILE_DELETE)},e.getHtml=function(){var e=this,t="",t="";return t+='  <input type="file" name="upfile" class="file">',t+='  <div class="file-selected">',t+='    <a class="ico_btn select-file" data-toggle="tooltip" data-original-title='+e.getFileName()+' data-placement="right">',t+='      <i class="fa fa-paperclip"></i>',t+="    </a>",t+='    <p class="file-name" data-toggle="tooltip" data-original-title="'+e.getFileName()+'" data-placement="bottom">'+e.getFileName()+"</p>",t+='    <a class="ico_btn cancel-file-upload" data-toggle="tooltip" data-original-title="cancel" data-placement="bottom">',t+='      <i class="fa fa-remove"></i>',t+="    </a>",t+='    <br class="clear-float">',t+="  </div>"}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){for(var t in e)if("url"==t){if(null==e[t]||"string"!=typeof e[t])return!1}else if("setAttachedFileData"==t&&(null==e[t]||"object"!=_typeof(e[t])))return!1;return!0}AttachedFileList.prototype=$.extend({},ArrayList.prototype,ViewCore.prototype);var t=ArrayList.prototype,n=AttachedFileList.prototype;
n.cleanup=function(){var e=this,t=e.getHtmlElement();t.off()},n.add=function(n){var o=this;if(0==e({url:n}))return!1;var i=o.getByUrl(n);if(null!=i)return!1;var a=new AttachedFileData(o.getHtmlElement(),n);return t.add.call(this,a)},n.getByUrl=function(t){var n=this;if(0==e({url:t}))return null;for(var o=null,i=n._length,a=0;i>a;a++)if(n._array[a].getUrl()==t){o=n._array[a];break}return o},n.removeByUrl=function(n){var o=this;if(0==e({url:n}))return null;for(var i=null,a=o._length,r=0;a>r;r++)if(o._array[r].getUrl()==n){i=t.remove.call(this,r);break}return i},n.setByUrl=function(t){var n=this;if(0==e({setAttachedFileData:t}))return null;for(var o=null,i=t.getUrl(),a=n._length,r=0;a>r;r++)if(n._array[r].getUrl()==i){o=n._array[r];break}return o.setFlag(t.getFlag()),o},n.removeAll=function(){t.removeAll.call(this)},n.getAttachedUrl=function(){for(var e=this,t=null,n=e._length,o=0;n>o;o++)t=e._array[o].getUrl();return t},n.getHtml=function(){var e=this,t="";t='<div class="attached-files">';for(var n=e._length,o=0;n>o;o++)t+=e._array[o].getHtml();return t+="</div>"}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t){if(t.getType()==Notification_model.TYPE_GROUP_CHAT){var n=t.getSubType(),o=t.getRoomInfo();if(TabManager.getInstance().isActiveMyWorkplace()||$(".project_btn").attr("data_value")==o.getParentRoomId()){var i=Utils.getSafeValue(c,n,function(){});i(e,o,t)}}else if(t.getType()==Notification_model.TYPE_QUESTIONNAIRE&&(TabManager.getInstance().isActiveMyWorkplace()||$(".project_btn").attr("data_value")==t.getQuestionnaireMessage().getParentRoomId())){var a=new ChatRoomInformation;a.setRoomId(t.getQuestionnaireMessage().getRoomId()),a.setRoomName(t.getQuestionnaireMessage().getRoomName()),e.newMessageNotifyForQuestionnaire(a,t)}}function t(e,t,n){e.newMessageNotify(t,n)}function n(e,t,n){e.addCreatedGroupChat(t)}function o(e,t,n){e.onChangeRoomName(t),null!=t&&t._roomId&&"string"==typeof t._roomId&&e.onUpdateOptionMenu(t._roomId)}function i(e,t,n){e.removeGroupChat(n)}function a(e){e.click(function(){var t=e.children("a").attr("roomid"),n=CubeeController.getInstance().getChatRoomInfoByRoomId(t),o=ViewUtils.getGroupChatColumnInfo(n);ColumnManager.getInstance().addColumn(o,!0,!0),ViewUtils.unsetNewNoticeMark(e),NotificationIconManager.getInstance().onColumnClicked(o),NotificationIconManager.getInstance().removeAttentionHeaderColumnIcon('li[msgto="'+t+'"][columntype="'+ColumnInformation.TYPE_COLUMN_GROUP_CHAT+'"].sortable-item .ico_group')})}function r(e,t){TooltipView.getInstance().setGroupChatNameToolTip(e,t,!1),e.attr("title",t)}GroupChatListView._VIEW_PARTS_LIST_HEADER="groupchat-list-header",GroupChatListView.prototype=$.extend({},SideMenuAccordionParts.prototype);var s=SideMenuAccordionParts.prototype,l=GroupChatListView.prototype;l.init=function(e){var t=this;return s.init.call(t),t._mode=e.mode,t._addEvent=!0,"addEvent"in e&&0==e.addEvent&&(t._addEvent=!1),t._currentLoadedItemId=0,t._allGroupChatListReceived=!1,t._headerDisplayName=Resource.getMessage("GroupChatList"),t.createFrame(),t},l.createFrame=function(){var e=this,t='<div class="sidebar_list list-groupchat box-border flex1 olient-vertical vertical-scroll"></div>',n=$(t);return e._frame=n,n},l.cleanUp=function(){var e=this;s.cleanUp.call(e),e._currentLoadedItemId=null,e._allGroupChatListReceived=null,e._headerDisplayName=null},l.showInnerFrame=function(e){var t=this;return setTimeout(function(){e()},10),t.showGroupChatList()},l.showInnerFrameFromProject=function(e,t){var n=this;return setTimeout(function(){e()},10),n.showGroupChatListFromProject(t)},l.showGroupChatList=function(){var e=this,t=e.getHtmlElement();return t.children().remove(),e.getHistoryRoomInfo(),!0},l.showGroupChatListFromProject=function(e){var t=this;return t.getHistoryRoomInfoFromProject(e),!0},l._addGroupChat=function(e,t,n){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return!1;var o=this,i=t.getId(),s=t.getUpdatedAt()?t.getUpdatedAt().getTime():+new Date;(0==o._currentLoadedItemId||o._currentLoadedItemDate>s)&&(o._currentLoadedItemId=i,o._currentLoadedItemDate=s);var l=Utils.convertEscapedHtml(t.getRoomName()),u=Utils.avatarCreate({type:"group",name:t.getRoomName()}),c=t.getPrivacyType(),d="";"sidebar"!=this._mode&&null!=c&&0==c&&(d=' <span class="public-room-chip"></span>');var g="";g='<li style="display:block">',g+='<a roomid="'+t.getRoomId()+'" title="'+l+'">',g+='  <span class="ico ico_group">',g+='    <div class="no_img" style="background-color:'+u.color+'">',g+='      <div class="no_img_inner">'+u.name+"</div>",g+="    </div></span>",g+='  <span class="name room-list-name">'+l+"</span>"+d,g+="</a></li>";var m=0;n?e.prepend(g):(e.append(g),m=e.children("*").length-1);var _=e.children("*").eq(m);return o._addEvent&&a(_),r(_,t.getRoomName()),!0};var u={};u[Notification_model.TYPE_GROUP_CHAT]=e,u[Notification_model.TYPE_QUESTIONNAIRE]=e,l.onNotification=function(e){var t=this,n=e.getType(),o=Utils.getSafeValue(u,n,function(){});o(t,e)};var c={};c[GroupChatNotification.SUB_TYPE_MESSAGE]=t,c[GroupChatNotification.SUB_TYPE_CREATE_ROOM]=n,c[GroupChatNotification.SUB_TYPE_UPDATE_ROOM_INFO]=o,c[GroupChatNotification.SUB_TYPE_REMOVE_MEMBER]=i,l.newMessageNotify=function(e,t){if(e&&t){var n=this.getHtmlElement(),o="a[roomid='"+e.getRoomId()+"']";0==n.find(o).length&&this._addGroupChat(n,e,!0);var i=n.find(o);t.getGroupChatMessage().getFrom()!=LoginUser.getInstance().getJid()&&0==i.find(".new_message_notice").length&&ViewUtils.setNewNoticeMark(i),i.parent().prependTo(n.find(o).parent().parent()),this.adjustListedNum()}},l.newMessageNotifyForQuestionnaire=function(e,t){if(e&&t){var n=this.getHtmlElement(),o="a[roomid='"+e.getRoomId()+"']";0==n.find(o).length&&this._addGroupChat(n,e,!0);var i=n.find(o),a=t.getQuestionnaireMessage().getOptionItems(),r=!1;for(var s in a._array)if(a._array[s].optionValue>0){r=!0;break}r||t.getQuestionnaireMessage().getFrom()==LoginUser.getInstance().getJid()||0==i.find(".new_message_notice").length&&ViewUtils.setNewNoticeMark(i),i.parent().prependTo(n.find(o).parent().parent()),this.adjustListedNum()}},l.addCreatedGroupChat=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=this,n=t.getHtmlElement(),o=n.find("a[roomid='"+e.getRoomId()+"']");return 0!=o.length?!0:(t._addGroupChat(n,e,!0),void t.adjustListedNum())},l.removeGroupChat=function(e){function t(){if(!(r>=a)){var o=LoginUser.getInstance(),s=o.getJid(),l=i.get(r);if(s==l){var u=e.getRoomInfo().getRoomId(),c=n.getHtmlElement(),d=c.find("div[roomid='"+u+"']");return void d.remove()}r++,setTimeout(function(){t()},1)}}var n=this;if(null!==e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var o=e.getSubType();if(o==GroupChatNotification.SUB_TYPE_REMOVE_MEMBER){var i=e.getRemovedMemberList(),a=i.getCount(),r=0;t();var s=e.getRemovedMemberList(),l=LoginUser.getInstance().getJid();if(s&&s._array.indexOf(l)>=0){for(var u=e.getRoomInfo().getRoomId(),c=ColumnManager.getInstance().getColumnObjList(),d=0;d<c._array.length;d++)c._array[d]&&c._array[d]._idName&&u==c._array[d]._idName&&(ColumnManager.getInstance().removeColumn(c._array[d],!0),$(window).resize());$('#groupChatList li:has(a[roomid="'+u+'"])').remove()}}}},l.onChangeRoomName=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=this,n=t.getHtmlElement(),o=n.find("a.[roomid='"+e.getRoomId()+"']");if(0!=o.length){var i=Utils.avatarCreate({type:"group",name:e.getRoomName()});return o.find("div.no_img").css("background-color",i.color),o.find("div.no_img_inner").text(i.name),o.find("span.name").text(e.getRoomName()),r(o,e.getRoomName()),!0}return!1},l.onUpdateOptionMenu=function(e){if(null==e||"string"!=typeof e)return!1;for(var t="div.popup_menu.col_menu",n=ColumnManager.getInstance().getColumnObjList(),o=0;o<n._array.length;o++)if(n._array[o]&&n._array[o]._idName&&e==n._array[o]._idName){var i=n._array[o].getHtmlElement().find(t);return i.find("ul.popup_list").remove(),n._array[o]._setOptionMenu(i),!0}return!1},l._showReadMore=function(){var e,t=this,n=!1,o=0,i=t.getHtmlElement();if(!i||"object"!=("undefined"==typeof i?"undefined":_typeof(i)))return n;if(1==t._allGroupChatListReceived)return!1;e=i.children("li:last");var a=i.children("div.loading-readmore");return a.length>0?!1:(ViewUtils.showLoadingIcon(e),o=i.children("li").size(),0==o?(ViewUtils.hideLoadingIcon(e),!1):(t.getHistoryRoomInfo(),n=!0))},l.getHistoryRoomInfo=function(){function e(e){e.getCount()<i&&(t._allGroupChatListReceived=!0),t._onGetGroupInfoListHistory(e)}var t=this,n=new ColumnSortCondition;n.getItems().removeAll(),n.getItems().add("updated_at"),n.getOrders().removeAll(),n.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC);var o=new ArrayList;o.add(new CommunityInfo);var i=t.getNumberOfGetCount();CubeeController.getInstance().getRoomInfoList(t._currentLoadedItemId,i,o,n,e)},l.getHistoryRoomInfoFromProject=function(e){function t(e){e.getCount()<a&&(n._allGroupChatListReceived=!0),n._onGetGroupInfoListHistory(e)}var n=this,o=new ColumnSortCondition;o.getItems().removeAll(),o.getItems().add("updated_at"),o.getOrders().removeAll(),o.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC);var i=new ArrayList;i.add(e);var a=n.getNumberOfGetCount();CubeeController.getInstance().getRoomInfoList(n._currentLoadedItemId,a,i,o,t)},l.getNumberOfGetCount=function(){switch(this._mode){case"sidebar":return 5;case"dialog":return 10;case"all":return 1e3;default:return 20}},l.adjustListedNum=function(){var e=this.getHtmlElement(),t=e.children("li"),n=t.length-this.getNumberOfGetCount();if(n>0)for(var o=0;n>o;o++)e.find("li:last").remove()},l._onGetGroupInfoListHistory=function(e){var t=this;t._hideLoadingIconInSelf();var n=t.getHtmlElement();if(null!=n)for(var o=0;o<e.getCount();o++){var i=e.get(o),a=n.find("div[roomid='"+i.getRoomId()+"']");0==a.length&&t._addGroupChat(n,i,!1)}},l._hideLoadingIconInSelf=function(){var e=this,t=e.getHtmlElement();ViewUtils.hideLoadingIconInChild(t)},l.resizeContent=function(){function e(){n.prop("clientHeight")==n.prop("scrollHeight")&&(t._allGroupChatListReceived||t._showReadMore())}var t=this,n=t.getHtmlElement();"none"!=n.parent().css("display")&&setTimeout(function(){e()},1)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t){TooltipView.getInstance().setGroupChatNameToolTip(e,t,!1),e.attr("title",t)}PublicGroupChatListView.prototype=$.extend({},SideMenuAccordionParts.prototype);var t=SideMenuAccordionParts.prototype,n=PublicGroupChatListView.prototype;n.init=function(e){var n=this;return t.init.call(n),n._mode=e.mode,n._addEvent=!0,"addEvent"in e&&0==e.addEvent&&(n._addEvent=!1),n._currentLoadedItemId=0,n._allGroupChatListReceived=!1,n._headerDisplayName=Resource.getMessage("GroupChatList"),n.createFrame(),n},n.createFrame=function(){var e=this,t='<div class="sidebar_list list-groupchat box-border flex1 olient-vertical vertical-scroll"></div>',n=$(t);return e._frame=n,n},n.cleanUp=function(){var e=this;t.cleanUp.call(e),e._currentLoadedItemId=null,e._allGroupChatListReceived=null,e._headerDisplayName=null},n.showInnerFrameFromProject=function(e,t){function n(e){return e._array||e._length||0==e.errorCode&&null!=e.content&&0!=e.content.result?(e.getCount()<r&&(o._allGroupChatListReceived=!0),void o._onGetGroupInfoListHistory(e)):($("#public_grouplist_modal #dialog-error").text(Resource.getMessage("get_room_list_err")),!1)}var o=this;setTimeout(function(){e()},10);var i=new ColumnSortCondition;i.getItems().removeAll(),i.getItems().add("updated_at"),i.getOrders().removeAll(),i.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC);var a=new ArrayList;a.add(t);var r=o.getNumberOfGetCount();return CubeeController.getInstance().getPublicGroupRoomInfoList(o._currentLoadedItemId,r,i,n),!0},n._addGroupChat=function(t,n,o){if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return!1;if(null==n||"object"!=("undefined"==typeof n?"undefined":_typeof(n)))return!1;var i=this,a=n.getId(),r=LoginUser.getInstance().getJid(),s=n.getMemberList();if(s._array.indexOf(r)>=0)return!0;var l=n.getUpdatedAt()?n.getUpdatedAt().getTime():+new Date;(0==i._currentLoadedItemId||i._currentLoadedItemDate>l)&&(i._currentLoadedItemId=a,i._currentLoadedItemDate=l);var u=Utils.convertEscapedHtml(n.getRoomName()),c=Utils.avatarCreate({type:"group",name:n.getRoomName()}),d="";d="<li>",d+='<label for="pub_gc_'+n.getRoomId()+'"><a roomid="'+n.getRoomId()+'" title="'+u+'"><div>',d+='  <span class="ico ico_group">',d+='    <div class="no_img" style="background-color:'+c.color+'">',d+='      <div class="no_img_inner">'+c.name+"</div>",d+="    </div>",d+="  </span>",d+='  <span class="name room-list-name">'+u+"</span>",d+="</a>",d+='<input type="radio" name="public-gc-room-id" value="'+n.getRoomId()+'" id="pub_gc_'+n.getRoomId()+'" />',d+='<span class="public-gc-room-list-radio"></span>',d+="",d+="</div></label></li>";var g=0;o?t.prepend(d):(t.append(d),g=t.children("*").length-1);var m=t.children("*").eq(g);return e(m,n.getRoomName()),!0},n._showReadMore=function(){var e,t=this,n=!1,o=0,i=t.getHtmlElement();if(!i||"object"!=("undefined"==typeof i?"undefined":_typeof(i)))return n;if(1==t._allGroupChatListReceived)return!1;e=i.children("li:last");var a=i.children("div.loading-readmore");return a.length>0?!1:(ViewUtils.showLoadingIcon(e),o=i.children("li").size(),0==o?(ViewUtils.hideLoadingIcon(e),!1):(t.getHistoryRoomInfo(),n=!0))},n.getHistoryRoomInfo=function(){function e(e){e.getCount()<i&&(t._allGroupChatListReceived=!0),t._onGetGroupInfoListHistory(e)}var t=this,n=new ColumnSortCondition;n.getItems().removeAll(),n.getItems().add("updated_at"),n.getOrders().removeAll(),n.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC);var o=new ArrayList;o.add(new CommunityInfo);var i=t.getNumberOfGetCount();CubeeController.getInstance().getPublicGroupRoomInfoList(t._currentLoadedItemId,i,n,e)},n.getNumberOfGetCount=function(){switch(this._mode){case"sidebar":return 5;case"dialog":return 10;case"all":return 1e3;default:return 20}},n._onGetGroupInfoListHistory=function(e){var t=this;t._hideLoadingIconInSelf();var n=t.getHtmlElement();if(null!=n)for(var o=0;o<e.getCount();o++){var i=e.get(o),a=n.find("div[roomid='"+i.getRoomId()+"']");0==a.length&&t._addGroupChat(n,i,!1)}},n._hideLoadingIconInSelf=function(){var e=this,t=e.getHtmlElement();ViewUtils.hideLoadingIconInChild(t)}}(),function(){LayoutManager.prototype=$.extend({},ViewCore.prototype),LayoutManager.INIT_COMPLETE=!1,LayoutManager.MARGINAL_WIDTH=641,LayoutManager.MENUICON_WIDTH=40,LayoutManager.MODE={UNKNOWN:"UNKNOWN",DESKTOP:"DESKTOP",MOBILE:"MOBILE"},LayoutManager.isMobile=!1,LayoutManager.isDesktop=!1,LayoutManager.isHeadreScrolling=!1,LayoutManager.CURRENT_MODE=LayoutManager.MODE.UNKNOWN,LayoutManager.PREVIOUS_MODE=LayoutManager.MODE.UNKNOWN,LayoutManager.SCREEN={WIDTH:0,HEIGHT:0},LayoutManager.HEADER={WIDTH:0,HEIGHT:0},LayoutManager.ACTION={FRAME:0,CANVAS:0},LayoutManager.MAINOUTER={WIDTH:0,HEIGHT:0},LayoutManager.LIST={WIDTH:0,HEIGHT:0};var e=LayoutManager;$("#columnContainer"),$("#listContainer"),$("#switchToList"),$("#switchToColumn"),$("#mainHeader"),$("#mainContainer"),$("#actionbar"),$("#menuoptionalfunction"),$("#menubar"),$("#menuIcons"),$("#searchIcon_for_mobile"),$("#mainOuterContainer");LayoutManager.initScreenLayout=function(){e.INIT_COMPLETE||(e.INIT_COMPLETE=!0)},LayoutManager.displayList=function(){},LayoutManager.displayColumn=function(){},LayoutManager.resetScreenLayout=function(){},LayoutManager.switchToList=function(){},LayoutManager.switchToColumn=function(){},LayoutManager.resetDialogWidth=function(e){},LayoutManager.resetDialogHeight=function(e){},LayoutManager.iconAreaScrollToShow=function(e){},LayoutManager._iconAreaScrollToShow=function(e,t){}}(),function(){CautionIconView.TYPE_UNKNOWN=0,CautionIconView.TYPE_DEMAND_TASK=1,CautionIconView.prototype=$.extend({},IconAreaIconView.prototype);var e=(IconAreaIconView.prototype,CautionIconView.prototype);e.getType=function(){return this._type},e._init=function(e){var t=this;t._setType();var n=t._getHtml();t._htmlElement=$(n),t._addNotificationCount(t._count+1),t._addEventHandler()},e.getHtmlElement=function(){var e=this;return e._htmlElement},e.destruct=function(){var e=this,t=e._htmlElement;t&&t.off().remove()},e.updateNotificationArea=function(e){var t=this;t._addNotificationCount(t._count+1)},e._addNotificationCount=function(e){if(!(null==e||"number"!=typeof e||0>e)){var t=this,n=t._htmlElement,o=n.children(".notification-count");t._count=e,o.text(e)}},e._getHtml=function(){var e="",t=this;return e+="<span>",e+='<input type="image" class="menu-button menu-notify" src="'+t._imagePath+'" alt="'+Resource.getMessage("notification")+'" title="'+t._getIconTitle()+'">',e+='<button class="notification-count">'+t._count+"</button>",e+="</span>"},e._addEventHandler=function(){var e=this,t=e._htmlElement;t.on("click",function(){console.log("CautionIconView::_addEventHandler  click!")})},e._getIconPath=function(){return"images/notice_blue.png"},e._setType=function(){},e.onLogin=function(){var e=this;e.setNotificationCountPosition()},e.setNotificationCountPosition=function(){var e=this,t=e._htmlElement.children(".menu-notify"),n=e._htmlElement.children(".notification-count");n.position({my:"right top",at:"right top",of:t,offset:"4 0"}),n.css("margin-right",-20)},e.onNotificationRecieved=function(e){}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DemandTaskCautionIconView.prototype=$.extend({},CautionIconView.prototype,ViewCore.prototype);var e=CautionIconView.prototype,t=DemandTaskCautionIconView.prototype;t._init=function(t){var n=this;e._init.call(n,t),n._itemList=t,n._createNotificationTooltip()},t.updateNotificationArea=function(t){var n=this;e.updateNotificationArea.call(n,t),n._itemList.removeAll(),n._itemList=t,n._count=n._getAllItemCount(),0==n._count?NotificationIconManager.getInstance().removeCautionIcon(n):(n._addNotificationCount(n._count),n.updateNotificationTooltipMessage())},t._getAllItemCount=function(){for(var e=this,t=0,n=0;n<e._itemList.getCount();n++)t+=e._itemList.get(n).valueOf();return t},t._getIconPath=function(){return"images/demand_task_notice_yellow.png"},t._setType=function(){var e=this;e._type=CautionIconView.TYPE_DEMAND_TASK},t._getIconTitle=function(){return Resource.getMessage("demand_notification")},t._createNotificationTooltip=function(){var e=this,t=e._htmlElement,n=null;if(n={showOn:"click touchend",holder:t,content:e._notificationTooltipHtml(),delay:[TooltipView.getInstance().TOOLTIP_SHOW_TIME,TooltipView.getInstance().TOOLTIP_HIDE_TIME]},null==n)return!1;ViewUtils.isIE8()&&(n.updateOn="dummy");var o=t.children(".mTip").children("div.notification_list"),i=e._itemList.getByKey(String(ColumnInformation.TYPE_COLUMN_INBOX)),a=e._itemList.getByKey(String(ColumnInformation.TYPE_COLUMN_TASK));if(null!=i&&i.valueOf()>0){var r=o.children("[columntype='"+ColumnInformation.TYPE_COLUMN_INBOX+"']");e._addEventClick(r)}if(null!=a&&a.valueOf()>0){var r=o.children("[columntype='"+ColumnInformation.TYPE_COLUMN_TASK+"']");e._addEventClick(r)}return e._count=e._getAllItemCount(),e._addNotificationCount(e._count),!0},t.updateNotificationTooltipMessage=function(){var e=this,t=(e._htmlElement,""),n=e._itemList.getByKey(String(ColumnInformation.TYPE_COLUMN_INBOX)),o=e._itemList.getByKey(String(ColumnInformation.TYPE_COLUMN_TASK));null!=n&&n.valueOf()>0&&(t=e._notificationTooltipMessageHtml(ColumnInformation.TYPE_COLUMN_INBOX,n.valueOf())),e._updateIconContent(ColumnInformation.TYPE_COLUMN_INBOX,t),t="",null!=o&&o.valueOf()>0&&(t=e._notificationTooltipMessageHtml(ColumnInformation.TYPE_COLUMN_TASK,o.valueOf())),e._updateIconContent(ColumnInformation.TYPE_COLUMN_TASK,t)},t._updateIconContent=function(e,t){var n=this,o=n._htmlElement,i=o.children(".mTip").children("div.notification_list"),a=i.children("[columntype='"+e+"']");a.length>0&&a.remove(),""!=t&&(i.prepend(t),n._addEventClick(i.children("[columntype='"+e+"']")))},t._notificationTooltipHtml=function(){var e=this,t="",n=e._itemList.getByKey(String(ColumnInformation.TYPE_COLUMN_INBOX)),o=e._itemList.getByKey(String(ColumnInformation.TYPE_COLUMN_TASK));return null!=n&&n.valueOf()>0&&(t+=e._notificationTooltipMessageHtml(ColumnInformation.TYPE_COLUMN_INBOX,n.valueOf())),null!=o&&o.valueOf()>0&&(t+=e._notificationTooltipMessageHtml(ColumnInformation.TYPE_COLUMN_TASK,o.valueOf())),'<div class="notification_list">'+t+"</div>"},t._notificationTooltipMessageHtml=function(e,t){var n="";if(t>0){var o=ColumnView.DISPLAY_NAME_MY_TASK;e==ColumnInformation.TYPE_COLUMN_INBOX&&(o=ColumnView.DISPLAY_NAME_INBOX),n='<div style="cursor: pointer;" class="notification_listitem" ',n+='columntype="'+e+'" value="'+t+'">',n+="<h>"+o+"("+t+Resource.getMessage("notification_items")+")</h>",n+="</div>"}return n},t._addEventClick=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=this,n=t._htmlElement,o=(n.children("button.notification-count"),function(){function t(e){if(e)switch(n){case ColumnInformation.TYPE_COLUMN_TASK:ColumnManager.getInstance().addTaskColumn(null,!0);break;case ColumnInformation.TYPE_COLUMN_INBOX:ColumnManager.getInstance().addInboxColumn(!0)}}var n=1*e.attr("columntype");TabManager.getInstance().isActiveMyWorkplace()?t(!0):TabManager.getInstance().activeMyWorkplaceTab(t)});e.on("click",function(){o()})}},DemandTaskCautionIconView.getDemandTaskCount=function(){function e(e,n){function o(e,n){t.add(String(ColumnInformation.TYPE_COLUMN_INBOX),new Number(n)),NotificationIconManager.getInstance().askCautionExistence(CautionIconView.TYPE_DEMAND_TASK,t)}t.add(String(ColumnInformation.TYPE_COLUMN_TASK),new Number(n));var i=FilterManager.getFilter(FilterManager.TYPE_MESSAGE_COUNT_DEMAND_TASK,ColumnInformation.TYPE_COLUMN_INBOX),a=CubeeController.getInstance().getMessageCount(i,o);return a?void 0:void console.log("GetMessageCount Request is fail")}var t=new StringMapedArrayList,n=FilterManager.getFilter(FilterManager.TYPE_MESSAGE_COUNT_DEMAND_TASK,ColumnInformation.TYPE_COLUMN_TASK),o=CubeeController.getInstance().getMessageCount(n,e);return o?void 0:void console.log("GetMessageCount Request is fail")}}(),function(){ReadMessageSetter.setReadMessage=function(e){function t(e){}function n(e){var t=LoginUser.getInstance().getJid(),n=CubeeController.getInstance().getPersonData(t),o=new ExistingReaderItem;o.setPerson(n),o.setDate(new Date);var i=new SetReadMessageNotification;return i.setItemId(e),i.setExistingReaderItem(o),i}if(null!=e&&e.getReadFlag()!=Message.READ_STATUS_READ){var o=e.getItemId();if(null!=o&&""!=o){var i=CubeeController.getInstance().sendSetReadOneMessage(o,t);if(!i)throw"faild to send ExistingRead Message:";var a=o,r=n(a);e.setReadFlag(Message.READ_STATUS_READ);var s=r.getExistingReaderItem(),l=e.getExistingReaderInfo();if(null==l)l=new MessageExistingReaderInfo,l.setAllCount(1),l.getExistingReaderItemList().add(s),e.setExistingReaderInfo(l);else{var u=l.getAllCount();l.setAllCount(u+1),l.getExistingReaderItemList().removeAll(),l.getExistingReaderItemList().add(s)}ColumnManager.getInstance().onNotification(r)}}}}(),function(){var e=SideMenuExtensionParts.prototype;e.init=function(){var e=this;return e._frame=e._createFrame(),e._createEventHandler(),e},e.cleanUp=function(){var e=this;e._frame&&(e._frame.remove(),e._frame=null),e._parentObj&&(e._parentObj=null)},e._createFrame=function(){var e=this,t="";return t+='<div id="'+e._partsType+'-subview" class="ui-widget-content subviewTop" style="width:'+e._width+"px; min-width:"+e._width+'px;" >',t+='<div class="ui-dialog-titlebar ui-widget-header"><span class="ui-dialog-title" >'+Resource.getMessage("subview_title")+"</span>",t+='<a class="subview-close"><span class="ui-icon ui-icon-closethick">close</span></a></div>',t+='  <div class="subview-contents">',t+=e._getInnerHtml(),t+="  </div>",t+="</div>",$(t)},e._getInnerHtml=function(){return""},e._createEventHandler=function(){var e=this;e._frame.find(".ui-icon-closethick").on("click",function(){e.hide()})},e.show=function(){var e=this;if("none"==e._frame.css("display")){var t=e._getPosition();$("#"+e._partsType+"-subview").css({top:t.top+"px","margin-left":t.marginLeft+"px"}),e._frame.toggle("slide",{direction:"right",duration:0}),e._isShow=!0}},e.hide=function(){var e=this;"none"!=e._frame.css("display")&&(e._frame.toggle("slide",{direction:"left",duration:0}),e._isShow=!1,e.setListInnerContainerScrollForIE89())},e._getPosition=function(){var e=this,t=$("#headerContainer").outerHeight()+$("#mainHeader").outerHeight()+$("#userProfile").outerHeight()+4,n=e._width+10,o=-n-4;return{top:t,marginLeft:o}}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){ContactListSubView.prototype=$.extend({},SideMenuExtensionParts.prototype);var e=SideMenuExtensionParts.prototype,t=ContactListSubView.prototype;t.init=function(){var t=this;return e.init.call(t),t},t.cleanUp=function(){var t=this;e.cleanUp(),t._frame&&(t._frame.remove(),t._frame=null),t._selectedUserList&&(t._selectedUserList=null)},t._getInnerHtml=function(){var e=AuthorityInfo.getInstance().checkRights(AuthorityDef.AUTHORITY_ACTIONS.GC_CREATE),t="";return t+='<div class="subview-padding">',t+='  <div class="label aligin-top">'+Resource.getMessage("subview_label_selected_user")+'<span class="selectedUserNumber">0</span>'+Resource.getMessage("subview_label_selected_user_suffix")+"</div>",t+='  <div class="input-form">',t+='    <ul name="member-list" class="ui-widget-content ui-corner-all width-100 member-list-area"></ul>',t+="  </div>",t+="</div>",t+='<div class="ui-widget-content width-100"></div>',t+='<div class="footer-area">',t+='  <button id="btnStartChat" class="subview-action-btn chat" title="'+Resource.getMessage("subview_btn_title_start_chat")+'"></button>',e&&(t+='  <button id="btnStartGroupChat" class="subview-action-btn groupchat" title="'+Resource.getMessage("subview_btn_title_start_group_chat")+'"></button>'),t+='  <button id="btnAddContactList" class="subview-action-btn" title="'+Resource.getMessage("subview_btn_title_add_contact_list")+'"></button>',t+='  <button id="btnRemoveContactList" class="subview-action-btn" title="'+Resource.getMessage("subview_btn_title_remove_contact_list")+'"></button>',t+='  <button id="btnAddFavorite" class="subview-action-btn favorite" title="'+Resource.getMessage("subview_btn_title_add_favorite")+'"></button>',t+="</div>"},t._createEventHandler=function(){var e=this;e._frame.find(".ui-icon-closethick").on("click",function(){e._parentObj&&e._parentObj.removeSelectedUserListAll&&e._parentObj.removeSelectedUserListAll()}),e._frame.find("#btnStartChat").button({icons:{primary:"ui-icon-custom-chat"}}),e._frame.find("#btnStartGroupChat").button({icons:{primary:"ui-icon-custom-group-chat"}}),e._frame.find("#btnAddContactList").button({icons:{primary:"ui-icon-plusthick",secondary:"ui-icon-person"}}),e._frame.find("#btnRemoveContactList").button({icons:{primary:"ui-icon-minusthick",secondary:"ui-icon-person"}}),e._frame.find("#btnAddFavorite").button({icons:{primary:"ui-icon-custom-favorite"}}),e._frame.find(".subview-action-btn").css({"padding-left":"0px",height:"32px"}),e._updateFunctionButtonStatus(),e._frame.on("click","#btnStartChat",e._startChat.bind(e)),e._frame.on("click","#btnStartGroupChat",e._startGroupChat.bind(e)),e._frame.on("click","#btnAddContactList",e._addContactListMember.bind(e)),e._frame.on("click","#btnRemoveContactList",e._removeContactListMember.bind(e)),e._frame.on("click","#btnAddFavorite",e._addFavoriteGroupMember.bind(e))},t.getSelectedUserList=function(){return this._selectedUserList},t.addSelectedUserList=function(e){return null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))?(this._selectedUserList.add(e),this._selectedUserList):void 0},t.removeSelectedUserList=function(e){if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){for(var t=-1,n=this._selectedUserList,o=n.getCount(),i=e.getJid(),a=0;o>a;a++){var r=n.get(a).getJid();if(r==i){t=a;break}}return this._selectedUserList.remove(t),this._selectedUserList}},t.removeSelectedUserListAll=function(){return this._selectedUserList.removeAll(),null},t.receivedChangeSelectedUser=function(e){var t=this;t._showSelectedUserList(e),t._updateFunctionButtonStatus()},t._showSelectedUserList=function(e){var t=this,n=e.getCount(),o=t._frame.find('ul[name="member-list"]');o.empty();for(var i=0;n>i;i++){var a=e.get(i),r=t._createMemberElement(a);if(null==r)return;o.append(r)}t._frame.find(".selectedUserNumber").text(n)},t._createMemberElement=function(e){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return null;var t=this,n=ViewUtils.getUserNameByPerson(e),o=e.getLoginAccount(),i="",a=e.getJid();i='<li class="selected-user-height-ie">',i+='  <span class="item text-abbreviation user-item" ></span>',i+='  <span class="cancel"><img src="images/add_close.png" class="user-cancel-icon"></span>',i+="</li>",i=$(i);var r=n+"@"+o;return i.children("span.item").attr("jid",a),i.children("span.item").attr("title",r),i.children("span.item").text(r),i.children("span.cancel").children().on("click",function(){t._parentObj&&t._parentObj.removeSelectedUserList&&t._parentObj.removeSelectedUserList(e)}),i},t._updateFunctionButtonStatus=function(){function e(){var e=!1,t=!1;if(o>0){e=!0,t=!0;for(var i=0;o>i;i++){var a=n.get(i).getJid(),r=CubeeController.getInstance().isContactListMember(a);r?e=!1:t=!1}}return{add:e,remove:t}}var t=this,n=t._selectedUserList,o=n.getCount(),i=e(),a=i.add,r=i.remove,s=(i.remove,{"#btnStartChat":1==o,"#btnStartGroupChat":o>0,"#btnAddContactList":a,"#btnRemoveContactList":r,"#btnAddFavorite":r});for(var l in s)s[l]?$(l).button("enable"):$(l).button("disable")},t._startChat=function(){var e=this,t=e._selectedUserList;if(1==t.getCount()){var n=t.get(0).getJid(),o=new ColumnInformation;o.setColumnType(ColumnInformation.TYPE_COLUMN_CHAT),o.setFilterCondition(n),ColumnManager.getInstance().addColumn(o,!0,!0),e._parentObj&&e._parentObj.removeSelectedUserListAll&&e._parentObj.removeSelectedUserListAll()}},t._startGroupChat=function(){var e=this,t=function(){e._parentObj&&e._parentObj.removeSelectedUserListAll&&e._parentObj.removeSelectedUserListAll()};LayoutManager.switchToColumn();for(var n=new ArrayList,o=e._selectedUserList.getCount(),i=0;o>i;i++){var a=e._selectedUserList.get(i);null!=a&&n.add(a.getJid())}new DialogChatRoomCreateRoomInfoView(Resource.getMessage("dialog_title_create_groupchat"),n,t)},t._addContactListMember=function(){var e=this;if(e._selectedUserList){for(var t=e._selectedUserList.getCount(),n=new ArrayList,o=0;t>o;o++){var i=e._selectedUserList.get(o);if(null!=i){var a={jid:i.getJid(),contactListGroup:""};n.add(a)}}var r=function(t,n){t&&e._parentObj&&e._parentObj.onAddContactListMemberSuccessCallback&&e._parentObj.onAddContactListMemberSuccessCallback(t)};CubeeController.getInstance().addContactListMember(n,r)}},t._removeContactListMember=function(){var e=this;if(e._selectedUserList){var t=Resource.getMessage("dialog_delete_conf_message_for_contactlist"),n=function(){for(var t=e._selectedUserList.getCount(),n=new ArrayList,o=0;t>o;o++){var i=e._selectedUserList.get(o);if(null!=i){var a={jid:i.getJid()
};n.add(a)}}var r=function(t,n){t&&e._parentObj&&e._parentObj.onRemoveContactListMemberSuccessCallback&&e._parentObj.onRemoveContactListMemberSuccessCallback(t)};CubeeController.getInstance().removeContactListMember(n,r)};LayoutManager.switchToColumn(),new MessageBox(t,n,!0,!1,!1,e._size)}},t._addFavoriteGroupMember=function(){function e(e){t._parentObj&&t._parentObj.onAddFavoriteMemberSuccessCallback&&t._parentObj.onAddFavoriteMemberSuccessCallback(e,FavoriteStore.getInstance().getGroupMember(e)),t._parentObj&&t._parentObj.removeSelectedUserListAll&&t._parentObj.removeSelectedUserListAll()}var t=this;LayoutManager.switchToColumn();for(var n=new ArrayList,o=t._selectedUserList.getCount(),i=0;o>i;i++){var a=t._selectedUserList.get(i);null!=a&&n.add(a.getJid())}new DialogFavoriteGroupView(Resource.getMessage("dialog_title_add_favorite"),n,e)}}(),function(){ContactListAccordion.prototype=$.extend({},AccordionView.prototype);AccordionView.prototype,ContactListAccordion.prototype;$(function(){$("#contactList").accordion({header:"> div > div > h3",fillSpace:!0,collapsible:!0}).sortable({axis:"y",handle:"h3",stop:function(e,t){t.item.children("h3").triggerHandler("focusout")}})})}(),function(){$(function(){$("#contactList div.block-avatar").selectable()})}(),function(){ContactListGroupMemberAvatar.prototype=$.extend({},AvatarView.prototype);AvatarView.prototype,ContactListGroupMemberAvatar.prototype}(),function(){ContactListGroupMemberAvatarTooltip.prototype=$.extend({},TooltipView.prototype);TooltipView.prototype,ContactListGroupMemberAvatarTooltip.prototype}(),function(){function e(e){for(var t=[],n=e.getCount(),o=0;n>o;o++){var i=e.get(o);i&&i._profile&&i._profile._loginAccount&&t.push("@"+i._profile._loginAccount)}return t}CommunityMemberListSubView.prototype=$.extend({},ContactListSubView.prototype);var t=(ContactListSubView.prototype,CommunityMemberListSubView.prototype);t._getInnerHtml=function(){var e=this,t=TabManager.getInstance().getCurrentTabInfo(),n=t.type,o=e.communityId;if(n==TabItemView.TYPE_COMMUNITY)var o=t.extras.communityId;var i=AuthorityInfo.getInstance().checkRights(AuthorityDef.AUTHORITY_ACTIONS.GC_CREATE),a=AuthorityInfo.getInstance().checkRights(AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_MANAGE,o),r="";return r+='<div class="subview-padding">',r+='  <div class="label aligin-top">'+Resource.getMessage("subview_label_selected_user")+'<span class="selectedUserNumber">0</span>'+Resource.getMessage("subview_label_selected_user_suffix")+"</div>",r+='  <div class="input-form">',r+='    <ul name="member-list" class="ui-widget-content ui-corner-all width-100 member-list-area"></ul>',r+="  </div>",r+="</div>",r+='<div class="ui-widget-content width-100"></div>',r+='<div class="footer-area">',r+='  <button id="btnStartChat" class="subview-action-btn chat" title="'+Resource.getMessage("subview_btn_title_start_chat")+'"></button>',i&&(r+='  <button id="btnStartGroupChat" class="subview-action-btn groupchat" title="'+Resource.getMessage("subview_btn_title_start_group_chat")+'"></button>'),o&&a&&(r+='  <button id="btnAddMember" class="subview-action-btn add_member" title="'+Resource.getMessage("subview_btn_title_community_add_member")+'"></button>',r+='  <button id="btnUnsubscribeMember" class="subview-action-btn unsubscribe_member" title="'+Resource.getMessage("subview_btn_title_community_unsubscribe_member")+'"></button>'),r+="</div>"},t._createEventHandler=function(){var e=this;e._frame.find(".ui-icon-closethick").on("click",function(){e._parentObj&&e._parentObj.removeSelectedUserListAll&&e._parentObj.removeSelectedUserListAll()}),e._frame.find("#btnStartChat").button({icons:{primary:"ui-icon-custom-chat"}}),e._frame.find("#btnStartGroupChat").button({icons:{primary:"ui-icon-custom-group-chat"}}),e._frame.find("#btnAddMember").button({icons:{primary:"ui-icon-plusthick",secondary:"ui-icon-custom-community"}}),e._frame.find("#btnUnsubscribeMember").button({icons:{primary:"ui-icon-minusthick",secondary:"ui-icon-custom-community"}}),e._frame.find(".subview-action-btn").css({"padding-left":"0px",height:"32px"}),e._updateFunctionButtonStatus(),e._frame.on("click","#btnStartChat",e._startChat.bind(e)),e._frame.on("click","#btnStartGroupChat",e._startGroupChat.bind(e)),e._frame.on("click","#btnAddMember",e._onClickAddMember.bind(e)),e._frame.on("click","#btnUnsubscribeMember",e._onClickUnsubscribeMember.bind(e))},t._updateFunctionButtonStatus=function(){var e=this,t=e._selectedUserList,n=t.getCount(),o={"#btnStartChat":1==n,"#btnStartGroupChat":n>0,"#btnAddMember":!1,"#btnUnsubscribeMember":!1};for(var i in o)o[i]?e._frame.find(i).button("enable"):e._frame.find(i).button("disable");e._updateMemberControlButton()},t._updateMemberControlButton=function(){function e(e){if(t._frame){var n="disable",o="disable";if(e){var i=LoginUser.getInstance().getJid();e.hasOwner(i)?(n="enable",o="enable"):e.hasGeneralMember(i)&&(n="enable")}t._frame.find("#btnAddMember").button(n),t._frame.find("#btnUnsubscribeMember").button(o)}}var t=this;t._communityId&&CubeeController.getInstance().getCommunityMemberInfo(t._communityId,e)},t._onClickAddMember=function(){var t=this;if(t._selectedUserList){var n=e(t._selectedUserList),o=TabManager.getInstance().getCurrentTabInfo(),i=o.type;if(i==TabItemView.TYPE_COMMUNITY){var a=o.extras.communityId;if(a){var r=new DialogSelectCommunityAddMemberView(a);r.showDialog(),r.setInputAccount(n)}}}},t._onClickUnsubscribeMember=function(){var t=this;if(t._selectedUserList){var n=e(t._selectedUserList),o=TabManager.getInstance().getCurrentTabInfo(),i=o.type;if(i==TabItemView.TYPE_COMMUNITY){var a=o.extras.communityId;if(a){var r=new DialogSelectCommunityForceLeaveMemberView(a);r.showDialog(),r.setInputAccount(n)}}}}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){SideMenuUserListView.prototype=$.extend({},SideMenuParts.prototype);var e=SideMenuParts.prototype,t=SideMenuUserListView.prototype;t.init=function(){var e=this;return e.element=e.createFrame(),e},t.cleanUp=function(){var t=this;if(e.cleanUp(),t._parentObj&&(t._parentObj=null),t._mTipList){var n=t._mTipList.getCount(),o=0,i=function a(){if(o>=n)return void(t._mTipList=null);var e=t._mTipList.get(o);$("#"+e).remove(),o++,setTimeout(function(){a()},1)};setTimeout(function(){i()},1)}},t.refreshAccrodion=function(e){var t=this,n=t.getHtmlElement();if(n.accordion){var o=!1;e||(o=n.accordion("option","active")),t._accordionSetting.active=o,n.accordion("destroy").accordion(t._accordionSetting).sortable(t._accordionSortableSetting)}},t.createFrame=function(){var e=this,t=e._getInnerHtml();return e._frame=$(t),e._createEventHandler(),e._frame},t._getInnerHtml=function(){var e=this,t="";return t+='<div class="'+e._partsType+" "+this._listViewType+' box-border flex1 olient-vertical vertical-scroll  ui-widget ui-helper-reset hide-view"></div>'},t.getParentHtmlElement=function(){var e=this;return e._frame.parent()},t.getPersonData=function(e){},t._createEventHandler=function(){var e=this,t=e.getHtmlElement();$(t).on("click","ul.list-contact.sidebar_list li",function(){$(this);e._startChat($(this))})},t._getSelectedUserList=function(){var e=this;return e._parentObj&&e._parentObj.getSelectedUserList?e._parentObj.getSelectedUserList():void 0},t._addSelectedUserList=function(e){var t=this;null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&t._parentObj&&t._parentObj.addSelectedUserList&&t._parentObj.addSelectedUserList(e)},t._removeSelectedUserList=function(e){var t=this;null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&t._parentObj&&t._parentObj.removeSelectedUserList&&t._parentObj.removeSelectedUserList(e)},t.receivedChangeSelectedUser=function(e){var t=this;t._frame.find("."+t._partsType+"-box").removeClass(t._partsType+"-selected");for(var n=e.getCount(),o=0;n>o;o++){var i=e.get(o).getJid(),a=t._frame.find("."+t._partsType+"-box[jid='"+i+"']");a.length>0&&a.addClass(t._partsType+"-selected")}},t._startChat=function(e){var t=e.attr("jid"),n=new ColumnInformation;n.setColumnType(ColumnInformation.TYPE_COLUMN_CHAT),n.setFilterCondition(t),ColumnManager.getInstance().addColumn(n,!0,!0),ViewUtils.unsetNewNoticeMark(e),NotificationIconManager.getInstance().onColumnClicked(n)},t.showPerson=function(e){var t=this,n=t.getHtmlElement();if(!e||!$(n).find("ul.list-contact.sidebar_list").length)return!1;var o=t._createHtmlOnePersonFromPersonData(e);return $(n).find("ul.list-contact.sidebar_list").append(o),!0},t._addContactListDialog=function(e,t){var n=this,o=(n.getHtmlElement(),t+10),i=!1;e.getCount()<=o&&(o=e.getCount(),i=!0);for(var a=t;o>a;a++){var r=n._createHtmlOnePersonFromPersonData(e.get(a));$("#chatlist_modal .list-contact.sidebar_list").append(r)}return i},t._asyncShowPersonList=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=this.getHtmlElement(),i=new ArrayList,a=5;if(n){if(null!=n.mode&&"dialog"==n.mode){var a=10;if(e.getCount()>a)for(var r=0;a>r;r++)i.add(e.get(r));else i=e}else if(null!=n.numOfChat)if("number"==typeof n.numOfChat)for(var r=0;r<n.numOfChat;r++)i.add(e.get(r));else if("string"==typeof n.numOfChat&&"all"==n.numOfChat)for(var r=0;r<e.getCount();r++)i.add(e.get(r))}else if(e.getCount()>a)for(var r=0;a>r;r++)i.add(e.get(r));else i=e;this._asyncAddGroupToPersonList(o,this._createOneGroupData("",i,!0),t)},t._asyncAddGroupList=function(e,t,n){var o=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return void n(!1);if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return void n(!1);t.isMemberList=!1;var i=o._createHtmlOneGroupFromGroupData(t);e.append(i),setTimeout(function(){n(!0)},1)},t._asyncAddPersonList=function(e,t,n){function o(){for(var e=20,s=0;e>s;s++){if(r>=t.person.length){t.isMemberList=!0;break}var l=t.person[r],u=i._createHtmlOnePersonFromPersonData(l,t.name);a.append(u),r++}return r>=t.person.length?(setTimeout(function(){n(!0)},1),void ViewUtils.hideLoadingIcon(a)):void setTimeout(function(){o()},1)}var i=this;if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))&&!t.isMemberList){var a=e.children("li.list-contact").eq(0),r=0;setTimeout(function(){ViewUtils.showLoadingIcon(a),o()},1)}},t._asyncAddGroupToPersonList=function(e,t,n){function o(){for(var e=20,a=0;e>a;a++){if(s>=t.person.length){t.isMemberList=!0;break}var l=t.person[s],u=i._createHtmlOnePersonFromPersonData(l);r.append(u),s++}return s>=t.person.length?void setTimeout(function(){n(!0)},1):void setTimeout(function(){o()},1)}var i=this;if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return void n(!1);if(null==t||"object"!=("undefined"==typeof t?"undefined":_typeof(t)))return void n(!1);var a=i._createHtmlOneGroupFromGroupData(t);e.append(a);var r=e.children("ul.list-contact"),s=0;setTimeout(function(){o()},1)},t._createOneGroupData=function(e,t,n,o){for(var i=o?o:t.getCount(),a={name:e,personCount:i,person:[],existing:n},r=t.getCount(),s=0;r>s;s++)a.person[s]=t.get(s);return a},t._createHtmlOneGroupFromGroupData=function(e){var t='<ul class="list-contact sidebar_list"></ul>';return $(t)},t._createHtmlOnePersonFromPersonData=function(e,t){var n=this,o=e,i=o.getJid(),a=!1,r=FavoriteStore.getInstance().getGroupIdByName(t);r>=0&&(a=!0);var t=ViewUtils.getGroupName(o),s="";s=ViewUtils.getAvatarUrl(o)==ViewUtils.DEFAULT_USER_AVATAR_SRC?ViewUtils.getDefaultAvatarHtml(o):ViewUtils.getAvatarDataHtmlFromPerson(o);var l="";l+='<li jid="'+i+'">',l+='  <a title="'+Utils.convertEscapedHtml(o.getUserName())+"  "+Utils.convertEscapedHtml(t)+'">',l+='    <span class="ico ico_user status '+ViewUtils.getPresenceColorCss(o.getPresence())+'">',l+=s,l+="    </span>",l+='    <span class="name">'+Utils.convertEscapedHtml(o.getUserName())+ViewUtils.getUserStatusString(o.getStatus())+"</span>",l+='    <span class="group">'+Utils.convertEscapedHtml(t)+"</span>",l+="</a></li>";var u=$(l),c=u.find(".info-user-nickname"),d=c.attr("title");c.attr("title",d);var g=u.find(".block-avatar");if(TooltipView.getInstance().setAvatarToolTip(TooltipView.TYPE_USER_AVATAR,g,!1,{align:"bottom left"}),n._mTipList&&g.data("mTip")&&g.data("mTip").tipID&&n._mTipList.add(g.data("mTip").tipID),a){var m;m=_bIE89?u.children().children().children().children().children("div.cancel").children():u.children("div.cancel").children(),m.on("click",function(o){var i=function(){var t=[];t.add(e.getJid()),FavoriteStore.getInstance().removeGroupMember(r,t),n._parentObj&&n._parentObj.removeSelectedUserList&&n._parentObj.onRemoveFavoriteListMemberSuccessCallback(r,t)};o.stopPropagation();var a=Resource.getMessage("dialog_label_remove");a=a.replace("[[1]]",e.getUserName()),a=a.replace("[[2]]",t),new MessageBox(a,i,!0,null,Resource.getMessage("dialog_title_remove_favorite"))})}return u},t._getUserNameAreaHtml=function(e){var t="";if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return t;var n=(e.getJid(),e.getUserName()),o=e.getLoginAccount(),i=e.getStatus();return t='<div class="contact-list-info info-user-nickname box-border-for-abbreviation" title="'+Utils.convertEscapedTag(n)+ViewUtils.getUserStatusString(i)+" @"+Utils.convertEscapedTag(o)+'">'+Utils.convertEscapedHtml(n)+ViewUtils.getUserStatusString(i)+'<span class="sender-account">@'+Utils.convertEscapedHtml(o)+"</span>"},t._getGroupByName=function(e,t){for(var n=0;n<e.length;n++)if(e[n].name==t)return e[n];return null}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t,n){for(var o=e.find('.group[groupname="'+t+'"]'),i=0;i<n.length;i++){var a=n[i].getJid(),r=o.find('div.contact-list-box[jid="'+a+'"]');r.length>-1&&r.eq(0).remove()}}function t(e,t,n){var o=Utils.convertEscapedHtml(t),i=e.find('.group[groupname="'+o+'"]'),a=(i.children(".list-contact").children(),t+"("+n+")"),r=i.children("h3").children("a");r.attr("title",t),r.text(a)}ContactListMemberView.prototype=$.extend({},SideMenuUserListView.prototype);var n=(SideMenuUserListView.prototype,ContactListMemberView.prototype);n.getPersonData=function(e){return CubeeController.getInstance().getPersonData(e)},n.notifyAddContactListMemberCallBack=function(e){function t(){if(r>=i)return o.refreshAccrodion(),void ViewUtils.clearAutoCompleteEventToTextArea(ViewUtils.TYPE_CONTACT_LIST);var a=function f(){if(g++,g>=c)return r++,void setTimeout(function(){t()},1);var e=u[g],o=d[g];n(e,o,l,!1,f)},s=e.get(r),l=s.getPerson(),u=s.getContactListGroup(),c=u.length,d=s.getPosition();if(0==c)return n(Resource.getMessage("group_title_no_group"),-1,l,!0),r++,void setTimeout(function(){t()},1);var g=0,m=u[g],_=d[g];n(m,_,l,!1,function(){a()})}function n(e,t,n,i,r){function s(e,t){if(t instanceof Person){var n=a[e.group];if(n){var o=n.person;o.splice(e.person,0,t),n.personCount=o.length}}else a.push(t);null!=r&&"function"==typeof r&&setTimeout(function(){r()},1)}var l=Utils.convertEscapedTag(e),u=o.getHtmlElement(),c=u.find('.group[groupname="'+l+'"]'),d={group:c.index(),person:0};if(c.length>0){var g=o._getGroupByName(a,l);if(g){if(g.isMemberList){var m=o._createHtmlOnePersonFromPersonData(n),_=c.find(".list-contact").children();0==t?c.find(".list-contact").prepend(m):0>t||_.length<t?(c.find(".list-contact").append(m),d.person=_.length):(_.eq(t-1).after(m),d.person=t-1)}c=u.find('.group[groupname="'+l+'"]');var f=(c.children(".list-contact").children(),g.person.length+1),p=e+"("+f+")";_headerElem=c.children("h3").children("a"),_headerElem.attr("title",e),_headerElem.text(p),s(d,n)}}else{var g={};g.name=e,g.personCount=1,g.person=[n],g.existing=i;var h=u.find("#groupList-"+o._listViewType);d.group=h.children().length,o._asyncAddGroupToPersonList(h,g,function(e){s(d,g)})}}if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var o=this,i=e.getCount(),a=ContactList.getInstance().getSortedData(),r=0;setTimeout(function(){t()},1)}},n.notifyRemoveContactListMemberCallBack=function(e){function t(){function t(e,t){var n=Utils.convertEscapedHtml(e),o=i.find('.group[groupname="'+n+'"]'),a=o.find("a").text(),r=a.substring(0,a.lastIndexOf("("))+"("+t+")";o.find("a").text(r),o.find("a").attr("title",r)}function r(e){var t=Utils.convertEscapedHtml(e),n=i.find('.group[groupname="'+t+'"]');n.length>-1&&n.eq(0).remove()}function s(e,t){var n=Utils.convertEscapedHtml(e),o=i.find('.group[groupname="'+n+'"]'),a=o.find('div.contact-list-box[jid="'+t+'"]');a.length>-1&&a.eq(0).remove()}for(var l=0;o>l;l++)for(var u=e.get(l).jid,c=0;c<a.length;c++){for(var d=a[c],g=d.person,m=g.length,_=m,f=FavoriteStore.getInstance().getGroupIdByName(d.name),p=0;p<g.length;p++)if(g[p]._jid==u){if(f>=0){var h=[];h.add(g[p]._jid),FavoriteStore.getInstance().removeGroupMember(f,h)}g.splice(p,1),_=g.length,d.personCount=_,p--,d.isMemberList&&s(d.name,u)}0==_&&0>f?(a.splice(c,1),c--,r(d.name)):m!=_&&t(d.name,_)}n.refreshAccrodion(!0),ViewUtils.clearAutoCompleteEventToTextArea(ViewUtils.TYPE_CONTACT_LIST)}if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var n=this,o=e.getCount(),i=n.getHtmlElement(),a=ContactList.getInstance().getSortedData();setTimeout(function(){t()},1)}},n.resizeContent=function(){var e=this;ViewUtils.isIE89()&&e._setGroupListHeightForIE89()},n.resizeAreaForIE89=function(){var e=this;ViewUtils.isIE89()&&e._setGroupListHeightForIE89()},n._setGroupListHeightForIE89=function(){if(ViewUtils.isIE89()){var e=this,t=e._frame;if(null!=t&&"none"!=t.css("display")){var n=t.parent(),o=t.find("#groupList-"+e._listViewType),i=n.parent().outerHeight(!0),a=t.closest("dd").find("#ui-tab").outerHeight(),r=i-a;o.height(r)}}},n.notifyAddFavoriteMemberCallBack=function(n,o){for(var i=this,a=[],r=o.length,s=0;r>s;s++)a[s]=i.getPersonData(o[s]);var l=FavoriteStore.getInstance().getGroupName(n),u=Utils.convertEscapedHtml(l),c=ContactList.getInstance().getSortedData(),d=i.getHtmlElement(),g=d.find('.group[groupname="'+u+'"]'),m=c[g.index()],_=m.person;if(e(d,u,_),_.splice(0,_.length),m.personCount=0,m.person=a,m.personCount=r,m.isMemberList){var f={};for(s=0;r>s;s++)f=i._createHtmlOnePersonFromPersonData(a[s],l),g.find(".list-contact").append(f)}t(d,l,r)},n.notifyRemoveFavoriteMemberCallBack=function(n,o){for(var i=this,a=FavoriteStore.getInstance().getGroupName(n),r=Utils.convertEscapedHtml(a),s=ContactList.getInstance().getSortedData(),l=i.getHtmlElement(),u=l.find('.group[groupname="'+r+'"]'),c=s[u.index()],d=c.person,g=o.length,m=[],_=0;g>_;_++)for(var f=o[_],p=0;p<d.length;p++)d[p]._jid==f&&(m.add(d[p]),d.splice(p,1),c.personCount--);m.length>0&&(e(l,r,m),t(l,a,d.length))}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){SearchPersonView.prototype=$.extend({},SideMenuParts.prototype);var e=SideMenuParts.prototype,t=SearchPersonView.prototype;SearchPersonView.TAB_TYPE_INNER_SEARCH=0,SearchPersonView.TAB_TYPE_ALL_USER_SEARCH=1,t.init=function(){var t=this;return e.init.call(t),t._frame=t._createFrame(),t._createEventHandler(),t},t.cleanUp=function(){var t=this;e.cleanUp.call(t),t._parentObj&&(t._parentObj=null)},t._createFrame=function(){var e=this,t="";return t='<div id="ui-tab" class="user-search-tab">',t+='  <ul class="userSearchTab">',t+='    <li><a href="#fragment-1"><span>'+Resource.getMessage("sideview_tab_search_contact_list_member")+"</span></a></li>",t+='    <li><a href="#fragment-2"><span>'+Resource.getMessage("sideview_tab_search_all_user")+"</span></a></li>",t+="  </ul>",t+='  <div id="fragment-1" class="tab-contents">',t+='    <div class="box-border search-main-view width-100">',t+='      <input type="text" placeholder="'+Resource.getMessage("sideview_text_search_placeholder")+'" id="txtSearchGroupUser" class="txtSearchUser ui-corner-all" size="5"/>',t+='      <button type="button" class="btnSearchUser btn-user-search" title="'+Resource.getMessage("sideview_btn_search_exec")+'" id="btnContactListUserSearch"/>',t+="    </div>",t+="  </div>",t+='  <div id="fragment-2" class="tab-contents">',t+='    <div class="box-border search-main-view width-100">',t+='      <input type="text" placeholder="'+Resource.getMessage("sideview_text_search_placeholder")+'" id="txtSearchAllUser" class="txtSearchUser ui-corner-all" size="5"/>',t+='      <button type="button" class="btnSearchUser btn-user-search" title="'+Resource.getMessage("sideview_btn_search_exec")+'" id="btnAllUserSearch" />',t+="    </div>",t+="  </div>",t+="</div>",t=$(t).tabs({selected:0,select:function(t,n){e._selectedTabIndex=n.index}})},t._createEventHandler=function(){var e=this;e._frame.find(".btnSearchUser").button({icons:{primary:"ui-icon-search"},text:!1}),e._frame.find(".txtSearchUser").on("keypress",function(t){return t.which&&13==t.which||t.keyCode&&13==t.keyCode?(e._excecute(),e._lastExecSearchTabIndex=e._selectedTabIndex,!1):void 0}),e._frame.find(".btnSearchUser").on("click",function(){e._lastExecSearchTabIndex=e._selectedTabIndex,e._excecute()})},t._excecute=function(){var e=this,t=e._selectedTabIndex,n=null,o=null;switch(t){case SearchPersonView.TAB_TYPE_INNER_SEARCH:n=e._frame.find("#txtSearchGroupUser").attr("value");break;case SearchPersonView.TAB_TYPE_ALL_USER_SEARCH:n=e._frame.find("#txtSearchAllUser").attr("value")}var i=Utils.trimStringMulutiByteSpace(n);i&&""!=i&&(o=ViewUtils.getKeywordFilterFromKeywordInputString(i,!1),e._parentObj&&"function"==typeof e._parentObj.searchExecute&&e._parentObj.searchExecute(t,o))},t.searchAllUser=function(e,t,n){if(t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))){var o=new ColumnSortCondition;o.getItems().removeAll(),o.getItems().add("login_account"),o.getOrders().removeAll(),o.getOrders().add(ColumnSortCondition.SORT_ORDER_ASC);var i=t,a=new ColumnSearchCondition(i,o),r=Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST");return CubeeController.getInstance().searchPerson(e,r,a,n)}},t.notifyAddContactListMemberCallBack=function(e){},t.notifyRemoveContactListMemberCallBack=function(e){}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){SearchPersonResultView.prototype=$.extend({},SideMenuUserListView.prototype);var e=SideMenuUserListView.prototype,t=SearchPersonResultView.prototype;t.initialize=function(e){var t=this;e&&(t._searchInfo.condition=e),t._currentLoadedJidForAllUserSearch=0,t._allUserListReceivedForAllUserSearch=!1,t._searchResultList={}},t.cleanUp=function(){var t=this;e.cleanUp.call(t),t._searchInfo=null,t._searchResultList=null},t._getInnerHtml=function(){var e=this,t="";return t+='<div class="'+e._partsType+"-"+e._listViewType+' box-border flex1 olient-vertical vertical-scroll  ui-widget ui-helper-reset hide-view">',t+="</div>"},t._createEventHandler=function(){var t=this;e._createEventHandler.call(t);var n=t.getHtmlElement();n.on("bottom","#groupList-"+t._listViewType,function(){t._showReadMore()})},t._showReadMore=function(){var e,t=this,n=!1,o=0,i=t.getHtmlElement(),a=i.find(".list-contact");if(!a||"object"!=("undefined"==typeof a?"undefined":_typeof(a)))return n;var r=t._searchInfo.isOpenSearchResultView(),s=t._searchInfo.lastExecSearchTabIndex();if(r&&s==SearchPersonView.TAB_TYPE_ALL_USER_SEARCH){if(1==t._allUserListReceivedForAllUserSearch)return!1;if(e=i.parent().children("div:last"),e.hasClass("loading-readmore"))return!1;if(ViewUtils.showLoadingIcon(i),o=a.children("div").size(),0==o)return ViewUtils.hideLoadingIcon(i),!1;var l=t._searchInfo.condition;return t._parentObj&&t._parentObj.searchExecuteFromAllUser&&t._parentObj.searchExecuteFromAllUser(l),n=!0}},t._asyncShowPersonList=function(e,t){function n(){setTimeout(function(){t&&"function"==typeof t&&t()},1)}function o(){var e=r.getHtmlElement();if(!e)return void n();var t="";t+='<div id="groupList-'+r._listViewType+'" class="'+r._listViewType+' group-list box-border-for-abbreviation olient-vertical flex1 vertical-scroll">',t+='  <div class="btn-back-to-list " align="right">',t+='    <button type="button" class="btnBackToOriginal">'+Resource.getMessage("sideview_btn_back_to_contact_list")+"</button>",t+="  </div>",t+="</div>",e.append(t);var o=e.find("#groupList-"+r._listViewType);r._asyncAddGroupToPersonList(o,l,function(e){if(e&&l.person.length>0){var t=l.person[l.person.length-1],n=t.getId();r._currentLoadedJidForAllUserSearch=n}}),setTimeout(function(){i()},1)}function i(){var e=r.getHtmlElement();return null==e?void n():(e.accordion("destroy").accordion({header:"> div > div > h3",fillSpace:!0,collapsible:!1,active:0}).sortable({axis:"y",handle:"h3",stop:function(e,t){t.item.children("h3").triggerHandler("focusout")}}),e.find(".group a").css("background-color","#FFDDAA"),void setTimeout(function(){a()},1))}function a(){var e=r.getHtmlElement();if(null==e)return void n();r._frame.find(".btnBackToOriginal").button(),r._frame.find(".btnBackToOriginal").on("click",function(){r._parentObj&&r._parentObj.onRemoveView&&(r._parentObj.onRemoveView(),r._parentObj=null),r.cleanUp(),r._frame.remove()});var t=e.find("#groupList-"+r._listViewType);t.bottom({proximity:.1}),ViewUtils.hideLoadingIcon(r.getHtmlElement()),e.removeClass("hide-view"),r.resizeAreaForIE89(),r.resizeContent(),t.scrollTop(0),n()}var r=this;r.getHtmlElement().children().remove(),r.getHtmlElement().addClass("hide-view"),ViewUtils.showLoadingIcon(r.getHtmlElement());var s=Resource.getMessage("sideview_label_search_result"),l=r._createOneGroupData(s,e,!0,e.getAllItemCount());return o(),!0},t.onSearchPersonCallback=function(e,t){var n=this,o=e.getCount();if(o<Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST")&&(n._allUserListReceivedForAllUserSearch=!0),0==n._currentLoadedJidForAllUserSearch)return void n._asyncShowPersonList(e,function(){n._refreshSearchResultList(e),t()});for(var i=0;o>i;i++){var a=e.get(i),r=a.getJid(),s=n._createHtmlOnePersonFromPersonData(a),l=n.getHtmlElement().find(".group[groupname]");l.length>0&&0==l.find('.list-contact div[jid="'+r+'"]').length&&(l.find(".list-contact").append(s),n._currentLoadedJidForAllUserSearch=a.getId()),n._addSearchResultPersonData(a)}ViewUtils.hideLoadingIcon(n.getHtmlElement()),n.resizeAreaForIE89(),n.resizeContent(),t()},t.getPersonData=function(e){var t=this;return t._searchResultList[e]},t._refreshSearchResultList=function(e){if(null!=e){var t=this;t._searchResultList={};for(var n=e.getCount(),o=0;n>o;o++){var i=e.get(o);if(null!=i){var a=i.getJid();t._searchResultList[a]=i}}}},t._addSearchResultPersonData=function(e){if(null!=e){var t=this,n=e.getJid();t._searchResultList[n]=e}},t.resizeContent=function(){function e(){var e=n.find("#groupList-"+t._listViewType);if(1==e.length&&e.prop("clientHeight")==e.prop("scrollHeight")&&!t._allUserListReceivedForAllUserSearch){var o=t._searchInfo.condition;setTimeout(function(){t._parentObj&&t._parentObj.searchExecuteFromAllUser&&t._parentObj.searchExecuteFromAllUser(o)},1)}}var t=this,n=t.getHtmlElement();if("none"!=n.closest("dd").css("display")){var o=t._searchInfo.isOpenSearchResultView(),i=t._searchInfo.lastExecSearchTabIndex();o&&i==SearchPersonView.TAB_TYPE_ALL_USER_SEARCH&&e()}},t.resizeAreaForIE89=function(){if(ViewUtils.isIE89()){var e=this;if(null!=e._frame){var t=e._frame,n=t.find("#groupList-"+e._listViewType),o=t.closest("dd").outerHeight(!0),i=t.closest("dd").find("#ui-tab");_searchViewHeight=i.outerHeight(!0);var a=o-_searchViewHeight;n.height(a)}}}}(),function(){MessageBox.prototype=$.extend({},DialogOkCancelView.prototype);var e=DialogOkCancelView.prototype,t=MessageBox.prototype;t._init=function(){var t=this;e._init.call(t),$("#dialog_area").html(t.getDeleteMessageCheckHtml());var n={title:t.title,buttons:t._buttons,modal:!0,autoOpen:!0,draggable:LayoutManager.isDesktop?!0:!1,resizable:!1,close:function(){}};t._width&&(n.width=LayoutManager.resetDialogWidth(t._width)),t._height&&(n.height=LayoutManager.resetDialogHeight(t._height)),t._dialogInnerElement.dialog(n)},t.getDeleteMessageCheckHtml=function(){var e=this,t="";return t+='<div class="control-group form_group">',t+='  <label class="control-label form_label message-box">',t+=e._displayMessage,t+="  </label>",t+="</div>"}}(),function(){DialogSelectCommunityConfirmAuthorityMemberView.prototype=$.extend({},DialogSelectCommunityMemberView.prototype);var e=(DialogSelectCommunityMemberView.prototype,DialogSelectCommunityConfirmAuthorityMemberView.prototype);e._init=function(){function e(e){var t=e.content.users,n={},o=!0,i=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){var l=r.value;n[l.user]=l.policies[0].rights[0].action}}catch(u){i=!0,a=u}finally{try{!o&&s["return"]&&s["return"]()}finally{if(i)throw a}}return n}var t=this;t.frame=t.getHtml(),t._dialogAreaElement.html(t.frame),t._dialogInnerElement=t._dialogAreaElement.children(),t.ps=new PerfectScrollbar(t.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t.personCount=0,t.frame.find(".scroll_content").off("scroll"),t.frame.find(".scroll_content").on("scroll",function(){$(this).get(0).scrollHeight===$(this).scrollTop()+$(this).get(0).clientHeight&&t.personCount!==t.allPersons.length&&t.addPersons()}),t._dialogInnerElement.find(".success_btn").off("click"),t._dialogInnerElement.find(".success_btn").on("click",function(){t.cleanup()}),Promise.all([CubeeController.getInstance().getUserPoliciesByResource(t._communityId),t.getCommunityMemberList(t._communityId)]).then(function(n){var o=e(n[0]);t.allPersons=n[1],t.allAuthLists=o,t.addPersons()})["catch"](function(e){})},e.getHtml=function(){var e='<div id="projectauthority_modal" class="card modal_card">          <div class="card_title">            <p>'+Resource.getMessage("conf_confirm_authority_tooltip")+'</p>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>            <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+'</span></button>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},e._createMemberElement=function(e,t){var n=this;LoginUser.getInstance().getJid();$.each(e,function(e,o){var i=o._profile,a=Utils.getSafeStringData(i._nickName);a=Utils.convertEscapedHtml(a);var r=i._loginAccount,s=ViewUtils.getAvatarDataHtmlFromPerson(o),l='<li title="'+a+" @"+r+'"><label>              <span class="ico ico_user"></span>               <span class="name">'+a+'</span>               <span class="group"></span>               <select class="field" name="authority">              <option value="'+AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_MANAGE+'">'+Resource.getMessage("policy_manage")+'</option>              <option value="'+AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_SEND+'">'+Resource.getMessage("policy_send")+'</option>              <option value="'+AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_VIEW+'">'+Resource.getMessage("policy_view")+"</option>              </select>              </label></li>",u=$(l);n._dialogInnerElement.find(".select_list").append(u);if(u.find(".ico_user").append(s),u.find(".group").text("@"+r).html(),t.hasOwnProperty(r)){var c=t[r];u.find('select.field option[value="'+c+'"]').prop("selected",!0),
u.find("select.field").attr("disabled","disabled")}})},e.getCommunityMemberList=function(e){return new Promise(function(t,n){function o(e){for(var n=new Array,o=e.getOwnerList(),i=o.getCount(),a=e.getGeneralMemberList(),r=a.getCount(),s=0;i>s;s++){var l=o.get(s);n.push(l)}for(var s=0;r>s;s++){var u=a.get(s);n.push(u)}t(n)}CubeeController.getInstance().getCommunityMemberInfo(e,o)})},e.addPersons=function(){for(var e=Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST"),t=this,n=[],o=t.personCount;o<Math.min(t.personCount+e,t.allPersons.length);o++)n.push(t.allPersons[o]);t.personCount+=n.length,t._createMemberElement(n,t.allAuthLists)},e.submit=function(e){_self.cleanup()},e.cleanup=function(){ViewUtils.modal_allexit()}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogSelectCommunityChangeAuthorityMemberView.prototype=$.extend({},DialogSelectCommunityMemberView.prototype);var e=(DialogSelectCommunityMemberView.prototype,DialogSelectCommunityChangeAuthorityMemberView.prototype);e._init=function(){function e(e){var t=e.content.users,n={},o=!0,i=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){var l=r.value;n[l.user]=l.policies[0].rights[0].action}}catch(u){i=!0,a=u}finally{try{!o&&s["return"]&&s["return"]()}finally{if(i)throw a}}return n}var t=this;t.frame=t.getHtml(),t._dialogAreaElement.html(t.frame),t._dialogInnerElement=t._dialogAreaElement.children(),t.ps=new PerfectScrollbar(t.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t.personCount=0,t.frame.find(".scroll_content").off("scroll"),t.frame.find(".scroll_content").on("scroll",function(){$(this).get(0).scrollHeight===$(this).scrollTop()+$(this).get(0).clientHeight&&t.personCount!==t.allPersons.length&&t.addPersons()}),t._dialogInnerElement.find(".success_btn").off("click"),t._dialogInnerElement.find(".success_btn").on("click",function(){for(var e=new ArrayList,n=t._dialogInnerElement.find("select.field[name=authority]"),o=[],i=0;i<n.length;i++)o.push(n[i].value);$.each(t.allPersons,function(n,i){e.add({jid:i._jid,action:o[n]?o[n]:t.allAuthLists[i._profile._loginAccount],accountName:i._profile._loginAccount})}),t._request(e,t)}),Promise.all([CubeeController.getInstance().getUserPoliciesByResource(t._communityId),t.getCommunityMemberList(t._communityId)]).then(function(n){var o=e(n[0]);t.allPersons=n[1],t.allAuthLists=o,t.addPersons()})["catch"](function(e){})},e.getHtml=function(){var e='<div id="projectauthority_modal" class="card modal_card">          <div class="card_title">            <p>'+Resource.getMessage("dialog_title_group_chat_change_authority_member")+'</p>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>            <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+'</span></button>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},e._createMemberElement=function(e,t){var n=this,o=LoginUser.getInstance().getJid();$.each(e,function(e,i){var a=i._profile,r=Utils.getSafeStringData(a._nickName);r=Utils.convertEscapedHtml(r);var s=a._loginAccount,l=ViewUtils.getAvatarDataHtmlFromPerson(i),u='<li title="'+r+" @"+s+'"><label>              <span class="ico ico_user"></span>               <span class="name">'+r+'</span>               <span class="group"></span>               <select class="field" name="authority">              <option value="'+AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_MANAGE+'">'+Resource.getMessage("policy_manage")+'</option>              <option value="'+AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_SEND+'">'+Resource.getMessage("policy_send")+'</option>              <option value="'+AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_VIEW+'">'+Resource.getMessage("policy_view")+"</option>              </select>              </label></li>",c=$(u);n._dialogInnerElement.find(".select_list").append(c);if(c.find(".ico_user").append(l),c.find(".group").text("@"+s).html(),t.hasOwnProperty(s)){var d=t[s];c.find('select.field option[value="'+d+'"]').prop("selected",!0),o===i.getJid()&&c.find("select.field").attr("disabled","disabled")}})},e.getCommunityMemberList=function(e){return new Promise(function(t,n){function o(e){if(null==e)return void n();for(var o=new Array,i=e.getOwnerList(),a=i.getCount(),r=e.getGeneralMemberList(),s=r.getCount(),l=0;a>l;l++){var u=i.get(l);o.push(u)}for(var l=0;s>l;l++){var c=r.get(l);o.push(c)}t(o)}CubeeController.getInstance().getCommunityMemberInfo(e,o)})},e.addPersons=function(){for(var e=Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST"),t=this,n=[],o=t.personCount;o<Math.min(t.personCount+e,t.allPersons.length);o++)n.push(t.allPersons[o]);t.personCount+=n.length,t._createMemberElement(n,t.allAuthLists)},e._createExistMemberElement=function(e,t){if(null==e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return null;var n=e.getJid(),o=e.getUserName(),i=e.getLoginAccount(),a=ViewUtils.getAvatarUrl(e),r=LoginUser.getInstance().getLoginAccount(),s="";s+='<li id="change_authority" class="change_authority authority-member-item" id="auth_li_'+i+'">',s+='  <span class="row-item"><img class="avatar" alt="'+Utils.convertEscapedTag(o)+'" src="'+a+'"></span>',s+='  <span class="row-item item text-abbreviation"></span>',s+='  <div class="item-left-position">',s+='    <span class="row-item">',s+='      <select class="form_control" name="groupchat_authority" id="auth_list_'+i+'">',s+='        <option selected value="'+AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_MANAGE+'">'+Resource.getMessage("policy_manage")+"</option>",s+='        <option value="'+AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_SEND+'">'+Resource.getMessage("policy_send")+"</option>",s+='        <option value="'+AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_VIEW+'">'+Resource.getMessage("policy_view")+"</option>",s+="      </select></span>",s+="  </div>",s+="</li>",s=$(s);var l=o+"@"+i;if(s.children("span.item").attr("jid",n),s.children("span.item").attr("accountName",i),s.children("span.item").text(l),t.hasOwnProperty(i)){var u=t[i];s.find("select#auth_list_"+i).val(u)}else s.find("select#auth_list_"+i).append($("<option selected />").html("").val(""));return r==i&&s.find("select#auth_list_"+i).prop("disabled",!0),s},e._createMemberListFromMemberListElement=function(){var e=this,t=e._dialogInnerElement,n=t.find('ul[name="member-list"]');if(0!=n.length){var o=new ArrayList;return n.children(".change_authority").each(function(){var e=$(this).children("span.item").attr("accountName"),t=$(this).children("span.item").attr("jid"),n=$("#auth_list_"+e).children("option:selected").val();o.add({jid:t,action:n,accountName:e})}),o}},e._request=function(e,t){function n(e,t){function n(e,t){for(var n in e)-1!=e[n].indexOf(t)&&e[n].splice(e[n].indexOf(t),1);return e}for(var o,i=(o={},_defineProperty(o,u[0],[]),_defineProperty(o,u[1],[]),_defineProperty(o,u[2],[]),o),a=t,r=0;r<e.getCount();r++){var s=e.get(r);if(""==s.action)return null;for(var l=!1,c=0;c<u.length;++c){var d=u[c];if(s.action==d&&-1==t[d].indexOf(s.accountName)){i[d].push(s.accountName),l=!0;break}}l||(a=n(a,s.accountName))}return{update:i,"delete":a}}function o(e){var t,n=e.content.users,o=(t={},_defineProperty(t,u[0],[]),_defineProperty(t,u[1],[]),_defineProperty(t,u[2],[]),t),i=!0,a=!1,r=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;o[c.policies[0].rights[0].action].push(c.user)}}catch(d){a=!0,r=d}finally{try{!i&&l["return"]&&l["return"]()}finally{if(a)throw r}}return o}function i(e){e.hasOwnProperty("content")&&a(403e3==e.content.reason?Resource.getMessage("authority_err"):Resource.getMessage("change_member_authority_err"));var t=[],n=!0,o=!1,i=void 0;try{for(var r,d=u[Symbol.iterator]();!(n=(r=d.next()).done);n=!0){var g=r.value;0!=c.update[g].length&&t.push(CubeeController.getInstance().assignPolicyToUser(Utils.getPolicyIdByActionAndResource(g,l),c.update[g])),0!=c["delete"][g].length&&t.push(CubeeController.getInstance().unassignPolicyFromUser(c["delete"][g],Utils.getPolicyIdByActionAndResource(g,l)))}}catch(m){o=!0,i=m}finally{try{!n&&d["return"]&&d["return"]()}finally{if(o)throw i}}Promise.all(t).then(function(e){s.closeDialog(e)})["catch"](function(e){a(403e3==e.content.reason?Resource.getMessage("authority_err"):404e3==e.content.reason?e.content.error_users+Resource.getMessage("not_assign_account_type_err"):Resource.getMessage("change_member_authority_err"))})}function a(e){s._dialogInnerElement.find("#dialog-error").text(e),s._dialogInnerElement.find(".success_btn").attr("disabled",!1)}function r(){ViewUtils.hideLoadingIconInChild($("#dialog-error")),ViewUtils.showLoadingTopInChild($("#dialog-error")),s._dialogInnerElement.find(".success_btn").attr("disabled",!0),s._dialogInnerElement.find("#dialog-error").text("")}if(null!=e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!=t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))&&0!=e.getCount()){var s=this,l=s._communityId,u=[AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_MANAGE,AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_SEND,AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_VIEW],c={};1==e.getCount()?s.cleanup():(r(),CubeeController.getInstance().getUserPoliciesByResource(l).then(function(t){var r=o(t);if(c=n(e,r),null==c)return void a(Resource.getMessage("not_selected_authority_info"));if(0!=c.update.manageCommunity.length||0!=c["delete"].manageCommunity.length){ownerList=new ArrayList;for(var s=0;s<e.getCount();s++)member=e.get(s),member.action==AuthorityDef.AUTHORITY_ACTIONS.COMMUNITY_MANAGE&&ownerList.add(member.jid);CubeeController.getInstance().updateCommunityOwner(l,ownerList,i)}else i("changedOwnerList")})["catch"](function(e){a(Resource.getMessage("change_member_authority_err"))}))}},e.closeDialog=function(e){var t=this,n=this,o=new CommunityDetailsView;o.init(this._communityId),new Promise(function(e){setTimeout(function(){e(o.setCommunityDetailData(t._communityId))},3e3)}),n.cleanup()},e._isValidateOk=function(e,t,n){var o=this,i=o._validateInputMemberList(e,t);o._isValidateJoinedMember(i,n)},e._validateJoinedMember=function(e,t,n){for(var o="",i=t.getCount(),a=0;i>a;a++)""!==o&&(o+=" "),o+=Utils.convertEscapedHtml("@"+t.get(a).getLoginAccount());return""!==o&&e.errList.add('"'+o+'"'+Resource.getMessage("add_member_err_exist")),{memberList:n,errList:e.errList}},e.cleanup=function(){ViewUtils.modal_allexit()}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){for(var t=e.getCount(),n=LoginUser.getInstance().getJid(),o="",i=0;t>i;i++){var a=e.get(i),r=a.getJid();if(n!=r){o+='<li><label> <span class="ico ico_user">';var s=Utils.getSafeStringData(a.getUserName());s=Utils.convertEscapedHtml(s);var l=a.getAvatarType(),u=a.getAvatarData(),c=Utils.getSafeArrayData(a.getGroup()),d=c.length>0?c[0]:Resource.getMessage("group_title_no_group");if(null==l||""==l||null==u||""==u)o+='<div id="avatar">',o+='<span class="ico ico_user">'+ViewUtils.getDefaultAvatarHtml(a)+"</span>",o+="</div>";else{var g=ViewUtils.getAvatarUrl(a);o+='<img src="'+g+'" alt="">'}o+=_selectedUserList.indexOf(r)>=0?'</span> <span class="name">'+s+'</span> <span class="group">'+Utils.convertEscapedHtml(d)+'</span> <label class="checkbox"><input type="checkbox" name="wizardlist" value="'+r+'" checked="checked"><span></span></label></label></li>':'</span> <span class="name">'+s+'</span> <span class="group">'+Utils.convertEscapedHtml(d)+'</span> <label class="checkbox"><input type="checkbox" name="wizardlist" value="'+r+'"><span></span></label></label></li>'}}return o}function t(){var e=new PerfectScrollbar($(".wizard_content").find(".scroll_content")[0],{suppressScrollX:!0});dlg_scr.push(e)}function n(){_searchResultPersonList=null,_selectedUserList=null,TabManager.getInstance().selectOrAddTabByCommunityInfo("myworkplace",null),ViewUtils.modal_allexit(),$(".wizard_overlay").animate({opacity:0},500,function(){$(this).remove()})}function o(e,t){"prev"===e?t.find(".current").removeClass("current").prev().addClass("current"):"next"===e&&t.find(".current").removeClass("current").next().addClass("current");var n=t.find(".current").index(),o=t.width();t.children(".modal_slide_wrapper").css("transform","translateX("+n*-o+"px)")}function i(){var e='input[type="checkbox"]input[name="wizardlist"]';$(".wizard_content .list_wrapper").off("change").on("change",e,function(e){a($(this)),$("#number").text(_selectedUserList.length)})}function a(e){if(e.prop("checked"))-1==_selectedUserList.indexOf(e.val())&&_selectedUserList.push(e.val());else{var t=_selectedUserList.indexOf(e.val());_selectedUserList.splice(t,1)}}function r(){_searchResultPersonList=null;var e=$("#wizard_chatList").find("#search_chatlist").val(),t=Utils.trimStringMulutiByteSpace(e);if(t||""!=t){var n=ViewUtils.getKeywordFilterFromKeywordInputString(t,!1);(n||"object"==("undefined"==typeof n?"undefined":_typeof(n)))&&(_searchResultPersonList=new SearchResultPersonList,l(0,n))}}function s(){for(var e=ContactList.getInstance().getCount(),t=0;e>t;t++){var n=ContactList.getInstance()._array[t].getJid(),o=$(".wizard_content").find('input[type="checkbox"]input[value="'+n+'"]');o.length>0&&o.prop("disabled",!0)}}function l(t,n){function o(t){for(var o=t.getCount(),a=0;o>a;a++){var r=t.get(a);_searchResultPersonList.add(r)}if(o<Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST")){$(".wizard_content .list_wrapper").find(".select_list").empty();var u=Promise.resolve();u.then(function(){return e(_searchResultPersonList)}).then(function(e){$(".wizard_content").find(".select_list").html(e),s(),$("#number").text(_selectedUserList.length),dlg_scr.forEach(function(e){e.update()})}).then(function(){i()})["catch"](function(e){console.log("Error WizardView "+e)})}else l(t.get(o-1).getId(),n)}var a=new ColumnSortCondition;a.getItems().removeAll(),a.getItems().add("login_account"),a.getOrders().removeAll(),a.getOrders().add(ColumnSortCondition.SORT_ORDER_ASC);var r=n,u=new ColumnSearchCondition(r,a),c=t,d=Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST");return CubeeController.getInstance().searchPerson(c,d,u,o)}var u=new WizardView;WizardView.getInstance=function(){return u};var c=WizardView.prototype;c.showWizard=function(n){var o=this;_selectedUserList=[],ViewUtils.hideLoginLoadingIcon($("#loginErrMsg"));var a=$("#wizard_profile");a.html(o.getProfileInnerHtml(n));var r=$("#wizard_password");r.html(o.getPasswordInnerHtml());var l=$("#wizard_chatList");l.html(o.getChatListInnerHtml()),$(".wizard_content").find(".select_list").html(e(n.getContactList())),s(),t();var u=new Profile;o.setEventHandler(u),i()},c.getProfileInnerHtml=function(e){var t=e.getLoginUserPerson().getUserName();t=Utils.convertEscapedTag(t);var n="";return n+='<div class="wizard_img">',n+='  <img src="images/wizard_img_01.png" alt="">',n+="</div>",n+='<div class="wizard_content">',n+='  <div class="wizard_title">',n+="    <p>"+Resource.getMessage("wizard_profile_title")+"</p>",n+="  </div>",n+='  <div class="modal_content_wrapper">',n+='    <div class="modal_content">',n+='      <p class="modal_title">'+Resource.getMessage("wizard_profile_nickname_label")+"</p>",n+=LoginUser.getInstance().isUpdatablePersonData()?'      <input type="text" maxlength="20" class="field ui-corner-all" id="nick_name" autofocus value="'+t+'">':'      <input type="text" maxlength="20" class="field ui-corner-all" id="nick_name" autofocus value="'+t+'" disabled>',n+="    </div>",n+='    <div class="modal_content">',n+='      <p class="modal_title">'+Resource.getMessage("wizard_profile_avater_label")+"</p>",n+='      <div class="cropped_wrapper">',n+='        <div id="profile-logo-field">',n+='          <input type="file" name="logofile" class="avatar_file" size="30" accept="image/jpeg, image/gif, image/png">',n+="        </div>",n+='        <div class="img_edit_area">',n+='          <div class="imageBox imageBox">',n+='            <div class="thumbBox"></div>',n+='            <div class="spinner" style="display: none">Loading...</div>',n+="          </div>",n+='          <div class="action">',n+='            <button class="modal_btn zoom_btn" id="btnZoomIn"><i class="fa fa-plus"></i>'+Resource.getMessage("wizard_btn_avater_up")+"</button>",n+='            <button class="modal_btn zoom_btn" id="btnZoomOut"><i class="fa fa-minus"></i>'+Resource.getMessage("wizard_btn_avater_down")+"</button>",n+='            <button class="modal_btn success_btn" id="btnCrop">'+Resource.getMessage("wizard_profile_avater_OK")+"</button>",n+="          </div>",n+="        </div>",n+='        <div class="cropped"></div>',n+="      </div>",n+="    </div>",n+="  </div>",n+='  <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',n+='  <div class="btn_wrapper slide_btn_wrapper cf">',n+='    <a class="modal_btn success_btn modal_slider_btn" id="wizard_next_password">'+Resource.getMessage("wizard_btn_next")+"</a>",n+="  </div>",n+="</div>"},c.getPasswordInnerHtml=function(){var e="";return e+='<div class="wizard_img">',e+='  <img src="images/wizard_img_02.png" alt="">',e+="</div>",e+='<div class="wizard_content">',e+='  <div class="wizard_title">',e+="    <p>"+Resource.getMessage("wizard_password_title")+"</p>",e+="  </div>",e+='  <div class="modal_content_wrapper">',e+='    <div class="modal_content">',e+='      <p class="modal_title">'+Resource.getMessage("wizard_password_new_label")+"</p>",e+=LoginUser.getInstance().isUpdatablePersonData()?'      <input type="password" id="new_password" class="field ui-corner-all">':'      <input type="password" id="new_password" class="field ui-corner-all" disabled>',e+="    </div>",e+='    <div class="modal_content">',e+='      <p class="modal_title">'+Resource.getMessage("wizard_password_new_confirm_label")+"</p>",e+=LoginUser.getInstance().isUpdatablePersonData()?'      <input type="password" id="new_password_confirm" class="field ui-corner-all"></p>':'      <input type="password" id="new_password_confirm" class="field ui-corner-all" disabled></p>',e+="    </div>",e+='    <p class="notes">'+Resource.getMessage("wizard_password_not_specified_label")+'<a class="txt_btn modal_slider_btn modal_slider_btn_next">'+Resource.getMessage("wizard_password_skip_label")+"</a>"+Resource.getMessage("wizard_password_not_specified_label_suffix")+"</p>",e+="  </div>",e+='  <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',e+='  <div class="btn_wrapper slide_btn_wrapper cf">',e+='     <a class="modal_btn modal_slider_btn modal_slider_btn_prev" id="wizard_before_profile">'+Resource.getMessage("wizard_btn_before")+"</a>",e+='     <a class="modal_btn success_btn modal_slider_btn" id="wizard_next_chatlist">'+Resource.getMessage("wizard_btn_next")+"</a>",e+="  </div>",e+="</div>"},c.getChatListInnerHtml=function(){var e="";return e+='<div class="wizard_img">',e+='  <img src="images/wizard_img_03.png" alt="">',e+="</div>",e+='<div class="wizard_content">',e+='  <div class="wizard_title">',e+="    <p>"+Resource.getMessage("wizard_chatlist_title")+"</p>",e+="  </div>",e+='  <div class="select_menu">',e+='    <span class="select_number"><i class="fa fa-user"></i><span id="number">0</span></span>',e+='    <div class="search_form">',e+='      <input type="text" id="search_chatlist" class="field" placeholder="'+Resource.getMessage("wizard_chatlist_conditions")+'">',e+='      <button type="button" id="search" class="user_search_btn ico_btn"><i class="fa fa-search"></i></button>',e+="    </div>",e+='    <label class="modal_btn all_check">'+Resource.getMessage("wizard_chatlist_allcheck")+'<label class="checkbox"><input type="checkbox"><span></span></label></label>',e+="  </div>",e+='  <div class="list_wrapper scroll_content">',e+='    <ul class="modal_list select_list">',e+="    </ul>",e+="  </div>",e+='  <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',e+='  <div class="btn_wrapper slide_btn_wrapper cf">',e+='    <a class="modal_btn modal_slider_btn modal_slider_btn_prev" id="wizard_before_password">'+Resource.getMessage("wizard_btn_before")+"</a>",e+='    <a class="modal_btn success_btn modal_slider_btn modal_slider_btn_complete wizard_modal_exit" id="wizard_btn_end">'+Resource.getMessage("wizard_btn_start")+"</a>",e+="  </div>",e+="</div>"},c.setEventHandler=function(e){$("#wizard_next_password").on("click",function(){function t(e){return e?void(LoginUser.getInstance().isUpdatablePersonData()?o("next",$(n).parents(".modal_slider")):(o("next",$(n).parents(".modal_slider")),o("next",$(n).parents(".modal_slider")))):void i.find("#dialog-error").text(Resource.getMessage("wizard_profile_change_failed"))}var n=this,i=$("#wizard_profile"),a=i.find("#nick_name"),r=a.val();return e.setNickName(r),0==Utils.trimStringMulutiByteSpace(r).length?void i.find("#dialog-error").text(Resource.getMessage("wizard_profile_nickname_empty")):void CubeeController.getInstance().changeProfile(e,t)}),$("#wizard_next_chatlist").on("click",function(){function e(e,i){if(!e){var a=Resource.getMessage("config_password_change_failed");return 8==i?a=Resource.getMessage("config_current_password_invalid"):32==i&&(a=Resource.getMessage("config_password_complexity")),void n.find("#dialog-error").text(a)}LoginTicket.password(r),o("next",$(t).parents(".modal_slider"))}var t=this,n=$("#wizard_password"),i=n.find("#new_password"),a=n.find("#new_password_confirm"),r=Utils.convertEscapedTag(i.val()),s=Utils.convertEscapedTag(a.val());if(null==r||""==r)return void n.find("#dialog-error").text(Resource.getMessage("wizard_password_new_must"));if(!ViewUtils.checkLength(i,LoginView.MIN_LENGTH_PASSWORD,LoginView.MAX_LENGTH_PASSWORD))return void n.find("#dialog-error").text(Resource.getMessage("wizard_password_Length1")+LoginView.MIN_LENGTH_PASSWORD+Resource.getMessage("wizard_password_Length2")+LoginView.MAX_LENGTH_PASSWORD+".");if(!ViewUtils.checkRegexp(i,/([!-~])+$/))return void n.find("#dialog-error").text(Resource.getMessage("wizard_password_Contain"));if(r!=s)return void n.find("#dialog-error").text(Resource.getMessage("wizard_password_new_confirm_must"));var l=LoginTicket.read(),u=LoginTicket.loginTicket2Account(l),c=u.pw;CubeeController.getInstance().changePassword(c,r,e)}),$("#wizard_before_profile").on("click",function(){o("prev",$(this).parents(".modal_slider"))}),$(".modal_slider_btn_next").on("click",function(){o("next",$(this).parents(".modal_slider"))}),$("#wizard_btn_end").on("click",function(){for(var e=$("#wizard_chatList"),t=new ArrayList,o=_selectedUserList.length,i=0;o>i;i++){var a={jid:_selectedUserList[i],contactListGroup:""};t.add(a)}if(t.getCount()>0){var r=function(t,o){if(t&&t.addFailureMemberList.getCount()>0){$("#wizard_btn_end").prop("disabled",!0);var i=Resource.getMessage("wizard_chatList_add_failed"),a=o?o:"";e.find("#dialog-error").text(i+a)}else{for(var r=TabManager.getInstance().selectedInfo,s=r.getSideListViewImpl().sidebarParts,l=0;l<s.length;l++)"function"==typeof s[l].onNotifyAddChatMember&&s[l].onNotifyAddChatMember(t.addSuccessMemberList);n()}};CubeeController.getInstance().addContactListMember(t,r)}else n()}),$("#wizard_before_password").on("click",function(){LoginUser.getInstance().isUpdatablePersonData()?o("prev",$(this).parents(".modal_slider")):(o("prev",$(this).parents(".modal_slider")),o("prev",$(this).parents(".modal_slider")))}),$("#search").on("click",function(){$('.all_check .checkbox input[type="checkbox"]').prop("checked",!1),r()}),$("#search_chatlist").on("keypress",function(e){(e.which&&13===e.which||e.keyCode&&13===e.keyCode)&&($('.all_check .checkbox input[type="checkbox"]').prop("checked",!1),r())});var t,i={imageBox:".imageBox",thumbBox:".thumbBox",spinner:".spinner",imgSrc:""};$(".img_edit_area, .cropped").hide(),$(".avatar_file").click(function(){$("#wizard_profile").find("#dialog-error").text(""),t="",$(this).val(""),$(this).parents(".cropped_wrapper").find(".cropped").hide(),$(this).parents(".cropped_wrapper").find(".img_edit_area").hide(),e.setAvatarData(""),e.setAvatarType("")}),$(".avatar_file").change(function(){var e=$("#wizard_profile");if(e.find("#dialog-error").text(""),this.files.length>0){var n=this.files[0];switch(n.type){case"image/jpeg":case"image/gif":case"image/png":case"image/bmp":break;default:return void e.find("#dialog-error").text(Resource.getMessage("wizard_profile_image_failed"))}reader=new FileReader,reader.onload=function(e){i.imgSrc=e.target.result,t=new cropbox(i)},reader.readAsDataURL(this.files[0]),$(this).parents(".cropped_wrapper").find(".cropped").hide(),$(this).parents(".cropped_wrapper").find(".img_edit_area").fadeIn()}}),$(".wizard_content #btnCrop").on("click",function(){$("#wizard_profile").find("#dialog-error").text("");var n=t.getDataURL();$(this).parents(".img_edit_area").nextAll(".cropped").replaceWith('<div class="cropped"><img src="'+n+'" class="mCS_img_loaded"></div>'),$(this).parents(".img_edit_area").hide(),$(this).parents(".img_edit_area").nextAll(".cropped").fadeIn();var o=n.split(";")[0];o=o.split(":")[1];var i=n.split(",")[1];e.setAvatarData(i),e.setAvatarType(o)}),$(".wizard_content #btnZoomIn").on("click",function(){t.zoomIn()}),$(".wizard_content #btnZoomOut").on("click",function(){t.zoomOut()}),$("#wizard_modal").find(".modal_exit_btn").on("click",function(){n()}),$(document).on("keydown","#wizard_modal",function(e){(e.which&&27===e.which||e.keyCode&&27===e.keyCode)&&n()}),$(".modal_slider").each(function(){var e=$(this).width(),t=e*$(this).find(".modal_slide").length;$(this).children(".modal_slide_wrapper").css("width",t+"px").children(".modal_slide").css("width",e+"px").first().addClass("current"),$(this).find("*").attr("tabindex",-1).end().find(".current").find("*").attr("tabindex","")}),$('.all_check .checkbox input[type="checkbox"]').on("click",function(){$(this).prop("checked")?($(this).parents(".select_menu").siblings(".list_wrapper").find('.checkbox input[type="checkbox"]').prop("checked",!0),$('[name="wizardlist"]:checked').each(function(){a($(this))})):($(this).parents(".select_menu").siblings(".list_wrapper").find('.checkbox input[type="checkbox"]').prop("checked",!1),$('[name="wizardlist"]').each(function(){a($(this))})),$("#number").text(_selectedUserList.length)})}}(),function(){function e(e,t){var n=parseInt(e.slice(1,3),16),o=parseInt(e.slice(3,5),16),i=parseInt(e.slice(5,7),16);return t?"rgba("+n+", "+o+", "+i+", "+t+")":"rgb("+n+", "+o+", "+i+")"}function t(e){return-1==e.indexOf("#")&&(e="#"+e),SelectAndAddProjectView._colors.indexOf(e)>=0?e:SelectAndAddProjectView._default_color}var n=SelectAndAddProjectView.prototype,o=new SelectAndAddProjectView;SelectAndAddProjectView.getInstance=function(){return o},n.getProjectList=function(e){function t(t){n.setProjectList(t);var o=AuthorityInfo.getInstance();o.checkRights("createCommunity")||$(".project_list .list_wrapper").find("#addproject_modal").remove(),n.setEventHandler(),$("#prj_ico").hide(),$("#side-bar-recent-ico").hide(),$("#side-bar-murmur-ico").show(),null!=e&&n.setHeaderIconAndColor(e),n._groupchatListView=(new GroupChatListView).init({mode:"sidebar"}),n._chatListView=(new ContactListView).init(),n._communityList=t}var n=this,o=new ColumnSortCondition;o.getItems().removeAll(),o.getItems().add("updated_at"),o.getOrders().removeAll(),o.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC),CubeeController.getInstance().getJoinedCommunityInfoList(0,Conf.getVal("NUMBER_OF_ITEMS_BY_PER_PROJECT_LIST_COUNT"),o,t)},n.setProjectList=function(e){var t=this,n=$(".project_list");n.html(t.getProjectInnerHtml(e))},n.setHeaderIconAndColor=function(n){var o=this;if(null==n){$("#header").find(".navbar").css("background-color",""),$(".content-wrapper").css("background-color","");var i=LoginUser.getInstance().getExtras();i&&i.backgroundImage?$('div[name="mainWrapper"]').addClass(i.backgroundImage):$('div[name="mainWrapper"]').addClass("dashboard_wrapper"),$('div[name="navbar"]').addClass("dashboard_header_navbar"),$("#watch_view").addClass("dashboard_content-wrapper");var a="linear-gradient(161deg, rgb(193, 48, 48) 0%, rgb(225, 196, 63) 100%) 50% 50% / 100% 100% no-repeat";$("#sidebar-gj-tp table").css({background:a}),o._headerElement.html('<img src="images/cubee_ico_02.png" alt="">'),$(".project_btn").attr("data_value","myworkplace"),$(".project_btn").html(Resource.getMessage("MyWorkplace")+'<i class="fa fa-caret-down"></i>'),$("#prj_ico").hide(),$("#side-bar-recent-ico").hide(),$("#side-bar-murmur-ico").show()}else{$('div[name="mainWrapper"]').removeClass(function(e,t){return(t.match(/\bdashboard_w\S+/g)||[]).join(" ")}),$('div[name="navbar"]').removeClass("dashboard_header_navbar"),$("#watch_view").removeClass("dashboard_content-wrapper");var r=t(n.getMemberEntryType());$("#header").find(".navbar").css("background-color",r),$(".content-wrapper").css("background-color",r);var a="linear-gradient(161deg, "+e(r)+" 0%, "+e(r,.5)+" 100%) no-repeat 50% 50% / 100% 100%";$("#sidebar-gj-tp table").css({background:a});var s=n.getLogoUrl(),l=null;if(null==s||""==s){var u=Utils.avatarCreate({name:n.getRoomName(),type:SelectAndAddProjectView.AvaterType});l='<div class="no_img" style="background-color:'+u.color+'"><div class="no_img_inner">'+u.name+"</div></div>"}else l='<div class="no_img"><div class="no_img_inner"><img src="'+s+'" alt=""></div></div>';o._headerElement.html(l),$(".project_btn").attr("data_value",n.getRoomId()),$(".project_btn").html(Utils.convertEscapedHtml(n.getRoomName(),!1)+'<i class="fa fa-caret-down"></i>'),$("#prj_ico").show(),$("#side-bar-recent-ico").show(),$("#side-bar-murmur-ico").hide()}},n.getProjectInnerHtml=function(e){var t=this;t._displayProjects=new CommunityList;var n=e.getCount(),o=e.get(0),i="";if(t.setHeaderIconAndColor(null),0==n)return i+='<a data_value="myworkplace" class="project_btn" data-toggle="tooltip" data-placement="right" data-original-title="'+Resource.getMessage("main_header_project_list_title")+'">'+Resource.getMessage("MyWorkplace")+'<i class="fa fa-caret-down"></i></a>',i+='<div class="list_wrapper">',i+='  <ul class="list" id="project">',i+='    <li><a data_value="myworkplace" class="txt_btn">'+Resource.getMessage("MyWorkplace")+"</a></li>",i+="  </ul>",i+='  <ul class="list">',i+='    <li><a  class="txt_btn" id="projectlist_modal"><i class="fa fa-address-book"></i>'+Resource.getMessage("main_header_project_all")+"</a></li>",i+='    <li><a  class="txt_btn" id="addproject_modal"><i class="fa fa-pencil"></i>'+Resource.getMessage("main_header_create_project")+"</a></li>",i+='    <li><a  class="txt_btn" id="public_project_list">'+Resource.getMessage("main_header_public_project_list")+"</a></li>",i+="  </ul>",i+="</div>";i+='<a data_value="myworkplace" class="project_btn" data-toggle="tooltip" data-placement="right" data-original-title="'+Resource.getMessage("main_header_project_list_title")+'">'+Resource.getMessage("MyWorkplace")+'<i class="fa fa-caret-down"></i></a>',i+='<div class="list_wrapper">',i+='  <ul class="list" id="project">',i+='    <li><a data_value="myworkplace" class="txt_btn">'+Resource.getMessage("MyWorkplace")+"</a></li>";for(var a=0;n>a;a++){var o=e.get(a);i+='    <li><a data_value="'+o.getRoomId()+'" class="txt_btn">'+Utils.convertEscapedHtml(o.getRoomName(),!1)+"</a></li>",t._displayProjects.add(o.getRoomId(),o)}return i+="  </ul>",i+='  <ul class="list">',i+='    <li><a class="txt_btn" id="projectlist_modal"><i class="fa fa-address-book"></i>'+Resource.getMessage("main_header_project_all")+"</a></li>",
i+='    <li><a class="txt_btn" id="addproject_modal"><i class="fa fa-pencil"></i>'+Resource.getMessage("main_header_create_project")+"</a></li>",i+='    <li><a class="txt_btn" id="public_project_list">'+Resource.getMessage("main_header_public_project_list")+"</a></li>",i+="  </ul>",i+="</div>"},n.setEventHandler=function(){var e=this;$(".project_list").find('[data-toggle="tooltip"]').tooltip({trigger:"hover"}),$(".project_btn").on("click",function(){$(this).parents(".project_list").toggleClass("open").find(".list_wrapper").stop().slideToggle(200)}),$(document).on("click",function(e){$(e.target).closest(".project_btn").length||$(".project_list").removeClass("open").find(".list_wrapper").stop().slideUp(200)}),$("#project li .txt_btn").on("click",function(t,n){function o(){for(var t=e._displayProjects.getCount(),n=0;t>n;n++){var o=e._displayProjects.get(n);if(o.getRoomId()==a)return o}}function i(){if(r!=a){var e=new TabCommunityItemView;"myworkplace"!=r&&e.init(r),TabManager.getInstance()._deleteProject(e)}NotificationIconManager.getInstance().updateAttentionHeaderColumnIconView()}var a=$(this).attr("data_value"),r=$(".project_btn").attr("data_value"),s=null;"myworkplace"!=a?(s=o(),SideMenuMurmurView.getInstance().close()):SideMenuMurmurView.getInstance().isViewFixed()&&SideMenuMurmurView.getInstance().open(),TabManager.getInstance().selectOrAddTabByCommunityInfo(a,s,i),$(".project_list").removeClass("open").find(".list_wrapper").stop().slideUp(200)}),$("#projectlist_modal").on("click",function(){var e=new DialogProjectListView;e.showDialog()}),$("#addproject_modal").on("click",function(){var e=new DialogCreateCommunityView;e.showDialog()}),$("#public_project_list").on("click",function(){var e=new DialogPublicProjectListView;e.showDialog()})}}(),function(){function e(e){e._dialogAreaElement=null,e.roomArrayList=null}function t(e,t){function n(e){t._dialogAreaElement.find("#projectList").append(o(t,e)),t._dialogInnerElement.off(),a(t),t._dialogInnerElement.find(".scroll_content").scrollTop(0)}if(t.isGotRoomArrayList)return t._dialogAreaElement.find("#projectList").append(o(t,t.roomArrayList)),a(t),void t._dialogInnerElement.find(".scroll_content").scrollTop(0);var i=new ColumnSortCondition;i.getItems().removeAll(),i.getItems().add("updated_at"),i.getOrders().removeAll(),i.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC),CubeeController.getInstance().getJoinedCommunityInfoList(0,Conf.getVal("NUMBER_OF_ITEMS_SEARCH_MAX_LIST"),i,n)}function n(){var e='<div id="projectlist_modal" class="card modal_card">    <div class="card_title">      <p> '+Resource.getMessage("project_list_title")+' </p>    </div>    <div class="select_menu">      <form action="#" method="get" class="search_form title_search_form">        <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("dialog_label_projectlist_search")+'">        <button type="button" name="search" class="title_search_btn ico_btn"><i class="fa fa-search"></i></button>      </form>    </div>    <div class="list_wrapper scroll_content">      <ul class="modal_list select_list" id="projectList"></ul>    </div>    <div class="btn_wrapper">      <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>    </div>    <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>  </div>';return e}function o(e,t){$("#projectList").empty(),e._dialogAreaElement.find("#dialog-error").text("");var n=t.getCount();if(0==n)return void e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_groupchatlist_nothing"));var o=e._dialogInnerElement.find("input.field").val();if(!(e.roomArrayList.getCount()>0)||e.isGotRoomArrayList||0!=o.length){for(var i="",a=0;n>a;a++){var r=t.get(a);if(e.isGotRoomArrayList||e.roomArrayList.add(r.getRoomId(),r),!(o.length>0&&r.getRoomName().indexOf(o)<0)){var s=r.getPrivacyType(),l="";null!=s&&0==s&&(l=' <span class="public-room-chip"></span>');var u=r.getLogoUrl(),c=r.getRoomName();if(i+='<li class="cf"><a  data_value="'+r.getRoomId()+'"><span class="project-status-block"><span class="ico ico_project">',null==u||""==u){var d=Utils.avatarCreate({name:c,type:DialogProjectListView.AvaterType});i+='<div class="no_img" style="background-color:'+d.color+'"><div class="no_img_inner">'+d.name+"</div></div></span>"}else i+='<img src="'+u+'" alt=""></span>';i+='<span class="name">'+Utils.convertEscapedHtml(c,!1)+'</span><span class="br" ></span>',i+='<span class="detail">'+Utils.convertEscapedHtml(r.getDescription(),!0)+"</span></span>",i+=l,i+="</a></li>"}}return i||e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_projectlist_search_nothing")),e.isGotRoomArrayList=!0,i}}function i(t,n){function o(){for(var e=n.roomArrayList.getCount(),t=0;e>t;t++){var o=n.roomArrayList.get(t);if(o.getRoomId()==a)return o}return null}function i(){if(s!=a){var e=new TabCommunityItemView;"myworkplace"!=s&&e.init(s),TabManager.getInstance()._deleteProject(e)}}var a=$(t.currentTarget).attr("data_value"),r=o();if(null!=r){var s=$(".project_btn").attr("data_value");SelectAndAddProjectView.getInstance().setHeaderIconAndColor(r),$("#prj_ico").show(),TabManager.getInstance().selectOrAddTabByCommunityInfo(r.getRoomId(),r,i),e(n),ViewUtils.modal_allexit()}}function a(e){$("#projectList li a").off("click"),$("#projectList li a").on("click",function(t){i(t,e)}),e._dialogInnerElement.find(".title_search_btn").off("click"),e._dialogInnerElement.find(".title_search_btn").on("click",function(){t(0,e)}),e._dialogInnerElement.find("input.field").off("keypress"),e._dialogInnerElement.find("input.field").on("keypress",function(n){return(n.which&&13===n.which||n.keyCode&&13===n.keyCode)&&t(0,e),13!==n.which})}DialogProjectListView.prototype=$.extend({},DialogOkCancelView.prototype);var r=DialogOkCancelView.prototype,s=DialogProjectListView.prototype;s._init=function(){var e=this;e.isGotRoomArrayList=!1,e.roomArrayList=new CommunityList,e._dialogAreaElement.html(n()),e._dialogInnerElement=e._dialogAreaElement.children(),t(0,e),e.ps=new PerfectScrollbar(e._dialogInnerElement.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(e.ps),e._dialogInnerElement.on("click",".modal_exit",function(){r.cleanup.call(e),e.cleanup()})}}(),function(){function e(e){e._dialogAreaElement=null,e.roomArrayList=null}function t(e,t){function n(e){t._dialogAreaElement.find("#public-projectList").append(o(t,e)),t._dialogInnerElement.off(),a(t),t._dialogInnerElement.find(".scroll_content").scrollTop(0)}if(t.isGotRoomArrayList)return t._dialogAreaElement.find("#public-projectList").append(o(t,t.roomArrayList)),a(t),void t._dialogInnerElement.find(".scroll_content").scrollTop(0);var i=new ColumnSortCondition;i.getItems().removeAll(),i.getItems().add("updated_at"),i.getOrders().removeAll(),i.getOrders().add(ColumnSortCondition.SORT_ORDER_DESC),CubeeController.getInstance().getNoJoinedPublicCommunityInfoList(0,Conf.getVal("NUMBER_OF_ITEMS_SEARCH_MAX_LIST"),i,n)}function n(){var e='<div id="public_projectlist_modal" class="card modal_card">    <div class="card_title">      <p> '+Resource.getMessage("public_project_list_title")+' </p>    </div>    <div class="select_menu">      <form action="#" method="get" class="search_form title_search_form">        <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("dialog_label_projectlist_search")+'">        <button type="button" name="search" class="title_search_btn ico_btn"><i class="fa fa-search"></i></button>      </form>    </div>    <div class="list_wrapper scroll_content">      <ul class="modal_list select_list" id="public-projectList"></ul>    </div>    <div class="btn_wrapper">      <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>      <button type="button" role="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" id="dialog-public-community-joining-button">      <span>'+Resource.getMessage("dialog_public_community_joining")+'</span>    </div>    <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>  </div>';return e}function o(e,t){if($("#public-projectList").empty(),e._dialogAreaElement.find("#dialog-error").text(""),null==t||!t._array||!Array.isArray(t._array))return void e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("get_room_list_err"));var n=t.getCount();if(0==n)return void e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_projectlist_search_nothing"));var o=e._dialogInnerElement.find("input.field").val();if(!(e.roomArrayList.getCount()>0)||e.isGotRoomArrayList||0!=o.length){for(var i="",a=0;n>a;a++){var r=t.get(a);if(e.isGotRoomArrayList||e.roomArrayList.add(r.getRoomId(),r),!(o.length>0&&r.getRoomName().indexOf(o)<0)){var s=r.getLogoUrl(),l=r.getRoomName();if(i+='<li class="cf">',i+='<label for="pub_comm_'+r.getRoomId()+'"><div>',i+='<a  data_value="'+r.getRoomId()+'">',i+='<span class="ico ico_project">',null==s||""==s){var u=Utils.avatarCreate({name:l,type:DialogPublicProjectListView.AvaterType});i+='<div class="no_img" style="background-color:'+u.color+'"><div class="no_img_inner">'+u.name+"</div></div></span>"}else i+='<img src="'+s+'" alt=""></span>';i+='<span class="name">'+Utils.convertEscapedHtml(l,!1)+"</span>",i+='<span class="detail">'+Utils.convertEscapedHtml(r.getDescription(),!0)+"</span>",i+="</a>",i+='<input type="radio" name="public-comm-room-id" value="'+r.getRoomId()+'" id="pub_comm_'+r.getRoomId()+'" />',i+='<span class="public-comm-room-list-radio"></span>',i+="</div></label>",i+="</li>"}}return i||e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_projectlist_search_nothing")),e.isGotRoomArrayList=!0,i}}function i(t,n){function o(){for(var e=n.roomArrayList.getCount(),o=0;e>o;o++){var i=n.roomArrayList.get(o);if(i.getRoomId()==t)return i}return null}function i(){if(r!=t){var e=new TabCommunityItemView;"myworkplace"!=r&&e.init(r)}}var a=o();if(null!=a){var r=$(".project_btn").attr("data_value");SelectAndAddProjectView.getInstance().setHeaderIconAndColor(a),$("#prj_ico").show(),TabManager.getInstance().selectOrAddTabByCommunityInfo(a.getRoomId(),a,i),e(n),ViewUtils.modal_allexit()}}function a(e){e._dialogInnerElement.find(".title_search_btn").off("click"),e._dialogInnerElement.find(".title_search_btn").on("click",function(){t(0,e)}),e._dialogInnerElement.find("input.field").off("keypress"),e._dialogInnerElement.find("input.field").on("keypress",function(n){return(n.which&&13===n.which||n.keyCode&&13===n.keyCode)&&t(0,e),13!==n.which}),$("#dialog-public-community-joining-button").click(function(){var t=e._dialogInnerElement.find("input[name=public-comm-room-id]:checked").val();null!=t&&CubeeServerConnector.getInstance().addPublicCommunityMember(t,function(n){if(n.content&&!n.content.result){var o=e._dialogAreaElement.find("#dialog-error");return void o.text(Resource.getMessage("add_member_err_submit"))}i(t,e)})})}DialogPublicProjectListView.prototype=$.extend({},DialogOkCancelView.prototype);var r=DialogOkCancelView.prototype,s=DialogPublicProjectListView.prototype;s._init=function(){var e=this;e.isGotRoomArrayList=!1,e.roomArrayList=new CommunityList,e._dialogAreaElement.html(n()),e._dialogInnerElement=e._dialogAreaElement.children(),t(0,e),e.ps=new PerfectScrollbar(e._dialogInnerElement.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(e.ps),e._dialogInnerElement.on("click",".modal_exit",function(){r.cleanup.call(e),e.cleanup()})}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=SelectUserListView.prototype;e.init=function(e){var t=this;return t.hasAuthority=e.hasAuthority?e.hasAuthority:!1,t.loginUserInfo=e.loginUserInfo,t.selectedUserList=[],t.excludedList=e.excludedList?e.excludedList:[],t},e.getSelectedUserList=function(){return this.selectedUserList},e.getInitialView=function(e){var t=this;return t.createFrame(),e&&!e.showDefault?t.frame:(t.getInitialUserList(),t._createEventHandler(),t.frame)},e.getInitialGroupView=function(e,t){var n=this;return n.createFrame(),t&&!t.showDefault?n.frame:(n.getCommunityMemberList(e).then(function(e){$.each(e,function(e,t){t._profile._loginAccount!=n.loginUserInfo.getLoginAccount()&&n.allPersons.push(t)}),n.frame.find(n.selector_list).find("input[type='checkbox']").off(),n.frame.find(n.selector_list).find("select").off(),n.frame.find(n.selector_list).empty(),n.addPersons()}),n.frame)},e.addPersons=function(){var e,t=this,n=t.countPmember+Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST"),o=t.countPmember,i="";for(n>t.allPersons.length&&(n=t.allPersons.length),e=o;n>e;e++){i=t.allPersons[e],t.countPmember++;var a=Utils.getSafeStringData(i._profile._nickName);a=Utils.convertEscapedHtml(a);var r=i._profile._avatarType,s=i._profile._avatarData,l="@"+i._profile._loginAccount,u="";if(null==r||""==r||null==s||""==s)u='<div id="avatar">',u+='<span class="ico ico_user">'+ViewUtils.getDefaultAvatarHtml(i)+"</span>",u+="</div>";else{var c=ViewUtils.getAvatarUrl(i);u='<img src="'+c+'" alt="">'}var d=i.getJid(),g='<label class="checkbox"><input type="checkbox" name="select_user" value="'+d+'"><span></span></label>';t.hasAuthority&&(g+='<select class="field" name="groupchat_authority" id="auth_list_'+i._profile._loginAccount+'">',g+='  <option value="'+AuthorityDef.AUTHORITY_ACTIONS.GC_MANAGE+'">'+Resource.getMessage("policy_manage")+"</option>",g+='  <option selected value="'+AuthorityDef.AUTHORITY_ACTIONS.GC_SEND+'">'+Resource.getMessage("policy_send")+"</option>",g+='  <option value="'+AuthorityDef.AUTHORITY_ACTIONS.GC_VIEW+'">'+Resource.getMessage("policy_view")+"</option>",g+="</select></span>");var m='<li><label title="'+a+"  "+Utils.convertEscapedTag(l)+'"><span class="ico ico_user">'+u+"</span>";m+='<span class="name">'+a+"</span>",m+='<span class="group">'+Utils.convertEscapedTag(l)+"</span>"+g,m+="</label></li>",t.frame.find(t.selector_list).append(m)}t.applySelectedInfoToView(),t.applyExcludedList(),t._createEventHandler()},e.createFrame=function(){var e=this,t=e.getFrameHtml();e.frame=$(t)},e.getFrameHtml=function(){var e="";return e+='<div class="select_menu">',e+='<span class="select_number"><i class="fa fa-user"></i><span id="seletedUserNum">0</span></span>',e+='<div class="search_form">',e+='<input type="text" id="txtSearchGroupUser" name="q" class="field" placeholder="'+Resource.getMessage("wizard_chatlist_conditions")+'">',e+='<button type="submit" name="search" class="user_search_btn ico_btn"><i class="fa fa-search"></i></button>',e+="</div>",e+='<label class="modal_btn all_check">'+Resource.getMessage("wizard_chatlist_allcheck")+'<label class="checkbox"><input type="checkbox"><span></span></label></label>',e+="</div>",e+='<div class="list_wrapper scroll_content">',e+='<ul class="modal_list select_list">',e+="</ul>",e+="</div>"},e.getCommunityMemberList=function(e){return new Promise(function(t,n){function o(e){if(!e)return void n();for(var o=new Array,i=e.getOwnerList(),a=i.getCount(),r=e.getGeneralMemberList(),s=r.getCount(),l=0;a>l;l++){var u=i.get(l);u._role=2,o.push(u)}for(var l=0;s>l;l++){var c=r.get(l);c._role=1,o.push(c)}t(o)}CubeeController.getInstance().getCommunityMemberInfo(e,o)})},e.searchExecute=function(){var e=this,t=e.frame.find(e.selector_searchinput).attr("value"),n=Utils.trimStringMulutiByteSpace(t);if(n&&""!=n){var o=ViewUtils.getKeywordFilterFromKeywordInputString(n,!1);if(o&&"object"==("undefined"==typeof o?"undefined":_typeof(o))){var i=new ColumnSortCondition;i.getItems().removeAll(),i.getItems().add("login_account"),i.getOrders().removeAll(),i.getOrders().add(ColumnSortCondition.SORT_ORDER_ASC);var a=o,r=new ColumnSearchCondition(a,i),s=new SearchResultPersonList;e.searchUser(0,r,s)}}},e.searchUser=function(e,t,n){function o(e){for(var o=e.getCount(),a=0;o>a;a++){var r=e.get(a);n.add(r)}o<Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST")?(i.frame.find(i.selector_list).find("input[type='checkbox']").off(),i.frame.find(i.selector_list).find("select").off(),i.frame.find(i.selector_list).empty(),i.setUserListHtml(n),i.applySelectedInfoToView(),i.applyExcludedList(),dlg_scr.forEach(function(e){e.update()}),i._createEventHandler()):i.searchUser(e.get(o-1).getId(),t,n)}var i=this;return CubeeController.getInstance().searchPerson(e,Conf.getVal("NUMBER_OF_ITEMS_BY_PER_REQUEST"),t,o)},e._createEventHandler=function(){var e=this;e.frame.find(".search_form").off("keypress").on("keypress",function(t){null!=e.allPersons&&($("#modal_area").find(".scroll_content").off(),e.allPersons=null,e.countPmember=null),(t.which&&13==t.which||t.keyCode&&13==t.keyCode)&&e.searchExecute()}),e.frame.find(".search_form button").off("click").on("click",function(){e.searchExecute()});var t='input[type="checkbox"]input[name="select_user"]';e.frame.off("change").on("change",t,function(t){e.changeSelectedUserInfo($(this)),e.frame.find("#seletedUserNum").text(e.selectedUserList.length)});var n='.all_check .checkbox input[type="checkbox"]';e.frame.on("change",n,function(n){var o=e.frame.find(t+":not(:disabled)");$(this).prop("checked")?o.prop("checked",!0):o.prop("checked",!1);for(var i=0;i<o.length;i++)e.changeSelectedUserInfo(o.eq(i));e.frame.find("#seletedUserNum").text(e.selectedUserList.length)}),e.frame.on("change",'select[name="groupchat_authority"]',function(t){e.changeSelectedAuthority($(this))})},e.changeSelectedUserInfo=function(e){var t=this,n=t.selectedUserList.length;if(e.prop("checked")){for(var o=0;n>o;o++)if(t.selectedUserList[o].jid==e.val())return t.selectedUserList;var i={jid:e.val()};if(t.hasAuthority){var a=e.parent().parent().find('select[name="groupchat_authority"]');i.authority=a.val(),i.accountName=a.prop("id").slice("auth_list_".length)}t.selectedUserList.push(i)}else for(var o=0;n>o;o++)if(t.selectedUserList[o].jid==e.val()){t.selectedUserList.splice(o,1);break}return t.selectedUserList},e.applySelectedInfoToView=function(){for(var e=this,t=e.selectedUserList.length,n=0;t>n;n++){var o=e.selectedUserList[n].jid,i=e.frame.find('input[type="checkbox"]input[value="'+o+'"]');if(i.length>0&&(i.prop("checked",!0),e.hasAuthority)){var a=e.selectedUserList[n].authority;i.parent().parent().find('select[name="groupchat_authority"]').val(a)}}},e.applyExcludedList=function(){for(var e=this,t=e.excludedList.length,n=0;t>n;n++){var o=e.excludedList[n],i=e.frame.find('input[type="checkbox"]input[value="'+o+'"]');i.length>0&&i.prop("disabled",!0)}},e.changeSelectedAuthority=function(e){for(var t=this,n=e.parent().find('input[type="checkbox"]input[name="select_user"]').val(),o=t.selectedUserList.length,i=0;o>i;i++)n==t.selectedUserList[i].jid&&(t.selectedUserList[i].authority=e.val())},e.getInitialUserList=function(){var e=this,t=Utils.getSafeArrayData(e.loginUserInfo.getGroup()),n=t.length>0?t[0]:"";e.frame.find(e.selector_searchinput).val(n),e.searchExecute()},e.setUserListHtml=function(e){for(var t=this,n=e.getCount(),o=t.loginUserInfo.getJid(),i="",a=0;n>a;a++){var r=e.get(a);if(o!=r.getJid()){var s=Utils.getSafeStringData(r.getUserName());s=Utils.convertEscapedHtml(s);var l=r.getAvatarType(),u=r.getAvatarData(),c=Utils.getSafeArrayData(r.getGroup()),d=c.length>0?c[0]:Resource.getMessage("group_title_no_group");if(i+='<li><label title="'+s+"  "+Utils.convertEscapedHtml(d)+' "> <span class="ico ico_user">',null==l||""==l||null==u||""==u)i+='<div id="avatar">',i+='<span class="ico ico_user">'+ViewUtils.getDefaultAvatarHtml(r)+"</span>",i+="</div>";else{var g=ViewUtils.getAvatarUrl(r);i+='<img src="'+g+'" alt="">'}i+='</span> <span class="name">'+s+'</span> <span class="group">'+Utils.convertEscapedHtml(d)+'</span> <label class="checkbox"><input type="checkbox" name="select_user" value="'+r.getJid()+'"><span></span></label>',t.hasAuthority&&(i+='<select class="field" name="groupchat_authority" id="auth_list_'+r.getLoginAccount()+'">',i+='  <option value="'+AuthorityDef.AUTHORITY_ACTIONS.GC_MANAGE+'">'+Resource.getMessage("policy_manage")+"</option>",i+='  <option selected value="'+AuthorityDef.AUTHORITY_ACTIONS.GC_SEND+'">'+Resource.getMessage("policy_send")+"</option>",i+='  <option value="'+AuthorityDef.AUTHORITY_ACTIONS.GC_VIEW+'">'+Resource.getMessage("policy_view")+"</option>",i+="</select></span>"),i+="</label></li>"}}t.frame.find(t.selector_list).append(i)},e.cleanUp=function(){var e=this;e.frame.find("*").off(),e.selector_searchinput=null,e.selector_list=null,e.hasAuthority=null,e.loginUserInfo=null,e.selectedUserList=null,e.excludedList=null,e.frame=null,e.allPersons=null,e.countPmember=null}}(),function(){DialogAddChatListView.prototype=$.extend({},DialogOkCancelView.prototype);var e=(DialogOkCancelView.prototype,DialogAddChatListView.prototype);e._init=function(){var e=this;e.frame=e.getInnerHtml(),e.selectUserListView=new SelectUserListView;for(var t=[],n=ContactList.getInstance().getCount(),o=0;n>o;o++)t.push(ContactList.getInstance().get(o).getJid());e.selectUserListView.init({hasAuthority:!1,loginUserInfo:LoginUser.getInstance(),excludedList:t}),e.frame.find(".modal_list").append(e.selectUserListView.getInitialView()),e._dialogAreaElement.html(e.frame),e._dialogInnerElement=e._dialogAreaElement.children(),e.ps=new PerfectScrollbar(e.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(e.ps),e._createEventHandler()},e.cleanup=function(){var e=this;e.ps&&e.ps.destroy(),e.selectUserListView.cleanUp(),e.selectUserListView=null,e._dialogAreaElement=null,e._dialogInnerElement=null,e.frame=null},e.getInnerHtml=function(){var e="";return e+='<div id="addchat_modal" class="card modal_card">',e+='<div class="card_title">',e+="<p></p>",e+="</div>",e+='<div class="list_wrapper">',e+='<ul class="modal_list select_content">',e+="</ul>",e+="</div>",e+='<div class="" style="height: 60px"></div>',e+='<div class="btn_wrapper">',e+='<p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',e+=' <button id="more_button" type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text"></span></button>',e+="</div>",e+='<a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',e+="</div>",$(e)},e._createEventHandler=function(){var e=this;e.frame.find("#more_button").on("click",function(){e.frame.find("#dialog-error").text(""),e.addChatListMember()})},e.addChatListMember=function(){var e=this;e.frame.find("#dialog-error").text("");for(var t=e.selectUserListView.getSelectedUserList(),n=new ArrayList,o=0;o<t.length;o++)n.add({jid:t[o].jid,contactListGroup:""});if(n.getCount()>0){var i=function(t,n){if(t&&t.addSuccessMemberList.getCount()>0)for(var o=TabManager.getInstance().selectedInfo,i=o.getSideListViewImpl().sidebarParts,a=0;a<i.length;a++)"function"==typeof i[a].onNotifyAddChatMember&&i[a].onNotifyAddChatMember(t.addSuccessMemberList);if(t&&t.addFailureMemberList.getCount()>0){var r=Resource.getMessage("wizard_chatList_add_failed"),s=n?n:"";e.frame.find("#dialog-error").text(r+s)}else e.cleanup(),ViewUtils.modal_allexit()};CubeeController.getInstance().addContactListMember(n,i)}else e.frame.find("#dialog-error").text(Resource.getMessage("dialog_add_chat_no_user"))},$(function(){var e=$("#left_sidebar").find(".contact_list .list_ttl a.list_add");e.on("click",function(){var e=new DialogAddChatListView;e.showDialog()})})}(),function(){DialogThreadTitleListView.prototype=$.extend({},DialogOkCancelView.prototype);var e=(DialogOkCancelView.prototype,DialogThreadTitleListView.prototype);e._init=function(){var e=this,t=this;t.frame=t.getInnerHtml(),t._dialogAreaElement.html(t.frame),t._dialogInnerElement=t._dialogAreaElement.children(),t.ps=new PerfectScrollbar(t.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t._createEventHandler(),CubeeController.getInstance().getThreadTitleList(t._columnInfo).then(function(n){e._allThreadTitles=n.content.items,t._createTitleElement(e._allThreadTitles)})["catch"](function(e){if(e&&e.content.reason)switch(e.content.reason){case 403e3:t._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("authority_err"));break;default:t._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_thread_title_list_get_error"))}else t._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_thread_title_list_get_error"))})},e._createTitleElement=function(e){var t=this,n=t._dialogAreaElement.find("#dialog-error");if(n.text(""),0==t._allThreadTitles.length)return void n.text(Resource.getMessage("dialog_thread_title_nothing"));if(0==e.length)return void t._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_thread_title_search_nothing"));for(var o=0;o<e.length;o++)if(null!=e[o].roomName&&(11!=e[o].msgType&&e[o].roomName.length>0||11==e[o].msgType&&this._columnInfo.getColumnType()==ColumnInformation.TYPE_COLUMN_RECENT)){e[o].roomName=Utils.urldecode(e[o].roomName);var i='                <li>                    <a class="text-overflow-ellipsis title-list thread-title-list">                        <span class="threadtitle name"></span>                        <span class="threadtitle roomname"></span>                    </a>                </li>',a=$(i),r=[],s=decodeURIComponent(e[o].threadTitle),l=s;l=ViewUtils.replaceTenantBaseTitleCategory(l,s,r),l=ViewUtils.replaceOrignalTitleCategory(l,s,r);for(var u=r.sort(function(e,t){return e.index-t.index}),c="",d=0;d<u.length;d++)c+=u[d].data;a.find("span.name").html(c+" "+Utils.convertEscapedHtml(l));var g="",m=void 0;switch(e[o].msgType){case 1:g=Resource.getMessage("MyFeed"),m="feedtype";break;case 2:g=Resource.getMessage("Chat")+" "+e[o].roomName,m="chattype";break;case 3:g="GC "+e[o].roomName,m="groupchattype";break;case 5:g="PJ "+e[o].roomName,m="projecttype";break;case 11:var _=e[o].roomName;_||(_=Resource.getMessage("Murmur")),g=_,m="murmur";break;default:g=e[o].roomName}a.find("span.roomname").text(g),m&&a.find("span.roomname").addClass(m),a.find("span.name").attr("itemid",e[o].threadRootId),a.find("span.name").attr("title",decodeURIComponent(e[o].threadTitle)),this._dialogInnerElement.find(".select_list").append(a),a.on("click",function(){t.openConversationColumn($(this).find("span").attr("itemid")),ViewUtils.modal_allexit()})}else{var i='                <li>                    <a class="text-overflow-ellipsis title-list">                        <span class="threadtitle name"></span>                    </a>                </li>',a=$(i),f=[],p=decodeURIComponent(e[o].threadTitle),h=p;h=ViewUtils.replaceTenantBaseTitleCategory(h,p,f),h=ViewUtils.replaceOrignalTitleCategory(h,p,f);for(var C=f.sort(function(e,t){return e.index-t.index}),v="",y=0;y<C.length;y++)v+=C[y].data;a.find("span").html(v+" "+Utils.convertEscapedHtml(h)),a.find("span").attr("itemid",e[o].threadRootId),a.find("span").attr("title",decodeURIComponent(e[o].threadTitle)),this._dialogInnerElement.find(".select_list").append(a),a.on("click",function(){t.openConversationColumn($(this).find("span").attr("itemid")),ViewUtils.modal_allexit()})}},e.getInnerHtml=function(){var e='<div id="threadtitlelist_modal" class="card modal_card">          <div class="card_title">            <p> '+Resource.getMessage("dialog_label_thread_title_list")+' </p>          </div>          <div class="select_menu">            <form action="#" method="get" class="search_form title_search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("dialog_label_thread_search")+'">              <button type="button" name="search" class="title_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},e._createEventHandler=function(){var e=this;e._dialogInnerElement.find(".title_search_btn").off("click"),e._dialogInnerElement.find(".title_search_btn").on("click",function(){e.filterTitles()}),e._dialogInnerElement.find("input.field").keypress(function(t){return(t.which&&13===t.which||t.keyCode&&13===t.keyCode)&&e.filterTitles(),13!==t.which})},e.filterTitles=function(){var e=this;e._dialogInnerElement.find(".select_list").empty();var t=e._dialogInnerElement.find("input.field").val(),n=e._allThreadTitles.filter(function(e){if(t==Resource.getMessage("MyFeed")&&e.msgType==Message.TYPE_PUBLIC||t==Resource.getMessage("Chat")&&e.msgType==Message.TYPE_CHAT||"GC"==t&&e.msgType==Message.TYPE_GROUP_CHAT||"PJ"==t&&e.msgType==Message.TYPE_COMMUNITY||t==Resource.getMessage("Murmur")&&e.msgType==Message.TYPE_MURMUR)return!0;var n=decodeURIComponent(e.threadTitle),o="";return e.roomName&&(o=Utils.urldecode(e.roomName)),0<=n.indexOf(t)||0<=o.indexOf(t)});e._createTitleElement(n),e._dialogInnerElement.find(".scroll_content").scrollTop(0)},e.openConversationColumn=function(e){var t=this,n=new ShowConversationColumnInfomation;n.setParentItemId(e),n.setSourceColumnDisplayName(t._columnInfo.getDisplayName()),n.setSourceColumnType(t._parentObj.getColumnInfo().getColumnType()),ColumnManager.getInstance().insertAfterColumn(n,t._parentObj,!0,!0)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogThreadTitleUpdateView.prototype=$.extend({},DialogOkCancelView.prototype);var e=DialogOkCancelView.prototype,t=DialogThreadTitleUpdateView.prototype;t._init=function(){var t=this;e._init.call(t),t._dialogAreaElement.html(t.getInnerHtml()),t._dialogInnerElement=t._dialogAreaElement.children();var n=t._dialogInnerElement,o=n.find("input#title_name");o.on("keypress",function(e){(e.which&&13==e.which||e.keyCode&&13==e.keyCode)&&t._updateTitleExecute()}),t._dialogInnerElement.find(".modal_btn").on("click",function(){t._updateTitleExecute()}),ColumnTextAreaView.setTitleCategorySelectorEvent(t._dialogInnerElement.find(".modal_content"),"#title_name")},t.showDialog=function(){var e=this;e._onOpenDialog();var t=e._dialogInnerElement.find("input#title_name");t.blur(),t.focus()},t._onOpenDialog=function(){var e=this;e._initInputData(),$("#modal_area").css("display","block"),$("#modal_area").prepend('<div class="overlay modal_exit"></div>'),e._dialogInnerElement.addClass("on").css("display","block").animate({"margin-top":0,opacity:1},200),$(".overlay").animate({opacity:.3},200)},t._initInputData=function(){var e=this,t=e._dialogInnerElement,n=t.find("input#title_name"),o=e._message.getThreadTitle();n.val(o)},t.getInnerHtml=function(){var e=this,t="";t='<div id="grouptitle_modal" class="card modal_card">',t+='    <div class="card_title">',t+="      <p>"+Resource.getMessage("dialog_label_thread_title_update"),t+="    </div>",t+='    <div class="modal_content_wrapper">',t+='      <div class="modal_content">',t+='        <input type="text" id="title_name" placeholder="'+Resource.getMessage("dialog_placeholder_title")+'" class="field ui-corner-all thread-title-input" style="padding-left: 20px;">';var n="",o="";if(e._message.getType()==Message.TYPE_COMMUNITY||e._message.getType()==Message.TYPE_GROUP_CHAT){n=e._message.getTo();var i=LoginUser.getInstance().getTenantInfo().threadTitleCategoryForRoom;i&&n in i&&(o="expands-notes")}return t+=ColumnTextAreaView.getTitleCategorySelectorHtml("in-edit",n,e._message.getType()),
t+='        <p id="dialog-notes" class="'+o+'">'+Resource.getMessage("dialog_update_title_note")+"</p>",t+="      </div>",t+="    </div>",t+='    <div class="btn_wrapper">',t+='      <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',t+='      <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+"</span></button>",t+="    </div>",t+='    <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',t+="</div>"},t._updateTitleExecute=function(){var e=this,t=e._dialogInnerElement;if(!e._isChangeData(t))return ViewUtils.modal_allexit(),!0;if(!e._isValidationOk(t))return!1;var n=t.find("input#title_name"),o=Utils.excludeControleCharacters(n.val());return CubeeController.getInstance().updateThreadTitle(e._message,o).then(function(e){ViewUtils.modal_allexit()})["catch"](function(t){if(t&&t.content.reason)switch(t.content.reason){case 403e3:e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("authority_err"));break;default:e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_update_title_error"))}else e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_update_title_error"))}),!0},t._isChangeData=function(e){var t=this,n=!0;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var o=e.find("input#title_name"),i=o.val();return i==t._message.getThreadTitle()&&(n=!1),n},t._isValidationOk=function(e){var t=!0;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var n=e.find("input#title_name"),o=n.val();return e.find("#dialog-error").text(""),n.removeClass("input-error"),ViewUtils.getCalculattionTitle(o)>ColumnView.THREAD_TITLE_MAX_LENGTH&&(n.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("dialog_update_title_validation_error")),t=!1),t}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogUpdateMessageView.prototype=$.extend({},DialogOkCancelView.prototype);var e=DialogOkCancelView.prototype,t=DialogUpdateMessageView.prototype;t._init=function(){var t=this;e._init.call(t),t._dialogAreaElement.html(t.getInnerHtml()),t._dialogInnerElement=t._dialogAreaElement.children(),t._createEventHandler()},t._createEventHandler=function(){var e=this,t=e._dialogInnerElement.find("textarea.message-input-area");t.on("keypress",function(t){(t.ctrlKey&&13==t.keyCode||10==t.keyCode)&&e._updateMessageExecute()}),e._dialogInnerElement.find(".modal_btn").on("click",function(){e._updateMessageExecute()}),autosize(e._dialogInnerElement.find(".message-input-area"));var t=e._dialogInnerElement.find("div.frm-message > textarea.message-input-area");e._textarea=new ColumnTextAreaView(t,e,Resource.getMessage("default_placeholder")),ViewUtils.setCharCounter(t,e._dialogInnerElement.find(".char-counter-column"),ColumnView.TEXTAREA_MAX_LENGTH);var n=e._dialogInnerElement.find("div.frm-message > .file-inputs");e._fileUpload=new ColumnFileUploadPartsView(n,e);var o=e._dialogInnerElement.find("div.frm-message").find(".submit-message-progress");e._progressBar=new ProgressBarView(o,!1)},t.showDialog=function(){var e=this;e._onOpenDialog();var t=e._dialogInnerElement.find(".message-input-area");t.blur(),t.focus(),autosize.update(t)},t._onOpenDialog=function(){var e=this;e._initInputData(),$("#modal_area").css("display","block"),$("#modal_area").prepend('<div class="overlay modal_exit"></div>'),e._dialogInnerElement.addClass("on").css("display","block").animate({"margin-top":0,opacity:1},200),$(".overlay").animate({opacity:.3},200)},t._initInputData=function(){var e=this,t=e._dialogInnerElement,n=t.find(".message-input-area"),o=e._message.getMessage();if(e.displayMessage=ViewUtils.removeAttachmentUrl(o),e.displayFileName=ViewUtils.getAttachmentFileName(o),e.displayFileName){var i=t.find("p.file-name");i.text(e.displayFileName),i.attr("title",e.displayFileName),t.find("#fileupload_cancel_btn").remove();var a='<a class="ico_btn" id="fileupload_cancel_btn">                 <i class="fa fa-close" title="'+Resource.getMessage("dialog_cancel_title")+'"></i>                </a>';i.after(a),e.displayMessage=e.displayMessage.slice(0,-1),n.val(e.displayMessage)}else n.val(e.displayMessage)},t.getInnerHtml=function(){var e=this,t="<div>",n="autocomplete";e._message.getType()==Message.TYPE_COMMUNITY?n='autocomplete-for-community" groupId="'+e._message.getTo()+'"':e._message.getType()==Message.TYPE_GROUP_CHAT&&(n='autocomplete-for-chatroom" groupId="'+e._message.getTo()+'"'),t+='<textarea class="ui-corner-all autoresize-textarea message-input-area '+n+' placeholder="" style="min-height: 4em; max-height: 300px;"></textarea>',t+=ColumnFileUploadPartsView.getHtml(1),t+=ColumnTextAreaView.getCharCounterHtml(1,!0),t+="</div>";var o="";return o='<div id="grouptitle_modal" class="card modal_card">',o+='    <div class="card_title">',o+="      <p>"+Resource.getMessage("dialog_label_update_message")+"</p>",o+="    </div>",o+='    <div class="modal_content_wrapper">',o+='      <div class="flex1 frm-message update_message">',o+=$(t).find(".message-input-area").prop("outerHTML"),o+=$(t).find(".file-inputs").prop("outerHTML"),o+=$(t).find(".char-counter-column").prop("outerHTML"),o+="      </div>",o+="    </div>",o+='    <div class="btn_wrapper">',o+='      <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',o+='      <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+"</span></button>",o+="    </div>",o+='    <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',o+="</div>"},t._uploadFileAndSendMessage=function(e,t){var n=this;if("function"!=typeof t)return!1;if(1==n._uploading)return!1;var o=null,i=n._dialogInnerElement.find(".modal_content_wrapper"),a=e;if(ViewUtils.getAttachmentFileName(e)&&(a=ViewUtils.removeAttachmentUrl(e).slice(0,-1)),ViewUtils.isValidInputTextLength(a)){var r=function(o){return"success"!=o.result?(n._uploading=!1,ViewUtils.switchAttachmentArea(i,!0),n._progressBar.progressClear(),void n._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_update_file_error"))):(e+="\n"+o.path,t(e),n._uploading=!1,ViewUtils.switchAttachmentArea(i,!0),void n._progressBar.progressComplete())},s=function(e){n._progressBar.setProgressValue(e)};if(null==n._fileUpload)return void t(e);if(o=n._fileUpload.getFilesObject(),null==o)return void t(e);if(o.length<=0)return void t(e);n._progressBar.visibleProgressBar(),ViewUtils.switchAttachmentArea(i,!1),n._uploading=!0;var l=o[0];return CubeeController.getInstance().uploadFile(l,r,s)}return!1},t._updateMessageExecute=function(){function e(e){CubeeController.getInstance().updateMessage(e,t._message).then(function(e){ViewUtils.modal_allexit()})["catch"](function(e){if(e&&e.content.reason)switch(e.content.reason){case 403e3:t._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("authority_err"));break;default:t._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_update_message_error"))}else t._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_update_message_error"))})}var t=this,n=t._dialogInnerElement;if(!t._isChangeData(n))return ViewUtils.modal_allexit(),!0;if(!t._isValidationOk(n))return!1;var o=t._textarea.getText();if(t.displayFileName&&n.find("p.file-name").text()==t.displayFileName&&t._fileUpload.getFilesObject().length<=0){var i=t._message.getMessage().split(/(\n| )/);if(i.length>1){var a="\n";" "==t._message.getMessage().substring(t._message.getMessage().indexOf(i[i.length-1])-1,t._message.getMessage().indexOf(i[i.length-1]))&&(a=" "),"\n"==a?o=o+"\n"+i[i.length-1]:" "==a&&i[i.length-1].match(/^https?:\/\//)&&(o=o+"\n"+i[i.length-1])}}return t._uploadFileAndSendMessage(o,e),!0},t._isChangeData=function(e){var t=this;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var n=e.find(".message-input-area").val();return t.displayMessage!=n?!0:t.displayFileName&&!e.find("p.file-name").text()?!0:t._fileUpload.getFilesObject().length>0?!0:!1},t._isValidationOk=function(e){if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=e.find("textarea.message-input-area"),n=t.val();return e.find("#dialog-error").text(""),t.removeClass("input-error"),n.length?ViewUtils.isValidInputTextLength(n)?!0:(t.addClass("input-error"),e.find("#dialog-error").text(ColumnView.TEXTAREA_MAX_LENGTH+Resource.getMessage("dialog_update_message_number_error")),!1):(t.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("dialog_update_message_nothing_error")),!1)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e){var t=e;t._dialogInnerElement.find("div.block-avatar").each(function(e,t){TooltipView.getInstance().setAvatarToolTip(TooltipView.TYPE_USER_AVATAR,$(t),!0)}),t._dialogInnerElement.find("div.block-avatar").on("mouseenter",function(){var e=$("#emotion_modal").offset().left+$("#emotion_modal").width(),t=$(this).offset().left+290,n=0;t>e&&(n=e-t),$(this).children(".mTip").css({top:"auto",left:n+"px"}).addClass("hover")})}function t(e){var t=e,n=o(t._emotionPointList),i=[],a=[];for(key in t._emotionIcons)0!=key&&(i.add(key),n[key]?a.add(n[key].length):a.add(0));new Chart(document.getElementById("emotion_canvas"),{type:"horizontalBar",data:{labels:i.reverse(),datasets:[{backgroundColor:"#d86868",data:a.reverse()}]},options:{title:{display:!0,text:""},legend:{display:!1},scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:""}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:""}}]},responsive:!1}})}function n(e){for(var t=0,n=0;n<e._length;n++)t+=e.get(n).getEmotionPoint();return t}function o(e){for(var t={},n=0;n<e._length;n++){var o=e.get(n),i=e.get(n).getEmotionPoint();i in t?t[i].add(a(o)):t[i]=[a(o)]}return t}function i(e){var t=e,n={};n=o(t._emotionPointList);var i=[];for(key in t._emotionIcons)i.add(key);i.reverse(),_ret="",_ret+='  <canvas id="emotion_canvas" width="420"></canvas>';for(key in i){var a=i[key];if(n[a]){ViewUtils.isAttachmentUrl(t._emotionIcons[a],t._emotionIcons[a])?_ret+='<div class="modal_header_emotion">                        <p class="modal_title_emotion">'+a+'</p>                        <img class="image-thumbnail clickable" title="'+t._emotionIcons[a]+'                        " data-url="'+t._emotionIcons[a]+'"/>                      </div>':_ret+='<div class="modal_header_emotion"><p class="modal_title_emotion">'+t._emotionIcons[a]+" ("+a+")</p></div>",_ret+='<div class="emotionAvatarList">';for(var r=0;r<n[a].length;r++)_ret+=ViewUtils.getAvatarDataHtmlFromPerson(n[a][r]);_ret+="</div>"}}return _ret}function a(e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))){var t=new Person;t.setJid(e.getJid());var n=new Profile;return n.setNickName(e.getNickName()),n.setAvatarType(e.getAvatarType()),n.setAvatarData(e.getAvatarData()),n.setLoginAccount(e.getLoginAccount()),n.setStatus(e.getStatus()),t._profile=n,t}}DialogEmotionPointPersonListView.prototype=$.extend({},DialogPersonListView.prototype);var r=DialogPersonListView.prototype,s=DialogEmotionPointPersonListView.prototype;s._init=function(){r._init.call(this);var n=this,o=this._dialogInnerElement.find("img.image-thumbnail");o.each(function(e,t){var n=$(t);if(!n.attr("src")){var o=n.attr("data-url");CubeeController.getInstance().downloadThumbnailImage(o,"item",n)}}),t(n),e(n)},s.getInnerHtml=function(){var e=this,t="",o=e._personList;if(null==o)return t;var a=n(e._emotionPointList);return t+='<div id="emotion_modal" class="card modal_card">',t+='  <div class="card_title">',t+="    <p>"+e._title+""+a+"</p>",t+="  </div>",t+='  <div class="list_wrapper scroll_content">',t+=i(e),t+="  </div>",t+='  <div class="btn_wrapper">',t+='    <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',t+='    <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+"</span></button>",t+="  </div>",t+='  <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',t+="</div>"},s.onNotification=function(n){var o=this;if($("#modal_area").is(":visible")&&null!=n&&"object"==("undefined"==typeof n?"undefined":_typeof(n))){var a=n.getType();if(a==Notification_model.TYPE_EMOTION_POINT){var r=i(o);o._dialogInnerElement.find(".list_wrapper").find("*").off(),o._dialogInnerElement.find(".list_wrapper").children().remove(),o._dialogInnerElement.find(".list_wrapper").html(r),o.rewritDialogTitle(),t(o),e(o)}}},s.rewritDialogTitle=function(){var e=this,t=(e._dialogInnerElement.find(".modal_list li"),n(e._emotionPointList)),o=e._dialogInnerElement.parent().find(".card_title p");o.text(e._title+" ("+t+")")}}(),function(){var e=!1,t=!1,n=SideMenuRecentView.prototype;SideMenuRecentView.prototype=$.extend({},ColumnRecentView.prototype);var o=ColumnRecentView.prototype,n=SideMenuRecentView.prototype,i=new SideMenuRecentView;SideMenuRecentView.getInstance=function(){return e||i.__init(),e=!0,i},n.createView=function(){},n.createHtml=function(){},n._setRecentColumnEvent=function(){},n._createDisplayName=function(){},n._setOptionMenu=function(){},n.onSystemMessageReceive=function(e){},n.__init=function(){var e=this,t=new RecentColumnInfomation,n=new ColumnSortCondition,o=ColumnFilterManager.getColumnFilter(ColumnInformation.TYPE_COLUMN_RECENT),i=new ColumnSearchCondition(o,n);return t.setSearchCondition(i),ColumnRecentView.call(e,t),e._headerDisplayName=Resource.getMessage("RecentSideBarTitle"),e.createSideList(),e._htmlElement=e.getHtmlElement(),e},n.showRecentHistory=function(){o._LoadingIcon(i,"div.column-content"),i.getHistoryMessage(),i.refreshScrollbar(),i.showButtonEvent(),t=!0},n.showButtonEvent=function(){a(),$(window).off("resize.side-bar-recent"),$(window).on("resize.side-bar-recent",function(){e&&t&&i.refreshScrollbar()})},n.isGotHistory=function(){return t};var a=function(){$("#side-bar-recent-ico").off("click.side-bar-recent"),$("#side-bar-recent-ico").on("click.side-bar-recent",function(){e||SideMenuRecentView.getInstance(),t||i.showRecentHistory(),"none"==$("#side-bar-recent").css("display")?(r(),$("#side-bar-recent-ico").removeClass("alert-btn-recent")):s()}),$(document).off("click.side-bar-recent"),$(document).on("click.side-bar-recent",function(e){$(e.target).closest("#side-bar-recent").length||$(e.target).closest("#side-bar-recent-ico").length||$(e.target).closest("#modal_area").length||$(e.target).closest("div.modal_exit").length||$(e.target).closest("#grouptitle_modal").length||$(e.target).closest("#quote_modal").length||$(e.target).closest("#read_modal").length||$(e.target).closest("#emotion_modal").length||$(e.target).closest("#assignnote_modal").length||$(e.target).closest("#taskregist_modal").length||$(e.target).closest("#taskregist_modal").length||$(e.target).closest("div.autocomplete-suggestion").length||$(e.target).closest("div.autocomplete-suggestion").length||$(e.target).closest("#msgdelete_modal").length||$(e.target).closest(".emoji-mart").length||$(e.target).closest("#mentionmember_modal").length||s()})},r=function(){$(".control-sidebar").hasClass("control-sidebar-open")&&$(".control-sidebar").toggleClass("control-sidebar-open"),"none"==$("#side-bar-recent").css("display")&&($("#side-bar-recent").css("display","block"),$("#side-bar-recent").animate({right:"0px"},{duration:300}))};n.open=function(){r()};var s=function(){"none"!=$("#side-bar-recent").css("display")&&$("#side-bar-recent").animate({right:"-400px"},{duration:300,complete:function(){$("#side-bar-recent").css("display","none")}})};n.close=function(){s()},n.clearColumn=function(){s(),$("#side-bar-recent").remove(),$(window).off("resize.side-bar-recent"),$(document).off("click.side-bar-recent"),e=!1,t=!1},n.createSideList=function(){var e=Resource.getMessage("RecentSideBarTitle");if(!$("#side-bar-recent").size()){var t='                <div id="side-bar-recent">                    <div class="sb-header">                        <span class="sb-ico"><i class="fa fa-commenting"></i></span>                        <span class="sb-ttl">'+e+'</span>                    </div>                    <div class="column-content scroll_content"></div>                </div>            ';$("div.control-sidebar").after(t)}},n.getHtmlElement=function(){return $("#side-bar-recent")},n._hideLoadingIconInSelf=function(){var e=i.getHtmlElement();if(null!=e){var t=e.children("div.column-content");ViewUtils.hideLoadingIconInChild(t)}},n._setToolTipToMessageElem=function(e,t,n){var a=i;o._setToolTipToMessageElem.call(a,e,t,n),$("a.ico_btn.action-show-conversation",e).remove()},n.afterCreateMessageHtml=function(e){var t=i;$(".message-body > pre a.hashtag",e).on("click",function(){t.close()})},n._initColumnSearchCondition=function(){var e={term:0,tome:!1,search:"",sender:"",unread:!1,having_url:!1,attached_file:!1},t=i.getColumnSearchCondition(e,"");i._info.setSearchCondition(t)},n.refreshScrollbar=function(){var e=this;if(!e._htmlElement.find(".scroll_content.ps").length){var t=e._htmlElement.find(".scroll_content");new PerfectScrollbar(t[0],{suppressScrollX:!0});$(t).on("ps-scroll-y",function(){$("emoji-picker").hasClass("open")&&$("emoji-picker").removeClass("open")}),t.on("ps-y-reach-end",function(){e._disableBottomEvent||e._showReadMore(!0)})}},n.showMessage=function(e){var n=i;"none"!=$("#side-bar-recent-ico").css("display")&&"none"==$("#side-bar-recent").css("display")&&e.getFrom()!=LoginUser.getInstance().getJid()&&$("#side-bar-recent-ico").addClass("alert-btn-recent"),t&&o.showMessage.call(n,e)},n._showReadMore=function(){var e,t=this,n=!1,o=0,i=t.getHtmlElement();if(null!=i){var a=t.getColumnContent();if(a.parents("#side-bar-recent").length)return 0==t._validation({object:a})?n:1==t._allMessageReceived?!1:(e=a.children("div:last"),e.hasClass(ViewUtils.LOADING_ICON_CLASS_NAME)?!1:(t._hideLoadingIconInSelf(),ViewUtils.showLoadingIcon(e),o=a.children("div.message-border").size(),0==o?(ViewUtils.hideLoadingIcon(e),!1):(a.parents("#side-bar-recent").length&&"none"!=a.parents("#side-bar-recent").css("display")&&(t.getHistoryMessage(),n=!0),n)))}},a()}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var e=!1,t=!1;SideMenuMurmurView.prototype=$.extend({},ColumnMurmurView.prototype);var n=ColumnMurmurView.prototype,o=SideMenuMurmurView.prototype,i=new SideMenuMurmurView;SideMenuMurmurView.getInstance=function(){return e||i.__init(),e=!0,i},i.viewFixed=!1,o.createView=function(){},o.createHtml=function(){},o._setMurmurColumnEvent=function(){},o._createDisplayName=function(){},o._setOptionMenu=function(){},o.onSystemMessageReceive=function(e){},o.isViewFixed=function(){return i.viewFixed},o.__init=function(){var e=this,t=new MurmurColumnInformation,n=new ColumnSortCondition,o=MyMurmurColumnFilter.getFilter(),i=new ColumnSearchCondition(o,n);t.setSearchCondition(i),t.isSideMenu=!0,e.isSideMenu=!0,ColumnMurmurView.call(e,t),e._headerDisplayName=Resource.getMessage("MurmurSideBarTitle"),e.createSideList(),e._htmlElement=e.getHtmlElement(),e.viewFixed=!1;var a=TabColumnStateStore.getInstance()._getItem("side_murmur_"+LoginUser.getInstance().getJid());if("string"==typeof a){var r=JSON.parse(a);"object"==("undefined"==typeof r?"undefined":_typeof(r))&&r.viewFixed&&(e.viewFixed=r.viewFixed)}return e},o.showMurmurHistory=function(){n._LoadingIcon(i,"div.column-content"),i.getHistoryMessage(),i.refreshScrollbar(),i.showButtonEvent(),t=!0,i.viewFixed&&($("#side-bar-murmur > div.sb-header .fa-thumb-tack").addClass("view-fixed"),$("#side-bar-murmur > div.sb-header .fa-thumb-tack").parent().find(".fa.fa-ban").length||$('<i class="fa fa-ban" aria-hidden="true"></i>').appendTo($("#side-bar-murmur > div.sb-header .fa-thumb-tack").parent()),$("#side-bar-murmur > div.sb-header .sb-ico-pin").attr("data-original-title",Resource.getMessage("side_menu_view_unfixed")),i.open())},o.showButtonEvent=function(){a(),i._SendMessageRight||($("#side-bar-murmur button.open-send-dialog").off("click"),$("#side-bar-murmur button.open-send-dialog").css("opacity","0.3")),i._ViewMessageRight||$("#side-bar-murmur > div.column-content").append($("<div>").css({width:"100%",height:"70px",color:"#cccccc",padding:"10px 25px 10px 10px",backgroundColor:"#eae5e5",fontSize:"1.4rem",lineHeight:"2rem",borderTop:"solid 1px #d9d9d9",borderBottom:"solid 1px #ccc"}).text(Resource.getMessage("not_view_to_murmur_err_placeholder"))),$("#side-bar-murmur > div.sb-header .fa-thumb-tack").off("click.sb-header-fa-thumb-tack"),$("#side-bar-murmur > div.sb-header .fa-thumb-tack").on("click.sb-header-fa-thumb-tack",function(){i.viewFixed?($("#side-bar-murmur > div.sb-header .fa-thumb-tack").removeClass("view-fixed"),$("#side-bar-murmur > div.sb-header .sb-ico-pin").find(".fa-ban").remove(),$("#side-bar-murmur > div.sb-header .sb-ico-pin").attr("data-original-title",Resource.getMessage("side_menu_view_fix")),i.viewFixed=!1):($("#side-bar-murmur > div.sb-header .fa-thumb-tack").addClass("view-fixed"),$("#side-bar-murmur > div.sb-header .fa-thumb-tack").parent().find(".fa.fa-ban").length||$('<i class="fa fa-ban" aria-hidden="true"></i>').appendTo($("#side-bar-murmur > div.sb-header .fa-thumb-tack").parent()),$("#side-bar-murmur > div.sb-header .sb-ico-pin").attr("data-original-title",Resource.getMessage("side_menu_view_unfixed")),i.viewFixed=!0);var e=TabColumnStateStore.getInstance()._getItem("side_murmur_"+LoginUser.getInstance().getJid()),t={};e&&(t=JSON.parse(e)),t.viewFixed=i.viewFixed,TabColumnStateStore.getInstance()._setItem("side_murmur_"+LoginUser.getInstance().getJid(),JSON.stringify(t))}),$(window).off("resize.side-bar-murmur"),$(window).on("resize.side-bar-murmur",function(){e&&t&&i.refreshScrollbar()})},o.isGotHistory=function(){return t};var a=function(){$("#side-bar-murmur-ico").off("click.side-bar-murmur-ico"),$("#side-bar-murmur-ico").attr("data-original-title",Resource.getMessage("MurmurSideBarTitle")),$("#side-bar-murmur-ico").on("click.side-bar-murmur-ico",function(){if(e||SideMenuMurmurView.getInstance(),t||i.showMurmurHistory(),"none"==$("#side-bar-murmur").css("display"))r(),$("#side-bar-murmur-ico").removeClass("alert-btn-murmur");else{$("#side-bar-murmur > div.sb-header .fa-thumb-tack").removeClass("view-fixed"),$("#side-bar-murmur > div.sb-header .sb-ico-pin").find(".fa-ban").remove(),$("#side-bar-murmur > div.sb-header .sb-ico-pin").attr("data-original-title",Resource.getMessage("side_menu_view_fix")),i.viewFixed=!1;var n=TabColumnStateStore.getInstance()._getItem("side_murmur_"+LoginUser.getInstance().getJid()),o={};n&&(o=JSON.parse(n)),o.viewFixed=i.viewFixed,TabColumnStateStore.getInstance()._setItem("side_murmur_"+LoginUser.getInstance().getJid(),JSON.stringify(o)),s()}}),$("#side-bar-murmur button.open-list-dialog").off("click.button-open-list-dialog"),$("#side-bar-murmur button.open-list-dialog").on("click.button-open-list-dialog",function(){var e=new DialogMurmurListView("","");e.showDialog()}),$(document).off("click.side-bar-murmur"),$(document).on("click.side-bar-murmur",function(e){i.viewFixed||$(e.target).closest("#side-bar-murmur").length||$(e.target).closest("#side-bar-murmur-ico").length||$(e.target).closest("#modal_area").length||$(e.target).closest("div.modal_exit").length||$(e.target).closest("#murmur_send_modal").length||$(e.target).closest("#quote_modal").length||$(e.target).closest("#read_modal").length||$(e.target).closest("#emotion_modal").length||$(e.target).closest("#assignnote_modal").length||$(e.target).closest("#taskregist_modal").length||$(e.target).closest("#taskregist_modal").length||$(e.target).closest("div.autocomplete-suggestion").length||$(e.target).closest("div.autocomplete-suggestion").length||$(e.target).closest("#msgdelete_modal").length||$(e.target).closest(".emoji-mart").length||$(e.target).closest("#mentionmember_modal").length||s()})},r=function(e){if(null==e&&(e=!0),$(".control-sidebar").hasClass("control-sidebar-open")&&$(".control-sidebar").toggleClass("control-sidebar-open"),"none"==$("#side-bar-murmur").css("display")){$("#side-bar-murmur").css("display","block"),$("#side-bar-murmur").animate({right:"0px"},{duration:300});for(var t=["#columnContainer","#columnInnerContainer"],n=0;n<t.length;n++){var o=parseInt($(t[n]).css("width"));if(!isNaN(o)){var i=o-400+40;320>i&&(i=320),$(t[n]).animate({width:i},{duration:300,complete:function(){e&&$(window).trigger("resize")}})}}}};o.open=function(e){r(e)};var s=function(e){if(null==e&&(e=!0),"none"!=$("#side-bar-murmur").css("display")){$("#side-bar-murmur").animate({right:"-400px"},{duration:300,complete:function(){$("#side-bar-murmur").css("display","none")}});for(var t=["#columnContainer","#columnInnerContainer"],n=0;n<t.length;n++){var o=parseInt($(t[n]).css("width"));if(!isNaN(o)){var i=o+400+40;320>i&&(i=320),$(t[n]).animate({width:i},{duration:300,complete:function(){e&&$(window).trigger("resize")}})}}}};o.close=function(e){s(e)},o.clearColumn=function(){s(),$("#side-bar-murmur").remove(),$(window).off("resize.side-bar-murmur"),$(document).off("click.side-bar-murmur"),e=!1,t=!1},o.createSideList=function(){var e=Resource.getMessage("MurmurSideBarTitle"),t=Resource.getMessage("dialog_murmur_show_unfollow_mess"),n=Resource.getMessage("dialog_murmur_list");if(!$("#side-bar-murmur").size()){var o='                <div id="side-bar-murmur">                    <div class="sb-header">                        <span class="sb-ico-pin" data-original-title="'+Resource.getMessage("side_menu_view_fix")+'" data-toggle="tooltip" data-placement="bottom">                          <i class="fa fa-thumb-tack"></i></span>                        <span class="sb-ico"><i class="fa fa-commenting"></i></span>                        <span class="sb-ttl">'+e+'</span>                        <!-- <button class="show-unfollow-mess" data-original-title="'+t+'" data-toggle="tooltip" data-placement="bottom">'+t+'</button> -->                        <button class="open-list-dialog" data-original-title="'+n+'" data-toggle="tooltip" data-placement="bottom">'+n+'</button>                    </div>                    <div class="column-content scroll_content"></div>                </div>                        ';$("div.control-sidebar").after(o),$('[data-toggle="tooltip"]').tooltip({trigger:"hover"})}},o.getHtmlElement=function(){return $("#side-bar-murmur")},o._hideLoadingIconInSelf=function(){var e=i.getHtmlElement();if(null!=e){var t=e.children("div.column-content");ViewUtils.hideLoadingIconInChild(t)}},o._setToolTipToMessageElem=function(e,t,o){var a=i;n._setToolTipToMessageElem.call(a,e,t,o),$("a.ico_btn.action-show-conversation",e).on("click",function(e){a.close()})},o.afterCreateMessageHtml=function(e){var t=i;$(".message-body > pre a.hashtag",e).on("click",function(){t.close()})},o._initColumnSearchCondition=function(){var e={term:0,tome:!1,search:"",sender:"",unread:!1,having_url:!1,attached_file:!1},t=i.getColumnSearchCondition(e,"");i._info.setSearchCondition(t)},o.refreshScrollbar=function(){var e=i;if(!e._htmlElement.find(".scroll_content.ps").length){var t=e._htmlElement.find(".scroll_content");new PerfectScrollbar(t[0],{suppressScrollX:!0});$(t).on("ps-scroll-y",function(){$("emoji-picker").hasClass("open")&&$("emoji-picker").removeClass("open")}),t.on("ps-y-reach-end",function(){e._disableBottomEvent||e._showReadMore(!0)})}},o.showMessage=function(e){var o=i;"none"!=$("#side-bar-murmur-ico").css("display")&&"none"==$("#side-bar-murmur").css("display")&&e.getFrom()!=LoginUser.getInstance().getJid()&&$("#side-bar-murmur-ico").addClass("alert-btn-murmur"),t&&n._showMessageData.call(o,e)},o._showReadMore=function(){var e,t=i,n=!1,o=0,a=t.getHtmlElement();if(null!=a){var r=t.getColumnContent();if(r.parents("#side-bar-murmur").length)return 0==t._validation({object:r})?n:1==t._allMessageReceived?!1:(e=r.children("div:last"),e.hasClass(ViewUtils.LOADING_ICON_CLASS_NAME)?!1:(t._hideLoadingIconInSelf(),ViewUtils.showLoadingIcon(e),o=r.children("div.message-border").size(),0==o?(ViewUtils.hideLoadingIcon(e),!1):(r.parents("#side-bar-murmur").length&&"none"!=r.parents("#side-bar-murmur").css("display")&&(t.getHistoryMessage(),n=!0),n)))}},a()}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogSendMurmurMessageView.prototype=$.extend({},DialogOkCancelView.prototype);var e=DialogOkCancelView.prototype,t=DialogSendMurmurMessageView.prototype;t._init=function(){var t=this;e._init.call(t),t._dialogAreaElement.html(t.getInnerHtml()),t._dialogInnerElement=t._dialogAreaElement.children(),$('[data-toggle="tooltip"]').tooltip({trigger:"hover"}),t._createEventHandler()},t._createEventHandler=function(){var e=this,t=e._dialogInnerElement.find("textarea.message-input-area");t.on("keypress",function(t){(t.ctrlKey&&13==t.keyCode||10==t.keyCode)&&e._sendMessageExecute()}),$("#murmur_send_modal > div.btn_wrapper > button.modal_btn").on("click",function(){e._sendMessageExecute()}),autosize(e._dialogInnerElement.find(".message-input-area"));var n=e._dialogInnerElement.find("div.frm-message > textarea.message-input-area-title");e._titlearea=new ColumnTextAreaView(n,e,Resource.getMessage("default_placeholder")),ViewUtils.setCharCounter(n,e._dialogInnerElement.find(".char-counter-column-title"),ColumnView.THREAD_TITLE_MAX_LENGTH);var t=e._dialogInnerElement.find("div.frm-message > textarea.message-input-area");e._textarea=new ColumnTextAreaView(t,e,Resource.getMessage("default_placeholder")),ViewUtils.setCharCounter(t,e._dialogInnerElement.find(".char-counter-column"),ColumnView.TEXTAREA_MAX_LENGTH);var o=e._dialogInnerElement.find("div.frm-message > .file-inputs");e._fileUpload=new ColumnFileUploadPartsView(o,e);var i=e._dialogInnerElement.find("div.frm-message").find(".submit-message-progress");e._progressBar=new ProgressBarView(i,!1),CodiMdViewUtils.judgeNoteEnable()&&(e.ps=new PerfectScrollbar(e._dialogInnerElement.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(e.ps)),e._dialogInnerElement.find("#attach-note-cancel-btn").hide(),e._dialogInnerElement.find("#attach-note-cancel-btn").off("click.attach-note-cancel-btn"),e._dialogInnerElement.find("#attach-note-cancel-btn").on("click",function(){$("#murmur_send_modal .message-body-note > a > span").remove(),$("#murmur_send_modal .message-body-note > a").append("<span>"),e._dialogInnerElement.find("#attach-note-cancel-btn").hide(),e.isNoteLiistOpen=!1}),$("#murmur_send_modal textarea").off("click.murmur_send_modal_textarea"),$("#murmur_send_modal textarea").on("click.murmur_send_modal_textarea",function(){e.isNoteLiistOpen=!1,$("#dialog-error").text(""),$("#murmur_send_modal div.note-assign-list").hide()}),e._dialogInnerElement.find(".note-assign-list").hide(),e._dialogInnerElement.find(".attach-note-btn").on("click",function(){CodiMdViewUtils.judgeNoteEnable()&&(e.isNoteLiistOpen?(e.isNoteLiistOpen=!1,
$("#dialog-error").text(""),$("#murmur_send_modal div.note-assign-list").hide()):(CodiMdController.getInstance().getNoteList().then(function(t){if(t.result&&Array.isArray(t.data)){e.isNoteLiistOpen=!0,$("#murmur_send_modal .note-assign-list ul > li").remove();for(var n=0,o=0;o<t.data.length;o++)if(!t.data[o].msgtype){var i=Utils.convertEscapedHtml(decodeURIComponent(t.data[o].note_title)),a=t.data[o].room_name?Utils.convertEscapedHtmldecodeURIComponent(t.data[o].room_name):Resource.getMessage("not_assign_room_notes"),r=$("<a>").val(t.data[o].note_url).attr("value",t.data[o].note_url).attr("title",i).attr("class","text-overflow-ellipsis title-list").html('<div class="name note-list">'+i+'</div><div class="group note-list">'+a+"</div>").on("click",function(t){e.isNoteLiistOpen=!1;var n=Utils.convertUnEscapedHtml($(t.currentTarget).attr("title")),o=Utils.convertUnEscapedHtml($(t.currentTarget).attr("value"));n.length>0&&($("#murmur_send_modal div.message-body-note > a.attach-note-btn > span").text(n),$("#murmur_send_modal div.message-body-note > a.attach-note-btn > span").attr("title",n),$("#murmur_send_modal div.message-body-note > a.attach-note-btn > span").attr("value",o),$("#attach-note-cancel-btn").css("display","inline-block"),$("#murmur_send_modal div.note-assign-list").hide())}),s=$("<li>").append(r);$("#murmur_send_modal .note-assign-list ul").append(s),n++}0==n&&($("#murmur_send_modal div.note-assign-list").hide(),$("#dialog-error").text(Resource.getMessage("dialog_note_nothing_for_assign")))}else $("#murmur_send_modal div.note-assign-list").hide(),$("#dialog-error").text(Resource.getMessage("dialog_note_nothing_for_assign"))})["catch"](function(e){console.error("can not get note list error:"+e)}),e._dialogInnerElement.find(".note-assign-list").show()))})},t.showDialog=function(){var e=this;e._onOpenDialog();var t=e._dialogInnerElement.find(".message-input-area");t.blur(),t.focus(),autosize.update(t)},t._onOpenDialog=function(){var e=this;$("#modal_area").css("display","block"),$("#modal_area").prepend('<div class="overlay modal_exit"></div>'),e._dialogInnerElement.addClass("on").css("display","block").animate({"margin-top":0,opacity:1},200),$(".overlay").animate({opacity:.3},200)},t.getInnerHtml=function(){var e="<div>",t="autocomplete";e+='<textarea class="ui-corner-all autoresize-textarea message-input-area '+t+'" placeholder="" style="min-height: 8em; max-height: 300px;margin-top:3px;border-radius: 3px;"></textarea>',e+=ColumnFileUploadPartsView.getHtml(1),e+=ColumnTextAreaView.getCharCounterHtml(1,!0),e+="</div>";var n="";n='<div id="murmur_send_modal" class="card modal_card">',n+='    <div class="card_title">',n+="      <p>"+Resource.getMessage("dialog_label_murmur_send_message")+"</p>",n+="    </div>",n+='    <div class="modal_content_wrapper">',n+='      <div class="flex1 frm-message murmur_send_message">',n+='<textarea class="ui-corner-all autoresize-textarea message-input-area-title '+t+'" _roomIdAttribute placeholder="'+Resource.getMessage("title_select_category")+'" style="min-height: 32px; max-height: 100px; width: 420px; padding-top: 6px; padding-bottom: 0px; padding-left: 21px;         border: solid #eee 1px; line-height: 2rem;border-radius: 3px;" maxlength="51"></textarea>',n+=ColumnTextAreaView.getTitleCategorySelectorHtml("murmur-send-message-title","",Message.TYPE_MURMUR),n+='<span class="char-counter char-counter-column-title char-counter-under">'+ColumnView.THREAD_TITLE_MAX_LENGTH+"</span>",n+=$(e).find(".message-input-area").prop("outerHTML"),n+=$(e).find(".file-inputs").prop("outerHTML"),n+=$(e).find(".char-counter-column").prop("outerHTML");return CodiMdViewUtils.judgeNoteEnable()&&(n+='      <div class="message-body-note">',n+='           <a class="ico_btn attach-note-btn" data-toggle="tooltip" data-original-title="'+Resource.getMessage("tootip_assign_note")+'" data-placement="right">',n+='               <i class="fa fa-pencil-square-o"></i>',n+="               <span></span>",n+="           </a>",n+='           <a class="ico_btn" id="attach-note-cancel-btn">',n+='             <i class="fa fa-close" title="'+Resource.getMessage("dialog_label_cancel")+'"></i></a>',n+="      </div>",n+='       <div class="note-assign-list scroll_content">',n+='        <ul class="select_list"></ul>',n+="       </div>"),n+="      </div>",n+="    </div>",n+='    <div class="btn_wrapper">',n+='      <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',n+='      <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+"</span></button>",n+="    </div>",n+='    <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',n+="</div>"},t._uploadFileAndSendMessage=function(e,t,n){var o=this;if("function"!=typeof n)return!1;if(1==o._uploading)return!1;var i=null,a=o._dialogInnerElement.find(".modal_content_wrapper"),r=e;if(ViewUtils.getAttachmentFileName(e)&&(r=ViewUtils.removeAttachmentUrl(e).slice(0,-1)),ViewUtils.isValidInputTextLength(r)){var s=function(i){return"success"!=i.result?(o._uploading=!1,ViewUtils.switchAttachmentArea(a,!0),o._progressBar.progressClear(),void o._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_update_file_error"))):(e+="\n"+i.path,n(e,t),o._uploading=!1,ViewUtils.switchAttachmentArea(a,!0),void o._progressBar.progressComplete())},l=function(e){o._progressBar.setProgressValue(e)};if(null==o._fileUpload)return void n(e,t);if(i=o._fileUpload.getFilesObject(),null==i)return void n(e,t);if(i.length<=0)return void n(e,t);o._progressBar.visibleProgressBar(),ViewUtils.switchAttachmentArea(a,!1),o._uploading=!0;var u=i[0];return CubeeController.getInstance().uploadFile(u,s,l)}return!1},t._sendMessageExecute=function(){function e(e,n){var i=new MurmurMessage;i.setMessage(e),i.setThreadTitle(n?n:""),i.setTo(LoginUser.getInstance().getJid()),i.setReplyItemId(""),i.setReplyTo(""),i.getBodyType(0);CubeeController.getInstance().sendMurmurMessage(i,function(e){if(e.content.result)o(e),ViewUtils.modal_allexit();else if(e&&e.content.reason)switch(e.content.reason){case 403e3:t._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("authority_err"));break;default:t._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_murmur_send_message_error"))}else t._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_murmur_send_message_error"))})}var t=this,n=t._dialogInnerElement;if(!t._isValidationOk(n))return!1;var o=function(e){var t=$("#murmur_send_modal div.message-body-note > a.attach-note-btn > span").attr("value");if(t){if(null==e||!e.content||!e.content.result){var n=Resource.getMessage("dialog_title_system_info"),o=Resource.getMessage("dialog_error_send_message"),i=new DialogCloseView(n,o);return void i.showDialog()}if(e.content.items&&e.content.items.length)var a=function(){if(CubeeController.getInstance()._messageManager.getAllMessage().getByItemId(r.itemId))clearInterval(u),CodiMdController.getInstance().assignNoteOnThreadRootId(r.itemId,t).then(function(e){$("#murmur_send_modal .message-body-note > a > span").remove(),$("#murmur_send_modal .message-body-note > a").append("<span>")})["catch"](function(e){var t=Resource.getMessage("dialog_title_system_info"),n=Resource.getMessage("dialog_error_assign_note_after_try"),o=new DialogCloseView(t,n);o.showDialog()});else if(c+=1,s*c>l){clearInterval(u);var e=Resource.getMessage("dialog_title_system_info"),n=Resource.getMessage("dialog_error_assign_note_after_try"),o=new DialogCloseView(e,n);o.showDialog()}},r=e.content.items[0],s=200,l=1e4,u=setInterval(a,s),c=0}else $("#murmur_send_modal .message-body-note > a > span").remove(),$("#murmur_send_modal .message-body-note > a").append("<span>")},i=$("#murmur_send_modal textarea.message-input-area-title").val(),a=$("#murmur_send_modal textarea.message-input-area").val();if(!a)return alert(""),!1;if(t.displayFileName&&n.find("p.file-name").text()==t.displayFileName&&t._fileUpload.getFilesObject().length<=0){var r=t._message.getMessage().split(/(\n| )/);if(r.length>1){var s="\n";" "==t._message.getMessage().substring(t._message.getMessage().indexOf(r[r.length-1])-1,t._message.getMessage().indexOf(r[r.length-1]))&&(s=" "),"\n"==s?a=a+"\n"+r[r.length-1]:" "==s&&r[r.length-1].match(/^https?:\/\//)&&(a=a+"\n"+r[r.length-1])}}return t._uploadFileAndSendMessage(a,i,e),!0},t._isChangeData=function(e){var t=this;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var n=e.find(".message-input-area").val();return t.displayMessage!=n?!0:t.displayFileName&&!e.find("p.file-name").text()?!0:t._fileUpload.getFilesObject().length>0?!0:!1},t._isValidationOk=function(e){if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var t=e.find("textarea.message-input-area"),n=t.val(),o=e.find("textarea.message-input-area-title"),i=o.val();return e.find("#dialog-error").text(""),t.removeClass("input-error"),o.removeClass("input-error"),i.length>ColumnView.THREAD_TITLE_MAX_LENGTH?(o.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("dialog_update_title_validation_error")),!1):0==n.trim().length?(t.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("dialog_update_message_nothing_error")),!1):ViewUtils.isValidInputTextLength(n)?!0:(t.addClass("input-error"),e.find("#dialog-error").text(ColumnView.TEXTAREA_MAX_LENGTH+Resource.getMessage("dialog_update_message_number_error")),!1)}}(),function(){function e(e,t){var n=t.length;if(0==n)return void showErrMessage(e._dialogMessageToPage,Resource.getMessage("dialog_error_nothing_murmur"));for(var o="",i=0;n>i;i++){var a=t[i].jid,r=Utils.urldecode(Utils.getSafeStringData(t[i].nickName)),s=(Utils.urldecode(Utils.getSafeStringData(ViewUtils.getCubeeAccountName(a))),Utils.urldecode(Utils.getSafeStringData(t[i].affiliation.join(",")))),l=new Person;l.setJid(t[i].jid),l.setUserName(Utils.urldecode(Utils.getSafeStringData(t[i].nickName)));for(var u=Utils.getSafeArrayData(t[i].affiliation),c=[],d=0;d<u.length;d++)c.push(Utils.urldecode(u[d]));l.setGroup(c),l.setAvatarType(Utils.getSafeStringData(t[i].avatartype)),l.setAvatarData(Utils.getSafeStringData(t[i].avatardata)),l.setLoginAccount(Utils.urldecode(Utils.getSafeStringData(ViewUtils.getCubeeAccountName(a))));var g="";g=ViewUtils.getAvatarUrl(l)==ViewUtils.DEFAULT_USER_AVATAR_SRC?ViewUtils.getDefaultAvatarHtml(l):ViewUtils.getAvatarDataHtmlFromPerson(l),o+='<li jid="'+a+'">',o+='  <a title="'+Utils.convertEscapedHtml(r)+"  "+Utils.convertEscapedHtml(s)+'">',o+='    <div style="display:inline-block">',o+="    </div>",o+='    <span class="ico ico_user">',o+=g,o+="    </span>",o+='    <span class="name">'+Utils.convertEscapedHtml(r)+"</span>",o+='    <span class="group">'+Utils.convertEscapedHtml(s)+"</span>",o+="</a></li>"}return o}function t(e){var t="";if(e.getFullYear()){var n=e.getFullYear(),o=("00"+(e.getMonth()+1)).slice(-2),i=("00"+e.getDate()).slice(-2);t=n+"/"+o+"/"+i}return t}DialogMurmurListView.prototype=$.extend({},DialogOkCancelView.prototype);var n=DialogOkCancelView.prototype,o=DialogMurmurListView.prototype;o._init=function(){var e=this;e._dialogAreaElement.html(e.getFrame()),e._dialogInnerElement=e._dialogAreaElement.children(),e.ps=new PerfectScrollbar(e._dialogInnerElement.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(e.ps),e._dialogInnerElement.on("click",".modal_exit",function(){return n.cleanup.call(e),e.cleanup(),ViewUtils.modal_allexit(),!1}),e._dialogInnerElement.find(".modal_btn").on("click",function(){return n.cleanup.call(e),e.cleanup(),ViewUtils.modal_allexit(),!1}),e.showMonthRanking(),e._dialogAreaElement.on("change",'input[name="ranking-period"]:radio',function(){switch(e._dialogInnerElement.find(".scroll_content").off(),$("#rankingList").children().remove(),e.ps.update(),e._dialogInnerElement.find("#dialog-error").text(""),$(this).attr("id")){case"period-week":e.showWeekRanking();break;case"period-month":e.showMonthRanking();break;case"period-year":e.showYearRanking()}})},o.getFrame=function(){var e="";return e='<div id="murmurlist_modal" class="card modal_card">',e+='<div class="card_title">',e+="  <p>"+Resource.getMessage("dialog_murmur_list")+"</p>",e+="</div>",e+='<div class="list_wrapper scroll_content">',e+='  <ul class="modal_list" id="rankingList">',e+="  </ul>",e+="</div>",e+='    <div class="btn_wrapper">',e+='      <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',e+='      <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+"</span></button>",e+="    </div>",e+='<a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',e+="</div>"},o.showWeekRanking=function(){var n=this,o=new Date;o.setDate(o.getDate()-7);var i=t(o);if(n._weekRankingList)return void n._dialogAreaElement.find("#rankingList").append(e(n,n._weekRankingList));var a=null;a=CubeeController.getInstance().getMurmurRanking(i,100,0,100),a.then(function(t){0==t.errorCode&&t.content.data.items.length?(n.weekRankingList=null,n._weekRankingList=t.content.data.items,n._dialogAreaElement.find("#rankingList").append(e(n,n._weekRankingList)).click(function(e){var t=$(e.target).closest("li").attr("jid");ColumnManager.getInstance().addMurmurColumn(t,!0,!1,!1),ViewUtils.modal_allexit()})):0==t.content.data.items.length&&n._dialogInnerElement.find("#dialog-error").text(Resource.getMessage("dialog_error_nothing_ranking"))})["catch"](function(e){n._dialogInnerElement.find("#dialog-error").text(Resource.getMessage("dialog_error_get_ranking"))})},o.showMonthRanking=function(){var n=this,o=new Date;o.setMonth(o.getMonth()-1);var i=t(o);if(n._monthRankingList)return void n._dialogAreaElement.find("#rankingList").append(e(n,n._monthRankingList));var a=null;a=CubeeController.getInstance().getMurmurRanking(i,100,0,100),a.then(function(t){0==t.errorCode&&t.content.data.items.length?(n._monthRankingList=null,n._monthRankingList=t.content.data.items,n._dialogAreaElement.find("#rankingList").append(e(n,n._monthRankingList)).click(function(e){var t=$(e.target).closest("li").attr("jid");ColumnManager.getInstance().addMurmurColumn(t,!0,!1,!1),ViewUtils.modal_allexit()})):0==t.content.data.items.length&&n._dialogInnerElement.find("#dialog-error").text(Resource.getMessage("dialog_error_nothing_ranking"))})["catch"](function(e){n._dialogInnerElement.find("#dialog-error").text(Resource.getMessage("dialog_error_get_ranking"))})},o.showYearRanking=function(){var n=this,o=new Date;o.setYear(o.getFullYear()-1);var i=t(o);if(n._yearRankingList)return void n._dialogAreaElement.find("#rankingList").append(e(n,n._yearRankingList));var a=null;a=CubeeController.getInstance().getMurmurRanking(i,100,0,100),a.then(function(t){0==t.errorCode&&t.content.data.items.length?(n._yearRankingList=null,n._yearRankingList=t.content.data.items,n._dialogAreaElement.find("#rankingList").append(e(n,n._yearRankingList)).click(function(e){var t=$(e.target).closest("li").attr("jid");ColumnManager.getInstance().addMurmurColumn(t,!0,!1,!1),ViewUtils.modal_allexit()})):0==t.content.data.items.length&&n._dialogInnerElement.find("#dialog-error").text(Resource.getMessage("dialog_error_nothing_ranking"))})["catch"](function(e){n._dialogInnerElement.find("#dialog-error").text(Resource.getMessage("dialog_error_get_ranking"))})}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogMurmurColumnNameSetView.prototype=$.extend({},DialogOkCancelView.prototype);var e=DialogOkCancelView.prototype,t=DialogMurmurColumnNameSetView.prototype;t._init=function(){var t=this;e._init.call(t),t._dialogAreaElement.html(t.getInnerHtml()),t._dialogInnerElement=t._dialogAreaElement.children();var n=t._dialogInnerElement,o=n.find("input#column-name");o.on("keypress",function(e){(e.which&&13==e.which||e.keyCode&&13==e.keyCode)&&t._updateColumnNameExecute()}),t._dialogInnerElement.find(".modal_btn").on("click",function(){t._updateColumnNameExecute()})},t.showDialog=function(){var e=this;e._onOpenDialog();var t=e._dialogInnerElement.find("input#column-name");t.blur(),t.focus()},t._onOpenDialog=function(){var e=this;e._initInputData(),$("#modal_area").css("display","block"),$("#modal_area").prepend('<div class="overlay modal_exit"></div>'),e._dialogInnerElement.addClass("on").css("display","block").animate({"margin-top":0,opacity:1},200),$(".overlay").animate({opacity:.3},200)},t._initInputData=function(){var e=this,t=e._dialogInnerElement,n=t.find("input#column-name"),o=null!=e.columnInfo._columnName?e.columnInfo._columnName:"";n.val(o)},t.getInnerHtml=function(){var e="";return e='<div id="murmur-column-name-modal" class="card modal_card">',e+='    <div class="card_title">',e+="      <p>"+Resource.getMessage("dialog_label_murmur_column_name_set"),e+="    </div>",e+='    <div class="modal_content_wrapper">',e+='      <div class="modal_content">',e+='        <input type="text" id="column-name" placeholder="'+Resource.getMessage("dialog_placeholder_murmur_column_name")+'" class="field ui-corner-all column-name-input">',e+='        <p id="dialog-notes" style="padding: 0 15px;">'+Resource.getMessage("dialog_set_murmur_column_name_note")+"</p>",e+="      </div>",e+="    </div>",e+='    <div class="btn_wrapper">',e+='      <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',e+='      <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+"</span></button>",e+="    </div>",e+='    <a class="modal_exit modal_exit_btn ico_btn ui-dialog-columnNamebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',e+="</div>"},t._updateColumnNameExecute=function(){var e=this,t=e._dialogInnerElement;if(!e._isChangeData(t))return ViewUtils.modal_allexit(),!0;if(!e._isValidationOk(t))return!1;var n=t.find("input#column-name"),o=Utils.excludeControleCharacters(n.val()),i=MurmurColumnInformation.getOwnJidFromSearchCondition(e.columnInfo);return null==i?!1:i!=LoginUser.getInstance().getJid()?(e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("authority_err")),!1):(CubeeServerConnector.getInstance().setMurmurColumnName(i,encodeURIComponent(o)).then(function(e){ViewUtils.modal_allexit()})["catch"](function(t){if(t&&t.content.reason)switch(t.content.reason){case 403e3:e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("authority_err"));break;default:e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_update_column_name_error"))}else e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_update_column_name_error"))}),!0)},t._isChangeData=function(e){var t=this,n=!0;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var o=e.find("input#column-name"),i=o.val();return i==t.columnInfo._columnName&&(n=!1),n},t._isValidationOk=function(e){var t=!0;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var n=e.find("input#column-name"),o=n.val();return e.find("#dialog-error").text(""),n.removeClass("input-error"),o.length>20&&(n.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("dialog_update_column_name_validation_error")),t=!1),t}}(),function(){function e(e){e.find("#note-create").on("click",function(){var e=new DialogCreateNoteView;e.showDialog()}),e.find("#note-delete").on("click",function(){var e=new DialogRemoveNoteView;e.showDialog()}),e.find("#note-all-list").on("click",function(){var e=new DialogNoteListView;e.showDialog()}),e.find('[data-toggle="tooltip"]').tooltip({trigger:"hover"})}function t(e,t){if(!t.note_title)return!1;var n=Utils.convertEscapedHtml(decodeURIComponent(t.note_title)),o=CodiMdViewUtils.getRoomName(t),i='            <li>                <a href="'+t.note_url+'" target="_blank"                         msgtype="'+t.msgtype+'"                         roomid="'+t.room_id+'"                         title="'+n+" "+o+'">                    <span class="name">'+n+'</span>                    <span class="group">'+o+"</span>                </a>            </li>";return i}var n=new SidebarNoteView;SidebarNoteView.getInstance=function(){return n};var o=SidebarNoteView.prototype;o.setNoteHtmlElement=function(){var t='          <div class="sidebar_list_content note_list">              <div class="list_ttl_ico">                  <i class="fa fa-pencil-square-o"></i>              </div>              <div class="sidebar_list_inner">                  <div class="list_ttl">                      <span></span>                      <a id="note-create" class="list_add ico_btn" data-toggle="tooltip" data-placement="left" title="" data-modal="addchat_modal"><i class="fa fa-plus"></i></a>                      <a id="note-delete" class="list_remove ico_btn" data-toggle="tooltip" data-placement="left" title="" data-modal="removechat_modal"><i class="fa fa-minus"></i></a>                  </div>                  <ul class="sidebar_list"></ul>                  <div class="all_list_btn">                      <a id="note-all-list" class="list_add txt_btn" data-modal="chatlist_modal"></a>                  </div>              </div>          </div>        ',n=$(".sidebar_list_wrapper");n.append(t),this._htmlElement=n.find(".note_list"),e(this._htmlElement),this.reloadNoteListOnSidebar()},o.reloadNoteListOnSidebar=function(){var e=this;CodiMdController.getInstance().getNoteList().then(function(n){if(n.result){var o=e._htmlElement.find("ul.sidebar_list");o.children().remove();for(var i=0;5>i;i++)o.append(t(o,n.data[i]))}})["catch"](function(){})},o.showNoteList=function(){var e=this;if(CodiMdViewUtils.judgeNoteEnable())var t=setInterval(function(){CodiMdController.getInstance().connectPostToZeroJson()&&(clearTimeout(t),e.setNoteHtmlElement())},1e3)}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){DialogCreateNoteView.prototype=$.extend({},DialogOkCancelView.prototype);var e=DialogOkCancelView.prototype,t=DialogCreateNoteView.prototype;t._init=function(){var t=this;e._init.call(t),t._dialogAreaElement.html(t.getInnerHtml()),t._dialogInnerElement=t._dialogAreaElement.children();var n=t._dialogInnerElement,o=n.find("input#title_name");o.on("keypress",function(e){(e.which&&13==e.which||e.keyCode&&13==e.keyCode)&&t._createNoteExecute()}),t._dialogInnerElement.find(".modal_btn").on("click",function(){t._createNoteExecute()})},t.showDialog=function(){var e=this;e._onOpenDialog();var t=e._dialogInnerElement.find("input#title_name");t.blur(),t.focus()},t._onOpenDialog=function(){var e=this;$("#modal_area").css("display","block"),$("#modal_area").prepend('<div class="overlay modal_exit"></div>'),e._dialogInnerElement.addClass("on").css("display","block").animate({"margin-top":0,opacity:1},200),$(".overlay").animate({opacity:.3},200)},t.getInnerHtml=function(){var e="";return e='<div id="createnote_modal" class="card modal_card">',e+='    <div class="card_title">',e+="      <p>"+Resource.getMessage("dialog_label_create_note"),e+="    </div>",e+='    <div class="modal_content_wrapper">',e+='      <div class="modal_content">',e+='        <p class="modal_title">'+Resource.getMessage("dialog_label_note_name")+"</p>",e+='        <input type="text" id="title_name" placeholder="'+Resource.getMessage("dialog_placeholder_note_name")+'" class="field ui-corner-all" maxlength="50">',e+="      </div>",e+="    </div>",e+='    <div class="btn_wrapper">',e+='      <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>',e+='      <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("button_create")+"</span></button>",e+="    </div>",e+='    <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>',e+="</div>"},t._createNoteExecute=function(){var e=this,t=e._dialogInnerElement;if(t.find("button.success_btn").prop("disabled",!0),!e._isValidationOk(t))return t.find("button.success_btn").prop("disabled",!1),!1;var n=t.find("input#title_name"),o=Utils.excludeControleCharacters(n.val());return o=encodeURIComponent(o),ViewUtils.showLoadingTopInChild($("#dialog-error")),CodiMdController.getInstance().makeNewNote(o).then(function(t){t.result?(ViewUtils.modal_allexit(),SidebarNoteView.getInstance().reloadNoteListOnSidebar()):e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_error_create_note"))})["catch"](function(t){e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_error_create_note"))})["finally"](function(){ViewUtils.hideLoadingIconInChild($("#dialog-error")),t.find("button.success_btn").prop("disabled",!1)}),!0},t._isValidationOk=function(e){var t=!0;if(!e||"object"!=("undefined"==typeof e?"undefined":_typeof(e)))return!1;var n=e.find("input#title_name"),o=n.val();return e.find("#dialog-error").text(""),n.removeClass("input-error"),o||(n.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("dialog_error_note_name")),t=!1),o.length>50&&(n.addClass("input-error"),e.find("#dialog-error").text(Resource.getMessage("dialog_create_note_validation_error")),t=!1),t}}(),function(){function e(e){switch(e._msgType=ViewUtils.convertColumnTypeToMessageType(e._columnInfo.getColumnType()),e._msgType){case Message.TYPE_PUBLIC:break;case Message.TYPE_CHAT:e._roomId=e._columnInfo.getFilterCondition();break;case Message.TYPE_GROUP_CHAT:e._roomId=e._columnInfo.getChatRoomInfomation().getRoomId();break;case Message.TYPE_COMMUNITY:e._roomId=e._columnInfo.getCommunityInfomation().getRoomId();break;case Message.TYPE_MURMUR:e._roomId=MurmurColumnInformation.getOwnJidFromSearchCondition(e._columnInfo)}}DialogNoteListView.prototype=$.extend({},DialogOkCancelView.prototype);var t=(DialogOkCancelView.prototype,DialogNoteListView.prototype);t._init=function(){var t=this;t.frame=t.getInnerHtml(),t._dialogAreaElement.html(t.frame),t._dialogInnerElement=t._dialogAreaElement.children(),t.ps=new PerfectScrollbar(t.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t._createEventHandler(),ViewUtils.showLoadingTopInChild($("#dialog-error")),t._columnInfo&&e(t),CodiMdController.getInstance().getNoteList(t._threadRootId,t._roomId,t._msgType).then(function(e){e.result?(t._allNoteNames=e.data,t._createNoteElement(e.data)):t._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_error_get_note_list"))})["catch"](function(e){t._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_error_get_note_list"))})["finally"](function(){ViewUtils.hideLoadingIconInChild($("#dialog-error"))})},t._createNoteElement=function(e){var t=this,n=this,o=n._dialogAreaElement.find("#dialog-error");if(o.text(""),0==n._allNoteNames.length)return void o.text(Resource.getMessage("dialog_note_nothing"));if(0==e.length)return void n._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_error_note_search_nothing"));for(var i=LoginUser.getInstance().getJid(),a=0;a<e.length;a++){var r=Utils.convertEscapedHtml(decodeURIComponent(e[a].note_title)),s=CodiMdViewUtils.getRoomName(e[a]),l="";l=e[a].ownjid==i?'<a class="note-info-edit-open-dialog ownnote ico_btn fa fa-pencil"  title="'+Resource.getMessage("note_name_edit_botton_tooltip")+'" noteurl="'+e[a].note_url+'"></a>':'<a class="note-info-edit-open-dialog notownnote ico_btn fa fa-pencil"></a>';var u='                <li>                    <a href="'+e[a].note_url+'" target="_blank"                    title="'+r+'" class="text-overflow-ellipsis title-list">                        <div class="note-name">                            <span class="name note-list">'+r+'</span>                        </div>                        <div class="note-group">                            <span class="group note-list">'+s+"</span>                        </div>                    </a>                    "+l+"                 </li>",c=$(u);this._dialogInnerElement.find(".select_list").append(c),$("a.note-info-edit-open-dialog.ownnote",c).bind({blur:function(e){$(".tooltip").remove()},click:function(e){if($(".tooltip").remove(),e.stopPropagation(),$("a.note-info-edit-open-dialog.ownnote",t._dialogInnerElement).each(function(t,n){n!=e.currentTarget&&$(n).attr("inedit")&&"true"==$(n).attr("inedit")&&$(n).trigger("resetNoteEdit")}),$(e.currentTarget).attr("inedit"))$(e.currentTarget).trigger("saveNoteEdit");else{$(e.currentTarget).attr("inedit",!0),$(e.currentTarget).css("font-size","2.1rem"),$(e.currentTarget).removeClass("fa-pencil"),$(e.currentTarget).addClass("fa-check"),$(e.currentTarget).attr("title",Resource.getMessage("note_name_save_botton_tooltip"));var n=$(e.currentTarget).parent().find("a.title-list span.name").text();$(e.currentTarget).parent().find("a.title-list").hide(),$(e.currentTarget).parent().on("click",function(t){t.stopPropagation(),$(e.currentTarget).trigger("resetNoteEdit")});var o=$('<input class="note-rename-input" type="text" />').val(n);o.bind({click:function(e){e.stopPropagation()},keydown:function(t){t.stopPropagation(),13==t.keyCode&&$(e.currentTarget).trigger("saveNoteEdit")},keyup:function(e){e.stopPropagation();var t=$(e.currentTarget).val();0==t.length||t.length>Conf.getVal("NOTE_TITLE_MAX_LENGTH")?$(e.currentTarget).css("background-color","#ffc0cb"):$(e.currentTarget).css("background-color","")},forcus:function(e){e.stopPropagation()}}),o.trigger("keyup"),$(e.currentTarget).parent().children("a.title-list").after(o),$(e.currentTarget).parent().children("input.note-rename-input").focus()}},saveNoteEdit:function(e){var t=$(e.currentTarget).attr("noteurl"),n=$(e.currentTarget).parent().find("input.note-rename-input").val();0==n.length||n.length>Conf.getVal("NOTE_TITLE_MAX_LENGTH")||(n!=$(e.currentTarget).parent().find("a.title-list span.name").text()?CodiMdController.getInstance().setNoteTitle(t,encodeURIComponent(Utils.excludeControleCharacters(n))).then(function(t){if(1==t.result)$(e.currentTarget).parent().find("a.title-list span.name").text(n),$(e.currentTarget).parent().find("a.title-list").attr("title",n);else{console.log("error responce:"+JSON.stringify(t));var o=Resource.getMessage("dialog_title_note_error"),i=Resource.getMessage("dialog_error_note_rename"),a=new DialogCloseView(o,i);a.showDialog()}})["catch"](function(e){console.log("error responce:"+JSON.stringify(e));var t=Resource.getMessage("dialog_title_note_error"),n=Resource.getMessage("dialog_error_note_rename"),o=new DialogCloseView(t,n);o.showDialog()})["finally"](function(){$(e.currentTarget).trigger("resetNoteEdit")}):$(e.currentTarget).trigger("resetNoteEdit"))},resetNoteEdit:function(e){$(e.currentTarget).css("color",""),$(e.currentTarget).css("font-size",""),$(e.currentTarget).removeAttr("inedit"),$(e.currentTarget).removeClass("fa-check"),$(e.currentTarget).addClass("fa-pencil"),$(e.currentTarget).attr("title",Resource.getMessage("note_name_edit_botton_tooltip")),$(e.currentTarget).parent().find("a.title-list").show(),$(e.currentTarget).parent().find("input.note-rename-input").remove()}}),$("a.title-list",c).on("click",function(e){
e.stopPropagation(),ViewUtils.modal_allexit()})}},t.getInnerHtml=function(){var e='<div id="notelist_modal" class="card modal_card">          <div class="card_title">            <p> '+Resource.getMessage("dialog_label_get_note_list")+' </p>          </div>          <div class="select_menu">            <form action="#" method="get" class="search_form title_search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("dialog_label_search_note_list")+'">              <button type="button" name="search" class="title_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},t._createEventHandler=function(){var e=this;e._dialogInnerElement.find(".title_search_btn").off("click"),e._dialogInnerElement.find(".title_search_btn").on("click",function(){e.filterTitles()}),e._dialogInnerElement.find("input.field").keypress(function(t){return(t.which&&13===t.which||t.keyCode&&13===t.keyCode)&&e.filterTitles(),13!==t.which})},t.filterTitles=function(){var e=this;e._dialogInnerElement.find(".select_list").empty();var t=e._dialogInnerElement.find("input.field").val(),n=e._allNoteNames.filter(function(e){var n=decodeURIComponent(e.note_title),o=Resource.getMessage("not_assign_room_notes");return e.room_name&&(o=decodeURIComponent(e.room_name)),0<=n.indexOf(t)||0<=o.indexOf(t)});e._createNoteElement(n),e._dialogInnerElement.find(".scroll_content").scrollTop(0)}}(),function(){DialogRemoveNoteView.prototype=$.extend({},DialogOkCancelView.prototype);var e=(DialogOkCancelView.prototype,DialogRemoveNoteView.prototype);e._init=function(){var e=this;e.frame=e.getInnerHtml(),e._dialogAreaElement.html(e.frame),e._dialogInnerElement=e._dialogAreaElement.children(),ViewUtils.showLoadingTopInChild($("#dialog-error")),CodiMdController.getInstance().getNoteList().then(function(t){t.result?(e._allNotes=t.data,e._createNoteElement(t.data)):e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_error_get_note_list"))})["catch"](function(t){e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_error_get_note_list"))})["finally"](function(){ViewUtils.hideLoadingIconInChild($("#dialog-error"))}),e.ps=new PerfectScrollbar(e.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(e.ps),e._createEventHandler()},e.cleanup=function(){var e=this;e.ps&&e.ps.destroy(),e.selectUserListView.cleanUp(),e.selectUserListView=null,e._dialogAreaElement=null,e._dialogInnerElement=null,e.frame=null},e.getInnerHtml=function(){var e='<div id="removenote_modal" class="card modal_card">          <div class="card_title">            <p> '+Resource.getMessage("dialog_label_remove_note")+' </p>          </div>          <div class="select_menu">            <span class="select_number"><i class="fa fa-user"></i><span class="checkedCnt">0</span></span>            <form action="#" method="get" class="search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("dialog_label_search_note_list")+'">              <button type="button" name="search" class="user_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>            <label class="modal_btn all_check">'+Resource.getMessage("wizard_chatlist_allcheck")+'<label class="checkbox"><input name="allcheck" type="checkbox"><span></span></label></label>          </div>          <div class="list_wrapper scroll_content">            <ul class="modal_list select_list"></ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>            <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_remove_user")+'</span></button>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},e._createNoteElement=function(e){var t=this;return t.frame.find("#dialog-error").text(""),0==t._allNotes.length?void t.frame.find("#dialog-error").text(Resource.getMessage("dialog_note_nothing")):0==e.length?void t.frame.find("#dialog-error").text(Resource.getMessage("dialog_error_note_search_nothing")):void $.each(e,function(e,n){var o=Utils.convertEscapedHtml(decodeURIComponent(n.note_title)),i=CodiMdViewUtils.getRoomName(n),a='<li title="'+o+" "+i+'"><label>                <div class="note-name">                    <span class="name">'+o+'</span>                 </div>                <div class="note-group">                    <span class="group">'+i+'</span>                 </div>                <label class="checkbox">                <input type="checkbox" name="removenote"><span></span></label>                 </label></li>',r=$(a);t._dialogInnerElement.find(".select_list").append(r);r.find("input:checkbox").val(n.note_url),0<=t._removeList._array.indexOf(n.note_url)&&r.find("input:checkbox").prop("checked",!0),r.find("input[name=removenote]").off("change"),r.find("input[name=removenote]").on("change",function(){var e=this.value;this.checked?t._removeList.add(this.value):t._removeList._array.forEach(function(n,o){n===e&&t._removeList.remove(o)});var n=t._removeList.getCount();t._dialogInnerElement.find(".checkedCnt").text(n)})})},e._createEventHandler=function(){var e=this;e.frame.find(".success_btn").on("click",function(){e.frame.find("#dialog-error").text(""),e.removeNotes()}),e._dialogInnerElement.find(".user_search_btn").off("click"),e._dialogInnerElement.find(".user_search_btn").on("click",function(){e.filterNotes()}),e._dialogInnerElement.find("input.field").keypress(function(t){return(t.which&&13===t.which||t.keyCode&&13===t.keyCode)&&e.filterNotes(),13!==t.which}),e._dialogInnerElement.find("input[name=allcheck]").off("change"),e._dialogInnerElement.find("input[name=allcheck]").on("change",function(){e._dialogInnerElement.find("input[name=removenote]").prop("checked",this.checked);var t=e._dialogInnerElement.find("input[name=removenote]");if(this.checked)for(var n=0;n<t.length;n++)0===e._removeList._array.filter(function(e){return e===t[n].value}).length&&e._removeList.add(t[n].value);else for(var n=0;n<t.length;n++)e._removeList.remove(e._removeList._array.indexOf(t[n].value));var o=e._removeList.getCount();e._dialogInnerElement.find(".checkedCnt").text(o)})},e.filterNotes=function(){var e=this;e._dialogInnerElement.find(".select_list").empty(),e._dialogInnerElement.find("input[name=allcheck]").prop("checked",!1);var t=e.frame.find(".field").val(),n=e._allNotes.filter(function(e){var n=Utils.convertEscapedHtml(decodeURIComponent(e.note_title)),o=Resource.getMessage("not_assign_room_notes");return e.room_name&&(o=decodeURIComponent(e.room_name)),0<=n.indexOf(t)||0<=o.indexOf(t)});e._searchNotesList=n,e._createNoteElement(e._searchNotesList),e.frame.find(".scroll_content").scrollTop(0)},e.removeNotes=function(){var e=this;if(e.frame.find("#dialog-error").text(""),ViewUtils.showLoadingTopInChild($("#dialog-error")),e._removeList.getCount()>0){for(var t=[],n=0;n<e._removeList.getCount();n++)t.push(CodiMdController.getInstance().removeNote(e._removeList.get(n)));Promise.all(t).then(function(e){SidebarNoteView.getInstance().reloadNoteListOnSidebar(),ViewUtils.modal_allexit()})["catch"](function(t){e.frame.find("#dialog-error").text(Resource.getMessage("dialog_error_failed_remove_notes"))})["finally"](function(){ViewUtils.hideLoadingIconInChild($("#dialog-error"))})}else ViewUtils.hideLoadingIconInChild($("#dialog-error")),e.frame.find("#dialog-error").text(Resource.getMessage("dialog_error_select_remove_notes"))}}(),function(){function e(e,t,n){return'              <a value="'+Utils.convertEscapedHtml(t)+'"                title="'+Utils.convertEscapedHtml(e)+'" class="text-overflow-ellipsis title-list">                  <div class="note-name">                      <span class="name note-list">'+Utils.convertEscapedHtml(e)+'</span>                  </div>                  <div class="note-group">                      <span class="group note-list">'+n+"</span>                  </div>              </a>"}function t(e,t){t=$(t),e._dialogAreaElement.find("ul.assign_note .title-list").remove(),e._dialogAreaElement.find("ul.assign_note .assign-cancel-btn").before(t.prop("outerHTML")),e._selectAssignNote=t,e._dialogAreaElement.find(".assign-cancel-btn").show()}DialogAssignNoteView.prototype=$.extend({},DialogOkCancelView.prototype);var n=(DialogOkCancelView.prototype,DialogAssignNoteView.prototype);n._init=function(){var t=this;if(t.frame=t.getInnerHtml(),t._dialogAreaElement.html(t.frame),t._dialogInnerElement=t._dialogAreaElement.children(),this.AssignedNoteTitle&&this.AssignedNoteUrl){var n=e(this.AssignedNoteTitle,this.AssignedNoteUrl,this.roomName);t._dialogInnerElement.find("ul.assign_note .assign-cancel-btn").before(n),this._selectAssignNote=$(n),t._dialogAreaElement.find(".assign-cancel-btn").show()}t.ps=new PerfectScrollbar(t.frame.find(".scroll_content")[0],{suppressScrollX:!0}),dlg_scr.push(t.ps),t._createEventHandler(),ViewUtils.showLoadingTopInChild($("#dialog-error")),CodiMdController.getInstance().getNoteList().then(function(e){e.result?(t._allNoteNames=e.data.filter(function(e){return!e.thread_root_id}),t._createNoteElement(t._allNoteNames)):t._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_error_get_note_list"))})["catch"](function(e){t._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_error_get_note_list"))})["finally"](function(){ViewUtils.hideLoadingIconInChild($("#dialog-error"))})},n._createNoteElement=function(e){var t=this,n=t._dialogAreaElement.find("#dialog-error");if(n.text(""),0==t._allNoteNames.length)return t.AssignedNoteUrl?void n.text(""):void n.text(Resource.getMessage("dialog_note_nothing_for_assign"));if(0==e.length)return void t._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_error_note_search_nothing"));for(var o=0;o<e.length;o++){var i=Utils.convertEscapedHtml(decodeURIComponent(e[o].note_title)),a=Resource.getMessage("not_assign_room_notes");if(!e[o].thread_root_id){var r='                <li>                    <a value="'+e[o].note_url+'"                    title="'+i+'" class="text-overflow-ellipsis title-list">                        <div class="note-name">                            <span class="name note-list">'+i+'</span>                        </div>                        <div class="note-group">                            <span class="group note-list">'+a+"</span>                        </div>                    </a>                </li>",s=$(r);this._dialogInnerElement.find(".select_list").append(s)}}},n.getInnerHtml=function(){var e='<div id="assignnote_modal" class="card modal_card">          <div class="card_title">            <p> '+Resource.getMessage("dialog_label_assign_note")+' </p>          </div>          <div class="select_menu">            <p class="modal_title">'+Resource.getMessage("dialog_label_select_assign_note")+':</p>            <form action="#" method="get" class="search_form title_search_form">              <input type="text" name="q" class="field" placeholder="'+Resource.getMessage("dialog_label_search_note_list")+'">              <button type="button" name="search" class="title_search_btn ico_btn"><i class="fa fa-search"></i></button>            </form>          </div>          <div class="assign-list">            <div class="list_wrapper scroll_content">              <ul class="modal_list select_list"></ul>            </div>            <p class="modal_title assign_note_title">'+Resource.getMessage("dialog_selected_note")+':</p>            <ul class="modal_list assign_note">              <li>                <a class="ico_btn assign-cancel-btn" role="button" style="display:none;"><i class="fa fa-times"></i></a>              <li>            </ul>          </div>          <div class="btn_wrapper">            <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>            <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">'+Resource.getMessage("dialog_label_ok")+'</span></button>          </div>          <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)},n._createEventHandler=function(){var e=this;e._dialogInnerElement.find(".title_search_btn").off("click"),e._dialogInnerElement.find(".title_search_btn").on("click",function(){e.filterTitles()}),e._dialogInnerElement.find("input.field").keypress(function(t){return(t.which&&13===t.which||t.keyCode&&13===t.keyCode)&&e.filterTitles(),13!==t.which}),e._dialogInnerElement.on("click",".select_list li",function(){t(e,$(this).find("a").prop("outerHTML"))}),e._dialogInnerElement.on("click",".success_btn",function(){e.executeAssignNote()}),e._dialogInnerElement.find(".assign-cancel-btn").on("click",function(){$(this).parent().find(".title-list").remove(),$(this).hide(),e._selectAssignNote=null})},n.filterTitles=function(){var e=this;e._dialogInnerElement.find(".select_list").empty();var t=e._dialogInnerElement.find("input.field").val(),n=e._allNoteNames.filter(function(e){var n=decodeURIComponent(e.note_title),o=Resource.getMessage("not_assign_room_notes");return e.room_name&&(o=decodeURIComponent(e.room_name)),0<=n.indexOf(t)||0<=o.indexOf(t)});e._createNoteElement(n),e._dialogInnerElement.find(".scroll_content").scrollTop(0)},n.executeAssignNote=function(){var e=this;if(e._dialogAreaElement.find("#dialog-error").text(""),!e.AssignedNoteUrl){if(!e._allNoteNames.length)return void ViewUtils.modal_allexit();if(!e._selectAssignNote||!e._selectAssignNote.length)return void e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_error_no_select_assign_note"))}if(!e._assignThreadRootId)return void e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_error_assign_note"));var t="";return e._selectAssignNote&&e._selectAssignNote.length&&(t=e._selectAssignNote.attr("value"),e.AssignedNoteUrl==t)?void ViewUtils.modal_allexit():(ViewUtils.showLoadingTopInChild(e._dialogAreaElement.find("#dialog-error")),e._dialogAreaElement.find("button.success_btn").prop("disabled",!0),void(t&&e.AssignedNoteUrl&&e.AssignedNoteUrl!=t?CodiMdController.getInstance().assignNoteOnThreadRootId(e._assignThreadRootId,"").then(function(n){return CodiMdController.getInstance().assignNoteOnThreadRootId(e._assignThreadRootId,t)}).then(function(e){ViewUtils.modal_allexit()})["catch"](function(t){e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_error_assign_note"))})["finally"](function(){ViewUtils.hideLoadingIconInChild(e._dialogAreaElement.find("#dialog-error")),e._dialogAreaElement.find("button.success_btn").prop("disabled",!1)}):CodiMdController.getInstance().assignNoteOnThreadRootId(e._assignThreadRootId,t).then(function(e){ViewUtils.modal_allexit()})["catch"](function(t){e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_error_assign_note"))})["finally"](function(){ViewUtils.hideLoadingIconInChild(e._dialogAreaElement.find("#dialog-error")),e._dialogAreaElement.find("button.success_btn").prop("disabled",!1)})))}}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};if(function(){CodiMdViewUtils.getRoomName=function(e){var t=Resource.getMessage("not_assign_room_notes");if(e.msgtype){switch(e.msgtype){case Message.TYPE_PUBLIC:t=Resource.getMessage("MyFeed");break;case Message.TYPE_GROUP_CHAT:t="GC";break;case Message.TYPE_COMMUNITY:t="PJ";break;case Message.TYPE_CHAT:t=Resource.getMessage("Chat");break;case Message.TYPE_MURMUR:t=e.room_name?Utils.convertEscapedHtml(Utils.urldecode(e.room_name)):Resource.getMessage("Murmur");break;default:t=""}e.room_name&&e.msgtype!=Message.TYPE_MURMUR&&(t+=" "+Utils.convertEscapedHtml(Utils.urldecode(e.room_name)))}return t},CodiMdViewUtils.getAttachmentHtmlElement=function(){var e="";return CodiMdViewUtils.judgeNoteEnable()?(e+='<div class="attach-note-element">',e+='<a class="ico_btn attach-note-btn" data-toggle="tooltip" data-original-title="'+Resource.getMessage("tootip_assign_note")+'" data-placement="right"><i class="fa fa-pencil-square-o"></i></a>',e+="</div>"):e},CodiMdViewUtils.getNoteListHtmlElementForColumn=function(){var e="";return CodiMdViewUtils.judgeNoteEnable()?'  <li><a class="txt_btn" value="'+ColumnOptionMenu.ELEMENT_MENU_NOTE_ASSIGNED_LIST+'">'+Resource.getMessage("dialog_label_get_note_list")+"</a></li>":e},CodiMdViewUtils.judgeNoteEnable=function(){var e=LoginUser.getInstance().getTenantInfo().note;return"object"!=("undefined"==typeof e?"undefined":_typeof(e))||!1 in e?!1:e.enable}}(),function(){DialogAssignNoteOnSendMessageView.prototype=$.extend({},DialogAssignNoteView.prototype);var e=(DialogOkCancelView.prototype,DialogAssignNoteOnSendMessageView.prototype);e.executeAssignNote=function(){var e=this;if(e._dialogAreaElement.find("#dialog-error").text(""),e._allNoteNames.length||ViewUtils.modal_allexit(),!e._selectAssignNote||!e._selectAssignNote.length)return void e._dialogAreaElement.find("#dialog-error").text(Resource.getMessage("dialog_error_no_select_assign_note"));this._attachElement.children("p , .note_cancel_btn").remove(),this._attachElement.children(".note_cancel_btn").off();var t=e._selectAssignNote.attr("value"),n=Utils.convertEscapedHtml(e._selectAssignNote.find(".note-name .note-list").text()),o='            <p title="'+n+'" value="'+t+'">'+n+'</p>            <a class="ico_btn note_cancel_btn">                <i class="fa fa-close" title="'+Resource.getMessage("dialog_label_cancel")+'"></i>            </a>';this._attachElement.append(o),this._attachElement.find(".note_cancel_btn").on("click",function(){$(this).off(),$(this).parent().find("p").remove(),$(this).remove()}),ViewUtils.modal_allexit()}}(),function(){PluginUtility.loadJsFile=function(e){var t=!1;if(null!=e&&"string"==typeof e){var n=document.createElement("script"),o=e;-1==e.indexOf("?")?n.src=o+"?rannum="+Math.floor(65536*Math.random()):n.src=o+"&rannum="+Math.floor(65536*Math.random()),document.body.appendChild(n),t=!0}return t}}(),function(){PluginReader.onLoadPluginList=function(e){if("undefined"==typeof e)return!1;var t=e;if(null==t||!(t instanceof Array))return!1;for(var n="js/plugins",o="main.js",i=0;i<t.length;i++){var a=t[i];a=n+"/"+a+"/"+o,PluginUtility.loadJsFile(a)}return!0}}(),function(){$(function(){var e="js/plugins/pluginlist";$.ajax({type:"GET",url:e,cache:!1,dataType:"text",success:function(e){for(var t=e.split(/\r\n|\r|\n/),n=[],o=0;o<t.length;o++)if(null!=t[o]){var i=t[o].indexOf("#"),a=t[o];-1!=i&&(a=t[o].substring(0,i)),a=$.trim(a),""!=a&&n.push(a)}PluginReader.onLoadPluginList(n)},error:function(){console.log("faild to get pluginlist")}})});var e="js/custom_ext/main.js";document.write('<script src="'+e+"?rannum="+Math.floor(65536*Math.random())+'"></script>')}(),Conf.getVal("PORTAL_ENABLED")){var PortalManager=function(){};!function(){PortalManager.PORTAL_ROOT_PATH="portal/",PortalManager._beforeDisplayModeIsMobile=!(window.innerWidth<LayoutManager.MARGINAL_WIDTH),PortalManager._loginTicket=null,PortalManager.viewContents=function(){var e,t=window.innerHeight,n=300,o=300,i=200,a=$(document).find("#loginOuterContainerTop"),r=$(document).find("#loginOuterContainerLeft"),s=$(document).find("#loginOuterContainerBottom"),l=$(document).find("#loginContainer");window.innerWidth<LayoutManager.MARGINAL_WIDTH?(r.width(0),r.html(""),s.height(0),s.html(""),a.css({height:o+"px","vertical-align":"middle","text-align":"left"}),PortalManager._beforeDisplayModeIsMobile===!1&&a.html('<iframe style="width:100%;height:100%;overflow:hidden;" src="'+PortalManager.PORTAL_ROOT_PATH+'top.html"></iframe>'),PortalManager._beforeDisplayModeIsMobile=!0,e=t-o):(a.height(0),a.html(""),r.css({width:n+"px","vertical-align":"top","text-align":"center"}),s.css({height:i+"px","vertical-align":"middle","text-align":"left"}),r.height(t),PortalManager._beforeDisplayModeIsMobile===!0?(r.html('<iframe style="width:100%;height:100%;overflow:hidden;" src="'+PortalManager.PORTAL_ROOT_PATH+'left.html"></iframe>'),s.html('<iframe style="width:100%;height:100%;overflow:hidden;" src="'+PortalManager.PORTAL_ROOT_PATH+'bottom.html"></iframe>')):r.children("iframe").eq(0).height(t),PortalManager._beforeDisplayModeIsMobile=!1,e=t-i),e>0?l.height(e):(l.height(0),r.height(t)),location.href="#PORTAL"},PortalManager.autoLogin=function(){var e=PortalManager._loginTicket;e?($("#btnLogin").css({visibility:"hidden"}),LoginView.getInstance()._execTicketLogin(e),LoginView.getInstance()._setResourceStaticElements()):$("#btnAutoLogin").hide()},$(window).resize(function(){"none"!=$(document).find("#loginOuterContainer").css("display")&&setTimeout(PortalManager.viewContents,1)}),PortalManager.viewContents()}(),LoginTicket.read=function(){if(PortalManager._loginTicket)return PortalManager._loginTicket;var e=localStorage.getItem(LoginView.URI_PARAM_LOGIN_TICKET);if(e&&(e=decrypt(e,createKey(_aes_password,_aes_salt),_aes_iv_string)),!e)return null;var t=LoginTicket.loginTicket2Account(e);if(t&&t.id){PortalManager._loginTicket=e;var n=$(document).find("#btnLogin");n.before('<div><a href="#" id="btnAutoLogin" onclick="PortalManager.autoLogin()" style="background-color:white;padding-left:5px;padding-right:5px;">Login as "'+t.id+'"</a><div><br>')}return null}}!function(){DialogSearchOptionView.prototype=$.extend({},DialogOkCancelView.prototype);var e=(DialogOkCancelView.prototype,DialogSearchOptionView.prototype);e._init=function(){var e=this;e.frame=e.getHtml(),e._dialogAreaElement.html(e.frame),e._dialogInnerElement=e._dialogAreaElement.children();var t=ContextSearchView.getInstance().getOptions();e.selectedOptions=[];for(var n=0;n<t.getCount();n++)e.selectedOptions.push(t.get(n));e._dialogInnerElement.find('input[name=search-column-checkbox][value="1"]').prop("checked",-1!=e.selectedOptions.indexOf(1)),e._dialogInnerElement.find('input[name=search-column-checkbox][value="9"]').prop("checked",-1!=e.selectedOptions.indexOf(9)),e._dialogInnerElement.find('input[name=search-column-checkbox][value="6"]').prop("checked",-1!=e.selectedOptions.indexOf(6)),e._dialogInnerElement.find('input[name=search-column-checkbox][value="12"]').prop("checked",-1!=e.selectedOptions.indexOf(12)),e._dialogInnerElement.find('input[name=search-column-checkbox][value="13"]').prop("checked",-1!=e.selectedOptions.indexOf(13)),e._dialogInnerElement.find('input[name=search-column-checkbox][value="3"]').prop("checked",-1!=e.selectedOptions.indexOf(3)),e._dialogInnerElement.find('input[name=search-column-checkbox][value="4"]').prop("checked",-1!=e.selectedOptions.indexOf(4)),e._dialogInnerElement.find('input[name=search-column-checkbox][value="10"]').prop("checked",-1!=e.selectedOptions.indexOf(10)),e._dialogInnerElement.find('input[name=search-column-checkbox][value="17"]').prop("checked",-1!=e.selectedOptions.indexOf(17)),e._dialogInnerElement.find('input[name=search-column-checkbox][value="18"]').prop("checked",-1!=e.selectedOptions.indexOf(18)),e._dialogInnerElement.find(".success_btn").on("click",function(){for(var t=e._dialogInnerElement.find("input[name=search-column-checkbox]:checked"),n=[],o=0;o<t.length;o++)n.push(parseInt(t[o].value));return 0===n.length?void e._dialogInnerElement.find("#dialog-error").text(Resource.getMessage("dialogerrorSelect")):(ContextSearchView.getInstance().setOptions(n),ViewUtils.modal_allexit(),void(e._dialogInnerElement=null))}),e._dialogInnerElement.find("input[name=allcheck]").on("change",function(){e._dialogInnerElement.find("input[name=search-column-checkbox]").prop("checked",this.checked)})},e.getHtml=function(){var e='<div id="searchmenu_modal" class="card modal_card">            <div class="card_title">                <p>'+Resource.getMessage("search_option_title")+'</p>            </div>            <div class="select_menu cf">                <label class="modal_btn all_check">'+Resource.getMessage("wizard_chatlist_allcheck")+'<label class="checkbox"><input type="checkbox" name="allcheck"><span></span></label></label>            </div>            <div class="list_wrapper">                <ul class="modal_list select_list cf">                    <li><label> <span class="name">'+Resource.getMessage("MyFeed")+'</span> <label class="checkbox"><input type="checkbox" id="column-info-search-myfeed" value="'+ColumnInformation.TYPE_COLUMN_TIMELINE+'" name="search-column-checkbox"><span></span></label> </label></li>                    <li><label> <span class="name">'+Resource.getMessage("GroupChat")+'</span> <label class="checkbox"><input type="checkbox" id="column-info-search-groupchat" value="'+ColumnInformation.TYPE_COLUMN_GROUP_CHAT+'" name="search-column-checkbox"><span></span></label> </label></li>                    <li><label> <span class="name">'+Resource.getMessage("Inbox")+'</span> <label class="checkbox"><input type="checkbox" id="column-info-search-inbox" value="'+ColumnInformation.TYPE_COLUMN_INBOX+'" name="search-column-checkbox"><span></span></label> </label></li>                    <li><label> <span class="name">'+Resource.getMessage("CommunityFeed")+'</span> <label class="checkbox"><input type="checkbox" id="column-info-search-community-feed" value="'+ColumnInformation.TYPE_COLUMN_COMMUNITY_FEED+'" name="search-column-checkbox"><span></span></label> </label></li>                    <li><label> <span class="name">'+Resource.getMessage("ContextSearchCommunityTask")+'</span> <label class="checkbox"><input type="checkbox" id="column-info-search-community-task" value="'+ColumnInformation.TYPE_COLUMN_COMMUNITY_TASK+'" name="search-column-checkbox"><span></span></label> </label></li>                    <li><label> <span class="name">'+Resource.getMessage("Chat")+'</span> <label class="checkbox"><input type="checkbox" id="column-info-search-chat" value="'+ColumnInformation.TYPE_COLUMN_CHAT+'" name="search-column-checkbox"><span></span></label> </label></li>                    <li><label> <span class="name">'+Resource.getMessage("MyTask")+'</span> <label class="checkbox"><input type="checkbox" id="column-info-search-task" value="'+ColumnInformation.TYPE_COLUMN_TASK+'" name="search-column-checkbox"><span></span></label> </label></li>                    <li><label> <span class="name">'+Resource.getMessage("Questionnaire")+'</span> <label class="checkbox"><input type="checkbox" id="column-info-search-questionnaire" value="'+ColumnInformation.TYPE_COLUMN_QUESTIONNAIRE+'" name="search-column-checkbox"><span></span></label> </label></li>                    <li><label> <span class="name">'+Resource.getMessage("Murmur")+'</span> <label class="checkbox"><input type="checkbox" id="column-info-search-murmur" value="'+ColumnInformation.TYPE_COLUMN_MURMUR+'" name="search-column-checkbox"><span></span></label> </label></li>                    <li></li>                </ul>            </div>            <div class="btn_wrapper">                <p id="dialog-error" class="ui-state-error-text dialog_error_footer"></p>                <button type="button" class="modal_btn success_btn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover" role="button" aria-disabled="false"><span class="ui-button-text">OK</span></button>            </div>            <a class="modal_exit modal_exit_btn ico_btn ui-dialog-titlebar-close ui-corner-all" role="button"><i class="fa fa-times"></i></a>        </div>';return $(e)}}();